function A_(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var ml=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function OV(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function PV(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){if(this instanceof r){var s=[null];s.push.apply(s,arguments);var o=Function.bind.apply(e,s);return new o}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var Oh={},FV={get exports(){return Oh},set exports(t){Oh=t}},Oy={},W={},LV={get exports(){return W},set exports(t){W=t}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ud=Symbol.for("react.element"),MV=Symbol.for("react.portal"),zV=Symbol.for("react.fragment"),BV=Symbol.for("react.strict_mode"),UV=Symbol.for("react.profiler"),VV=Symbol.for("react.provider"),WV=Symbol.for("react.context"),jV=Symbol.for("react.forward_ref"),GV=Symbol.for("react.suspense"),HV=Symbol.for("react.memo"),KV=Symbol.for("react.lazy"),AE=Symbol.iterator;function qV(t){return t===null||typeof t!="object"?null:(t=AE&&t[AE]||t["@@iterator"],typeof t=="function"?t:null)}var D_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O_=Object.assign,P_={};function ru(t,e,n){this.props=t,this.context=e,this.refs=P_,this.updater=n||D_}ru.prototype.isReactComponent={};ru.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ru.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function F_(){}F_.prototype=ru.prototype;function GC(t,e,n){this.props=t,this.context=e,this.refs=P_,this.updater=n||D_}var HC=GC.prototype=new F_;HC.constructor=GC;O_(HC,ru.prototype);HC.isPureReactComponent=!0;var DE=Array.isArray,L_=Object.prototype.hasOwnProperty,KC={current:null},M_={key:!0,ref:!0,__self:!0,__source:!0};function z_(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)L_.call(e,r)&&!M_.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Ud,type:t,key:o,ref:i,props:s,_owner:KC.current}}function XV(t,e){return{$$typeof:Ud,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qC(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ud}function YV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var OE=/\/+/g;function vx(t,e){return typeof t=="object"&&t!==null&&t.key!=null?YV(""+t.key):e.toString(36)}function Tm(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Ud:case MV:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+vx(i,0):r,DE(s)?(n="",t!=null&&(n=t.replace(OE,"$&/")+"/"),Tm(s,e,n,"",function(c){return c})):s!=null&&(qC(s)&&(s=XV(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(OE,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",DE(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+vx(o,a);i+=Tm(o,e,n,l,s)}else if(l=qV(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+vx(o,a++),i+=Tm(o,e,n,l,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function zp(t,e,n){if(t==null)return t;var r=[],s=0;return Tm(t,r,"","",function(o){return e.call(n,o,s++)}),r}function QV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cr={current:null},Rm={transition:null},JV={ReactCurrentDispatcher:cr,ReactCurrentBatchConfig:Rm,ReactCurrentOwner:KC};Ue.Children={map:zp,forEach:function(t,e,n){zp(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return zp(t,function(){e++}),e},toArray:function(t){return zp(t,function(e){return e})||[]},only:function(t){if(!qC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ue.Component=ru;Ue.Fragment=zV;Ue.Profiler=UV;Ue.PureComponent=GC;Ue.StrictMode=BV;Ue.Suspense=GV;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JV;Ue.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=O_({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=KC.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)L_.call(e,l)&&!M_.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Ud,type:t.type,key:s,ref:o,props:r,_owner:i}};Ue.createContext=function(t){return t={$$typeof:WV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:VV,_context:t},t.Consumer=t};Ue.createElement=z_;Ue.createFactory=function(t){var e=z_.bind(null,t);return e.type=t,e};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(t){return{$$typeof:jV,render:t}};Ue.isValidElement=qC;Ue.lazy=function(t){return{$$typeof:KV,_payload:{_status:-1,_result:t},_init:QV}};Ue.memo=function(t,e){return{$$typeof:HV,type:t,compare:e===void 0?null:e}};Ue.startTransition=function(t){var e=Rm.transition;Rm.transition={};try{t()}finally{Rm.transition=e}};Ue.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ue.useCallback=function(t,e){return cr.current.useCallback(t,e)};Ue.useContext=function(t){return cr.current.useContext(t)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(t){return cr.current.useDeferredValue(t)};Ue.useEffect=function(t,e){return cr.current.useEffect(t,e)};Ue.useId=function(){return cr.current.useId()};Ue.useImperativeHandle=function(t,e,n){return cr.current.useImperativeHandle(t,e,n)};Ue.useInsertionEffect=function(t,e){return cr.current.useInsertionEffect(t,e)};Ue.useLayoutEffect=function(t,e){return cr.current.useLayoutEffect(t,e)};Ue.useMemo=function(t,e){return cr.current.useMemo(t,e)};Ue.useReducer=function(t,e,n){return cr.current.useReducer(t,e,n)};Ue.useRef=function(t){return cr.current.useRef(t)};Ue.useState=function(t){return cr.current.useState(t)};Ue.useSyncExternalStore=function(t,e,n){return cr.current.useSyncExternalStore(t,e,n)};Ue.useTransition=function(){return cr.current.useTransition()};Ue.version="18.2.0";(function(t){t.exports=Ue})(LV);const q=OV(W),Fb=A_({__proto__:null,default:q},[W]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZV=W,eW=Symbol.for("react.element"),tW=Symbol.for("react.fragment"),nW=Object.prototype.hasOwnProperty,rW=ZV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sW={key:!0,ref:!0,__self:!0,__source:!0};function B_(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)nW.call(e,r)&&!sW.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:eW,type:t,key:o,ref:i,props:s,_owner:rW.current}}Oy.Fragment=tW;Oy.jsx=B_;Oy.jsxs=B_;(function(t){t.exports=Oy})(FV);const _o=Oh.Fragment,T=Oh.jsx,he=Oh.jsxs;var Lb={},Mb={},oW={get exports(){return Mb},set exports(t){Mb=t}},Vr={},zb={},iW={get exports(){return zb},set exports(t){zb=t}},U_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(R,D){var z=R.length;R.push(D);e:for(;0<z;){var Q=z-1>>>1,J=R[Q];if(0<s(J,D))R[Q]=D,R[z]=J,z=Q;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var D=R[0],z=R.pop();if(z!==D){R[0]=z;e:for(var Q=0,J=R.length,ee=J>>>1;Q<ee;){var ie=2*(Q+1)-1,re=R[ie],ue=ie+1,ge=R[ue];if(0>s(re,z))ue<J&&0>s(ge,re)?(R[Q]=ge,R[ue]=z,Q=ue):(R[Q]=re,R[ie]=z,Q=ie);else if(ue<J&&0>s(ge,z))R[Q]=ge,R[ue]=z,Q=ue;else break e}}return D}function s(R,D){var z=R.sortIndex-D.sortIndex;return z!==0?z:R.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,p=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(R){for(var D=n(c);D!==null;){if(D.callback===null)r(c);else if(D.startTime<=R)r(c),D.sortIndex=D.expirationTime,e(l,D);else break;D=n(c)}}function b(R){if(m=!1,x(R),!p)if(n(l)!==null)p=!0,H(w);else{var D=n(c);D!==null&&K(b,D.startTime-R)}}function w(R,D){p=!1,m&&(m=!1,g(S),S=-1),f=!0;var z=d;try{for(x(D),h=n(l);h!==null&&(!(h.expirationTime>D)||R&&!A());){var Q=h.callback;if(typeof Q=="function"){h.callback=null,d=h.priorityLevel;var J=Q(h.expirationTime<=D);D=t.unstable_now(),typeof J=="function"?h.callback=J:h===n(l)&&r(l),x(D)}else r(l);h=n(l)}if(h!==null)var ee=!0;else{var ie=n(c);ie!==null&&K(b,ie.startTime-D),ee=!1}return ee}finally{h=null,d=z,f=!1}}var C=!1,I=null,S=-1,$=5,E=-1;function A(){return!(t.unstable_now()-E<$)}function M(){if(I!==null){var R=t.unstable_now();E=R;var D=!0;try{D=I(!0,R)}finally{D?B():(C=!1,I=null)}}else C=!1}var B;if(typeof v=="function")B=function(){v(M)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,V=U.port2;U.port1.onmessage=M,B=function(){V.postMessage(null)}}else B=function(){y(M,0)};function H(R){I=R,C||(C=!0,B())}function K(R,D){S=y(function(){R(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,H(w))},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(R){switch(d){case 1:case 2:case 3:var D=3;break;default:D=d}var z=d;d=D;try{return R()}finally{d=z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(R,D){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var z=d;d=R;try{return D()}finally{d=z}},t.unstable_scheduleCallback=function(R,D,z){var Q=t.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?Q+z:Q):z=Q,R){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=z+J,R={id:u++,callback:D,priorityLevel:R,startTime:z,expirationTime:J,sortIndex:-1},z>Q?(R.sortIndex=z,e(c,R),n(l)===null&&R===n(c)&&(m?(g(S),S=-1):m=!0,K(b,z-Q))):(R.sortIndex=J,e(l,R),p||f||(p=!0,H(w))),R},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(R){var D=d;return function(){var z=d;d=D;try{return R.apply(this,arguments)}finally{d=z}}}})(U_);(function(t){t.exports=U_})(iW);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V_=W,zr=zb;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var W_=new Set,Ph={};function gl(t,e){Cc(t,e),Cc(t+"Capture",e)}function Cc(t,e){for(Ph[t]=e,t=0;t<e.length;t++)W_.add(e[t])}var Ao=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bb=Object.prototype.hasOwnProperty,aW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,PE={},FE={};function lW(t){return Bb.call(FE,t)?!0:Bb.call(PE,t)?!1:aW.test(t)?FE[t]=!0:(PE[t]=!0,!1)}function cW(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function uW(t,e,n,r){if(e===null||typeof e>"u"||cW(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ur(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Tn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tn[t]=new ur(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tn[e]=new ur(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tn[t]=new ur(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tn[t]=new ur(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tn[t]=new ur(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tn[t]=new ur(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tn[t]=new ur(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tn[t]=new ur(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tn[t]=new ur(t,5,!1,t.toLowerCase(),null,!1,!1)});var XC=/[\-:]([a-z])/g;function YC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(XC,YC);Tn[e]=new ur(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(XC,YC);Tn[e]=new ur(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(XC,YC);Tn[e]=new ur(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tn[t]=new ur(t,1,!1,t.toLowerCase(),null,!1,!1)});Tn.xlinkHref=new ur("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tn[t]=new ur(t,1,!1,t.toLowerCase(),null,!0,!0)});function QC(t,e,n,r){var s=Tn.hasOwnProperty(e)?Tn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(uW(e,n,s,r)&&(n=null),r||s===null?lW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ho=V_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bp=Symbol.for("react.element"),Vl=Symbol.for("react.portal"),Wl=Symbol.for("react.fragment"),JC=Symbol.for("react.strict_mode"),Ub=Symbol.for("react.profiler"),j_=Symbol.for("react.provider"),G_=Symbol.for("react.context"),ZC=Symbol.for("react.forward_ref"),Vb=Symbol.for("react.suspense"),Wb=Symbol.for("react.suspense_list"),eI=Symbol.for("react.memo"),oi=Symbol.for("react.lazy"),H_=Symbol.for("react.offscreen"),LE=Symbol.iterator;function Vu(t){return t===null||typeof t!="object"?null:(t=LE&&t[LE]||t["@@iterator"],typeof t=="function"?t:null)}var Dt=Object.assign,xx;function eh(t){if(xx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xx=e&&e[1]||""}return`
`+xx+t}var bx=!1;function wx(t,e){if(!t||bx)return"";bx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{bx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?eh(t):""}function hW(t){switch(t.tag){case 5:return eh(t.type);case 16:return eh("Lazy");case 13:return eh("Suspense");case 19:return eh("SuspenseList");case 0:case 2:case 15:return t=wx(t.type,!1),t;case 11:return t=wx(t.type.render,!1),t;case 1:return t=wx(t.type,!0),t;default:return""}}function jb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wl:return"Fragment";case Vl:return"Portal";case Ub:return"Profiler";case JC:return"StrictMode";case Vb:return"Suspense";case Wb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case G_:return(t.displayName||"Context")+".Consumer";case j_:return(t._context.displayName||"Context")+".Provider";case ZC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case eI:return e=t.displayName||null,e!==null?e:jb(t.type)||"Memo";case oi:e=t._payload,t=t._init;try{return jb(t(e))}catch{}}return null}function dW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jb(e);case 8:return e===JC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Bi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function K_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function fW(t){var e=K_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Up(t){t._valueTracker||(t._valueTracker=fW(t))}function q_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=K_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Qm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gb(t,e){var n=e.checked;return Dt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ME(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Bi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function X_(t,e){e=e.checked,e!=null&&QC(t,"checked",e,!1)}function Hb(t,e){X_(t,e);var n=Bi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Kb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Kb(t,e.type,Bi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function zE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Kb(t,e,n){(e!=="number"||Qm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var th=Array.isArray;function ic(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Bi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function qb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return Dt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function BE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(th(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Bi(n)}}function Y_(t,e){var n=Bi(e.value),r=Bi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function UE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Q_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Q_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Vp,J_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Vp=Vp||document.createElement("div"),Vp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Vp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var gh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pW=["Webkit","ms","Moz","O"];Object.keys(gh).forEach(function(t){pW.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),gh[e]=gh[t]})});function Z_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||gh.hasOwnProperty(t)&&gh[t]?(""+e).trim():e+"px"}function eA(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Z_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var mW=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yb(t,e){if(e){if(mW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function Qb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jb=null;function tI(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Zb=null,ac=null,lc=null;function VE(t){if(t=jd(t)){if(typeof Zb!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=zy(e),Zb(t.stateNode,t.type,e))}}function tA(t){ac?lc?lc.push(t):lc=[t]:ac=t}function nA(){if(ac){var t=ac,e=lc;if(lc=ac=null,VE(t),e)for(t=0;t<e.length;t++)VE(e[t])}}function rA(t,e){return t(e)}function sA(){}var Cx=!1;function oA(t,e,n){if(Cx)return t(e,n);Cx=!0;try{return rA(t,e,n)}finally{Cx=!1,(ac!==null||lc!==null)&&(sA(),nA())}}function Lh(t,e){var n=t.stateNode;if(n===null)return null;var r=zy(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var e1=!1;if(Ao)try{var Wu={};Object.defineProperty(Wu,"passive",{get:function(){e1=!0}}),window.addEventListener("test",Wu,Wu),window.removeEventListener("test",Wu,Wu)}catch{e1=!1}function gW(t,e,n,r,s,o,i,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var yh=!1,Jm=null,Zm=!1,t1=null,yW={onError:function(t){yh=!0,Jm=t}};function vW(t,e,n,r,s,o,i,a,l){yh=!1,Jm=null,gW.apply(yW,arguments)}function xW(t,e,n,r,s,o,i,a,l){if(vW.apply(this,arguments),yh){if(yh){var c=Jm;yh=!1,Jm=null}else throw Error(ne(198));Zm||(Zm=!0,t1=c)}}function yl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function iA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function WE(t){if(yl(t)!==t)throw Error(ne(188))}function bW(t){var e=t.alternate;if(!e){if(e=yl(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return WE(s),t;if(o===r)return WE(s),e;o=o.sibling}throw Error(ne(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(ne(189))}}if(n.alternate!==r)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function aA(t){return t=bW(t),t!==null?lA(t):null}function lA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=lA(t);if(e!==null)return e;t=t.sibling}return null}var cA=zr.unstable_scheduleCallback,jE=zr.unstable_cancelCallback,wW=zr.unstable_shouldYield,CW=zr.unstable_requestPaint,Vt=zr.unstable_now,IW=zr.unstable_getCurrentPriorityLevel,nI=zr.unstable_ImmediatePriority,uA=zr.unstable_UserBlockingPriority,eg=zr.unstable_NormalPriority,SW=zr.unstable_LowPriority,hA=zr.unstable_IdlePriority,Py=null,Zs=null;function kW(t){if(Zs&&typeof Zs.onCommitFiberRoot=="function")try{Zs.onCommitFiberRoot(Py,t,void 0,(t.current.flags&128)===128)}catch{}}var $s=Math.clz32?Math.clz32:NW,$W=Math.log,EW=Math.LN2;function NW(t){return t>>>=0,t===0?32:31-($W(t)/EW|0)|0}var Wp=64,jp=4194304;function nh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function tg(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=nh(a):(o&=i,o!==0&&(r=nh(o)))}else i=n&~s,i!==0?r=nh(i):o!==0&&(r=nh(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-$s(e),s=1<<n,r|=t[n],e&=~s;return r}function TW(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function RW(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-$s(o),a=1<<i,l=s[i];l===-1?(!(a&n)||a&r)&&(s[i]=TW(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function n1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function dA(){var t=Wp;return Wp<<=1,!(Wp&4194240)&&(Wp=64),t}function Ix(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$s(e),t[e]=n}function _W(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-$s(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function rI(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-$s(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var rt=0;function fA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pA,sI,mA,gA,yA,r1=!1,Gp=[],Ci=null,Ii=null,Si=null,Mh=new Map,zh=new Map,li=[],AW="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function GE(t,e){switch(t){case"focusin":case"focusout":Ci=null;break;case"dragenter":case"dragleave":Ii=null;break;case"mouseover":case"mouseout":Si=null;break;case"pointerover":case"pointerout":Mh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zh.delete(e.pointerId)}}function ju(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=jd(e),e!==null&&sI(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function DW(t,e,n,r,s){switch(e){case"focusin":return Ci=ju(Ci,t,e,n,r,s),!0;case"dragenter":return Ii=ju(Ii,t,e,n,r,s),!0;case"mouseover":return Si=ju(Si,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return Mh.set(o,ju(Mh.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,zh.set(o,ju(zh.get(o)||null,t,e,n,r,s)),!0}return!1}function vA(t){var e=ka(t.target);if(e!==null){var n=yl(e);if(n!==null){if(e=n.tag,e===13){if(e=iA(n),e!==null){t.blockedOn=e,yA(t.priority,function(){mA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function _m(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=s1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Jb=r,n.target.dispatchEvent(r),Jb=null}else return e=jd(n),e!==null&&sI(e),t.blockedOn=n,!1;e.shift()}return!0}function HE(t,e,n){_m(t)&&n.delete(e)}function OW(){r1=!1,Ci!==null&&_m(Ci)&&(Ci=null),Ii!==null&&_m(Ii)&&(Ii=null),Si!==null&&_m(Si)&&(Si=null),Mh.forEach(HE),zh.forEach(HE)}function Gu(t,e){t.blockedOn===e&&(t.blockedOn=null,r1||(r1=!0,zr.unstable_scheduleCallback(zr.unstable_NormalPriority,OW)))}function Bh(t){function e(s){return Gu(s,t)}if(0<Gp.length){Gu(Gp[0],t);for(var n=1;n<Gp.length;n++){var r=Gp[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ci!==null&&Gu(Ci,t),Ii!==null&&Gu(Ii,t),Si!==null&&Gu(Si,t),Mh.forEach(e),zh.forEach(e),n=0;n<li.length;n++)r=li[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<li.length&&(n=li[0],n.blockedOn===null);)vA(n),n.blockedOn===null&&li.shift()}var cc=Ho.ReactCurrentBatchConfig,ng=!0;function PW(t,e,n,r){var s=rt,o=cc.transition;cc.transition=null;try{rt=1,oI(t,e,n,r)}finally{rt=s,cc.transition=o}}function FW(t,e,n,r){var s=rt,o=cc.transition;cc.transition=null;try{rt=4,oI(t,e,n,r)}finally{rt=s,cc.transition=o}}function oI(t,e,n,r){if(ng){var s=s1(t,e,n,r);if(s===null)Dx(t,e,r,rg,n),GE(t,r);else if(DW(s,t,e,n,r))r.stopPropagation();else if(GE(t,r),e&4&&-1<AW.indexOf(t)){for(;s!==null;){var o=jd(s);if(o!==null&&pA(o),o=s1(t,e,n,r),o===null&&Dx(t,e,r,rg,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Dx(t,e,r,null,n)}}var rg=null;function s1(t,e,n,r){if(rg=null,t=tI(r),t=ka(t),t!==null)if(e=yl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=iA(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return rg=t,null}function xA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(IW()){case nI:return 1;case uA:return 4;case eg:case SW:return 16;case hA:return 536870912;default:return 16}default:return 16}}var pi=null,iI=null,Am=null;function bA(){if(Am)return Am;var t,e=iI,n=e.length,r,s="value"in pi?pi.value:pi.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return Am=s.slice(t,1<r?1-r:void 0)}function Dm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Hp(){return!0}function KE(){return!1}function Wr(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Hp:KE,this.isPropagationStopped=KE,this}return Dt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Hp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Hp)},persist:function(){},isPersistent:Hp}),e}var su={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},aI=Wr(su),Wd=Dt({},su,{view:0,detail:0}),LW=Wr(Wd),Sx,kx,Hu,Fy=Dt({},Wd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lI,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Hu&&(Hu&&t.type==="mousemove"?(Sx=t.screenX-Hu.screenX,kx=t.screenY-Hu.screenY):kx=Sx=0,Hu=t),Sx)},movementY:function(t){return"movementY"in t?t.movementY:kx}}),qE=Wr(Fy),MW=Dt({},Fy,{dataTransfer:0}),zW=Wr(MW),BW=Dt({},Wd,{relatedTarget:0}),$x=Wr(BW),UW=Dt({},su,{animationName:0,elapsedTime:0,pseudoElement:0}),VW=Wr(UW),WW=Dt({},su,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jW=Wr(WW),GW=Dt({},su,{data:0}),XE=Wr(GW),HW={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KW={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qW={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function XW(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=qW[t])?!!e[t]:!1}function lI(){return XW}var YW=Dt({},Wd,{key:function(t){if(t.key){var e=HW[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Dm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?KW[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lI,charCode:function(t){return t.type==="keypress"?Dm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Dm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),QW=Wr(YW),JW=Dt({},Fy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),YE=Wr(JW),ZW=Dt({},Wd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lI}),ej=Wr(ZW),tj=Dt({},su,{propertyName:0,elapsedTime:0,pseudoElement:0}),nj=Wr(tj),rj=Dt({},Fy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sj=Wr(rj),oj=[9,13,27,32],cI=Ao&&"CompositionEvent"in window,vh=null;Ao&&"documentMode"in document&&(vh=document.documentMode);var ij=Ao&&"TextEvent"in window&&!vh,wA=Ao&&(!cI||vh&&8<vh&&11>=vh),QE=String.fromCharCode(32),JE=!1;function CA(t,e){switch(t){case"keyup":return oj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function IA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var jl=!1;function aj(t,e){switch(t){case"compositionend":return IA(e);case"keypress":return e.which!==32?null:(JE=!0,QE);case"textInput":return t=e.data,t===QE&&JE?null:t;default:return null}}function lj(t,e){if(jl)return t==="compositionend"||!cI&&CA(t,e)?(t=bA(),Am=iI=pi=null,jl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return wA&&e.locale!=="ko"?null:e.data;default:return null}}var cj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ZE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!cj[t.type]:e==="textarea"}function SA(t,e,n,r){tA(r),e=sg(e,"onChange"),0<e.length&&(n=new aI("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var xh=null,Uh=null;function uj(t){PA(t,0)}function Ly(t){var e=Kl(t);if(q_(e))return t}function hj(t,e){if(t==="change")return e}var kA=!1;if(Ao){var Ex;if(Ao){var Nx="oninput"in document;if(!Nx){var eN=document.createElement("div");eN.setAttribute("oninput","return;"),Nx=typeof eN.oninput=="function"}Ex=Nx}else Ex=!1;kA=Ex&&(!document.documentMode||9<document.documentMode)}function tN(){xh&&(xh.detachEvent("onpropertychange",$A),Uh=xh=null)}function $A(t){if(t.propertyName==="value"&&Ly(Uh)){var e=[];SA(e,Uh,t,tI(t)),oA(uj,e)}}function dj(t,e,n){t==="focusin"?(tN(),xh=e,Uh=n,xh.attachEvent("onpropertychange",$A)):t==="focusout"&&tN()}function fj(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ly(Uh)}function pj(t,e){if(t==="click")return Ly(e)}function mj(t,e){if(t==="input"||t==="change")return Ly(e)}function gj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var _s=typeof Object.is=="function"?Object.is:gj;function Vh(t,e){if(_s(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Bb.call(e,s)||!_s(t[s],e[s]))return!1}return!0}function nN(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function rN(t,e){var n=nN(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=nN(n)}}function EA(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?EA(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function NA(){for(var t=window,e=Qm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Qm(t.document)}return e}function uI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function yj(t){var e=NA(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&EA(n.ownerDocument.documentElement,n)){if(r!==null&&uI(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=rN(n,o);var i=rN(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var vj=Ao&&"documentMode"in document&&11>=document.documentMode,Gl=null,o1=null,bh=null,i1=!1;function sN(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;i1||Gl==null||Gl!==Qm(r)||(r=Gl,"selectionStart"in r&&uI(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bh&&Vh(bh,r)||(bh=r,r=sg(o1,"onSelect"),0<r.length&&(e=new aI("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Gl)))}function Kp(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Hl={animationend:Kp("Animation","AnimationEnd"),animationiteration:Kp("Animation","AnimationIteration"),animationstart:Kp("Animation","AnimationStart"),transitionend:Kp("Transition","TransitionEnd")},Tx={},TA={};Ao&&(TA=document.createElement("div").style,"AnimationEvent"in window||(delete Hl.animationend.animation,delete Hl.animationiteration.animation,delete Hl.animationstart.animation),"TransitionEvent"in window||delete Hl.transitionend.transition);function My(t){if(Tx[t])return Tx[t];if(!Hl[t])return t;var e=Hl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in TA)return Tx[t]=e[n];return t}var RA=My("animationend"),_A=My("animationiteration"),AA=My("animationstart"),DA=My("transitionend"),OA=new Map,oN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zi(t,e){OA.set(t,e),gl(e,[t])}for(var Rx=0;Rx<oN.length;Rx++){var _x=oN[Rx],xj=_x.toLowerCase(),bj=_x[0].toUpperCase()+_x.slice(1);Zi(xj,"on"+bj)}Zi(RA,"onAnimationEnd");Zi(_A,"onAnimationIteration");Zi(AA,"onAnimationStart");Zi("dblclick","onDoubleClick");Zi("focusin","onFocus");Zi("focusout","onBlur");Zi(DA,"onTransitionEnd");Cc("onMouseEnter",["mouseout","mouseover"]);Cc("onMouseLeave",["mouseout","mouseover"]);Cc("onPointerEnter",["pointerout","pointerover"]);Cc("onPointerLeave",["pointerout","pointerover"]);gl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gl("onBeforeInput",["compositionend","keypress","textInput","paste"]);gl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wj=new Set("cancel close invalid load scroll toggle".split(" ").concat(rh));function iN(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,xW(r,e,void 0,t),t.currentTarget=null}function PA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var a=r[i],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break e;iN(s,a,c),o=l}else for(i=0;i<r.length;i++){if(a=r[i],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break e;iN(s,a,c),o=l}}}if(Zm)throw t=t1,Zm=!1,t1=null,t}function vt(t,e){var n=e[h1];n===void 0&&(n=e[h1]=new Set);var r=t+"__bubble";n.has(r)||(FA(e,t,2,!1),n.add(r))}function Ax(t,e,n){var r=0;e&&(r|=4),FA(n,t,r,e)}var qp="_reactListening"+Math.random().toString(36).slice(2);function Wh(t){if(!t[qp]){t[qp]=!0,W_.forEach(function(n){n!=="selectionchange"&&(wj.has(n)||Ax(n,!1,t),Ax(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[qp]||(e[qp]=!0,Ax("selectionchange",!1,e))}}function FA(t,e,n,r){switch(xA(e)){case 1:var s=PW;break;case 4:s=FW;break;default:s=oI}n=s.bind(null,e,n,t),s=void 0,!e1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Dx(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;a!==null;){if(i=ka(a),i===null)return;if(l=i.tag,l===5||l===6){r=o=i;continue e}a=a.parentNode}}r=r.return}oA(function(){var c=o,u=tI(n),h=[];e:{var d=OA.get(t);if(d!==void 0){var f=aI,p=t;switch(t){case"keypress":if(Dm(n)===0)break e;case"keydown":case"keyup":f=QW;break;case"focusin":p="focus",f=$x;break;case"focusout":p="blur",f=$x;break;case"beforeblur":case"afterblur":f=$x;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=qE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=zW;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=ej;break;case RA:case _A:case AA:f=VW;break;case DA:f=nj;break;case"scroll":f=LW;break;case"wheel":f=sj;break;case"copy":case"cut":case"paste":f=jW;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=YE}var m=(e&4)!==0,y=!m&&t==="scroll",g=m?d!==null?d+"Capture":null:d;m=[];for(var v=c,x;v!==null;){x=v;var b=x.stateNode;if(x.tag===5&&b!==null&&(x=b,g!==null&&(b=Lh(v,g),b!=null&&m.push(jh(v,b,x)))),y)break;v=v.return}0<m.length&&(d=new f(d,p,null,n,u),h.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==Jb&&(p=n.relatedTarget||n.fromElement)&&(ka(p)||p[Do]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?ka(p):null,p!==null&&(y=yl(p),p!==y||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=qE,b="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=YE,b="onPointerLeave",g="onPointerEnter",v="pointer"),y=f==null?d:Kl(f),x=p==null?d:Kl(p),d=new m(b,v+"leave",f,n,u),d.target=y,d.relatedTarget=x,b=null,ka(u)===c&&(m=new m(g,v+"enter",p,n,u),m.target=x,m.relatedTarget=y,b=m),y=b,f&&p)t:{for(m=f,g=p,v=0,x=m;x;x=Dl(x))v++;for(x=0,b=g;b;b=Dl(b))x++;for(;0<v-x;)m=Dl(m),v--;for(;0<x-v;)g=Dl(g),x--;for(;v--;){if(m===g||g!==null&&m===g.alternate)break t;m=Dl(m),g=Dl(g)}m=null}else m=null;f!==null&&aN(h,d,f,m,!1),p!==null&&y!==null&&aN(h,y,p,m,!0)}}e:{if(d=c?Kl(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var w=hj;else if(ZE(d))if(kA)w=mj;else{w=fj;var C=dj}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(w=pj);if(w&&(w=w(t,c))){SA(h,w,n,u);break e}C&&C(t,d,c),t==="focusout"&&(C=d._wrapperState)&&C.controlled&&d.type==="number"&&Kb(d,"number",d.value)}switch(C=c?Kl(c):window,t){case"focusin":(ZE(C)||C.contentEditable==="true")&&(Gl=C,o1=c,bh=null);break;case"focusout":bh=o1=Gl=null;break;case"mousedown":i1=!0;break;case"contextmenu":case"mouseup":case"dragend":i1=!1,sN(h,n,u);break;case"selectionchange":if(vj)break;case"keydown":case"keyup":sN(h,n,u)}var I;if(cI)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else jl?CA(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(wA&&n.locale!=="ko"&&(jl||S!=="onCompositionStart"?S==="onCompositionEnd"&&jl&&(I=bA()):(pi=u,iI="value"in pi?pi.value:pi.textContent,jl=!0)),C=sg(c,S),0<C.length&&(S=new XE(S,t,null,n,u),h.push({event:S,listeners:C}),I?S.data=I:(I=IA(n),I!==null&&(S.data=I)))),(I=ij?aj(t,n):lj(t,n))&&(c=sg(c,"onBeforeInput"),0<c.length&&(u=new XE("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=I))}PA(h,e)})}function jh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function sg(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Lh(t,n),o!=null&&r.unshift(jh(t,o,s)),o=Lh(t,e),o!=null&&r.push(jh(t,o,s))),t=t.return}return r}function Dl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function aN(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=Lh(n,o),l!=null&&i.unshift(jh(n,l,a))):s||(l=Lh(n,o),l!=null&&i.push(jh(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var Cj=/\r\n?/g,Ij=/\u0000|\uFFFD/g;function lN(t){return(typeof t=="string"?t:""+t).replace(Cj,`
`).replace(Ij,"")}function Xp(t,e,n){if(e=lN(e),lN(t)!==e&&n)throw Error(ne(425))}function og(){}var a1=null,l1=null;function c1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var u1=typeof setTimeout=="function"?setTimeout:void 0,Sj=typeof clearTimeout=="function"?clearTimeout:void 0,cN=typeof Promise=="function"?Promise:void 0,kj=typeof queueMicrotask=="function"?queueMicrotask:typeof cN<"u"?function(t){return cN.resolve(null).then(t).catch($j)}:u1;function $j(t){setTimeout(function(){throw t})}function Ox(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Bh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Bh(e)}function ki(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function uN(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ou=Math.random().toString(36).slice(2),Ks="__reactFiber$"+ou,Gh="__reactProps$"+ou,Do="__reactContainer$"+ou,h1="__reactEvents$"+ou,Ej="__reactListeners$"+ou,Nj="__reactHandles$"+ou;function ka(t){var e=t[Ks];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Do]||n[Ks]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=uN(t);t!==null;){if(n=t[Ks])return n;t=uN(t)}return e}t=n,n=t.parentNode}return null}function jd(t){return t=t[Ks]||t[Do],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Kl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function zy(t){return t[Gh]||null}var d1=[],ql=-1;function ea(t){return{current:t}}function xt(t){0>ql||(t.current=d1[ql],d1[ql]=null,ql--)}function ft(t,e){ql++,d1[ql]=t.current,t.current=e}var Ui={},qn=ea(Ui),br=ea(!1),ja=Ui;function Ic(t,e){var n=t.type.contextTypes;if(!n)return Ui;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function wr(t){return t=t.childContextTypes,t!=null}function ig(){xt(br),xt(qn)}function hN(t,e,n){if(qn.current!==Ui)throw Error(ne(168));ft(qn,e),ft(br,n)}function LA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(ne(108,dW(t)||"Unknown",s));return Dt({},n,r)}function ag(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ui,ja=qn.current,ft(qn,t),ft(br,br.current),!0}function dN(t,e,n){var r=t.stateNode;if(!r)throw Error(ne(169));n?(t=LA(t,e,ja),r.__reactInternalMemoizedMergedChildContext=t,xt(br),xt(qn),ft(qn,t)):xt(br),ft(br,n)}var vo=null,By=!1,Px=!1;function MA(t){vo===null?vo=[t]:vo.push(t)}function Tj(t){By=!0,MA(t)}function ta(){if(!Px&&vo!==null){Px=!0;var t=0,e=rt;try{var n=vo;for(rt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}vo=null,By=!1}catch(s){throw vo!==null&&(vo=vo.slice(t+1)),cA(nI,ta),s}finally{rt=e,Px=!1}}return null}var Xl=[],Yl=0,lg=null,cg=0,Xr=[],Yr=0,Ga=null,wo=1,Co="";function ya(t,e){Xl[Yl++]=cg,Xl[Yl++]=lg,lg=t,cg=e}function zA(t,e,n){Xr[Yr++]=wo,Xr[Yr++]=Co,Xr[Yr++]=Ga,Ga=t;var r=wo;t=Co;var s=32-$s(r)-1;r&=~(1<<s),n+=1;var o=32-$s(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,wo=1<<32-$s(e)+s|n<<s|r,Co=o+t}else wo=1<<o|n<<s|r,Co=t}function hI(t){t.return!==null&&(ya(t,1),zA(t,1,0))}function dI(t){for(;t===lg;)lg=Xl[--Yl],Xl[Yl]=null,cg=Xl[--Yl],Xl[Yl]=null;for(;t===Ga;)Ga=Xr[--Yr],Xr[Yr]=null,Co=Xr[--Yr],Xr[Yr]=null,wo=Xr[--Yr],Xr[Yr]=null}var Fr=null,Dr=null,St=!1,xs=null;function BA(t,e){var n=Jr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function fN(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Fr=t,Dr=ki(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Fr=t,Dr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ga!==null?{id:wo,overflow:Co}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Jr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Fr=t,Dr=null,!0):!1;default:return!1}}function f1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function p1(t){if(St){var e=Dr;if(e){var n=e;if(!fN(t,e)){if(f1(t))throw Error(ne(418));e=ki(n.nextSibling);var r=Fr;e&&fN(t,e)?BA(r,n):(t.flags=t.flags&-4097|2,St=!1,Fr=t)}}else{if(f1(t))throw Error(ne(418));t.flags=t.flags&-4097|2,St=!1,Fr=t}}}function pN(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Fr=t}function Yp(t){if(t!==Fr)return!1;if(!St)return pN(t),St=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!c1(t.type,t.memoizedProps)),e&&(e=Dr)){if(f1(t))throw UA(),Error(ne(418));for(;e;)BA(t,e),e=ki(e.nextSibling)}if(pN(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Dr=ki(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Dr=null}}else Dr=Fr?ki(t.stateNode.nextSibling):null;return!0}function UA(){for(var t=Dr;t;)t=ki(t.nextSibling)}function Sc(){Dr=Fr=null,St=!1}function fI(t){xs===null?xs=[t]:xs.push(t)}var Rj=Ho.ReactCurrentBatchConfig;function ys(t,e){if(t&&t.defaultProps){e=Dt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var ug=ea(null),hg=null,Ql=null,pI=null;function mI(){pI=Ql=hg=null}function gI(t){var e=ug.current;xt(ug),t._currentValue=e}function m1(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function uc(t,e){hg=t,pI=Ql=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vr=!0),t.firstContext=null)}function as(t){var e=t._currentValue;if(pI!==t)if(t={context:t,memoizedValue:e,next:null},Ql===null){if(hg===null)throw Error(ne(308));Ql=t,hg.dependencies={lanes:0,firstContext:t}}else Ql=Ql.next=t;return e}var $a=null;function yI(t){$a===null?$a=[t]:$a.push(t)}function VA(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,yI(e)):(n.next=s.next,s.next=n),e.interleaved=n,Oo(t,r)}function Oo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ii=!1;function vI(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Eo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $i(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Oo(t,n)}return s=r.interleaved,s===null?(e.next=e,yI(r)):(e.next=s.next,s.next=e),r.interleaved=e,Oo(t,n)}function Om(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rI(t,n)}}function mN(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function dg(t,e,n,r){var s=t.updateQueue;ii=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,i===null?o=c:i.next=c,i=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==i&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var h=s.baseState;i=0,u=c=l=null,a=o;do{var d=a.lane,f=a.eventTime;if((r&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(d=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,h,d):p,d==null)break e;h=Dt({},h,d);break e;case 2:ii=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=s.effects,d===null?s.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,i|=d;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;d=a,a=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(1);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Ka|=i,t.lanes=i,t.memoizedState=h}}function gN(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(ne(191,s));s.call(r)}}}var jA=new V_.Component().refs;function g1(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Dt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Uy={isMounted:function(t){return(t=t._reactInternals)?yl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=sr(),s=Ni(t),o=Eo(r,s);o.payload=e,n!=null&&(o.callback=n),e=$i(t,o,s),e!==null&&(Es(e,t,s,r),Om(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=sr(),s=Ni(t),o=Eo(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=$i(t,o,s),e!==null&&(Es(e,t,s,r),Om(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=sr(),r=Ni(t),s=Eo(n,r);s.tag=2,e!=null&&(s.callback=e),e=$i(t,s,r),e!==null&&(Es(e,t,r,n),Om(e,t,r))}};function yN(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!Vh(n,r)||!Vh(s,o):!0}function GA(t,e,n){var r=!1,s=Ui,o=e.contextType;return typeof o=="object"&&o!==null?o=as(o):(s=wr(e)?ja:qn.current,r=e.contextTypes,o=(r=r!=null)?Ic(t,s):Ui),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Uy,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function vN(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Uy.enqueueReplaceState(e,e.state,null)}function y1(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=jA,vI(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=as(o):(o=wr(e)?ja:qn.current,s.context=Ic(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(g1(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Uy.enqueueReplaceState(s,s.state,null),dg(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Ku(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var r=n.stateNode}if(!r)throw Error(ne(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;a===jA&&(a=s.refs={}),i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function Qp(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function xN(t){var e=t._init;return e(t._payload)}function HA(t){function e(g,v){if(t){var x=g.deletions;x===null?(g.deletions=[v],g.flags|=16):x.push(v)}}function n(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function r(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function s(g,v){return g=Ti(g,v),g.index=0,g.sibling=null,g}function o(g,v,x){return g.index=x,t?(x=g.alternate,x!==null?(x=x.index,x<v?(g.flags|=2,v):x):(g.flags|=2,v)):(g.flags|=1048576,v)}function i(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,v,x,b){return v===null||v.tag!==6?(v=Vx(x,g.mode,b),v.return=g,v):(v=s(v,x),v.return=g,v)}function l(g,v,x,b){var w=x.type;return w===Wl?u(g,v,x.props.children,b,x.key):v!==null&&(v.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===oi&&xN(w)===v.type)?(b=s(v,x.props),b.ref=Ku(g,v,x),b.return=g,b):(b=Bm(x.type,x.key,x.props,null,g.mode,b),b.ref=Ku(g,v,x),b.return=g,b)}function c(g,v,x,b){return v===null||v.tag!==4||v.stateNode.containerInfo!==x.containerInfo||v.stateNode.implementation!==x.implementation?(v=Wx(x,g.mode,b),v.return=g,v):(v=s(v,x.children||[]),v.return=g,v)}function u(g,v,x,b,w){return v===null||v.tag!==7?(v=Fa(x,g.mode,b,w),v.return=g,v):(v=s(v,x),v.return=g,v)}function h(g,v,x){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Vx(""+v,g.mode,x),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Bp:return x=Bm(v.type,v.key,v.props,null,g.mode,x),x.ref=Ku(g,null,v),x.return=g,x;case Vl:return v=Wx(v,g.mode,x),v.return=g,v;case oi:var b=v._init;return h(g,b(v._payload),x)}if(th(v)||Vu(v))return v=Fa(v,g.mode,x,null),v.return=g,v;Qp(g,v)}return null}function d(g,v,x,b){var w=v!==null?v.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return w!==null?null:a(g,v,""+x,b);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Bp:return x.key===w?l(g,v,x,b):null;case Vl:return x.key===w?c(g,v,x,b):null;case oi:return w=x._init,d(g,v,w(x._payload),b)}if(th(x)||Vu(x))return w!==null?null:u(g,v,x,b,null);Qp(g,x)}return null}function f(g,v,x,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return g=g.get(x)||null,a(v,g,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Bp:return g=g.get(b.key===null?x:b.key)||null,l(v,g,b,w);case Vl:return g=g.get(b.key===null?x:b.key)||null,c(v,g,b,w);case oi:var C=b._init;return f(g,v,x,C(b._payload),w)}if(th(b)||Vu(b))return g=g.get(x)||null,u(v,g,b,w,null);Qp(v,b)}return null}function p(g,v,x,b){for(var w=null,C=null,I=v,S=v=0,$=null;I!==null&&S<x.length;S++){I.index>S?($=I,I=null):$=I.sibling;var E=d(g,I,x[S],b);if(E===null){I===null&&(I=$);break}t&&I&&E.alternate===null&&e(g,I),v=o(E,v,S),C===null?w=E:C.sibling=E,C=E,I=$}if(S===x.length)return n(g,I),St&&ya(g,S),w;if(I===null){for(;S<x.length;S++)I=h(g,x[S],b),I!==null&&(v=o(I,v,S),C===null?w=I:C.sibling=I,C=I);return St&&ya(g,S),w}for(I=r(g,I);S<x.length;S++)$=f(I,g,S,x[S],b),$!==null&&(t&&$.alternate!==null&&I.delete($.key===null?S:$.key),v=o($,v,S),C===null?w=$:C.sibling=$,C=$);return t&&I.forEach(function(A){return e(g,A)}),St&&ya(g,S),w}function m(g,v,x,b){var w=Vu(x);if(typeof w!="function")throw Error(ne(150));if(x=w.call(x),x==null)throw Error(ne(151));for(var C=w=null,I=v,S=v=0,$=null,E=x.next();I!==null&&!E.done;S++,E=x.next()){I.index>S?($=I,I=null):$=I.sibling;var A=d(g,I,E.value,b);if(A===null){I===null&&(I=$);break}t&&I&&A.alternate===null&&e(g,I),v=o(A,v,S),C===null?w=A:C.sibling=A,C=A,I=$}if(E.done)return n(g,I),St&&ya(g,S),w;if(I===null){for(;!E.done;S++,E=x.next())E=h(g,E.value,b),E!==null&&(v=o(E,v,S),C===null?w=E:C.sibling=E,C=E);return St&&ya(g,S),w}for(I=r(g,I);!E.done;S++,E=x.next())E=f(I,g,S,E.value,b),E!==null&&(t&&E.alternate!==null&&I.delete(E.key===null?S:E.key),v=o(E,v,S),C===null?w=E:C.sibling=E,C=E);return t&&I.forEach(function(M){return e(g,M)}),St&&ya(g,S),w}function y(g,v,x,b){if(typeof x=="object"&&x!==null&&x.type===Wl&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Bp:e:{for(var w=x.key,C=v;C!==null;){if(C.key===w){if(w=x.type,w===Wl){if(C.tag===7){n(g,C.sibling),v=s(C,x.props.children),v.return=g,g=v;break e}}else if(C.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===oi&&xN(w)===C.type){n(g,C.sibling),v=s(C,x.props),v.ref=Ku(g,C,x),v.return=g,g=v;break e}n(g,C);break}else e(g,C);C=C.sibling}x.type===Wl?(v=Fa(x.props.children,g.mode,b,x.key),v.return=g,g=v):(b=Bm(x.type,x.key,x.props,null,g.mode,b),b.ref=Ku(g,v,x),b.return=g,g=b)}return i(g);case Vl:e:{for(C=x.key;v!==null;){if(v.key===C)if(v.tag===4&&v.stateNode.containerInfo===x.containerInfo&&v.stateNode.implementation===x.implementation){n(g,v.sibling),v=s(v,x.children||[]),v.return=g,g=v;break e}else{n(g,v);break}else e(g,v);v=v.sibling}v=Wx(x,g.mode,b),v.return=g,g=v}return i(g);case oi:return C=x._init,y(g,v,C(x._payload),b)}if(th(x))return p(g,v,x,b);if(Vu(x))return m(g,v,x,b);Qp(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,v!==null&&v.tag===6?(n(g,v.sibling),v=s(v,x),v.return=g,g=v):(n(g,v),v=Vx(x,g.mode,b),v.return=g,g=v),i(g)):n(g,v)}return y}var kc=HA(!0),KA=HA(!1),Gd={},eo=ea(Gd),Hh=ea(Gd),Kh=ea(Gd);function Ea(t){if(t===Gd)throw Error(ne(174));return t}function xI(t,e){switch(ft(Kh,e),ft(Hh,t),ft(eo,Gd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Xb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Xb(e,t)}xt(eo),ft(eo,e)}function $c(){xt(eo),xt(Hh),xt(Kh)}function qA(t){Ea(Kh.current);var e=Ea(eo.current),n=Xb(e,t.type);e!==n&&(ft(Hh,t),ft(eo,n))}function bI(t){Hh.current===t&&(xt(eo),xt(Hh))}var _t=ea(0);function fg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fx=[];function wI(){for(var t=0;t<Fx.length;t++)Fx[t]._workInProgressVersionPrimary=null;Fx.length=0}var Pm=Ho.ReactCurrentDispatcher,Lx=Ho.ReactCurrentBatchConfig,Ha=0,At=null,nn=null,fn=null,pg=!1,wh=!1,qh=0,_j=0;function Pn(){throw Error(ne(321))}function CI(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!_s(t[n],e[n]))return!1;return!0}function II(t,e,n,r,s,o){if(Ha=o,At=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Pm.current=t===null||t.memoizedState===null?Pj:Fj,t=n(r,s),wh){o=0;do{if(wh=!1,qh=0,25<=o)throw Error(ne(301));o+=1,fn=nn=null,e.updateQueue=null,Pm.current=Lj,t=n(r,s)}while(wh)}if(Pm.current=mg,e=nn!==null&&nn.next!==null,Ha=0,fn=nn=At=null,pg=!1,e)throw Error(ne(300));return t}function SI(){var t=qh!==0;return qh=0,t}function Us(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?At.memoizedState=fn=t:fn=fn.next=t,fn}function ls(){if(nn===null){var t=At.alternate;t=t!==null?t.memoizedState:null}else t=nn.next;var e=fn===null?At.memoizedState:fn.next;if(e!==null)fn=e,nn=t;else{if(t===null)throw Error(ne(310));nn=t,t={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},fn===null?At.memoizedState=fn=t:fn=fn.next=t}return fn}function Xh(t,e){return typeof e=="function"?e(t):e}function Mx(t){var e=ls(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=nn,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,l=null,c=o;do{var u=c.lane;if((Ha&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,i=r):l=l.next=h,At.lanes|=u,Ka|=u}c=c.next}while(c!==null&&c!==o);l===null?i=r:l.next=a,_s(r,e.memoizedState)||(vr=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,At.lanes|=o,Ka|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function zx(t){var e=ls(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);_s(o,e.memoizedState)||(vr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function XA(){}function YA(t,e){var n=At,r=ls(),s=e(),o=!_s(r.memoizedState,s);if(o&&(r.memoizedState=s,vr=!0),r=r.queue,kI(ZA.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||fn!==null&&fn.memoizedState.tag&1){if(n.flags|=2048,Yh(9,JA.bind(null,n,r,s,e),void 0,null),gn===null)throw Error(ne(349));Ha&30||QA(n,e,s)}return s}function QA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function JA(t,e,n,r){e.value=n,e.getSnapshot=r,eD(e)&&tD(t)}function ZA(t,e,n){return n(function(){eD(e)&&tD(t)})}function eD(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!_s(t,n)}catch{return!0}}function tD(t){var e=Oo(t,1);e!==null&&Es(e,t,1,-1)}function bN(t){var e=Us();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xh,lastRenderedState:t},e.queue=t,t=t.dispatch=Oj.bind(null,At,t),[e.memoizedState,t]}function Yh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=At.updateQueue,e===null?(e={lastEffect:null,stores:null},At.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function nD(){return ls().memoizedState}function Fm(t,e,n,r){var s=Us();At.flags|=t,s.memoizedState=Yh(1|e,n,void 0,r===void 0?null:r)}function Vy(t,e,n,r){var s=ls();r=r===void 0?null:r;var o=void 0;if(nn!==null){var i=nn.memoizedState;if(o=i.destroy,r!==null&&CI(r,i.deps)){s.memoizedState=Yh(e,n,o,r);return}}At.flags|=t,s.memoizedState=Yh(1|e,n,o,r)}function wN(t,e){return Fm(8390656,8,t,e)}function kI(t,e){return Vy(2048,8,t,e)}function rD(t,e){return Vy(4,2,t,e)}function sD(t,e){return Vy(4,4,t,e)}function oD(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function iD(t,e,n){return n=n!=null?n.concat([t]):null,Vy(4,4,oD.bind(null,e,t),n)}function $I(){}function aD(t,e){var n=ls();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&CI(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function lD(t,e){var n=ls();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&CI(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function cD(t,e,n){return Ha&21?(_s(n,e)||(n=dA(),At.lanes|=n,Ka|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vr=!0),t.memoizedState=n)}function Aj(t,e){var n=rt;rt=n!==0&&4>n?n:4,t(!0);var r=Lx.transition;Lx.transition={};try{t(!1),e()}finally{rt=n,Lx.transition=r}}function uD(){return ls().memoizedState}function Dj(t,e,n){var r=Ni(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},hD(t))dD(e,n);else if(n=VA(t,e,n,r),n!==null){var s=sr();Es(n,t,r,s),fD(n,e,r)}}function Oj(t,e,n){var r=Ni(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(hD(t))dD(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,_s(a,i)){var l=e.interleaved;l===null?(s.next=s,yI(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=VA(t,e,s,r),n!==null&&(s=sr(),Es(n,t,r,s),fD(n,e,r))}}function hD(t){var e=t.alternate;return t===At||e!==null&&e===At}function dD(t,e){wh=pg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function fD(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rI(t,n)}}var mg={readContext:as,useCallback:Pn,useContext:Pn,useEffect:Pn,useImperativeHandle:Pn,useInsertionEffect:Pn,useLayoutEffect:Pn,useMemo:Pn,useReducer:Pn,useRef:Pn,useState:Pn,useDebugValue:Pn,useDeferredValue:Pn,useTransition:Pn,useMutableSource:Pn,useSyncExternalStore:Pn,useId:Pn,unstable_isNewReconciler:!1},Pj={readContext:as,useCallback:function(t,e){return Us().memoizedState=[t,e===void 0?null:e],t},useContext:as,useEffect:wN,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Fm(4194308,4,oD.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Fm(4194308,4,t,e)},useInsertionEffect:function(t,e){return Fm(4,2,t,e)},useMemo:function(t,e){var n=Us();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Us();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Dj.bind(null,At,t),[r.memoizedState,t]},useRef:function(t){var e=Us();return t={current:t},e.memoizedState=t},useState:bN,useDebugValue:$I,useDeferredValue:function(t){return Us().memoizedState=t},useTransition:function(){var t=bN(!1),e=t[0];return t=Aj.bind(null,t[1]),Us().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=At,s=Us();if(St){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),gn===null)throw Error(ne(349));Ha&30||QA(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,wN(ZA.bind(null,r,o,t),[t]),r.flags|=2048,Yh(9,JA.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=Us(),e=gn.identifierPrefix;if(St){var n=Co,r=wo;n=(r&~(1<<32-$s(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=qh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=_j++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Fj={readContext:as,useCallback:aD,useContext:as,useEffect:kI,useImperativeHandle:iD,useInsertionEffect:rD,useLayoutEffect:sD,useMemo:lD,useReducer:Mx,useRef:nD,useState:function(){return Mx(Xh)},useDebugValue:$I,useDeferredValue:function(t){var e=ls();return cD(e,nn.memoizedState,t)},useTransition:function(){var t=Mx(Xh)[0],e=ls().memoizedState;return[t,e]},useMutableSource:XA,useSyncExternalStore:YA,useId:uD,unstable_isNewReconciler:!1},Lj={readContext:as,useCallback:aD,useContext:as,useEffect:kI,useImperativeHandle:iD,useInsertionEffect:rD,useLayoutEffect:sD,useMemo:lD,useReducer:zx,useRef:nD,useState:function(){return zx(Xh)},useDebugValue:$I,useDeferredValue:function(t){var e=ls();return nn===null?e.memoizedState=t:cD(e,nn.memoizedState,t)},useTransition:function(){var t=zx(Xh)[0],e=ls().memoizedState;return[t,e]},useMutableSource:XA,useSyncExternalStore:YA,useId:uD,unstable_isNewReconciler:!1};function Ec(t,e){try{var n="",r=e;do n+=hW(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Bx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function v1(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Mj=typeof WeakMap=="function"?WeakMap:Map;function pD(t,e,n){n=Eo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){yg||(yg=!0,N1=r),v1(t,e)},n}function mD(t,e,n){n=Eo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){v1(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){v1(t,e),typeof r!="function"&&(Ei===null?Ei=new Set([this]):Ei.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function CN(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Mj;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Jj.bind(null,t,e,n),e.then(t,t))}function IN(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function SN(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Eo(-1,1),e.tag=2,$i(n,e,1))),n.lanes|=1),t)}var zj=Ho.ReactCurrentOwner,vr=!1;function Zn(t,e,n,r){e.child=t===null?KA(e,null,n,r):kc(e,t.child,n,r)}function kN(t,e,n,r,s){n=n.render;var o=e.ref;return uc(e,s),r=II(t,e,n,r,o,s),n=SI(),t!==null&&!vr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Po(t,e,s)):(St&&n&&hI(e),e.flags|=1,Zn(t,e,r,s),e.child)}function $N(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!OI(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,gD(t,e,o,r,s)):(t=Bm(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Vh,n(i,r)&&t.ref===e.ref)return Po(t,e,s)}return e.flags|=1,t=Ti(o,r),t.ref=e.ref,t.return=e,e.child=t}function gD(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(Vh(o,r)&&t.ref===e.ref)if(vr=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(vr=!0);else return e.lanes=t.lanes,Po(t,e,s)}return x1(t,e,n,r,s)}function yD(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ft(Zl,Rr),Rr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ft(Zl,Rr),Rr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ft(Zl,Rr),Rr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ft(Zl,Rr),Rr|=r;return Zn(t,e,s,n),e.child}function vD(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function x1(t,e,n,r,s){var o=wr(n)?ja:qn.current;return o=Ic(e,o),uc(e,s),n=II(t,e,n,r,o,s),r=SI(),t!==null&&!vr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Po(t,e,s)):(St&&r&&hI(e),e.flags|=1,Zn(t,e,n,s),e.child)}function EN(t,e,n,r,s){if(wr(n)){var o=!0;ag(e)}else o=!1;if(uc(e,s),e.stateNode===null)Lm(t,e),GA(e,n,r),y1(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=as(c):(c=wr(n)?ja:qn.current,c=Ic(e,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||l!==c)&&vN(e,i,r,c),ii=!1;var d=e.memoizedState;i.state=d,dg(e,r,i,s),l=e.memoizedState,a!==r||d!==l||br.current||ii?(typeof u=="function"&&(g1(e,n,u,r),l=e.memoizedState),(a=ii||yN(e,n,a,r,d,l,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),i.props=r,i.state=l,i.context=c,r=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,WA(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ys(e.type,a),i.props=c,h=e.pendingProps,d=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=as(l):(l=wr(n)?ja:qn.current,l=Ic(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==h||d!==l)&&vN(e,i,r,l),ii=!1,d=e.memoizedState,i.state=d,dg(e,r,i,s);var p=e.memoizedState;a!==h||d!==p||br.current||ii?(typeof f=="function"&&(g1(e,n,f,r),p=e.memoizedState),(c=ii||yN(e,n,c,r,d,p,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,p,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),i.props=r,i.state=p,i.context=l,r=c):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),r=!1)}return b1(t,e,n,r,o,s)}function b1(t,e,n,r,s,o){vD(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&dN(e,n,!1),Po(t,e,o);r=e.stateNode,zj.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=kc(e,t.child,null,o),e.child=kc(e,null,a,o)):Zn(t,e,a,o),e.memoizedState=r.state,s&&dN(e,n,!0),e.child}function xD(t){var e=t.stateNode;e.pendingContext?hN(t,e.pendingContext,e.pendingContext!==e.context):e.context&&hN(t,e.context,!1),xI(t,e.containerInfo)}function NN(t,e,n,r,s){return Sc(),fI(s),e.flags|=256,Zn(t,e,n,r),e.child}var w1={dehydrated:null,treeContext:null,retryLane:0};function C1(t){return{baseLanes:t,cachePool:null,transitions:null}}function bD(t,e,n){var r=e.pendingProps,s=_t.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ft(_t,s&1),t===null)return p1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Gy(i,r,0,null),t=Fa(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=C1(n),e.memoizedState=w1,t):EI(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return Bj(t,e,i,r,a,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ti(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Ti(a,o):(o=Fa(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?C1(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=w1,r}return o=t.child,t=o.sibling,r=Ti(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function EI(t,e){return e=Gy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Jp(t,e,n,r){return r!==null&&fI(r),kc(e,t.child,null,n),t=EI(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Bj(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Bx(Error(ne(422))),Jp(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Gy({mode:"visible",children:r.children},s,0,null),o=Fa(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&kc(e,t.child,null,i),e.child.memoizedState=C1(i),e.memoizedState=w1,o);if(!(e.mode&1))return Jp(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(ne(419)),r=Bx(o,r,void 0),Jp(t,e,i,r)}if(a=(i&t.childLanes)!==0,vr||a){if(r=gn,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Oo(t,s),Es(r,t,s,-1))}return DI(),r=Bx(Error(ne(421))),Jp(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Zj.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,Dr=ki(s.nextSibling),Fr=e,St=!0,xs=null,t!==null&&(Xr[Yr++]=wo,Xr[Yr++]=Co,Xr[Yr++]=Ga,wo=t.id,Co=t.overflow,Ga=e),e=EI(e,r.children),e.flags|=4096,e)}function TN(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),m1(t.return,e,n)}function Ux(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function wD(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(Zn(t,e,r.children,n),r=_t.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&TN(t,n,e);else if(t.tag===19)TN(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ft(_t,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&fg(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ux(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&fg(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ux(e,!0,n,null,o);break;case"together":Ux(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Lm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Po(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ka|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=Ti(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ti(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Uj(t,e,n){switch(e.tag){case 3:xD(e),Sc();break;case 5:qA(e);break;case 1:wr(e.type)&&ag(e);break;case 4:xI(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ft(ug,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ft(_t,_t.current&1),e.flags|=128,null):n&e.child.childLanes?bD(t,e,n):(ft(_t,_t.current&1),t=Po(t,e,n),t!==null?t.sibling:null);ft(_t,_t.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return wD(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ft(_t,_t.current),r)break;return null;case 22:case 23:return e.lanes=0,yD(t,e,n)}return Po(t,e,n)}var CD,I1,ID,SD;CD=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};I1=function(){};ID=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ea(eo.current);var o=null;switch(n){case"input":s=Gb(t,s),r=Gb(t,r),o=[];break;case"select":s=Dt({},s,{value:void 0}),r=Dt({},r,{value:void 0}),o=[];break;case"textarea":s=qb(t,s),r=qb(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=og)}Yb(n,r);var i;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ph.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ph.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&vt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};SD=function(t,e,n,r){n!==r&&(e.flags|=4)};function qu(t,e){if(!St)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Fn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Vj(t,e,n){var r=e.pendingProps;switch(dI(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fn(e),null;case 1:return wr(e.type)&&ig(),Fn(e),null;case 3:return r=e.stateNode,$c(),xt(br),xt(qn),wI(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Yp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,xs!==null&&(_1(xs),xs=null))),I1(t,e),Fn(e),null;case 5:bI(e);var s=Ea(Kh.current);if(n=e.type,t!==null&&e.stateNode!=null)ID(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ne(166));return Fn(e),null}if(t=Ea(eo.current),Yp(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Ks]=e,r[Gh]=o,t=(e.mode&1)!==0,n){case"dialog":vt("cancel",r),vt("close",r);break;case"iframe":case"object":case"embed":vt("load",r);break;case"video":case"audio":for(s=0;s<rh.length;s++)vt(rh[s],r);break;case"source":vt("error",r);break;case"img":case"image":case"link":vt("error",r),vt("load",r);break;case"details":vt("toggle",r);break;case"input":ME(r,o),vt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},vt("invalid",r);break;case"textarea":BE(r,o),vt("invalid",r)}Yb(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Xp(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Xp(r.textContent,a,t),s=["children",""+a]):Ph.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&vt("scroll",r)}switch(n){case"input":Up(r),zE(r,o,!0);break;case"textarea":Up(r),UE(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=og)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Q_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[Ks]=e,t[Gh]=r,CD(t,e,!1,!1),e.stateNode=t;e:{switch(i=Qb(n,r),n){case"dialog":vt("cancel",t),vt("close",t),s=r;break;case"iframe":case"object":case"embed":vt("load",t),s=r;break;case"video":case"audio":for(s=0;s<rh.length;s++)vt(rh[s],t);s=r;break;case"source":vt("error",t),s=r;break;case"img":case"image":case"link":vt("error",t),vt("load",t),s=r;break;case"details":vt("toggle",t),s=r;break;case"input":ME(t,r),s=Gb(t,r),vt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Dt({},r,{value:void 0}),vt("invalid",t);break;case"textarea":BE(t,r),s=qb(t,r),vt("invalid",t);break;default:s=r}Yb(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?eA(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&J_(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Fh(t,l):typeof l=="number"&&Fh(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ph.hasOwnProperty(o)?l!=null&&o==="onScroll"&&vt("scroll",t):l!=null&&QC(t,o,l,i))}switch(n){case"input":Up(t),zE(t,r,!1);break;case"textarea":Up(t),UE(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Bi(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?ic(t,!!r.multiple,o,!1):r.defaultValue!=null&&ic(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=og)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Fn(e),null;case 6:if(t&&e.stateNode!=null)SD(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ne(166));if(n=Ea(Kh.current),Ea(eo.current),Yp(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ks]=e,(o=r.nodeValue!==n)&&(t=Fr,t!==null))switch(t.tag){case 3:Xp(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Xp(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ks]=e,e.stateNode=r}return Fn(e),null;case 13:if(xt(_t),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(St&&Dr!==null&&e.mode&1&&!(e.flags&128))UA(),Sc(),e.flags|=98560,o=!1;else if(o=Yp(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(ne(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ne(317));o[Ks]=e}else Sc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Fn(e),o=!1}else xs!==null&&(_1(xs),xs=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||_t.current&1?on===0&&(on=3):DI())),e.updateQueue!==null&&(e.flags|=4),Fn(e),null);case 4:return $c(),I1(t,e),t===null&&Wh(e.stateNode.containerInfo),Fn(e),null;case 10:return gI(e.type._context),Fn(e),null;case 17:return wr(e.type)&&ig(),Fn(e),null;case 19:if(xt(_t),o=e.memoizedState,o===null)return Fn(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)qu(o,!1);else{if(on!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=fg(t),i!==null){for(e.flags|=128,qu(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ft(_t,_t.current&1|2),e.child}t=t.sibling}o.tail!==null&&Vt()>Nc&&(e.flags|=128,r=!0,qu(o,!1),e.lanes=4194304)}else{if(!r)if(t=fg(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),qu(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!St)return Fn(e),null}else 2*Vt()-o.renderingStartTime>Nc&&n!==1073741824&&(e.flags|=128,r=!0,qu(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Vt(),e.sibling=null,n=_t.current,ft(_t,r?n&1|2:n&1),e):(Fn(e),null);case 22:case 23:return AI(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Rr&1073741824&&(Fn(e),e.subtreeFlags&6&&(e.flags|=8192)):Fn(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function Wj(t,e){switch(dI(e),e.tag){case 1:return wr(e.type)&&ig(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return $c(),xt(br),xt(qn),wI(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return bI(e),null;case 13:if(xt(_t),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));Sc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xt(_t),null;case 4:return $c(),null;case 10:return gI(e.type._context),null;case 22:case 23:return AI(),null;case 24:return null;default:return null}}var Zp=!1,Bn=!1,jj=typeof WeakSet=="function"?WeakSet:Set,pe=null;function Jl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ot(t,e,r)}else n.current=null}function S1(t,e,n){try{n()}catch(r){Ot(t,e,r)}}var RN=!1;function Gj(t,e){if(a1=ng,t=NA(),uI(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,c=0,u=0,h=t,d=null;t:for(;;){for(var f;h!==n||s!==0&&h.nodeType!==3||(a=i+s),h!==o||r!==0&&h.nodeType!==3||(l=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++c===s&&(a=i),d===o&&++u===r&&(l=i),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(l1={focusedElem:t,selectionRange:n},ng=!1,pe=e;pe!==null;)if(e=pe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pe=t;else for(;pe!==null;){e=pe;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,y=p.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:ys(e.type,m),y);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var x=e.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(b){Ot(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,pe=t;break}pe=e.return}return p=RN,RN=!1,p}function Ch(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&S1(e,n,o)}s=s.next}while(s!==r)}}function Wy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function k1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function kD(t){var e=t.alternate;e!==null&&(t.alternate=null,kD(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ks],delete e[Gh],delete e[h1],delete e[Ej],delete e[Nj])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function $D(t){return t.tag===5||t.tag===3||t.tag===4}function _N(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||$D(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=og));else if(r!==4&&(t=t.child,t!==null))for($1(t,e,n),t=t.sibling;t!==null;)$1(t,e,n),t=t.sibling}function E1(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(E1(t,e,n),t=t.sibling;t!==null;)E1(t,e,n),t=t.sibling}var Sn=null,vs=!1;function ri(t,e,n){for(n=n.child;n!==null;)ED(t,e,n),n=n.sibling}function ED(t,e,n){if(Zs&&typeof Zs.onCommitFiberUnmount=="function")try{Zs.onCommitFiberUnmount(Py,n)}catch{}switch(n.tag){case 5:Bn||Jl(n,e);case 6:var r=Sn,s=vs;Sn=null,ri(t,e,n),Sn=r,vs=s,Sn!==null&&(vs?(t=Sn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Sn.removeChild(n.stateNode));break;case 18:Sn!==null&&(vs?(t=Sn,n=n.stateNode,t.nodeType===8?Ox(t.parentNode,n):t.nodeType===1&&Ox(t,n),Bh(t)):Ox(Sn,n.stateNode));break;case 4:r=Sn,s=vs,Sn=n.stateNode.containerInfo,vs=!0,ri(t,e,n),Sn=r,vs=s;break;case 0:case 11:case 14:case 15:if(!Bn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&S1(n,e,i),s=s.next}while(s!==r)}ri(t,e,n);break;case 1:if(!Bn&&(Jl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ot(n,e,a)}ri(t,e,n);break;case 21:ri(t,e,n);break;case 22:n.mode&1?(Bn=(r=Bn)||n.memoizedState!==null,ri(t,e,n),Bn=r):ri(t,e,n);break;default:ri(t,e,n)}}function AN(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new jj),e.forEach(function(r){var s=eG.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function ps(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:Sn=a.stateNode,vs=!1;break e;case 3:Sn=a.stateNode.containerInfo,vs=!0;break e;case 4:Sn=a.stateNode.containerInfo,vs=!0;break e}a=a.return}if(Sn===null)throw Error(ne(160));ED(o,i,s),Sn=null,vs=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Ot(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)ND(e,t),e=e.sibling}function ND(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ps(e,t),zs(t),r&4){try{Ch(3,t,t.return),Wy(3,t)}catch(m){Ot(t,t.return,m)}try{Ch(5,t,t.return)}catch(m){Ot(t,t.return,m)}}break;case 1:ps(e,t),zs(t),r&512&&n!==null&&Jl(n,n.return);break;case 5:if(ps(e,t),zs(t),r&512&&n!==null&&Jl(n,n.return),t.flags&32){var s=t.stateNode;try{Fh(s,"")}catch(m){Ot(t,t.return,m)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&X_(s,o),Qb(a,i);var c=Qb(a,o);for(i=0;i<l.length;i+=2){var u=l[i],h=l[i+1];u==="style"?eA(s,h):u==="dangerouslySetInnerHTML"?J_(s,h):u==="children"?Fh(s,h):QC(s,u,h,c)}switch(a){case"input":Hb(s,o);break;case"textarea":Y_(s,o);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?ic(s,!!o.multiple,f,!1):d!==!!o.multiple&&(o.defaultValue!=null?ic(s,!!o.multiple,o.defaultValue,!0):ic(s,!!o.multiple,o.multiple?[]:"",!1))}s[Gh]=o}catch(m){Ot(t,t.return,m)}}break;case 6:if(ps(e,t),zs(t),r&4){if(t.stateNode===null)throw Error(ne(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(m){Ot(t,t.return,m)}}break;case 3:if(ps(e,t),zs(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Bh(e.containerInfo)}catch(m){Ot(t,t.return,m)}break;case 4:ps(e,t),zs(t);break;case 13:ps(e,t),zs(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(RI=Vt())),r&4&&AN(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Bn=(c=Bn)||u,ps(e,t),Bn=c):ps(e,t),zs(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(pe=t,u=t.child;u!==null;){for(h=pe=u;pe!==null;){switch(d=pe,f=d.child,d.tag){case 0:case 11:case 14:case 15:Ch(4,d,d.return);break;case 1:Jl(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,n=d.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Ot(r,n,m)}}break;case 5:Jl(d,d.return);break;case 22:if(d.memoizedState!==null){ON(h);continue}}f!==null?(f.return=d,pe=f):ON(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Z_("display",i))}catch(m){Ot(t,t.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Ot(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ps(e,t),zs(t),r&4&&AN(t);break;case 21:break;default:ps(e,t),zs(t)}}function zs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if($D(n)){var r=n;break e}n=n.return}throw Error(ne(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Fh(s,""),r.flags&=-33);var o=_N(t);E1(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=_N(t);$1(t,a,i);break;default:throw Error(ne(161))}}catch(l){Ot(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Hj(t,e,n){pe=t,TD(t)}function TD(t,e,n){for(var r=(t.mode&1)!==0;pe!==null;){var s=pe,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Zp;if(!i){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Bn;a=Zp;var c=Bn;if(Zp=i,(Bn=l)&&!c)for(pe=s;pe!==null;)i=pe,l=i.child,i.tag===22&&i.memoizedState!==null?PN(s):l!==null?(l.return=i,pe=l):PN(s);for(;o!==null;)pe=o,TD(o),o=o.sibling;pe=s,Zp=a,Bn=c}DN(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,pe=o):DN(t)}}function DN(t){for(;pe!==null;){var e=pe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Bn||Wy(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Bn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:ys(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&gN(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}gN(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Bh(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}Bn||e.flags&512&&k1(e)}catch(d){Ot(e,e.return,d)}}if(e===t){pe=null;break}if(n=e.sibling,n!==null){n.return=e.return,pe=n;break}pe=e.return}}function ON(t){for(;pe!==null;){var e=pe;if(e===t){pe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pe=n;break}pe=e.return}}function PN(t){for(;pe!==null;){var e=pe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Wy(4,e)}catch(l){Ot(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Ot(e,s,l)}}var o=e.return;try{k1(e)}catch(l){Ot(e,o,l)}break;case 5:var i=e.return;try{k1(e)}catch(l){Ot(e,i,l)}}}catch(l){Ot(e,e.return,l)}if(e===t){pe=null;break}var a=e.sibling;if(a!==null){a.return=e.return,pe=a;break}pe=e.return}}var Kj=Math.ceil,gg=Ho.ReactCurrentDispatcher,NI=Ho.ReactCurrentOwner,ss=Ho.ReactCurrentBatchConfig,qe=0,gn=null,Xt=null,En=0,Rr=0,Zl=ea(0),on=0,Qh=null,Ka=0,jy=0,TI=0,Ih=null,pr=null,RI=0,Nc=1/0,yo=null,yg=!1,N1=null,Ei=null,em=!1,mi=null,vg=0,Sh=0,T1=null,Mm=-1,zm=0;function sr(){return qe&6?Vt():Mm!==-1?Mm:Mm=Vt()}function Ni(t){return t.mode&1?qe&2&&En!==0?En&-En:Rj.transition!==null?(zm===0&&(zm=dA()),zm):(t=rt,t!==0||(t=window.event,t=t===void 0?16:xA(t.type)),t):1}function Es(t,e,n,r){if(50<Sh)throw Sh=0,T1=null,Error(ne(185));Vd(t,n,r),(!(qe&2)||t!==gn)&&(t===gn&&(!(qe&2)&&(jy|=n),on===4&&ci(t,En)),Cr(t,r),n===1&&qe===0&&!(e.mode&1)&&(Nc=Vt()+500,By&&ta()))}function Cr(t,e){var n=t.callbackNode;RW(t,e);var r=tg(t,t===gn?En:0);if(r===0)n!==null&&jE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&jE(n),e===1)t.tag===0?Tj(FN.bind(null,t)):MA(FN.bind(null,t)),kj(function(){!(qe&6)&&ta()}),n=null;else{switch(fA(r)){case 1:n=nI;break;case 4:n=uA;break;case 16:n=eg;break;case 536870912:n=hA;break;default:n=eg}n=LD(n,RD.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function RD(t,e){if(Mm=-1,zm=0,qe&6)throw Error(ne(327));var n=t.callbackNode;if(hc()&&t.callbackNode!==n)return null;var r=tg(t,t===gn?En:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=xg(t,r);else{e=r;var s=qe;qe|=2;var o=AD();(gn!==t||En!==e)&&(yo=null,Nc=Vt()+500,Pa(t,e));do try{Yj();break}catch(a){_D(t,a)}while(1);mI(),gg.current=o,qe=s,Xt!==null?e=0:(gn=null,En=0,e=on)}if(e!==0){if(e===2&&(s=n1(t),s!==0&&(r=s,e=R1(t,s))),e===1)throw n=Qh,Pa(t,0),ci(t,r),Cr(t,Vt()),n;if(e===6)ci(t,r);else{if(s=t.current.alternate,!(r&30)&&!qj(s)&&(e=xg(t,r),e===2&&(o=n1(t),o!==0&&(r=o,e=R1(t,o))),e===1))throw n=Qh,Pa(t,0),ci(t,r),Cr(t,Vt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(ne(345));case 2:va(t,pr,yo);break;case 3:if(ci(t,r),(r&130023424)===r&&(e=RI+500-Vt(),10<e)){if(tg(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){sr(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=u1(va.bind(null,t,pr,yo),e);break}va(t,pr,yo);break;case 4:if(ci(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-$s(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=Vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Kj(r/1960))-r,10<r){t.timeoutHandle=u1(va.bind(null,t,pr,yo),r);break}va(t,pr,yo);break;case 5:va(t,pr,yo);break;default:throw Error(ne(329))}}}return Cr(t,Vt()),t.callbackNode===n?RD.bind(null,t):null}function R1(t,e){var n=Ih;return t.current.memoizedState.isDehydrated&&(Pa(t,e).flags|=256),t=xg(t,e),t!==2&&(e=pr,pr=n,e!==null&&_1(e)),t}function _1(t){pr===null?pr=t:pr.push.apply(pr,t)}function qj(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!_s(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ci(t,e){for(e&=~TI,e&=~jy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-$s(e),r=1<<n;t[n]=-1,e&=~r}}function FN(t){if(qe&6)throw Error(ne(327));hc();var e=tg(t,0);if(!(e&1))return Cr(t,Vt()),null;var n=xg(t,e);if(t.tag!==0&&n===2){var r=n1(t);r!==0&&(e=r,n=R1(t,r))}if(n===1)throw n=Qh,Pa(t,0),ci(t,e),Cr(t,Vt()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,va(t,pr,yo),Cr(t,Vt()),null}function _I(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(Nc=Vt()+500,By&&ta())}}function qa(t){mi!==null&&mi.tag===0&&!(qe&6)&&hc();var e=qe;qe|=1;var n=ss.transition,r=rt;try{if(ss.transition=null,rt=1,t)return t()}finally{rt=r,ss.transition=n,qe=e,!(qe&6)&&ta()}}function AI(){Rr=Zl.current,xt(Zl)}function Pa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Sj(n)),Xt!==null)for(n=Xt.return;n!==null;){var r=n;switch(dI(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ig();break;case 3:$c(),xt(br),xt(qn),wI();break;case 5:bI(r);break;case 4:$c();break;case 13:xt(_t);break;case 19:xt(_t);break;case 10:gI(r.type._context);break;case 22:case 23:AI()}n=n.return}if(gn=t,Xt=t=Ti(t.current,null),En=Rr=e,on=0,Qh=null,TI=jy=Ka=0,pr=Ih=null,$a!==null){for(e=0;e<$a.length;e++)if(n=$a[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}$a=null}return t}function _D(t,e){do{var n=Xt;try{if(mI(),Pm.current=mg,pg){for(var r=At.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}pg=!1}if(Ha=0,fn=nn=At=null,wh=!1,qh=0,NI.current=null,n===null||n.return===null){on=1,Qh=e,Xt=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=En,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=IN(i);if(f!==null){f.flags&=-257,SN(f,i,a,o,e),f.mode&1&&CN(o,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){CN(o,c,e),DI();break e}l=Error(ne(426))}}else if(St&&a.mode&1){var y=IN(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),SN(y,i,a,o,e),fI(Ec(l,a));break e}}o=l=Ec(l,a),on!==4&&(on=2),Ih===null?Ih=[o]:Ih.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=pD(o,l,e);mN(o,g);break e;case 1:a=l;var v=o.type,x=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ei===null||!Ei.has(x)))){o.flags|=65536,e&=-e,o.lanes|=e;var b=mD(o,a,e);mN(o,b);break e}}o=o.return}while(o!==null)}OD(n)}catch(w){e=w,Xt===n&&n!==null&&(Xt=n=n.return);continue}break}while(1)}function AD(){var t=gg.current;return gg.current=mg,t===null?mg:t}function DI(){(on===0||on===3||on===2)&&(on=4),gn===null||!(Ka&268435455)&&!(jy&268435455)||ci(gn,En)}function xg(t,e){var n=qe;qe|=2;var r=AD();(gn!==t||En!==e)&&(yo=null,Pa(t,e));do try{Xj();break}catch(s){_D(t,s)}while(1);if(mI(),qe=n,gg.current=r,Xt!==null)throw Error(ne(261));return gn=null,En=0,on}function Xj(){for(;Xt!==null;)DD(Xt)}function Yj(){for(;Xt!==null&&!wW();)DD(Xt)}function DD(t){var e=FD(t.alternate,t,Rr);t.memoizedProps=t.pendingProps,e===null?OD(t):Xt=e,NI.current=null}function OD(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Wj(n,e),n!==null){n.flags&=32767,Xt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{on=6,Xt=null;return}}else if(n=Vj(n,e,Rr),n!==null){Xt=n;return}if(e=e.sibling,e!==null){Xt=e;return}Xt=e=t}while(e!==null);on===0&&(on=5)}function va(t,e,n){var r=rt,s=ss.transition;try{ss.transition=null,rt=1,Qj(t,e,n,r)}finally{ss.transition=s,rt=r}return null}function Qj(t,e,n,r){do hc();while(mi!==null);if(qe&6)throw Error(ne(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(_W(t,o),t===gn&&(Xt=gn=null,En=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||em||(em=!0,LD(eg,function(){return hc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ss.transition,ss.transition=null;var i=rt;rt=1;var a=qe;qe|=4,NI.current=null,Gj(t,n),ND(n,t),yj(l1),ng=!!a1,l1=a1=null,t.current=n,Hj(n),CW(),qe=a,rt=i,ss.transition=o}else t.current=n;if(em&&(em=!1,mi=t,vg=s),o=t.pendingLanes,o===0&&(Ei=null),kW(n.stateNode),Cr(t,Vt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(yg)throw yg=!1,t=N1,N1=null,t;return vg&1&&t.tag!==0&&hc(),o=t.pendingLanes,o&1?t===T1?Sh++:(Sh=0,T1=t):Sh=0,ta(),null}function hc(){if(mi!==null){var t=fA(vg),e=ss.transition,n=rt;try{if(ss.transition=null,rt=16>t?16:t,mi===null)var r=!1;else{if(t=mi,mi=null,vg=0,qe&6)throw Error(ne(331));var s=qe;for(qe|=4,pe=t.current;pe!==null;){var o=pe,i=o.child;if(pe.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(pe=c;pe!==null;){var u=pe;switch(u.tag){case 0:case 11:case 15:Ch(8,u,o)}var h=u.child;if(h!==null)h.return=u,pe=h;else for(;pe!==null;){u=pe;var d=u.sibling,f=u.return;if(kD(u),u===c){pe=null;break}if(d!==null){d.return=f,pe=d;break}pe=f}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}pe=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,pe=i;else e:for(;pe!==null;){if(o=pe,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Ch(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,pe=g;break e}pe=o.return}}var v=t.current;for(pe=v;pe!==null;){i=pe;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,pe=x;else e:for(i=v;pe!==null;){if(a=pe,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Wy(9,a)}}catch(w){Ot(a,a.return,w)}if(a===i){pe=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,pe=b;break e}pe=a.return}}if(qe=s,ta(),Zs&&typeof Zs.onPostCommitFiberRoot=="function")try{Zs.onPostCommitFiberRoot(Py,t)}catch{}r=!0}return r}finally{rt=n,ss.transition=e}}return!1}function LN(t,e,n){e=Ec(n,e),e=pD(t,e,1),t=$i(t,e,1),e=sr(),t!==null&&(Vd(t,1,e),Cr(t,e))}function Ot(t,e,n){if(t.tag===3)LN(t,t,n);else for(;e!==null;){if(e.tag===3){LN(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ei===null||!Ei.has(r))){t=Ec(n,t),t=mD(e,t,1),e=$i(e,t,1),t=sr(),e!==null&&(Vd(e,1,t),Cr(e,t));break}}e=e.return}}function Jj(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=sr(),t.pingedLanes|=t.suspendedLanes&n,gn===t&&(En&n)===n&&(on===4||on===3&&(En&130023424)===En&&500>Vt()-RI?Pa(t,0):TI|=n),Cr(t,e)}function PD(t,e){e===0&&(t.mode&1?(e=jp,jp<<=1,!(jp&130023424)&&(jp=4194304)):e=1);var n=sr();t=Oo(t,e),t!==null&&(Vd(t,e,n),Cr(t,n))}function Zj(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),PD(t,n)}function eG(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ne(314))}r!==null&&r.delete(e),PD(t,n)}var FD;FD=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||br.current)vr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return vr=!1,Uj(t,e,n);vr=!!(t.flags&131072)}else vr=!1,St&&e.flags&1048576&&zA(e,cg,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Lm(t,e),t=e.pendingProps;var s=Ic(e,qn.current);uc(e,n),s=II(null,e,r,t,s,n);var o=SI();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wr(r)?(o=!0,ag(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vI(e),s.updater=Uy,e.stateNode=s,s._reactInternals=e,y1(e,r,t,n),e=b1(null,e,r,!0,o,n)):(e.tag=0,St&&o&&hI(e),Zn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Lm(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=nG(r),t=ys(r,t),s){case 0:e=x1(null,e,r,t,n);break e;case 1:e=EN(null,e,r,t,n);break e;case 11:e=kN(null,e,r,t,n);break e;case 14:e=$N(null,e,r,ys(r.type,t),n);break e}throw Error(ne(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ys(r,s),x1(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ys(r,s),EN(t,e,r,s,n);case 3:e:{if(xD(e),t===null)throw Error(ne(387));r=e.pendingProps,o=e.memoizedState,s=o.element,WA(t,e),dg(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=Ec(Error(ne(423)),e),e=NN(t,e,r,n,s);break e}else if(r!==s){s=Ec(Error(ne(424)),e),e=NN(t,e,r,n,s);break e}else for(Dr=ki(e.stateNode.containerInfo.firstChild),Fr=e,St=!0,xs=null,n=KA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Sc(),r===s){e=Po(t,e,n);break e}Zn(t,e,r,n)}e=e.child}return e;case 5:return qA(e),t===null&&p1(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,c1(r,s)?i=null:o!==null&&c1(r,o)&&(e.flags|=32),vD(t,e),Zn(t,e,i,n),e.child;case 6:return t===null&&p1(e),null;case 13:return bD(t,e,n);case 4:return xI(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=kc(e,null,r,n):Zn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ys(r,s),kN(t,e,r,s,n);case 7:return Zn(t,e,e.pendingProps,n),e.child;case 8:return Zn(t,e,e.pendingProps.children,n),e.child;case 12:return Zn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,ft(ug,r._currentValue),r._currentValue=i,o!==null)if(_s(o.value,i)){if(o.children===s.children&&!br.current){e=Po(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=Eo(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),m1(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(ne(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),m1(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Zn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,uc(e,n),s=as(s),r=r(s),e.flags|=1,Zn(t,e,r,n),e.child;case 14:return r=e.type,s=ys(r,e.pendingProps),s=ys(r.type,s),$N(t,e,r,s,n);case 15:return gD(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:ys(r,s),Lm(t,e),e.tag=1,wr(r)?(t=!0,ag(e)):t=!1,uc(e,n),GA(e,r,s),y1(e,r,s,n),b1(null,e,r,!0,t,n);case 19:return wD(t,e,n);case 22:return yD(t,e,n)}throw Error(ne(156,e.tag))};function LD(t,e){return cA(t,e)}function tG(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(t,e,n,r){return new tG(t,e,n,r)}function OI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function nG(t){if(typeof t=="function")return OI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ZC)return 11;if(t===eI)return 14}return 2}function Ti(t,e){var n=t.alternate;return n===null?(n=Jr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Bm(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")OI(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Wl:return Fa(n.children,s,o,e);case JC:i=8,s|=8;break;case Ub:return t=Jr(12,n,e,s|2),t.elementType=Ub,t.lanes=o,t;case Vb:return t=Jr(13,n,e,s),t.elementType=Vb,t.lanes=o,t;case Wb:return t=Jr(19,n,e,s),t.elementType=Wb,t.lanes=o,t;case H_:return Gy(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case j_:i=10;break e;case G_:i=9;break e;case ZC:i=11;break e;case eI:i=14;break e;case oi:i=16,r=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=Jr(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function Fa(t,e,n,r){return t=Jr(7,t,r,e),t.lanes=n,t}function Gy(t,e,n,r){return t=Jr(22,t,r,e),t.elementType=H_,t.lanes=n,t.stateNode={isHidden:!1},t}function Vx(t,e,n){return t=Jr(6,t,null,e),t.lanes=n,t}function Wx(t,e,n){return e=Jr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function rG(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ix(0),this.expirationTimes=Ix(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ix(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function PI(t,e,n,r,s,o,i,a,l){return t=new rG(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Jr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vI(o),t}function sG(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function MD(t){if(!t)return Ui;t=t._reactInternals;e:{if(yl(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(wr(n))return LA(t,n,e)}return e}function zD(t,e,n,r,s,o,i,a,l){return t=PI(n,r,!0,t,s,o,i,a,l),t.context=MD(null),n=t.current,r=sr(),s=Ni(n),o=Eo(r,s),o.callback=e??null,$i(n,o,s),t.current.lanes=s,Vd(t,s,r),Cr(t,r),t}function Hy(t,e,n,r){var s=e.current,o=sr(),i=Ni(s);return n=MD(n),e.context===null?e.context=n:e.pendingContext=n,e=Eo(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$i(s,e,i),t!==null&&(Es(t,s,i,o),Om(t,s,i)),i}function bg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function MN(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function FI(t,e){MN(t,e),(t=t.alternate)&&MN(t,e)}function oG(){return null}var BD=typeof reportError=="function"?reportError:function(t){console.error(t)};function LI(t){this._internalRoot=t}Ky.prototype.render=LI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));Hy(t,e,null,null)};Ky.prototype.unmount=LI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;qa(function(){Hy(null,t,null,null)}),e[Do]=null}};function Ky(t){this._internalRoot=t}Ky.prototype.unstable_scheduleHydration=function(t){if(t){var e=gA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<li.length&&e!==0&&e<li[n].priority;n++);li.splice(n,0,t),n===0&&vA(t)}};function MI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function qy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function zN(){}function iG(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var c=bg(i);o.call(c)}}var i=zD(e,r,t,0,null,!1,!1,"",zN);return t._reactRootContainer=i,t[Do]=i.current,Wh(t.nodeType===8?t.parentNode:t),qa(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=bg(l);a.call(c)}}var l=PI(t,0,!1,null,null,!1,!1,"",zN);return t._reactRootContainer=l,t[Do]=l.current,Wh(t.nodeType===8?t.parentNode:t),qa(function(){Hy(e,l,n,r)}),l}function Xy(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var l=bg(i);a.call(l)}}Hy(e,i,t,s)}else i=iG(n,e,t,s,r);return bg(i)}pA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=nh(e.pendingLanes);n!==0&&(rI(e,n|1),Cr(e,Vt()),!(qe&6)&&(Nc=Vt()+500,ta()))}break;case 13:qa(function(){var r=Oo(t,1);if(r!==null){var s=sr();Es(r,t,1,s)}}),FI(t,1)}};sI=function(t){if(t.tag===13){var e=Oo(t,134217728);if(e!==null){var n=sr();Es(e,t,134217728,n)}FI(t,134217728)}};mA=function(t){if(t.tag===13){var e=Ni(t),n=Oo(t,e);if(n!==null){var r=sr();Es(n,t,e,r)}FI(t,e)}};gA=function(){return rt};yA=function(t,e){var n=rt;try{return rt=t,e()}finally{rt=n}};Zb=function(t,e,n){switch(e){case"input":if(Hb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=zy(r);if(!s)throw Error(ne(90));q_(r),Hb(r,s)}}}break;case"textarea":Y_(t,n);break;case"select":e=n.value,e!=null&&ic(t,!!n.multiple,e,!1)}};rA=_I;sA=qa;var aG={usingClientEntryPoint:!1,Events:[jd,Kl,zy,tA,nA,_I]},Xu={findFiberByHostInstance:ka,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},lG={bundleType:Xu.bundleType,version:Xu.version,rendererPackageName:Xu.rendererPackageName,rendererConfig:Xu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ho.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=aA(t),t===null?null:t.stateNode},findFiberByHostInstance:Xu.findFiberByHostInstance||oG,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tm.isDisabled&&tm.supportsFiber)try{Py=tm.inject(lG),Zs=tm}catch{}}Vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aG;Vr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!MI(e))throw Error(ne(200));return sG(t,e,null,n)};Vr.createRoot=function(t,e){if(!MI(t))throw Error(ne(299));var n=!1,r="",s=BD;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=PI(t,1,!1,null,null,n,!1,r,s),t[Do]=e.current,Wh(t.nodeType===8?t.parentNode:t),new LI(e)};Vr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=aA(e),t=t===null?null:t.stateNode,t};Vr.flushSync=function(t){return qa(t)};Vr.hydrate=function(t,e,n){if(!qy(e))throw Error(ne(200));return Xy(null,t,e,!0,n)};Vr.hydrateRoot=function(t,e,n){if(!MI(t))throw Error(ne(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=BD;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=zD(e,null,t,1,n??null,s,!1,o,i),t[Do]=e.current,Wh(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ky(e)};Vr.render=function(t,e,n){if(!qy(e))throw Error(ne(200));return Xy(null,t,e,!1,n)};Vr.unmountComponentAtNode=function(t){if(!qy(t))throw Error(ne(40));return t._reactRootContainer?(qa(function(){Xy(null,null,t,!1,function(){t._reactRootContainer=null,t[Do]=null})}),!0):!1};Vr.unstable_batchedUpdates=_I;Vr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!qy(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return Xy(t,e,n,!1,r)};Vr.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=Vr})(oW);var BN=Mb;Lb.createRoot=BN.createRoot,Lb.hydrateRoot=BN.hydrateRoot;/**
 * @remix-run/router v1.5.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jh(){return Jh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Jh.apply(this,arguments)}var gi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(gi||(gi={}));const UN="popstate";function cG(t){t===void 0&&(t={});function e(r,s){let{pathname:o,search:i,hash:a}=r.location;return A1("",{pathname:o,search:i,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:wg(s)}return hG(e,n,null,t)}function ln(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zI(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uG(){return Math.random().toString(36).substr(2,8)}function VN(t,e){return{usr:t.state,key:t.key,idx:e}}function A1(t,e,n,r){return n===void 0&&(n=null),Jh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?iu(e):e,{state:n,key:e&&e.key||r||uG()})}function wg(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function iu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function hG(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,i=s.history,a=gi.Pop,l=null,c=u();c==null&&(c=0,i.replaceState(Jh({},i.state,{idx:c}),""));function u(){return(i.state||{idx:null}).idx}function h(){a=gi.Pop;let y=u(),g=y==null?null:y-c;c=y,l&&l({action:a,location:m.location,delta:g})}function d(y,g){a=gi.Push;let v=A1(m.location,y,g);n&&n(v,y),c=u()+1;let x=VN(v,c),b=m.createHref(v);try{i.pushState(x,"",b)}catch{s.location.assign(b)}o&&l&&l({action:a,location:m.location,delta:1})}function f(y,g){a=gi.Replace;let v=A1(m.location,y,g);n&&n(v,y),c=u();let x=VN(v,c),b=m.createHref(v);i.replaceState(x,"",b),o&&l&&l({action:a,location:m.location,delta:0})}function p(y){let g=s.location.origin!=="null"?s.location.origin:s.location.href,v=typeof y=="string"?y:wg(y);return ln(g,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,g)}let m={get action(){return a},get location(){return t(s,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(UN,h),l=y,()=>{s.removeEventListener(UN,h),l=null}},createHref(y){return e(s,y)},createURL:p,encodeLocation(y){let g=p(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:d,replace:f,go(y){return i.go(y)}};return m}var WN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(WN||(WN={}));function dG(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?iu(e):e,s=BI(r.pathname||"/",n);if(s==null)return null;let o=UD(t);fG(o);let i=null;for(let a=0;i==null&&a<o.length;++a)i=CG(o[a],kG(s));return i}function UD(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,i,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};l.relativePath.startsWith("/")&&(ln(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let c=Ri([r,l.relativePath]),u=n.concat(l);o.children&&o.children.length>0&&(ln(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),UD(o.children,e,u,c)),!(o.path==null&&!o.index)&&e.push({path:c,score:bG(c,o.index),routesMeta:u})};return t.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))s(o,i);else for(let l of VD(o.path))s(o,i,l)}),e}function VD(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let i=VD(r.join("/")),a=[];return a.push(...i.map(l=>l===""?o:[o,l].join("/"))),s&&a.push(...i),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function fG(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:wG(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const pG=/^:\w+$/,mG=3,gG=2,yG=1,vG=10,xG=-2,jN=t=>t==="*";function bG(t,e){let n=t.split("/"),r=n.length;return n.some(jN)&&(r+=xG),e&&(r+=gG),n.filter(s=>!jN(s)).reduce((s,o)=>s+(pG.test(o)?mG:o===""?yG:vG),r)}function wG(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function CG(t,e){let{routesMeta:n}=t,r={},s="/",o=[];for(let i=0;i<n.length;++i){let a=n[i],l=i===n.length-1,c=s==="/"?e:e.slice(s.length)||"/",u=IG({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},c);if(!u)return null;Object.assign(r,u.params);let h=a.route;o.push({params:r,pathname:Ri([s,u.pathname]),pathnameBase:TG(Ri([s,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(s=Ri([s,u.pathnameBase]))}return o}function IG(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=SG(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((c,u,h)=>{if(u==="*"){let d=a[h]||"";i=o.slice(0,o.length-d.length).replace(/(.)\/+$/,"$1")}return c[u]=$G(a[h]||"",u),c},{}),pathname:o,pathnameBase:i,pattern:t}}function SG(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),zI(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(i,a)=>(r.push(a),"/([^\\/]+)"));return t.endsWith("*")?(r.push("*"),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function kG(t){try{return decodeURI(t)}catch(e){return zI(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function $G(t,e){try{return decodeURIComponent(t)}catch(n){return zI(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function BI(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function EG(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?iu(t):t;return{pathname:n?n.startsWith("/")?n:NG(n,e):e,search:RG(r),hash:_G(s)}}function NG(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function jx(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function WD(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function jD(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=iu(t):(s=Jh({},t),ln(!s.pathname||!s.pathname.includes("?"),jx("?","pathname","search",s)),ln(!s.pathname||!s.pathname.includes("#"),jx("#","pathname","hash",s)),ln(!s.search||!s.search.includes("#"),jx("#","search","hash",s)));let o=t===""||s.pathname==="",i=o?"/":s.pathname,a;if(r||i==null)a=n;else{let h=e.length-1;if(i.startsWith("..")){let d=i.split("/");for(;d[0]==="..";)d.shift(),h-=1;s.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=EG(s,a),c=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Ri=t=>t.join("/").replace(/\/\/+/g,"/"),TG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),RG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,_G=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function AG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}/**
 * React Router v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function DG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}const OG=typeof Object.is=="function"?Object.is:DG,{useState:PG,useEffect:FG,useLayoutEffect:LG,useDebugValue:MG}=Fb;function zG(t,e,n){const r=e(),[{inst:s},o]=PG({inst:{value:r,getSnapshot:e}});return LG(()=>{s.value=r,s.getSnapshot=e,Gx(s)&&o({inst:s})},[t,r,e]),FG(()=>(Gx(s)&&o({inst:s}),t(()=>{Gx(s)&&o({inst:s})})),[t]),MG(r),r}function Gx(t){const e=t.getSnapshot,n=t.value;try{const r=e();return!OG(n,r)}catch{return!0}}function BG(t,e,n){return e()}const UG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",VG=!UG,WG=VG?BG:zG;"useSyncExternalStore"in Fb&&(t=>t.useSyncExternalStore)(Fb);const GD=W.createContext(null),HD=W.createContext(null),Hd=W.createContext(null),Yy=W.createContext(null),au=W.createContext({outlet:null,matches:[]}),KD=W.createContext(null);function D1(){return D1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},D1.apply(this,arguments)}function jG(t,e){let{relative:n}=e===void 0?{}:e;Kd()||ln(!1);let{basename:r,navigator:s}=W.useContext(Hd),{hash:o,pathname:i,search:a}=qD(t,{relative:n}),l=i;return r!=="/"&&(l=i==="/"?r:Ri([r,i])),s.createHref({pathname:l,search:a,hash:o})}function Kd(){return W.useContext(Yy)!=null}function Qy(){return Kd()||ln(!1),W.useContext(Yy).location}function qd(){Kd()||ln(!1);let{basename:t,navigator:e}=W.useContext(Hd),{matches:n}=W.useContext(au),{pathname:r}=Qy(),s=JSON.stringify(WD(n).map(a=>a.pathnameBase)),o=W.useRef(!1);return W.useEffect(()=>{o.current=!0}),W.useCallback(function(a,l){if(l===void 0&&(l={}),!o.current)return;if(typeof a=="number"){e.go(a);return}let c=jD(a,JSON.parse(s),r,l.relative==="path");t!=="/"&&(c.pathname=c.pathname==="/"?t:Ri([t,c.pathname])),(l.replace?e.replace:e.push)(c,l.state,l)},[t,e,s,r])}function qD(t,e){let{relative:n}=e===void 0?{}:e,{matches:r}=W.useContext(au),{pathname:s}=Qy(),o=JSON.stringify(WD(r).map(i=>i.pathnameBase));return W.useMemo(()=>jD(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function GG(t,e){Kd()||ln(!1);let{navigator:n}=W.useContext(Hd),r=W.useContext(HD),{matches:s}=W.useContext(au),o=s[s.length-1],i=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let l=Qy(),c;if(e){var u;let m=typeof e=="string"?iu(e):e;a==="/"||(u=m.pathname)!=null&&u.startsWith(a)||ln(!1),c=m}else c=l;let h=c.pathname||"/",d=a==="/"?h:h.slice(a.length)||"/",f=dG(t,{pathname:d}),p=XG(f&&f.map(m=>Object.assign({},m,{params:Object.assign({},i,m.params),pathname:Ri([a,n.encodeLocation?n.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?a:Ri([a,n.encodeLocation?n.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),s,r||void 0);return e&&p?W.createElement(Yy.Provider,{value:{location:D1({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:gi.Pop}},p):p}function HG(){let t=ZG(),e=AG(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return W.createElement(W.Fragment,null,W.createElement("h2",null,"Unexpected Application Error!"),W.createElement("h3",{style:{fontStyle:"italic"}},e),n?W.createElement("pre",{style:s},n):null,o)}class KG extends W.Component{constructor(e){super(e),this.state={location:e.location,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location?{error:e.error,location:e.location}:{error:e.error||n.error,location:n.location}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?W.createElement(au.Provider,{value:this.props.routeContext},W.createElement(KD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function qG(t){let{routeContext:e,match:n,children:r}=t,s=W.useContext(GD);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),W.createElement(au.Provider,{value:e},r)}function XG(t,e,n){if(e===void 0&&(e=[]),t==null)if(n!=null&&n.errors)t=n.matches;else return null;let r=t,s=n==null?void 0:n.errors;if(s!=null){let o=r.findIndex(i=>i.route.id&&(s==null?void 0:s[i.route.id]));o>=0||ln(!1),r=r.slice(0,Math.min(r.length,o+1))}return r.reduceRight((o,i,a)=>{let l=i.route.id?s==null?void 0:s[i.route.id]:null,c=null;n&&(i.route.ErrorBoundary?c=W.createElement(i.route.ErrorBoundary,null):i.route.errorElement?c=i.route.errorElement:c=W.createElement(HG,null));let u=e.concat(r.slice(0,a+1)),h=()=>{let d=o;return l?d=c:i.route.Component?d=W.createElement(i.route.Component,null):i.route.element&&(d=i.route.element),W.createElement(qG,{match:i,routeContext:{outlet:o,matches:u},children:d})};return n&&(i.route.ErrorBoundary||i.route.errorElement||a===0)?W.createElement(KG,{location:n.location,component:c,error:l,children:h(),routeContext:{outlet:null,matches:u}}):h()},null)}var GN;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator"})(GN||(GN={}));var Cg;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator"})(Cg||(Cg={}));function YG(t){let e=W.useContext(HD);return e||ln(!1),e}function QG(t){let e=W.useContext(au);return e||ln(!1),e}function JG(t){let e=QG(),n=e.matches[e.matches.length-1];return n.route.id||ln(!1),n.route.id}function ZG(){var t;let e=W.useContext(KD),n=YG(Cg.UseRouteError),r=JG(Cg.UseRouteError);return e||((t=n.errors)==null?void 0:t[r])}function Bs(t){ln(!1)}function eH(t){let{basename:e="/",children:n=null,location:r,navigationType:s=gi.Pop,navigator:o,static:i=!1}=t;Kd()&&ln(!1);let a=e.replace(/^\/*/,"/"),l=W.useMemo(()=>({basename:a,navigator:o,static:i}),[a,o,i]);typeof r=="string"&&(r=iu(r));let{pathname:c="/",search:u="",hash:h="",state:d=null,key:f="default"}=r,p=W.useMemo(()=>{let m=BI(c,a);return m==null?null:{location:{pathname:m,search:u,hash:h,state:d,key:f},navigationType:s}},[a,c,u,h,d,f,s]);return p==null?null:W.createElement(Hd.Provider,{value:l},W.createElement(Yy.Provider,{children:n,value:p}))}function tH(t){let{children:e,location:n}=t,r=W.useContext(GD),s=r&&!e?r.router.routes:O1(e);return GG(s,n)}var HN;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(HN||(HN={}));new Promise(()=>{});function O1(t,e){e===void 0&&(e=[]);let n=[];return W.Children.forEach(t,(r,s)=>{if(!W.isValidElement(r))return;let o=[...e,s];if(r.type===W.Fragment){n.push.apply(n,O1(r.props.children,o));return}r.type!==Bs&&ln(!1),!r.props.index||!r.props.children||ln(!1);let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=O1(r.props.children,o)),n.push(i)}),n}/**
 * React Router DOM v6.10.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function P1(){return P1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},P1.apply(this,arguments)}function nH(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function rH(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function sH(t,e){return t.button===0&&(!e||e==="_self")&&!rH(t)}const oH=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function iH(t){let{basename:e,children:n,window:r}=t,s=W.useRef();s.current==null&&(s.current=cG({window:r,v5Compat:!0}));let o=s.current,[i,a]=W.useState({action:o.action,location:o.location});return W.useLayoutEffect(()=>o.listen(a),[o]),W.createElement(eH,{basename:e,children:n,location:i.location,navigationType:i.action,navigator:o})}const aH=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",lH=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_r=W.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:o,replace:i,state:a,target:l,to:c,preventScrollReset:u}=e,h=nH(e,oH),{basename:d}=W.useContext(Hd),f,p=!1;if(typeof c=="string"&&lH.test(c)&&(f=c,aH)){let v=new URL(window.location.href),x=c.startsWith("//")?new URL(v.protocol+c):new URL(c),b=BI(x.pathname,d);x.origin===v.origin&&b!=null?c=b+x.search+x.hash:p=!0}let m=jG(c,{relative:s}),y=cH(c,{replace:i,state:a,target:l,preventScrollReset:u,relative:s});function g(v){r&&r(v),v.defaultPrevented||y(v)}return W.createElement("a",P1({},h,{href:f||m,onClick:p||o?r:g,ref:n,target:l}))});var KN;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmitImpl="useSubmitImpl",t.UseFetcher="useFetcher"})(KN||(KN={}));var qN;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(qN||(qN={}));function cH(t,e){let{target:n,replace:r,state:s,preventScrollReset:o,relative:i}=e===void 0?{}:e,a=qd(),l=Qy(),c=qD(t,{relative:i});return W.useCallback(u=>{if(sH(u,n)){u.preventDefault();let h=r!==void 0?r:wg(l)===wg(c);a(t,{replace:h,state:s,preventScrollReset:o,relative:i})}},[l,a,c,r,s,n,t,o,i])}const uH="/assets/farmgf-d7d72361.gif",hH="/assets/mittgf-c2e635b5.gif",dH="/assets/chickgf-d84a368f.gif",fH="/assets/egg-85d656dc.gif",pH="/assets/invasive-fddacc8e.gif",mH="/assets/feed-32bbf866.gif";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},gH=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const o=t[n++];e[r++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=t[n++],i=t[n++],a=t[n++],l=((s&7)<<18|(o&63)<<12|(i&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const o=t[n++],i=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(o&63)<<6|i&63)}}return e.join("")},YD={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const o=t[s],i=s+1<t.length,a=i?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=o>>2,h=(o&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,i||(d=64)),r.push(n[u],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(XD(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gH(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const o=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const c=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,o==null||a==null||c==null||h==null)throw new yH;const d=o<<2|a>>4;if(r.push(d),c!==64){const f=a<<4&240|c>>2;if(r.push(f),h!==64){const p=c<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vH=function(t){const e=XD(t);return YD.encodeByteArray(e,!0)},Ig=function(t){return vH(t).replace(/\./g,"")},QD=function(t){try{return YD.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xH(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bH=()=>xH().__FIREBASE_DEFAULTS__,wH=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},CH=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&QD(t[1]);return e&&JSON.parse(e)},UI=()=>{try{return bH()||wH()||CH()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},JD=t=>{var e,n;return(n=(e=UI())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},IH=t=>{const e=JD(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},SH=()=>{var t;return(t=UI())===null||t===void 0?void 0:t.config},ZD=t=>{var e;return(e=UI())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kH{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $H(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Ig(JSON.stringify(n)),Ig(JSON.stringify(i)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function EH(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xn())}function NH(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function TH(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RH(){const t=Xn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _H(){try{return typeof indexedDB=="object"}catch{return!1}}function AH(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DH="FirebaseError";class Ko extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=DH,Object.setPrototypeOf(this,Ko.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xd.prototype.create)}}class Xd{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,o=this.errors[e],i=o?OH(o,r):"Error",a=`${this.serviceName}: ${i} (${s}).`;return new Ko(s,a,r)}}function OH(t,e){return t.replace(PH,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const PH=/\{\$([^}]+)}/g;function FH(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Sg(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const o=t[s],i=e[s];if(XN(o)&&XN(i)){if(!Sg(o,i))return!1}else if(o!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function XN(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function sh(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,o]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function oh(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function LH(t,e){const n=new MH(t,e);return n.subscribe.bind(n)}class MH{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");zH(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Hx),s.error===void 0&&(s.error=Hx),s.complete===void 0&&(s.complete=Hx);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zH(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Hx(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ir(t){return t&&t._delegate?t._delegate:t}class Xa{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BH=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new kH;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(VH(e))try{this.getOrInitializeService({instanceIdentifier:xa})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:s});r.resolve(o)}catch{}}}}clearInstance(e=xa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xa){return this.instances.has(e)}getOptions(e=xa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&i.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(s,o);const i=this.instances.get(s);return i&&e(i,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:UH(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=xa){return this.component?this.component.multipleInstances?e:xa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function UH(t){return t===xa?void 0:t}function VH(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WH{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new BH(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Xe||(Xe={}));const jH={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},GH=Xe.INFO,HH={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},KH=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=HH[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let VI=class{constructor(e){this.name=e,this._logLevel=GH,this._logHandler=KH,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jH[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}};const qH=(t,e)=>e.some(n=>t instanceof n);let YN,QN;function XH(){return YN||(YN=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YH(){return QN||(QN=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eO=new WeakMap,F1=new WeakMap,tO=new WeakMap,Kx=new WeakMap,WI=new WeakMap;function QH(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",o),t.removeEventListener("error",i)},o=()=>{n(_i(t.result)),s()},i=()=>{r(t.error),s()};t.addEventListener("success",o),t.addEventListener("error",i)});return e.then(n=>{n instanceof IDBCursor&&eO.set(n,t)}).catch(()=>{}),WI.set(e,t),e}function JH(t){if(F1.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",i),t.removeEventListener("abort",i)},o=()=>{n(),s()},i=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",o),t.addEventListener("error",i),t.addEventListener("abort",i)});F1.set(t,e)}let L1={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return F1.get(t);if(e==="objectStoreNames")return t.objectStoreNames||tO.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _i(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ZH(t){L1=t(L1)}function e6(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(qx(this),e,...n);return tO.set(r,e.sort?e.sort():[e]),_i(r)}:YH().includes(t)?function(...e){return t.apply(qx(this),e),_i(eO.get(this))}:function(...e){return _i(t.apply(qx(this),e))}}function t6(t){return typeof t=="function"?e6(t):(t instanceof IDBTransaction&&JH(t),qH(t,XH())?new Proxy(t,L1):t)}function _i(t){if(t instanceof IDBRequest)return QH(t);if(Kx.has(t))return Kx.get(t);const e=t6(t);return e!==t&&(Kx.set(t,e),WI.set(e,t)),e}const qx=t=>WI.get(t);function n6(t,e,{blocked:n,upgrade:r,blocking:s,terminated:o}={}){const i=indexedDB.open(t,e),a=_i(i);return r&&i.addEventListener("upgradeneeded",l=>{r(_i(i.result),l.oldVersion,l.newVersion,_i(i.transaction))}),n&&i.addEventListener("blocked",()=>n()),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}const r6=["get","getKey","getAll","getAllKeys","count"],s6=["put","add","delete","clear"],Xx=new Map;function JN(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Xx.get(e))return Xx.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=s6.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||r6.includes(n)))return;const o=async function(i,...a){const l=this.transaction(i,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return Xx.set(e,o),o}ZH(t=>({...t,get:(e,n,r)=>JN(e,n)||t.get(e,n,r),has:(e,n)=>!!JN(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(i6(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function i6(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const M1="@firebase/app",ZN="0.9.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=new VI("@firebase/app"),a6="@firebase/app-compat",l6="@firebase/analytics-compat",c6="@firebase/analytics",u6="@firebase/app-check-compat",h6="@firebase/app-check",d6="@firebase/auth",f6="@firebase/auth-compat",p6="@firebase/database",m6="@firebase/database-compat",g6="@firebase/functions",y6="@firebase/functions-compat",v6="@firebase/installations",x6="@firebase/installations-compat",b6="@firebase/messaging",w6="@firebase/messaging-compat",C6="@firebase/performance",I6="@firebase/performance-compat",S6="@firebase/remote-config",k6="@firebase/remote-config-compat",$6="@firebase/storage",E6="@firebase/storage-compat",N6="@firebase/firestore",T6="@firebase/firestore-compat",R6="firebase",_6="9.20.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1="[DEFAULT]",A6={[M1]:"fire-core",[a6]:"fire-core-compat",[c6]:"fire-analytics",[l6]:"fire-analytics-compat",[h6]:"fire-app-check",[u6]:"fire-app-check-compat",[d6]:"fire-auth",[f6]:"fire-auth-compat",[p6]:"fire-rtdb",[m6]:"fire-rtdb-compat",[g6]:"fire-fn",[y6]:"fire-fn-compat",[v6]:"fire-iid",[x6]:"fire-iid-compat",[b6]:"fire-fcm",[w6]:"fire-fcm-compat",[C6]:"fire-perf",[I6]:"fire-perf-compat",[S6]:"fire-rc",[k6]:"fire-rc-compat",[$6]:"fire-gcs",[E6]:"fire-gcs-compat",[N6]:"fire-fst",[T6]:"fire-fst-compat","fire-js":"fire-js",[R6]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg=new Map,B1=new Map;function D6(t,e){try{t.container.addComponent(e)}catch(n){Ya.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Tc(t){const e=t.name;if(B1.has(e))return Ya.debug(`There were multiple attempts to register component ${e}.`),!1;B1.set(e,t);for(const n of kg.values())D6(n,t);return!0}function jI(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Ai=new Xd("app","Firebase",O6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Xa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ai.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu=_6;function nO(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:z1,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Ai.create("bad-app-name",{appName:String(s)});if(n||(n=SH()),!n)throw Ai.create("no-options");const o=kg.get(s);if(o){if(Sg(n,o.options)&&Sg(r,o.config))return o;throw Ai.create("duplicate-app",{appName:s})}const i=new WH(s);for(const l of B1.values())i.addComponent(l);const a=new P6(n,r,i);return kg.set(s,a),a}function rO(t=z1){const e=kg.get(t);if(!e&&t===z1)return nO();if(!e)throw Ai.create("no-app",{appName:t});return e}function Di(t,e,n){var r;let s=(r=A6[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),i=e.match(/\s|\//);if(o||i){const a=[`Unable to register library "${s}" with version "${e}":`];o&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&i&&a.push("and"),i&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ya.warn(a.join(" "));return}Tc(new Xa(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6="firebase-heartbeat-database",L6=1,Zh="firebase-heartbeat-store";let Yx=null;function sO(){return Yx||(Yx=n6(F6,L6,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Zh)}}}).catch(t=>{throw Ai.create("idb-open",{originalErrorMessage:t.message})})),Yx}async function M6(t){try{return(await sO()).transaction(Zh).objectStore(Zh).get(oO(t))}catch(e){if(e instanceof Ko)Ya.warn(e.message);else{const n=Ai.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ya.warn(n.message)}}}async function eT(t,e){try{const r=(await sO()).transaction(Zh,"readwrite");return await r.objectStore(Zh).put(e,oO(t)),r.done}catch(n){if(n instanceof Ko)Ya.warn(n.message);else{const r=Ai.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ya.warn(r.message)}}}function oO(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z6=1024,B6=30*24*60*60*1e3;class U6{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new W6(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=tT();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const o=new Date(s.date).valueOf();return Date.now()-o<=B6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=tT(),{heartbeatsToSend:n,unsentEntries:r}=V6(this._heartbeatsCache.heartbeats),s=Ig(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function tT(){return new Date().toISOString().substring(0,10)}function V6(t,e=z6){const n=[];let r=t.slice();for(const s of t){const o=n.find(i=>i.agent===s.agent);if(o){if(o.dates.push(s.date),nT(n)>e){o.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),nT(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class W6{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _H()?AH().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await M6(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return eT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return eT(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function nT(t){return Ig(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j6(t){Tc(new Xa("platform-logger",e=>new o6(e),"PRIVATE")),Tc(new Xa("heartbeat",e=>new U6(e),"PRIVATE")),Di(M1,ZN,t),Di(M1,ZN,"esm2017"),Di("fire-js","")}j6("");var G6="firebase",H6="9.20.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Di(G6,H6,"app");var K6=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ve,GI=GI||{},Te=K6||self;function $g(){}function Jy(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Qd(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function q6(t){return Object.prototype.hasOwnProperty.call(t,Qx)&&t[Qx]||(t[Qx]=++X6)}var Qx="closure_uid_"+(1e9*Math.random()>>>0),X6=0;function Y6(t,e,n){return t.call.apply(t.bind,arguments)}function Q6(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function Gn(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Gn=Y6:Gn=Q6,Gn.apply(null,arguments)}function nm(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function An(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Wb=function(r,s,o){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return e.prototype[s].apply(r,i)}}function na(){this.s=this.s,this.o=this.o}var J6=0;na.prototype.s=!1;na.prototype.na=function(){!this.s&&(this.s=!0,this.M(),J6!=0)&&q6(this)};na.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const iO=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function HI(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function rT(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Jy(r)){const s=t.length||0,o=r.length||0;t.length=s+o;for(let i=0;i<o;i++)t[s+i]=r[i]}else t.push(r)}}function Hn(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Hn.prototype.h=function(){this.defaultPrevented=!0};var Z6=function(){if(!Te.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Te.addEventListener("test",$g,e),Te.removeEventListener("test",$g,e)}catch{}return t}();function Eg(t){return/^[\s\xa0]*$/.test(t)}var sT=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Jx(t,e){return t<e?-1:t>e?1:0}function Zy(){var t=Te.navigator;return t&&(t=t.userAgent)?t:""}function qs(t){return Zy().indexOf(t)!=-1}function KI(t){return KI[" "](t),t}KI[" "]=$g;function e5(t){var e=r5;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var t5=qs("Opera"),Rc=qs("Trident")||qs("MSIE"),aO=qs("Edge"),U1=aO||Rc,lO=qs("Gecko")&&!(Zy().toLowerCase().indexOf("webkit")!=-1&&!qs("Edge"))&&!(qs("Trident")||qs("MSIE"))&&!qs("Edge"),n5=Zy().toLowerCase().indexOf("webkit")!=-1&&!qs("Edge");function cO(){var t=Te.document;return t?t.documentMode:void 0}var Ng;e:{var Zx="",eb=function(){var t=Zy();if(lO)return/rv:([^\);]+)(\)|;)/.exec(t);if(aO)return/Edge\/([\d\.]+)/.exec(t);if(Rc)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(n5)return/WebKit\/(\S+)/.exec(t);if(t5)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(eb&&(Zx=eb?eb[1]:""),Rc){var tb=cO();if(tb!=null&&tb>parseFloat(Zx)){Ng=String(tb);break e}}Ng=Zx}var r5={};function s5(){return e5(function(){let t=0;const e=sT(String(Ng)).split("."),n=sT("9").split("."),r=Math.max(e.length,n.length);for(let i=0;t==0&&i<r;i++){var s=e[i]||"",o=n[i]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s[0].length==0&&o[0].length==0)break;t=Jx(s[1].length==0?0:parseInt(s[1],10),o[1].length==0?0:parseInt(o[1],10))||Jx(s[2].length==0,o[2].length==0)||Jx(s[2],o[2]),s=s[3],o=o[3]}while(t==0)}return 0<=t})}var V1;if(Te.document&&Rc){var oT=cO();V1=oT||parseInt(Ng,10)||void 0}else V1=void 0;var o5=V1;function ed(t,e){if(Hn.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(lO){e:{try{KI(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:i5[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ed.X.h.call(this)}}An(ed,Hn);var i5={2:"touch",3:"pen",4:"mouse"};ed.prototype.h=function(){ed.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Jd="closure_listenable_"+(1e6*Math.random()|0),a5=0;function l5(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=s,this.key=++a5,this.ba=this.ea=!1}function ev(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function qI(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function uO(t){const e={};for(const n in t)e[n]=t[n];return e}const iT="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function hO(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let o=0;o<iT.length;o++)n=iT[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function tv(t){this.src=t,this.g={},this.h=0}tv.prototype.add=function(t,e,n,r,s){var o=t.toString();t=this.g[o],t||(t=this.g[o]=[],this.h++);var i=j1(t,e,r,s);return-1<i?(e=t[i],n||(e.ea=!1)):(e=new l5(e,this.src,o,!!r,s),e.ea=n,t.push(e)),e};function W1(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=iO(r,e),o;(o=0<=s)&&Array.prototype.splice.call(r,s,1),o&&(ev(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function j1(t,e,n,r){for(var s=0;s<t.length;++s){var o=t[s];if(!o.ba&&o.listener==e&&o.capture==!!n&&o.ha==r)return s}return-1}var XI="closure_lm_"+(1e6*Math.random()|0),nb={};function dO(t,e,n,r,s){if(r&&r.once)return pO(t,e,n,r,s);if(Array.isArray(e)){for(var o=0;o<e.length;o++)dO(t,e[o],n,r,s);return null}return n=JI(n),t&&t[Jd]?t.N(e,n,Qd(r)?!!r.capture:!!r,s):fO(t,e,n,!1,r,s)}function fO(t,e,n,r,s,o){if(!e)throw Error("Invalid event type");var i=Qd(s)?!!s.capture:!!s,a=QI(t);if(a||(t[XI]=a=new tv(t)),n=a.add(e,n,r,i,o),n.proxy)return n;if(r=c5(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Z6||(s=i),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(gO(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function c5(){function t(n){return e.call(t.src,t.listener,n)}const e=u5;return t}function pO(t,e,n,r,s){if(Array.isArray(e)){for(var o=0;o<e.length;o++)pO(t,e[o],n,r,s);return null}return n=JI(n),t&&t[Jd]?t.O(e,n,Qd(r)?!!r.capture:!!r,s):fO(t,e,n,!0,r,s)}function mO(t,e,n,r,s){if(Array.isArray(e))for(var o=0;o<e.length;o++)mO(t,e[o],n,r,s);else r=Qd(r)?!!r.capture:!!r,n=JI(n),t&&t[Jd]?(t=t.i,e=String(e).toString(),e in t.g&&(o=t.g[e],n=j1(o,n,r,s),-1<n&&(ev(o[n]),Array.prototype.splice.call(o,n,1),o.length==0&&(delete t.g[e],t.h--)))):t&&(t=QI(t))&&(e=t.g[e.toString()],t=-1,e&&(t=j1(e,n,r,s)),(n=-1<t?e[t]:null)&&YI(n))}function YI(t){if(typeof t!="number"&&t&&!t.ba){var e=t.src;if(e&&e[Jd])W1(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(gO(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=QI(e))?(W1(n,t),n.h==0&&(n.src=null,e[XI]=null)):ev(t)}}}function gO(t){return t in nb?nb[t]:nb[t]="on"+t}function u5(t,e){if(t.ba)t=!0;else{e=new ed(e,this);var n=t.listener,r=t.ha||t.src;t.ea&&YI(t),t=n.call(r,e)}return t}function QI(t){return t=t[XI],t instanceof tv?t:null}var rb="__closure_events_fn_"+(1e9*Math.random()>>>0);function JI(t){return typeof t=="function"?t:(t[rb]||(t[rb]=function(e){return t.handleEvent(e)}),t[rb])}function xn(){na.call(this),this.i=new tv(this),this.P=this,this.I=null}An(xn,na);xn.prototype[Jd]=!0;xn.prototype.removeEventListener=function(t,e,n,r){mO(this,t,e,n,r)};function Nn(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new Hn(e,t);else if(e instanceof Hn)e.target=e.target||t;else{var s=e;e=new Hn(r,t),hO(e,s)}if(s=!0,n)for(var o=n.length-1;0<=o;o--){var i=e.g=n[o];s=rm(i,r,!0,e)&&s}if(i=e.g=t,s=rm(i,r,!0,e)&&s,s=rm(i,r,!1,e)&&s,n)for(o=0;o<n.length;o++)i=e.g=n[o],s=rm(i,r,!1,e)&&s}xn.prototype.M=function(){if(xn.X.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ev(n[r]);delete t.g[e],t.h--}}this.I=null};xn.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};xn.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function rm(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,o=0;o<e.length;++o){var i=e[o];if(i&&!i.ba&&i.capture==n){var a=i.listener,l=i.ha||i.src;i.ea&&W1(t.i,i),s=a.call(l,r)!==!1&&s}}return s&&!r.defaultPrevented}var ZI=Te.JSON.stringify;function h5(){var t=xO;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class d5{constructor(){this.h=this.g=null}add(e,n){const r=yO.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var yO=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new f5,t=>t.reset());class f5{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function p5(t){Te.setTimeout(()=>{throw t},0)}function vO(t,e){G1||m5(),H1||(G1(),H1=!0),xO.add(t,e)}var G1;function m5(){var t=Te.Promise.resolve(void 0);G1=function(){t.then(g5)}}var H1=!1,xO=new d5;function g5(){for(var t;t=h5();){try{t.h.call(t.g)}catch(n){p5(n)}var e=yO;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}H1=!1}function nv(t,e){xn.call(this),this.h=t||1,this.g=e||Te,this.j=Gn(this.lb,this),this.l=Date.now()}An(nv,xn);ve=nv.prototype;ve.ca=!1;ve.R=null;ve.lb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Nn(this,"tick"),this.ca&&(eS(this),this.start()))}};ve.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function eS(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}ve.M=function(){nv.X.M.call(this),eS(this),delete this.g};function tS(t,e,n){if(typeof t=="function")n&&(t=Gn(t,n));else if(t&&typeof t.handleEvent=="function")t=Gn(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Te.setTimeout(t,e||0)}function bO(t){t.g=tS(()=>{t.g=null,t.i&&(t.i=!1,bO(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class y5 extends na{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:bO(this)}M(){super.M(),this.g&&(Te.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function td(t){na.call(this),this.h=t,this.g={}}An(td,na);var aT=[];function wO(t,e,n,r){Array.isArray(n)||(n&&(aT[0]=n.toString()),n=aT);for(var s=0;s<n.length;s++){var o=dO(e,n[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function CO(t){qI(t.g,function(e,n){this.g.hasOwnProperty(n)&&YI(e)},t),t.g={}}td.prototype.M=function(){td.X.M.call(this),CO(this)};td.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function rv(){this.g=!0}rv.prototype.Aa=function(){this.g=!1};function v5(t,e,n,r,s,o){t.info(function(){if(t.g)if(o)for(var i="",a=o.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");i=2<=h.length&&h[1]=="type"?i+(u+"="+c+"&"):i+(u+"=redacted&")}}else i=null;else i=o;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+i})}function x5(t,e,n,r,s,o,i){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+o+" "+i})}function ec(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+w5(t,n)+(r?" "+r:"")})}function b5(t,e){t.info(function(){return"TIMEOUT: "+e})}rv.prototype.info=function(){};function w5(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var o=s[0];if(o!="noop"&&o!="stop"&&o!="close")for(var i=1;i<s.length;i++)s[i]=""}}}}return ZI(n)}catch{return e}}var vl={},lT=null;function sv(){return lT=lT||new xn}vl.Pa="serverreachability";function IO(t){Hn.call(this,vl.Pa,t)}An(IO,Hn);function nd(t){const e=sv();Nn(e,new IO(e))}vl.STAT_EVENT="statevent";function SO(t,e){Hn.call(this,vl.STAT_EVENT,t),this.stat=e}An(SO,Hn);function nr(t){const e=sv();Nn(e,new SO(e,t))}vl.Qa="timingevent";function kO(t,e){Hn.call(this,vl.Qa,t),this.size=e}An(kO,Hn);function Zd(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Te.setTimeout(function(){t()},e)}var ov={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},$O={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function nS(){}nS.prototype.h=null;function cT(t){return t.h||(t.h=t.i())}function EO(){}var ef={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function rS(){Hn.call(this,"d")}An(rS,Hn);function sS(){Hn.call(this,"c")}An(sS,Hn);var K1;function iv(){}An(iv,nS);iv.prototype.g=function(){return new XMLHttpRequest};iv.prototype.i=function(){return{}};K1=new iv;function tf(t,e,n,r){this.l=t,this.j=e,this.m=n,this.U=r||1,this.S=new td(this),this.O=C5,t=U1?125:void 0,this.T=new nv(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new NO}function NO(){this.i=null,this.g="",this.h=!1}var C5=45e3,q1={},Tg={};ve=tf.prototype;ve.setTimeout=function(t){this.O=t};function X1(t,e,n){t.K=1,t.v=lv(Fo(e)),t.s=n,t.P=!0,TO(t,null)}function TO(t,e){t.F=Date.now(),nf(t),t.A=Fo(t.v);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),LO(n.i,"t",r),t.C=0,n=t.l.H,t.h=new NO,t.g=sP(t.l,n?e:null,!t.s),0<t.N&&(t.L=new y5(Gn(t.La,t,t.g),t.N)),wO(t.S,t.g,"readystatechange",t.ib),e=t.H?uO(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),nd(),v5(t.j,t.u,t.A,t.m,t.U,t.s)}ve.ib=function(t){t=t.target;const e=this.L;e&&Io(t)==3?e.l():this.La(t)};ve.La=function(t){try{if(t==this.g)e:{const u=Io(this.g);var e=this.g.Ea();const h=this.g.aa();if(!(3>u)&&(u!=3||U1||this.g&&(this.h.h||this.g.fa()||fT(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?nd(3):nd(2)),av(this);var n=this.g.aa();this.Y=n;t:if(RO(this)){var r=fT(this.g);t="";var s=r.length,o=Io(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Na(this),kh(this);var i="";break t}this.h.i=new Te.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:o&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,i=this.h.g}else i=this.g.fa();if(this.i=n==200,x5(this.j,this.u,this.A,this.m,this.U,u,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Eg(a)){var c=a;break t}}c=null}if(n=c)ec(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Y1(this,n);else{this.i=!1,this.o=3,nr(12),Na(this),kh(this);break e}}this.P?(_O(this,u,i),U1&&this.i&&u==3&&(wO(this.S,this.T,"tick",this.hb),this.T.start())):(ec(this.j,this.m,i,null),Y1(this,i)),u==4&&Na(this),this.i&&!this.I&&(u==4?eP(this.l,this):(this.i=!1,nf(this)))}else n==400&&0<i.indexOf("Unknown SID")?(this.o=3,nr(12)):(this.o=0,nr(13)),Na(this),kh(this)}}}catch{}finally{}};function RO(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Da:!1}function _O(t,e,n){let r=!0,s;for(;!t.I&&t.C<n.length;)if(s=I5(t,n),s==Tg){e==4&&(t.o=4,nr(14),r=!1),ec(t.j,t.m,null,"[Incomplete Response]");break}else if(s==q1){t.o=4,nr(15),ec(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else ec(t.j,t.m,s,null),Y1(t,s);RO(t)&&s!=Tg&&s!=q1&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,nr(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.$&&(t.$=!0,e=t.l,e.g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),hS(e),e.K=!0,nr(11))):(ec(t.j,t.m,n,"[Invalid Chunked Response]"),Na(t),kh(t))}ve.hb=function(){if(this.g){var t=Io(this.g),e=this.g.fa();this.C<e.length&&(av(this),_O(this,t,e),this.i&&t!=4&&nf(this))}};function I5(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Tg:(n=Number(e.substring(n,r)),isNaN(n)?q1:(r+=1,r+n>e.length?Tg:(e=e.substr(r,n),t.C=r+n,e)))}ve.cancel=function(){this.I=!0,Na(this)};function nf(t){t.V=Date.now()+t.O,AO(t,t.O)}function AO(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=Zd(Gn(t.gb,t),e)}function av(t){t.B&&(Te.clearTimeout(t.B),t.B=null)}ve.gb=function(){this.B=null;const t=Date.now();0<=t-this.V?(b5(this.j,this.A),this.K!=2&&(nd(),nr(17)),Na(this),this.o=2,kh(this)):AO(this,this.V-t)};function kh(t){t.l.G==0||t.I||eP(t.l,t)}function Na(t){av(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,eS(t.T),CO(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Y1(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||Q1(n.h,t))){if(!t.J&&Q1(n.h,t)&&n.G==3){try{var r=n.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Ag(n),hv(n);else break e;uS(n),nr(18)}}else n.Ba=s[1],0<n.Ba-n.T&&37500>s[2]&&n.L&&n.A==0&&!n.v&&(n.v=Zd(Gn(n.cb,n),6e3));if(1>=BO(n.h)&&n.ja){try{n.ja()}catch{}n.ja=void 0}}else Ta(n,11)}else if((t.J||n.g==t)&&Ag(n),!Eg(e))for(s=n.Fa.g.parse(e),e=0;e<s.length;e++){let c=s[e];if(n.T=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.I=c[1],n.ka=c[2];const u=c[3];u!=null&&(n.ma=u,n.j.info("VER="+n.ma));const h=c[4];h!=null&&(n.Ca=h,n.j.info("SVER="+n.Ca));const d=c[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var o=r.h;o.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(o.j=o.l,o.g=new Set,o.h&&(oS(o,o.h),o.h=null))}if(r.D){const m=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;m&&(r.za=m,kt(r.F,r.D,m))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms")),r=n;var i=t;if(r.sa=rP(r,r.H?r.ka:null,r.V),i.J){UO(r.h,i);var a=i,l=r.J;l&&a.setTimeout(l),a.B&&(av(a),nf(a)),r.g=i}else JO(r);0<n.i.length&&dv(n)}else c[0]!="stop"&&c[0]!="close"||Ta(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Ta(n,7):cS(n):c[0]!="noop"&&n.l&&n.l.wa(c),n.A=0)}}nd(4)}catch{}}function S5(t){if(t.W&&typeof t.W=="function")return t.W();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Jy(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function k5(t){if(t.oa&&typeof t.oa=="function")return t.oa();if(!t.W||typeof t.W!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Jy(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function DO(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Jy(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=k5(t),r=S5(t),s=r.length,o=0;o<s;o++)e.call(void 0,r[o],n&&n[o],t)}var OO=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $5(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var o=t[n].substring(0,r);s=t[n].substring(r+1)}else o=t[n];e(o,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function La(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof La){this.h=e!==void 0?e:t.h,Rg(this,t.j),this.s=t.s,this.g=t.g,_g(this,t.m),this.l=t.l,e=t.i;var n=new rd;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),uT(this,n),this.o=t.o}else t&&(n=String(t).match(OO))?(this.h=!!e,Rg(this,n[1]||"",!0),this.s=ih(n[2]||""),this.g=ih(n[3]||"",!0),_g(this,n[4]),this.l=ih(n[5]||"",!0),uT(this,n[6]||"",!0),this.o=ih(n[7]||"")):(this.h=!!e,this.i=new rd(null,this.h))}La.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ah(e,hT,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(ah(e,hT,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(ah(n,n.charAt(0)=="/"?T5:N5,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ah(n,_5)),t.join("")};function Fo(t){return new La(t)}function Rg(t,e,n){t.j=n?ih(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function _g(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function uT(t,e,n){e instanceof rd?(t.i=e,A5(t.i,t.h)):(n||(e=ah(e,R5)),t.i=new rd(e,t.h))}function kt(t,e,n){t.i.set(e,n)}function lv(t){return kt(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ih(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ah(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,E5),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function E5(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var hT=/[#\/\?@]/g,N5=/[#\?:]/g,T5=/[#\?]/g,R5=/[#\?@]/g,_5=/#/g;function rd(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ra(t){t.g||(t.g=new Map,t.h=0,t.i&&$5(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}ve=rd.prototype;ve.add=function(t,e){ra(this),this.i=null,t=cu(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function PO(t,e){ra(t),e=cu(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function FO(t,e){return ra(t),e=cu(t,e),t.g.has(e)}ve.forEach=function(t,e){ra(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};ve.oa=function(){ra(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let o=0;o<s.length;o++)n.push(e[r])}return n};ve.W=function(t){ra(this);let e=[];if(typeof t=="string")FO(this,t)&&(e=e.concat(this.g.get(cu(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};ve.set=function(t,e){return ra(this),this.i=null,t=cu(this,t),FO(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};ve.get=function(t,e){return t?(t=this.W(t),0<t.length?String(t[0]):e):e};function LO(t,e,n){PO(t,e),0<n.length&&(t.i=null,t.g.set(cu(t,e),HI(n)),t.h+=n.length)}ve.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const o=encodeURIComponent(String(r)),i=this.W(r);for(r=0;r<i.length;r++){var s=o;i[r]!==""&&(s+="="+encodeURIComponent(String(i[r]))),t.push(s)}}return this.i=t.join("&")};function cu(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function A5(t,e){e&&!t.j&&(ra(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(PO(this,r),LO(this,s,n))},t)),t.j=e}var D5=class{constructor(t,e){this.h=t,this.g=e}};function MO(t){this.l=t||O5,Te.PerformanceNavigationTiming?(t=Te.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Te.g&&Te.g.Ga&&Te.g.Ga()&&Te.g.Ga().$b),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var O5=10;function zO(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function BO(t){return t.h?1:t.g?t.g.size:0}function Q1(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function oS(t,e){t.g?t.g.add(e):t.h=e}function UO(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}MO.prototype.cancel=function(){if(this.i=VO(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function VO(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return HI(t.i)}function iS(){}iS.prototype.stringify=function(t){return Te.JSON.stringify(t,void 0)};iS.prototype.parse=function(t){return Te.JSON.parse(t,void 0)};function P5(){this.g=new iS}function F5(t,e,n){const r=n||"";try{DO(t,function(s,o){let i=s;Qd(s)&&(i=ZI(s)),e.push(r+o+"="+encodeURIComponent(i))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function L5(t,e){const n=new rv;if(Te.Image){const r=new Image;r.onload=nm(sm,n,r,"TestLoadImage: loaded",!0,e),r.onerror=nm(sm,n,r,"TestLoadImage: error",!1,e),r.onabort=nm(sm,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=nm(sm,n,r,"TestLoadImage: timeout",!1,e),Te.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function sm(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function rf(t){this.l=t.ac||null,this.j=t.jb||!1}An(rf,nS);rf.prototype.g=function(){return new cv(this.l,this.j)};rf.prototype.i=function(t){return function(){return t}}({});function cv(t,e){xn.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=aS,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}An(cv,xn);var aS=0;ve=cv.prototype;ve.open=function(t,e){if(this.readyState!=aS)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,sd(this)};ve.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||Te).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))};ve.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,sf(this)),this.readyState=aS};ve.Wa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,sd(this)),this.g&&(this.readyState=3,sd(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof Te.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;WO(this)}else t.text().then(this.Va.bind(this),this.ga.bind(this))};function WO(t){t.j.read().then(t.Ta.bind(t)).catch(t.ga.bind(t))}ve.Ta=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?sf(this):sd(this),this.readyState==3&&WO(this)}};ve.Va=function(t){this.g&&(this.response=this.responseText=t,sf(this))};ve.Ua=function(t){this.g&&(this.response=t,sf(this))};ve.ga=function(){this.g&&sf(this)};function sf(t){t.readyState=4,t.l=null,t.j=null,t.A=null,sd(t)}ve.setRequestHeader=function(t,e){this.v.append(t,e)};ve.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};ve.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function sd(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(cv.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var M5=Te.JSON.parse;function Mt(t){xn.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=jO,this.K=this.L=!1}An(Mt,xn);var jO="",z5=/^https?$/i,B5=["POST","PUT"];ve=Mt.prototype;ve.Ka=function(t){this.L=t};ve.da=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():K1.g(),this.C=this.u?cT(this.u):cT(K1),this.g.onreadystatechange=Gn(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(o){dT(this,o);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const o of r.keys())n.set(o,r.get(o));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(o=>o.toLowerCase()=="content-type"),s=Te.FormData&&t instanceof Te.FormData,!(0<=iO(B5,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,i]of n)this.g.setRequestHeader(o,i);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{KO(this),0<this.B&&((this.K=U5(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Gn(this.qa,this)):this.A=tS(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){dT(this,o)}};function U5(t){return Rc&&s5()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}ve.qa=function(){typeof GI<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Nn(this,"timeout"),this.abort(8))};function dT(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,GO(t),uv(t)}function GO(t){t.D||(t.D=!0,Nn(t,"complete"),Nn(t,"error"))}ve.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Nn(this,"complete"),Nn(this,"abort"),uv(this))};ve.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),uv(this,!0)),Mt.X.M.call(this)};ve.Ha=function(){this.s||(this.F||this.v||this.l?HO(this):this.fb())};ve.fb=function(){HO(this)};function HO(t){if(t.h&&typeof GI<"u"&&(!t.C[1]||Io(t)!=4||t.aa()!=2)){if(t.v&&Io(t)==4)tS(t.Ha,0,t);else if(Nn(t,"readystatechange"),Io(t)==4){t.h=!1;try{const a=t.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var s=String(t.H).match(OO)[1]||null;if(!s&&Te.self&&Te.self.location){var o=Te.self.location.protocol;s=o.substr(0,o.length-1)}r=!z5.test(s?s.toLowerCase():"")}n=r}if(n)Nn(t,"complete"),Nn(t,"success");else{t.m=6;try{var i=2<Io(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.aa()+"]",GO(t)}}finally{uv(t)}}}}function uv(t,e){if(t.g){KO(t);const n=t.g,r=t.C[0]?$g:null;t.g=null,t.C=null,e||Nn(t,"ready");try{n.onreadystatechange=r}catch{}}}function KO(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(Te.clearTimeout(t.A),t.A=null)}function Io(t){return t.g?t.g.readyState:0}ve.aa=function(){try{return 2<Io(this)?this.g.status:-1}catch{return-1}};ve.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}};ve.Sa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),M5(e)}};function fT(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case jO:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}ve.Ea=function(){return this.m};ve.Oa=function(){return typeof this.j=="string"?this.j:String(this.j)};function qO(t){let e="";return qI(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function lS(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=qO(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):kt(t,e,n))}function Yu(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function XO(t){this.Ca=0,this.i=[],this.j=new rv,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Yu("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Yu("baseRetryDelayMs",5e3,t),this.bb=Yu("retryDelaySeedMs",1e4,t),this.$a=Yu("forwardChannelMaxRetries",2,t),this.ta=Yu("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Zb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new MO(t&&t.concurrentRequestLimit),this.Fa=new P5,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=t&&t.Xb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}ve=XO.prototype;ve.ma=8;ve.G=1;function cS(t){if(YO(t),t.G==3){var e=t.U++,n=Fo(t.F);kt(n,"SID",t.I),kt(n,"RID",e),kt(n,"TYPE","terminate"),of(t,n),e=new tf(t,t.j,e,void 0),e.K=2,e.v=lv(Fo(n)),n=!1,Te.navigator&&Te.navigator.sendBeacon&&(n=Te.navigator.sendBeacon(e.v.toString(),"")),!n&&Te.Image&&(new Image().src=e.v,n=!0),n||(e.g=sP(e.l,null),e.g.da(e.v)),e.F=Date.now(),nf(e)}nP(t)}function hv(t){t.g&&(hS(t),t.g.cancel(),t.g=null)}function YO(t){hv(t),t.u&&(Te.clearTimeout(t.u),t.u=null),Ag(t),t.h.cancel(),t.m&&(typeof t.m=="number"&&Te.clearTimeout(t.m),t.m=null)}function dv(t){zO(t.h)||t.m||(t.m=!0,vO(t.Ja,t),t.C=0)}function V5(t,e){return BO(t.h)>=t.h.j-(t.m?1:0)?!1:t.m?(t.i=e.D.concat(t.i),!0):t.G==1||t.G==2||t.C>=(t.Za?0:t.$a)?!1:(t.m=Zd(Gn(t.Ja,t,e),tP(t,t.C)),t.C++,!0)}ve.Ja=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const s=new tf(this,this.j,t,void 0);let o=this.s;if(this.S&&(o?(o=uO(o),hO(o,this.S)):o=this.S),this.o!==null||this.N||(s.H=o,o=null),this.O)e:{for(var e=0,n=0;n<this.i.length;n++){t:{var r=this.i[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.i.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=QO(this,s,e),n=Fo(this.F),kt(n,"RID",t),kt(n,"CVER",22),this.D&&kt(n,"X-HTTP-Session-Id",this.D),of(this,n),o&&(this.N?e="headers="+encodeURIComponent(String(qO(o)))+"&"+e:this.o&&lS(n,this.o,o)),oS(this.h,s),this.Ya&&kt(n,"TYPE","init"),this.O?(kt(n,"$req",e),kt(n,"SID","null"),s.Z=!0,X1(s,n,null)):X1(s,n,e),this.G=2}}else this.G==3&&(t?pT(this,t):this.i.length==0||zO(this.h)||pT(this))};function pT(t,e){var n;e?n=e.m:n=t.U++;const r=Fo(t.F);kt(r,"SID",t.I),kt(r,"RID",n),kt(r,"AID",t.T),of(t,r),t.o&&t.s&&lS(r,t.o,t.s),n=new tf(t,t.j,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=QO(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),oS(t.h,n),X1(n,r,e)}function of(t,e){t.ia&&qI(t.ia,function(n,r){kt(e,r,n)}),t.l&&DO({},function(n,r){kt(e,r,n)})}function QO(t,e,n){n=Math.min(t.i.length,n);var r=t.l?Gn(t.l.Ra,t.l,t):null;e:{var s=t.i;let o=-1;for(;;){const i=["count="+n];o==-1?0<n?(o=s[0].h,i.push("ofs="+o)):o=0:i.push("ofs="+o);let a=!0;for(let l=0;l<n;l++){let c=s[l].h;const u=s[l].g;if(c-=o,0>c)o=Math.max(0,s[l].h-100),a=!1;else try{F5(u,i,"req"+c+"_")}catch{r&&r(u)}}if(a){r=i.join("&");break e}}}return t=t.i.splice(0,n),e.D=t,r}function JO(t){t.g||t.u||(t.Z=1,vO(t.Ia,t),t.A=0)}function uS(t){return t.g||t.u||3<=t.A?!1:(t.Z++,t.u=Zd(Gn(t.Ia,t),tP(t,t.A)),t.A++,!0)}ve.Ia=function(){if(this.u=null,ZO(this),this.$&&!(this.K||this.g==null||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=Zd(Gn(this.eb,this),t)}};ve.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,nr(10),hv(this),ZO(this))};function hS(t){t.B!=null&&(Te.clearTimeout(t.B),t.B=null)}function ZO(t){t.g=new tf(t,t.j,"rpc",t.Z),t.o===null&&(t.g.H=t.s),t.g.N=0;var e=Fo(t.sa);kt(e,"RID","rpc"),kt(e,"SID",t.I),kt(e,"CI",t.L?"0":"1"),kt(e,"AID",t.T),kt(e,"TYPE","xmlhttp"),of(t,e),t.o&&t.s&&lS(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=lv(Fo(e)),n.s=null,n.P=!0,TO(n,t)}ve.cb=function(){this.v!=null&&(this.v=null,hv(this),uS(this),nr(19))};function Ag(t){t.v!=null&&(Te.clearTimeout(t.v),t.v=null)}function eP(t,e){var n=null;if(t.g==e){Ag(t),hS(t),t.g=null;var r=2}else if(Q1(t.h,e))n=e.D,UO(t.h,e),r=1;else return;if(t.G!=0){if(t.pa=e.Y,e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var s=t.C;r=sv(),Nn(r,new kO(r,n)),dv(t)}else JO(t);else if(s=e.o,s==3||s==0&&0<t.pa||!(r==1&&V5(t,e)||r==2&&uS(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),s){case 1:Ta(t,5);break;case 4:Ta(t,10);break;case 3:Ta(t,6);break;default:Ta(t,2)}}}function tP(t,e){let n=t.Xa+Math.floor(Math.random()*t.bb);return t.l||(n*=2),n*e}function Ta(t,e){if(t.j.info("Error code "+e),e==2){var n=null;t.l&&(n=null);var r=Gn(t.kb,t);n||(n=new La("//www.google.com/images/cleardot.gif"),Te.location&&Te.location.protocol=="http"||Rg(n,"https"),lv(n)),L5(n.toString(),r)}else nr(2);t.G=0,t.l&&t.l.va(e),nP(t),YO(t)}ve.kb=function(t){t?(this.j.info("Successfully pinged google.com"),nr(2)):(this.j.info("Failed to ping google.com"),nr(1))};function nP(t){if(t.G=0,t.la=[],t.l){const e=VO(t.h);(e.length!=0||t.i.length!=0)&&(rT(t.la,e),rT(t.la,t.i),t.h.i.length=0,HI(t.i),t.i.length=0),t.l.ua()}}function rP(t,e,n){var r=n instanceof La?Fo(n):new La(n,void 0);if(r.g!="")e&&(r.g=e+"."+r.g),_g(r,r.m);else{var s=Te.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var o=new La(null,void 0);r&&Rg(o,r),e&&(o.g=e),s&&_g(o,s),n&&(o.l=n),r=o}return n=t.D,e=t.za,n&&e&&kt(r,n,e),kt(r,"VER",t.ma),of(t,r),r}function sP(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Da&&!t.ra?new Mt(new rf({jb:!0})):new Mt(t.ra),e.Ka(t.H),e}function oP(){}ve=oP.prototype;ve.xa=function(){};ve.wa=function(){};ve.va=function(){};ve.ua=function(){};ve.Ra=function(){};function Dg(){if(Rc&&!(10<=Number(o5)))throw Error("Environmental error: no available transport.")}Dg.prototype.g=function(t,e){return new Br(t,e)};function Br(t,e){xn.call(this),this.g=new XO(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Yb)&&!Eg(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Eg(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new uu(this)}An(Br,xn);Br.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;nr(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=rP(t,null,t.V),dv(t)};Br.prototype.close=function(){cS(this.g)};Br.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=ZI(t),t=n);e.i.push(new D5(e.ab++,t)),e.G==3&&dv(e)};Br.prototype.M=function(){this.g.l=null,delete this.j,cS(this.g),delete this.g,Br.X.M.call(this)};function iP(t){rS.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}An(iP,rS);function aP(){sS.call(this),this.status=1}An(aP,sS);function uu(t){this.g=t}An(uu,oP);uu.prototype.xa=function(){Nn(this.g,"a")};uu.prototype.wa=function(t){Nn(this.g,new iP(t))};uu.prototype.va=function(t){Nn(this.g,new aP)};uu.prototype.ua=function(){Nn(this.g,"b")};Dg.prototype.createWebChannel=Dg.prototype.g;Br.prototype.send=Br.prototype.u;Br.prototype.open=Br.prototype.m;Br.prototype.close=Br.prototype.close;ov.NO_ERROR=0;ov.TIMEOUT=8;ov.HTTP_ERROR=6;$O.COMPLETE="complete";EO.EventType=ef;ef.OPEN="a";ef.CLOSE="b";ef.ERROR="c";ef.MESSAGE="d";xn.prototype.listen=xn.prototype.N;Mt.prototype.listenOnce=Mt.prototype.O;Mt.prototype.getLastError=Mt.prototype.Oa;Mt.prototype.getLastErrorCode=Mt.prototype.Ea;Mt.prototype.getStatus=Mt.prototype.aa;Mt.prototype.getResponseJson=Mt.prototype.Sa;Mt.prototype.getResponseText=Mt.prototype.fa;Mt.prototype.send=Mt.prototype.da;Mt.prototype.setWithCredentials=Mt.prototype.Ka;var W5=function(){return new Dg},j5=function(){return sv()},sb=ov,G5=$O,H5=vl,mT={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},K5=rf,om=EO,q5=Mt;const gT="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mn.UNAUTHENTICATED=new Mn(null),Mn.GOOGLE_CREDENTIALS=new Mn("google-credentials-uid"),Mn.FIRST_PARTY=new Mn("first-party-uid"),Mn.MOCK_USER=new Mn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hu="9.20.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qa=new VI("@firebase/firestore");function yT(){return Qa.logLevel}function Ie(t,...e){if(Qa.logLevel<=Xe.DEBUG){const n=e.map(dS);Qa.debug(`Firestore (${hu}): ${t}`,...n)}}function Ja(t,...e){if(Qa.logLevel<=Xe.ERROR){const n=e.map(dS);Qa.error(`Firestore (${hu}): ${t}`,...n)}}function Og(t,...e){if(Qa.logLevel<=Xe.WARN){const n=e.map(dS);Qa.warn(`Firestore (${hu}): ${t}`,...n)}}function dS(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(t="Unexpected state"){const e=`FIRESTORE (${hu}) INTERNAL ASSERTION FAILED: `+t;throw Ja(e),new Error(e)}function bn(t,e){t||Ve()}function Ct(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends Ko{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class X5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Mn.UNAUTHENTICATED))}shutdown(){}}class Y5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Q5{constructor(e){this.t=e,this.currentUser=Mn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let o=new Ma;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ma,e.enqueueRetryable(()=>s(this.currentUser))};const i=()=>{const l=o;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),i()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ma)}},0),i()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(bn(typeof r.accessToken=="string"),new lP(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return bn(e===null||typeof e=="string"),new Mn(e)}}class J5{constructor(e,n,r){this.h=e,this.l=n,this.m=r,this.type="FirstParty",this.user=Mn.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Z5{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new J5(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(Mn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class e8{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class t8{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,n){const r=o=>{o.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const i=o.token!==this.T;return this.T=o.token,Ie("FirebaseAppCheckTokenProvider",`Received ${i?"new":"existing"} token.`),i?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const s=o=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.I.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.I.getImmediate({optional:!0});o?s(o):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(bn(typeof n.token=="string"),this.T=n.token,new e8(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n8(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=n8(40);for(let o=0;o<s.length;++o)r.length<20&&s[o]<n&&(r+=e.charAt(s[o]%e.length))}return r}}function dt(t,e){return t<e?-1:t>e?1:0}function _c(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Re(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Re(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new Re(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return yn.fromMillis(Date.now())}static fromDate(e){return yn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new yn(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?dt(this.nanoseconds,e.nanoseconds):dt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Tt(e)}static min(){return new Tt(new yn(0,0))}static max(){return new Tt(new yn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ve(),r===void 0?r=e.length-n:r>e.length-n&&Ve(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return od.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof od?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const o=e.get(s),i=n.get(s);if(o<i)return-1;if(o>i)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Pt extends od{construct(e,n,r){return new Pt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Re(oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Pt(n)}static emptyPath(){return new Pt([])}}const r8=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Wn extends od{construct(e,n,r){return new Wn(e,n,r)}static isValidIdentifier(e){return r8.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Wn(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const o=()=>{if(r.length===0)throw new Re(oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let i=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Re(oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new Re(oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(i=!i,s++):a!=="."||i?(r+=a,s++):(o(),s++)}if(o(),i)throw new Re(oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Wn(n)}static emptyPath(){return new Wn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.path=e}static fromPath(e){return new Pe(Pt.fromString(e))}static fromName(e){return new Pe(Pt.fromString(e).popFirst(5))}static empty(){return new Pe(Pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Pt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pe(new Pt(e.slice()))}}function s8(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Tt.fromTimestamp(r===1e9?new yn(n+1,0):new yn(n,r));return new Vi(s,Pe.empty(),e)}function o8(t){return new Vi(t.readTime,t.key,-1)}class Vi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Vi(Tt.min(),Pe.empty(),-1)}static max(){return new Vi(Tt.max(),Pe.empty(),-1)}}function i8(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Pe.comparator(t.documentKey,e.documentKey),n!==0?n:dt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a8="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class l8{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uP(t){if(t.code!==oe.FAILED_PRECONDITION||t.message!==a8)throw t;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ve(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new se((r,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,s)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof se?n:se.resolve(n)}catch(n){return se.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):se.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):se.reject(n)}static resolve(e){return new se((n,r)=>{n(e)})}static reject(e){return new se((n,r)=>{r(e)})}static waitFor(e){return new se((n,r)=>{let s=0,o=0,i=!1;e.forEach(a=>{++s,a.next(()=>{++o,i&&o===s&&n()},l=>r(l))}),i=!0,o===s&&n()})}static or(e){let n=se.resolve(!1);for(const r of e)n=n.next(s=>s?se.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,o)=>{r.push(n.call(this,s,o))}),this.waitFor(r)}static mapArray(e,n){return new se((r,s)=>{const o=e.length,i=new Array(o);let a=0;for(let l=0;l<o;l++){const c=l;n(e[c]).next(u=>{i[c]=u,++a,a===o&&r(i)},u=>s(u))}})}static doWhile(e,n){return new se((r,s)=>{const o=()=>{e()===!0?n().next(()=>{o()},s):r()};o()})}}function fv(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>n.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}hP.ct=-1;function fS(t){return t==null}function Pg(t){return t===0&&1/t==-1/0}function c8(t){return typeof t=="number"&&Number.isInteger(t)&&!Pg(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function af(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function dP(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,n){this.comparator=e,this.root=n||kn.EMPTY}insert(e,n){return new Sr(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,kn.BLACK,null,null))}remove(e){return new Sr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,kn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new im(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new im(this.root,e,this.comparator,!1)}getReverseIterator(){return new im(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new im(this.root,e,this.comparator,!0)}}class im{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class kn{constructor(e,n,r,s,o){this.key=e,this.value=n,this.color=r??kn.RED,this.left=s??kn.EMPTY,this.right=o??kn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,o){return new kn(e??this.key,n??this.value,r??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const o=r(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,n,r),null):o===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return kn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return kn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,kn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,kn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ve();const e=this.left.check();if(e!==this.right.check())throw Ve();return e+(this.isRed()?0:1)}}kn.EMPTY=null,kn.RED=!0,kn.BLACK=!1;kn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ve()}get value(){throw Ve()}get color(){throw Ve()}get left(){throw Ve()}get right(){throw Ve()}copy(t,e,n,r,s){return this}insert(t,e,n){return new kn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this.comparator=e,this.data=new Sr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xT(this.data.getIterator())}getIteratorFrom(e){return new xT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof or)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,o=r.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new or(this.comparator);return n.data=e,n}}class xT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.fields=e,e.sort(Wn.comparator)}static empty(){return new Ss([])}unionWith(e){let n=new or(Wn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ss(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return _c(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new u8("Invalid base64 string: "+s):s}}(e);return new Lo(n)}static fromUint8Array(e){const n=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(e);return new Lo(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return dt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Lo.EMPTY_BYTE_STRING=new Lo("");const h8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Za(t){if(bn(!!t),typeof t=="string"){let e=0;const n=h8.exec(t);if(bn(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$n(t.seconds),nanos:$n(t.nanos)}}function $n(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function id(t){return typeof t=="string"?Lo.fromBase64String(t):Lo.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d8(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Fg(t){const e=Za(t.mapValue.fields.__local_write_time__.timestampValue);return new yn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f8{constructor(e,n,r,s,o,i,a,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=o,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class Lg{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Lg("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Lg&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const am={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ac(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?d8(t)?4:p8(t)?9007199254740991:10:Ve()}function lo(t,e){if(t===e)return!0;const n=Ac(t);if(n!==Ac(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Fg(t).isEqual(Fg(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const o=Za(r.timestampValue),i=Za(s.timestampValue);return o.seconds===i.seconds&&o.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return id(r.bytesValue).isEqual(id(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return $n(r.geoPointValue.latitude)===$n(s.geoPointValue.latitude)&&$n(r.geoPointValue.longitude)===$n(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return $n(r.integerValue)===$n(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const o=$n(r.doubleValue),i=$n(s.doubleValue);return o===i?Pg(o)===Pg(i):isNaN(o)&&isNaN(i)}return!1}(t,e);case 9:return _c(t.arrayValue.values||[],e.arrayValue.values||[],lo);case 10:return function(r,s){const o=r.mapValue.fields||{},i=s.mapValue.fields||{};if(vT(o)!==vT(i))return!1;for(const a in o)if(o.hasOwnProperty(a)&&(i[a]===void 0||!lo(o[a],i[a])))return!1;return!0}(t,e);default:return Ve()}}function ad(t,e){return(t.values||[]).find(n=>lo(n,e))!==void 0}function Dc(t,e){if(t===e)return 0;const n=Ac(t),r=Ac(e);if(n!==r)return dt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return dt(t.booleanValue,e.booleanValue);case 2:return function(s,o){const i=$n(s.integerValue||s.doubleValue),a=$n(o.integerValue||o.doubleValue);return i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1}(t,e);case 3:return bT(t.timestampValue,e.timestampValue);case 4:return bT(Fg(t),Fg(e));case 5:return dt(t.stringValue,e.stringValue);case 6:return function(s,o){const i=id(s),a=id(o);return i.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const i=s.split("/"),a=o.split("/");for(let l=0;l<i.length&&l<a.length;l++){const c=dt(i[l],a[l]);if(c!==0)return c}return dt(i.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const i=dt($n(s.latitude),$n(o.latitude));return i!==0?i:dt($n(s.longitude),$n(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){const i=s.values||[],a=o.values||[];for(let l=0;l<i.length&&l<a.length;++l){const c=Dc(i[l],a[l]);if(c)return c}return dt(i.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===am.mapValue&&o===am.mapValue)return 0;if(s===am.mapValue)return 1;if(o===am.mapValue)return-1;const i=s.fields||{},a=Object.keys(i),l=o.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let u=0;u<a.length&&u<c.length;++u){const h=dt(a[u],c[u]);if(h!==0)return h;const d=Dc(i[a[u]],l[c[u]]);if(d!==0)return d}return dt(a.length,c.length)}(t.mapValue,e.mapValue);default:throw Ve()}}function bT(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return dt(t,e);const n=Za(t),r=Za(e),s=dt(n.seconds,r.seconds);return s!==0?s:dt(n.nanos,r.nanos)}function Oc(t){return J1(t)}function J1(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=Za(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?id(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Pe.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",o=!0;for(const i of r.values||[])o?o=!1:s+=",",s+=J1(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let o="{",i=!0;for(const a of s)i?i=!1:o+=",",o+=`${a}:${J1(r.fields[a])}`;return o+"}"}(t.mapValue):Ve();var e,n}function Z1(t){return!!t&&"integerValue"in t}function pS(t){return!!t&&"arrayValue"in t}function Um(t){return!!t&&"mapValue"in t}function $h(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return af(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=$h(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=$h(t.arrayValue.values[n]);return e}return Object.assign({},t)}function p8(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e){this.value=e}static empty(){return new Is({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Um(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=$h(n)}setAll(e){let n=Wn.emptyPath(),r={},s=[];e.forEach((i,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=a.popLast()}i?r[a.lastSegment()]=$h(i):s.push(a.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,s)}delete(e){const n=this.field(e.popLast());Um(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return lo(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Um(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){af(n,(s,o)=>e[s]=o);for(const s of r)delete e[s]}clone(){return new Is($h(this.value))}}function fP(t){const e=[];return af(t.fields,(n,r)=>{const s=new Wn([n]);if(Um(r)){const o=fP(r.mapValue).fields;if(o.length===0)e.push(s);else for(const i of o)e.push(s.child(i))}else e.push(s)}),new Ss(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n,r,s,o,i,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=o,this.data=i,this.documentState=a}static newInvalidDocument(e){return new bs(e,0,Tt.min(),Tt.min(),Tt.min(),Is.empty(),0)}static newFoundDocument(e,n,r,s){return new bs(e,1,n,Tt.min(),r,s,0)}static newNoDocument(e,n){return new bs(e,2,n,Tt.min(),Tt.min(),Is.empty(),0)}static newUnknownDocument(e,n){return new bs(e,3,n,Tt.min(),Tt.min(),Is.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Tt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Is.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Is.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Tt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{constructor(e,n){this.position=e,this.inclusive=n}}function wT(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const o=e[s],i=t.position[s];if(o.field.isKeyField()?r=Pe.comparator(Pe.fromName(i.referenceValue),n.key):r=Dc(i,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function CT(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!lo(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,n="asc"){this.field=e,this.dir=n}}function m8(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{}class pn extends pP{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new y8(e,n,r):n==="array-contains"?new b8(e,r):n==="in"?new w8(e,r):n==="not-in"?new C8(e,r):n==="array-contains-any"?new I8(e,r):new pn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new v8(e,r):new x8(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Dc(n,this.value)):n!==null&&Ac(this.value)===Ac(n)&&this.matchesComparison(Dc(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ve()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Wi extends pP{constructor(e,n){super(),this.filters=e,this.op=n,this.ht=null}static create(e,n){return new Wi(e,n)}matches(e){return mP(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ht!==null||(this.ht=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.lt(n=>n.isInequality());return e!==null?e.field:null}lt(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function mP(t){return t.op==="and"}function gP(t){return g8(t)&&mP(t)}function g8(t){for(const e of t.filters)if(e instanceof Wi)return!1;return!0}function ew(t){if(t instanceof pn)return t.field.canonicalString()+t.op.toString()+Oc(t.value);if(gP(t))return t.filters.map(e=>ew(e)).join(",");{const e=t.filters.map(n=>ew(n)).join(",");return`${t.op}(${e})`}}function yP(t,e){return t instanceof pn?function(n,r){return r instanceof pn&&n.op===r.op&&n.field.isEqual(r.field)&&lo(n.value,r.value)}(t,e):t instanceof Wi?function(n,r){return r instanceof Wi&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,o,i)=>s&&yP(o,r.filters[i]),!0):!1}(t,e):void Ve()}function vP(t){return t instanceof pn?function(e){return`${e.field.canonicalString()} ${e.op} ${Oc(e.value)}`}(t):t instanceof Wi?function(e){return e.op.toString()+" {"+e.getFilters().map(vP).join(" ,")+"}"}(t):"Filter"}class y8 extends pn{constructor(e,n,r){super(e,n,r),this.key=Pe.fromName(r.referenceValue)}matches(e){const n=Pe.comparator(e.key,this.key);return this.matchesComparison(n)}}class v8 extends pn{constructor(e,n){super(e,"in",n),this.keys=xP("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class x8 extends pn{constructor(e,n){super(e,"not-in",n),this.keys=xP("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function xP(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Pe.fromName(r.referenceValue))}class b8 extends pn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return pS(n)&&ad(n.arrayValue,this.value)}}class w8 extends pn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ad(this.value.arrayValue,n)}}class C8 extends pn{constructor(e,n){super(e,"not-in",n)}matches(e){if(ad(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!ad(this.value.arrayValue,n)}}class I8 extends pn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!pS(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ad(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S8{constructor(e,n=null,r=[],s=[],o=null,i=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=o,this.startAt=i,this.endAt=a,this.ft=null}}function IT(t,e=null,n=[],r=[],s=null,o=null,i=null){return new S8(t,e,n,r,s,o,i)}function mS(t){const e=Ct(t);if(e.ft===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ew(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),fS(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Oc(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Oc(r)).join(",")),e.ft=n}return e.ft}function gS(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!m8(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!yP(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!CT(t.startAt,e.startAt)&&CT(t.endAt,e.endAt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pv{constructor(e,n=null,r=[],s=[],o=null,i="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=o,this.limitType=i,this.startAt=a,this.endAt=l,this.dt=null,this.wt=null,this.startAt,this.endAt}}function k8(t,e,n,r,s,o,i,a){return new pv(t,e,n,r,s,o,i,a)}function $8(t){return new pv(t)}function ST(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function E8(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function N8(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function T8(t){return t.collectionGroup!==null}function dc(t){const e=Ct(t);if(e.dt===null){e.dt=[];const n=N8(e),r=E8(e);if(n!==null&&r===null)n.isKeyField()||e.dt.push(new Eh(n)),e.dt.push(new Eh(Wn.keyField(),"asc"));else{let s=!1;for(const o of e.explicitOrderBy)e.dt.push(o),o.field.isKeyField()&&(s=!0);if(!s){const o=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.dt.push(new Eh(Wn.keyField(),o))}}}return e.dt}function Pc(t){const e=Ct(t);if(!e.wt)if(e.limitType==="F")e.wt=IT(e.path,e.collectionGroup,dc(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const o of dc(e)){const i=o.dir==="desc"?"asc":"desc";n.push(new Eh(o.field,i))}const r=e.endAt?new Mg(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Mg(e.startAt.position,e.startAt.inclusive):null;e.wt=IT(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e.wt}function tw(t,e,n){return new pv(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bP(t,e){return gS(Pc(t),Pc(e))&&t.limitType===e.limitType}function wP(t){return`${mS(Pc(t))}|lt:${t.limitType}`}function kT(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>vP(r)).join(", ")}]`),fS(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Oc(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Oc(r)).join(",")),`Target(${n})`}(Pc(t))}; limitType=${t.limitType})`}function yS(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Pe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of dc(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,o,i){const a=wT(s,o,i);return s.inclusive?a<=0:a<0}(n.startAt,dc(n),r)||n.endAt&&!function(s,o,i){const a=wT(s,o,i);return s.inclusive?a>=0:a>0}(n.endAt,dc(n),r))}(t,e)}function R8(t){return(e,n)=>{let r=!1;for(const s of dc(t)){const o=_8(s,e,n);if(o!==0)return o;r=r||s.field.isKeyField()}return 0}}function _8(t,e,n){const r=t.field.isKeyField()?Pe.comparator(e.key,n.key):function(s,o,i){const a=o.data.field(s),l=i.data.field(s);return a!==null&&l!==null?Dc(a,l):Ve()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,o]of r)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){af(this.inner,(n,r)=>{for(const[s,o]of r)e(s,o)})}isEmpty(){return dP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A8=new Sr(Pe.comparator);function zg(){return A8}const CP=new Sr(Pe.comparator);function lm(...t){let e=CP;for(const n of t)e=e.insert(n.key,n);return e}function IP(t){let e=CP;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ra(){return Nh()}function SP(){return Nh()}function Nh(){return new du(t=>t.toString(),(t,e)=>t.isEqual(e))}const D8=new Sr(Pe.comparator),O8=new or(Pe.comparator);function Un(...t){let e=O8;for(const n of t)e=e.add(n);return e}const P8=new or(dt);function F8(){return P8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kP(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pg(e)?"-0":e}}function $P(t){return{integerValue:""+t}}function L8(t,e){return c8(e)?$P(e):kP(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mv{constructor(){this._=void 0}}function M8(t,e,n){return t instanceof Bg?function(r,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ld?NP(t,e):t instanceof cd?TP(t,e):function(r,s){const o=EP(r,s),i=$T(o)+$T(r._t);return Z1(o)&&Z1(r._t)?$P(i):kP(r.serializer,i)}(t,e)}function z8(t,e,n){return t instanceof ld?NP(t,e):t instanceof cd?TP(t,e):n}function EP(t,e){return t instanceof Ug?Z1(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class Bg extends mv{}class ld extends mv{constructor(e){super(),this.elements=e}}function NP(t,e){const n=RP(e);for(const r of t.elements)n.some(s=>lo(s,r))||n.push(r);return{arrayValue:{values:n}}}class cd extends mv{constructor(e){super(),this.elements=e}}function TP(t,e){let n=RP(e);for(const r of t.elements)n=n.filter(s=>!lo(s,r));return{arrayValue:{values:n}}}class Ug extends mv{constructor(e,n){super(),this.serializer=e,this._t=n}}function $T(t){return $n(t.integerValue||t.doubleValue)}function RP(t){return pS(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function B8(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof ld&&r instanceof ld||n instanceof cd&&r instanceof cd?_c(n.elements,r.elements,lo):n instanceof Ug&&r instanceof Ug?lo(n._t,r._t):n instanceof Bg&&r instanceof Bg}(t.transform,e.transform)}class U8{constructor(e,n){this.version=e,this.transformResults=n}}class No{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new No}static exists(e){return new No(void 0,e)}static updateTime(e){return new No(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Vm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class gv{}function _P(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new DP(t.key,No.none()):new lf(t.key,t.data,No.none());{const n=t.data,r=Is.empty();let s=new or(Wn.comparator);for(let o of e.fields)if(!s.has(o)){let i=n.field(o);i===null&&o.length>1&&(o=o.popLast(),i=n.field(o)),i===null?r.delete(o):r.set(o,i),s=s.add(o)}return new xl(t.key,r,new Ss(s.toArray()),No.none())}}function V8(t,e,n){t instanceof lf?function(r,s,o){const i=r.value.clone(),a=NT(r.fieldTransforms,s,o.transformResults);i.setAll(a),s.convertToFoundDocument(o.version,i).setHasCommittedMutations()}(t,e,n):t instanceof xl?function(r,s,o){if(!Vm(r.precondition,s))return void s.convertToUnknownDocument(o.version);const i=NT(r.fieldTransforms,s,o.transformResults),a=s.data;a.setAll(AP(r)),a.setAll(i),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Th(t,e,n,r){return t instanceof lf?function(s,o,i,a){if(!Vm(s.precondition,o))return i;const l=s.value.clone(),c=TT(s.fieldTransforms,a,o);return l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof xl?function(s,o,i,a){if(!Vm(s.precondition,o))return i;const l=TT(s.fieldTransforms,a,o),c=o.data;return c.setAll(AP(s)),c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),i===null?null:i.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(s,o,i){return Vm(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):i}(t,e,n)}function W8(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),o=EP(r.transform,s||null);o!=null&&(n===null&&(n=Is.empty()),n.set(r.field,o))}return n||null}function ET(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&_c(n,r,(s,o)=>B8(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class lf extends gv{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class xl extends gv{constructor(e,n,r,s,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function AP(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function NT(t,e,n){const r=new Map;bn(t.length===n.length);for(let s=0;s<n.length;s++){const o=t[s],i=o.transform,a=e.data.field(o.field);r.set(o.field,z8(i,a,n[s]))}return r}function TT(t,e,n){const r=new Map;for(const s of t){const o=s.transform,i=n.data.field(s.field);r.set(s.field,M8(o,i,e))}return r}class DP extends gv{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class j8 extends gv{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G8{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&V8(o,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Th(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Th(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=SP();return this.mutations.forEach(s=>{const o=e.get(s.key),i=o.overlayedDocument;let a=this.applyToLocalView(i,o.mutatedFields);a=n.has(s.key)?null:a;const l=_P(i,a);l!==null&&r.set(s.key,l),i.isValidDocument()||i.convertToNoDocument(Tt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Un())}isEqual(e){return this.batchId===e.batchId&&_c(this.mutations,e.mutations,(n,r)=>ET(n,r))&&_c(this.baseMutations,e.baseMutations,(n,r)=>ET(n,r))}}class vS{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){bn(e.mutations.length===r.length);let s=D8;const o=e.mutations;for(let i=0;i<o.length;i++)s=s.insert(o[i].key,r[i].version);return new vS(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt,He;function K8(t){switch(t){default:return Ve();case oe.CANCELLED:case oe.UNKNOWN:case oe.DEADLINE_EXCEEDED:case oe.RESOURCE_EXHAUSTED:case oe.INTERNAL:case oe.UNAVAILABLE:case oe.UNAUTHENTICATED:return!1;case oe.INVALID_ARGUMENT:case oe.NOT_FOUND:case oe.ALREADY_EXISTS:case oe.PERMISSION_DENIED:case oe.FAILED_PRECONDITION:case oe.ABORTED:case oe.OUT_OF_RANGE:case oe.UNIMPLEMENTED:case oe.DATA_LOSS:return!0}}function q8(t){if(t===void 0)return Ja("GRPC error has no .code"),oe.UNKNOWN;switch(t){case Kt.OK:return oe.OK;case Kt.CANCELLED:return oe.CANCELLED;case Kt.UNKNOWN:return oe.UNKNOWN;case Kt.DEADLINE_EXCEEDED:return oe.DEADLINE_EXCEEDED;case Kt.RESOURCE_EXHAUSTED:return oe.RESOURCE_EXHAUSTED;case Kt.INTERNAL:return oe.INTERNAL;case Kt.UNAVAILABLE:return oe.UNAVAILABLE;case Kt.UNAUTHENTICATED:return oe.UNAUTHENTICATED;case Kt.INVALID_ARGUMENT:return oe.INVALID_ARGUMENT;case Kt.NOT_FOUND:return oe.NOT_FOUND;case Kt.ALREADY_EXISTS:return oe.ALREADY_EXISTS;case Kt.PERMISSION_DENIED:return oe.PERMISSION_DENIED;case Kt.FAILED_PRECONDITION:return oe.FAILED_PRECONDITION;case Kt.ABORTED:return oe.ABORTED;case Kt.OUT_OF_RANGE:return oe.OUT_OF_RANGE;case Kt.UNIMPLEMENTED:return oe.UNIMPLEMENTED;case Kt.DATA_LOSS:return oe.DATA_LOSS;default:return Ve()}}(He=Kt||(Kt={}))[He.OK=0]="OK",He[He.CANCELLED=1]="CANCELLED",He[He.UNKNOWN=2]="UNKNOWN",He[He.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",He[He.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",He[He.NOT_FOUND=5]="NOT_FOUND",He[He.ALREADY_EXISTS=6]="ALREADY_EXISTS",He[He.PERMISSION_DENIED=7]="PERMISSION_DENIED",He[He.UNAUTHENTICATED=16]="UNAUTHENTICATED",He[He.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",He[He.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",He[He.ABORTED=10]="ABORTED",He[He.OUT_OF_RANGE=11]="OUT_OF_RANGE",He[He.UNIMPLEMENTED=12]="UNIMPLEMENTED",He[He.INTERNAL=13]="INTERNAL",He[He.UNAVAILABLE=14]="UNAVAILABLE",He[He.DATA_LOSS=15]="DATA_LOSS";class X8{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function nw(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Y8(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Q8(t,e){return nw(t,e.toTimestamp())}function fc(t){return bn(!!t),Tt.fromTimestamp(function(e){const n=Za(e);return new yn(n.seconds,n.nanos)}(t))}function OP(t,e){return function(n){return new Pt(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function J8(t){const e=Pt.fromString(t);return bn(iK(e)),e}function rw(t,e){return OP(t.databaseId,e.path)}function Z8(t){const e=J8(t);return e.length===4?Pt.emptyPath():tK(e)}function eK(t){return new Pt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function tK(t){return bn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function RT(t,e,n){return{name:rw(t,e),fields:n.value.mapValue.fields}}function nK(t,e){let n;if(e instanceof lf)n={update:RT(t,e.key,e.value)};else if(e instanceof DP)n={delete:rw(t,e.key)};else if(e instanceof xl)n={update:RT(t,e.key,e.data),updateMask:oK(e.fieldMask)};else{if(!(e instanceof j8))return Ve();n={verify:rw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const i=o.transform;if(i instanceof Bg)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(i instanceof ld)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:i.elements}};if(i instanceof cd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:i.elements}};if(i instanceof Ug)return{fieldPath:o.field.canonicalString(),increment:i._t};throw Ve()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:Q8(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ve()}(t,e.precondition)),n}function rK(t,e){return t&&t.length>0?(bn(e!==void 0),t.map(n=>function(r,s){let o=r.updateTime?fc(r.updateTime):fc(s);return o.isEqual(Tt.min())&&(o=fc(s)),new U8(o,r.transformResults||[])}(n,e))):[]}function sK(t){let e=Z8(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){bn(r===1);const u=n.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let o=[];n.where&&(o=function(u){const h=PP(u);return h instanceof Wi&&gP(h)?h.getFilters():[h]}(n.where));let i=[];n.orderBy&&(i=n.orderBy.map(u=>function(h){return new Eh(Ll(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,fS(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(u){const h=!!u.before,d=u.values||[];return new Mg(d,h)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const h=!u.before,d=u.values||[];return new Mg(d,h)}(n.endAt)),k8(e,s,i,o,a,"F",l,c)}function PP(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=Ll(e.unaryFilter.field);return pn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=Ll(e.unaryFilter.field);return pn.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ll(e.unaryFilter.field);return pn.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ll(e.unaryFilter.field);return pn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ve()}}(t):t.fieldFilter!==void 0?function(e){return pn.create(Ll(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ve()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return Wi.create(e.compositeFilter.filters.map(n=>PP(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return Ve()}}(e.compositeFilter.op))}(t):Ve()}function Ll(t){return Wn.fromServerFormat(t.fieldPath)}function oK(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function iK(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aK{constructor(e){this.se=e}}function lK(t){const e=sK({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?tw(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cK{constructor(){this.He=new uK}addToCollectionParentIndex(e,n){return this.He.add(n),se.resolve()}getCollectionParents(e,n){return se.resolve(this.He.getEntries(n))}addFieldIndex(e,n){return se.resolve()}deleteFieldIndex(e,n){return se.resolve()}getDocumentsMatchingTarget(e,n){return se.resolve(null)}getIndexType(e,n){return se.resolve(0)}getFieldIndexes(e,n){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,n){return se.resolve(Vi.min())}getMinOffsetFromCollectionGroup(e,n){return se.resolve(Vi.min())}updateCollectionGroup(e,n,r){return se.resolve()}updateIndexEntries(e,n){return se.resolve()}}class uK{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new or(Pt.comparator),o=!s.has(r);return this.index[n]=s.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new or(Pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e){this.Rn=e}next(){return this.Rn+=2,this.Rn}static vn(){return new Fc(0)}static bn(){return new Fc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hK{constructor(){this.changes=new du(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,bs.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?se.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dK{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fK{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Th(r.mutation,s,Ss.empty(),yn.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Un()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Un()){const s=Ra();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(o=>{let i=lm();return o.forEach((a,l)=>{i=i.insert(a,l.overlayedDocument)}),i}))}getOverlayedDocuments(e,n){const r=Ra();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Un()))}populateOverlays(e,n,r){const s=[];return r.forEach(o=>{n.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((i,a)=>{n.set(i,a)})})}computeViews(e,n,r,s){let o=zg();const i=Nh(),a=Nh();return n.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof xl)?o=o.insert(c.key,c):u!==void 0?(i.set(c.key,u.mutation.getFieldMask()),Th(u.mutation,c,u.mutation.getFieldMask(),yn.now())):i.set(c.key,Ss.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,u)=>i.set(c,u)),n.forEach((c,u)=>{var h;return a.set(c,new dK(u,(h=i.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Nh();let s=new Sr((i,a)=>i-a),o=Un();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(i=>{for(const a of i)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||Ss.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(s.get(a.batchId)||Un()).add(l);s=s.insert(a.batchId,h)})}).next(()=>{const i=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=SP();u.forEach(d=>{if(!o.has(d)){const f=_P(n.get(d),r.get(d));f!==null&&h.set(d,f),o=o.add(d)}}),i.push(this.documentOverlayCache.saveOverlays(e,c,h))}return se.waitFor(i)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return Pe.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):T8(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(o=>{const i=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-o.size):se.resolve(Ra());let a=-1,l=o;return i.next(c=>se.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),o.get(u)?se.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,Un())).next(u=>({batchId:a,changes:IP(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Pe(n)).next(r=>{let s=lm();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let o=lm();return this.indexManager.getCollectionParents(e,s).next(i=>se.forEach(i,a=>{const l=function(c,u){return new pv(u,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(c=>{c.forEach((u,h)=>{o=o.insert(u,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s))).next(o=>{s.forEach((a,l)=>{const c=l.getKey();o.get(c)===null&&(o=o.insert(c,bs.newInvalidDocument(c)))});let i=lm();return o.forEach((a,l)=>{const c=s.get(a);c!==void 0&&Th(c.mutation,l,Ss.empty(),yn.now()),yS(n,l)&&(i=i.insert(a,l))}),i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pK{constructor(e){this.serializer=e,this.Zn=new Map,this.Xn=new Map}getBundleMetadata(e,n){return se.resolve(this.Zn.get(n))}saveBundleMetadata(e,n){var r;return this.Zn.set(n.id,{id:(r=n).id,version:r.version,createTime:fc(r.createTime)}),se.resolve()}getNamedQuery(e,n){return se.resolve(this.Xn.get(n))}saveNamedQuery(e,n){return this.Xn.set(n.name,function(r){return{name:r.name,query:lK(r.bundledQuery),readTime:fc(r.readTime)}}(n)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mK{constructor(){this.overlays=new Sr(Pe.comparator),this.ts=new Map}getOverlay(e,n){return se.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ra();return se.forEach(n,s=>this.getOverlay(e,s).next(o=>{o!==null&&r.set(s,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,o)=>{this.re(e,n,o)}),se.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.ts.get(r);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.ts.delete(r)),se.resolve()}getOverlaysForCollection(e,n,r){const s=Ra(),o=n.length+1,i=new Pe(n.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>r&&s.set(l.getKey(),l)}return se.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let o=new Sr((c,u)=>c-u);const i=this.overlays.getIterator();for(;i.hasNext();){const c=i.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=o.get(c.largestBatchId);u===null&&(u=Ra(),o=o.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=Ra(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return se.resolve(a)}re(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const i=this.ts.get(s.largestBatchId).delete(r.key);this.ts.set(s.largestBatchId,i)}this.overlays=this.overlays.insert(r.key,new H8(n,r));let o=this.ts.get(n);o===void 0&&(o=Un(),this.ts.set(n,o)),this.ts.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(){this.es=new or(dn.ns),this.ss=new or(dn.rs)}isEmpty(){return this.es.isEmpty()}addReference(e,n){const r=new dn(e,n);this.es=this.es.add(r),this.ss=this.ss.add(r)}os(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.us(new dn(e,n))}cs(e,n){e.forEach(r=>this.removeReference(r,n))}hs(e){const n=new Pe(new Pt([])),r=new dn(n,e),s=new dn(n,e+1),o=[];return this.ss.forEachInRange([r,s],i=>{this.us(i),o.push(i.key)}),o}ls(){this.es.forEach(e=>this.us(e))}us(e){this.es=this.es.delete(e),this.ss=this.ss.delete(e)}fs(e){const n=new Pe(new Pt([])),r=new dn(n,e),s=new dn(n,e+1);let o=Un();return this.ss.forEachInRange([r,s],i=>{o=o.add(i.key)}),o}containsKey(e){const n=new dn(e,0),r=this.es.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class dn{constructor(e,n){this.key=e,this.ds=n}static ns(e,n){return Pe.comparator(e.key,n.key)||dt(e.ds,n.ds)}static rs(e,n){return dt(e.ds,n.ds)||Pe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gK{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this._s=new or(dn.ns)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const o=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new G8(o,n,r,s);this.mutationQueue.push(i);for(const a of s)this._s=this._s.add(new dn(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return se.resolve(i)}lookupMutationBatch(e,n){return se.resolve(this.gs(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ys(r),o=s<0?0:s;return se.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?-1:this.ws-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new dn(n,0),s=new dn(n,Number.POSITIVE_INFINITY),o=[];return this._s.forEachInRange([r,s],i=>{const a=this.gs(i.ds);o.push(a)}),se.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new or(dt);return n.forEach(s=>{const o=new dn(s,0),i=new dn(s,Number.POSITIVE_INFINITY);this._s.forEachInRange([o,i],a=>{r=r.add(a.ds)})}),se.resolve(this.ps(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let o=r;Pe.isDocumentKey(o)||(o=o.child(""));const i=new dn(new Pe(o),0);let a=new or(dt);return this._s.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.ds)),!0)},i),se.resolve(this.ps(a))}ps(e){const n=[];return e.forEach(r=>{const s=this.gs(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){bn(this.Is(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this._s;return se.forEach(n.mutations,s=>{const o=new dn(s.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this._s=r})}En(e){}containsKey(e,n){const r=new dn(n,0),s=this._s.firstAfterOrEqual(r);return se.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}Is(e,n){return this.ys(e)}ys(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}gs(e){const n=this.ys(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yK{constructor(e){this.Ts=e,this.docs=new Sr(Pe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),o=s?s.size:0,i=this.Ts(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:i}),this.size+=i-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return se.resolve(r?r.document.mutableCopy():bs.newInvalidDocument(n))}getEntries(e,n){let r=zg();return n.forEach(s=>{const o=this.docs.get(s);r=r.insert(s,o?o.document.mutableCopy():bs.newInvalidDocument(s))}),se.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let o=zg();const i=n.path,a=new Pe(i.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!i.isPrefixOf(c.path))break;c.path.length>i.length+1||i8(o8(u),r)<=0||(s.has(u.key)||yS(n,u))&&(o=o.insert(u.key,u.mutableCopy()))}return se.resolve(o)}getAllFromCollectionGroup(e,n,r,s){Ve()}Es(e,n){return se.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new vK(this)}getSize(e){return se.resolve(this.size)}}class vK extends hK{constructor(e){super(),this.Jn=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Jn.addEntry(e,s)):this.Jn.removeEntry(r)}),se.waitFor(n)}getFromCache(e,n){return this.Jn.getEntry(e,n)}getAllFromCache(e,n){return this.Jn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xK{constructor(e){this.persistence=e,this.As=new du(n=>mS(n),gS),this.lastRemoteSnapshotVersion=Tt.min(),this.highestTargetId=0,this.Rs=0,this.vs=new xS,this.targetCount=0,this.bs=Fc.vn()}forEachTarget(e,n){return this.As.forEach((r,s)=>n(s)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.Rs)}allocateTargetId(e){return this.highestTargetId=this.bs.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Rs&&(this.Rs=n),se.resolve()}Sn(e){this.As.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.bs=new Fc(n),this.highestTargetId=n),e.sequenceNumber>this.Rs&&(this.Rs=e.sequenceNumber)}addTargetData(e,n){return this.Sn(n),this.targetCount+=1,se.resolve()}updateTargetData(e,n){return this.Sn(n),se.resolve()}removeTargetData(e,n){return this.As.delete(n.target),this.vs.hs(n.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,n,r){let s=0;const o=[];return this.As.forEach((i,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.As.delete(i),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),se.waitFor(o).next(()=>s)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,n){const r=this.As.get(n)||null;return se.resolve(r)}addMatchingKeys(e,n,r){return this.vs.os(n,r),se.resolve()}removeMatchingKeys(e,n,r){this.vs.cs(n,r);const s=this.persistence.referenceDelegate,o=[];return s&&n.forEach(i=>{o.push(s.markPotentiallyOrphaned(e,i))}),se.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.vs.hs(n),se.resolve()}getMatchingKeysForTargetId(e,n){const r=this.vs.fs(n);return se.resolve(r)}containsKey(e,n){return se.resolve(this.vs.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bK{constructor(e,n){this.Ps={},this.overlays={},this.Vs=new hP(0),this.Ss=!1,this.Ss=!0,this.referenceDelegate=e(this),this.Ds=new xK(this),this.indexManager=new cK,this.remoteDocumentCache=function(r){return new yK(r)}(r=>this.referenceDelegate.Cs(r)),this.serializer=new aK(n),this.xs=new pK(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ss=!1,Promise.resolve()}get started(){return this.Ss}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new mK,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Ps[e.toKey()];return r||(r=new gK(n,this.referenceDelegate),this.Ps[e.toKey()]=r),r}getTargetCache(){return this.Ds}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.xs}runTransaction(e,n,r){Ie("MemoryPersistence","Starting transaction:",e);const s=new wK(this.Vs.next());return this.referenceDelegate.Ns(),r(s).next(o=>this.referenceDelegate.ks(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Os(e,n){return se.or(Object.values(this.Ps).map(r=>()=>r.containsKey(e,n)))}}class wK extends l8{constructor(e){super(),this.currentSequenceNumber=e}}class bS{constructor(e){this.persistence=e,this.$s=new xS,this.Ms=null}static Fs(e){return new bS(e)}get Bs(){if(this.Ms)return this.Ms;throw Ve()}addReference(e,n,r){return this.$s.addReference(r,n),this.Bs.delete(r.toString()),se.resolve()}removeReference(e,n,r){return this.$s.removeReference(r,n),this.Bs.add(r.toString()),se.resolve()}markPotentiallyOrphaned(e,n){return this.Bs.add(n.toString()),se.resolve()}removeTarget(e,n){this.$s.hs(n.targetId).forEach(s=>this.Bs.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(o=>this.Bs.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}Ns(){this.Ms=new Set}ks(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.Bs,r=>{const s=Pe.fromPath(r);return this.Ls(e,s).next(o=>{o||n.removeEntry(s,Tt.min())})}).next(()=>(this.Ms=null,n.apply(e)))}updateLimboDocument(e,n){return this.Ls(e,n).next(r=>{r?this.Bs.delete(n.toString()):this.Bs.add(n.toString())})}Cs(e){return 0}Ls(e,n){return se.or([()=>se.resolve(this.$s.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Os(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Vi=r,this.Si=s}static Di(e,n){let r=Un(),s=Un();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new wS(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CK{constructor(){this.Ci=!1}initialize(e,n){this.xi=e,this.indexManager=n,this.Ci=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ni(e,n).next(o=>o||this.ki(e,n,s,r)).next(o=>o||this.Oi(e,n))}Ni(e,n){if(ST(n))return se.resolve(null);let r=Pc(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=tw(n,null,"F"),r=Pc(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const i=Un(...o);return this.xi.getDocuments(e,i).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.$i(n,a);return this.Mi(n,c,i,l.readTime)?this.Ni(e,tw(n,null,"F")):this.Fi(e,c,n,l)}))})))}ki(e,n,r,s){return ST(n)||s.isEqual(Tt.min())?this.Oi(e,n):this.xi.getDocuments(e,r).next(o=>{const i=this.$i(n,o);return this.Mi(n,i,r,s)?this.Oi(e,n):(yT()<=Xe.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),kT(n)),this.Fi(e,i,n,s8(s,-1)))})}$i(e,n){let r=new or(R8(e));return n.forEach((s,o)=>{yS(e,o)&&(r=r.add(o))}),r}Mi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Oi(e,n){return yT()<=Xe.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",kT(n)),this.xi.getDocumentsMatchingQuery(e,n,Vi.min())}Fi(e,n,r,s){return this.xi.getDocumentsMatchingQuery(e,r,s).next(o=>(n.forEach(i=>{o=o.insert(i.key,i)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IK{constructor(e,n,r,s){this.persistence=e,this.Bi=n,this.serializer=s,this.Li=new Sr(dt),this.qi=new du(o=>mS(o),gS),this.Ui=new Map,this.Ki=e.getRemoteDocumentCache(),this.Ds=e.getTargetCache(),this.xs=e.getBundleCache(),this.Gi(r)}Gi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fK(this.Ki,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ki.setIndexManager(this.indexManager),this.Bi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Li))}}function SK(t,e,n,r){return new IK(t,e,n,r)}async function FP(t,e){const n=Ct(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(o=>(s=o,n.Gi(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const i=[],a=[];let l=Un();for(const c of s){i.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of o){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({Qi:c,removedBatchIds:i,addedBatchIds:a}))})})}function kK(t,e){const n=Ct(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),o=n.Ki.newChangeBuffer({trackRemovals:!0});return function(i,a,l,c){const u=l.batch,h=u.keys();let d=se.resolve();return h.forEach(f=>{d=d.next(()=>c.getEntry(a,f)).next(p=>{const m=l.docVersions.get(f);bn(m!==null),p.version.compareTo(m)<0&&(u.applyToRemoteDocument(p,l),p.isValidDocument()&&(p.setReadTime(l.commitVersion),c.addEntry(p)))})}),d.next(()=>i.mutationQueue.removeMutationBatch(a,u))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(i){let a=Un();for(let l=0;l<i.mutationResults.length;++l)i.mutationResults[l].transformResults.length>0&&(a=a.add(i.batch.mutations[l].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function $K(t){const e=Ct(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ds.getLastRemoteSnapshotVersion(n))}function EK(t,e){const n=Ct(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}class _T{constructor(){this.activeTargetIds=F8()}tr(e){this.activeTargetIds=this.activeTargetIds.add(e)}er(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Xi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class NK{constructor(){this.Br=new _T,this.Lr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Br.tr(e),this.Lr[e]||"not-current"}updateQueryState(e,n,r){this.Lr[e]=n}removeLocalQueryTarget(e){this.Br.er(e)}isLocalQueryTarget(e){return this.Br.activeTargetIds.has(e)}clearQueryState(e){delete this.Lr[e]}getAllActiveQueryTargets(){return this.Br.activeTargetIds}isActiveQueryTarget(e){return this.Br.activeTargetIds.has(e)}start(){return this.Br=new _T,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TK{qr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(){this.Ur=()=>this.Kr(),this.Gr=()=>this.Qr(),this.zr=[],this.jr()}qr(e){this.zr.push(e)}shutdown(){window.removeEventListener("online",this.Ur),window.removeEventListener("offline",this.Gr)}jr(){window.addEventListener("online",this.Ur),window.addEventListener("offline",this.Gr)}Kr(){Ie("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.zr)e(0)}Qr(){Ie("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.zr)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cm=null;function ob(){return cm===null?cm=268435456+Math.round(2147483648*Math.random()):cm++,"0x"+cm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _K{constructor(e){this.Wr=e.Wr,this.Hr=e.Hr}Jr(e){this.Yr=e}Zr(e){this.Xr=e}onMessage(e){this.eo=e}close(){this.Hr()}send(e){this.Wr(e)}no(){this.Yr()}so(e){this.Xr(e)}io(e){this.eo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln="WebChannelConnection";class AK extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.ro=n+"://"+e.host,this.oo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get uo(){return!1}co(e,n,r,s,o){const i=ob(),a=this.ao(e,n);Ie("RestConnection",`Sending RPC '${e}' ${i}:`,a,r);const l={};return this.ho(l,s,o),this.lo(e,a,l,r).then(c=>(Ie("RestConnection",`Received RPC '${e}' ${i}: `,c),c),c=>{throw Og("RestConnection",`RPC '${e}' ${i} failed with error: `,c,"url: ",a,"request:",r),c})}fo(e,n,r,s,o,i){return this.co(e,n,r,s,o)}ho(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+hu,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,o)=>e[o]=s),r&&r.headers.forEach((s,o)=>e[o]=s)}ao(e,n){const r=RK[e];return`${this.ro}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}lo(e,n,r,s){const o=ob();return new Promise((i,a)=>{const l=new q5;l.setWithCredentials(!0),l.listenOnce(G5.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case sb.NO_ERROR:const u=l.getResponseJson();Ie(Ln,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(u)),i(u);break;case sb.TIMEOUT:Ie(Ln,`RPC '${e}' ${o} timed out`),a(new Re(oe.DEADLINE_EXCEEDED,"Request time out"));break;case sb.HTTP_ERROR:const h=l.getStatus();if(Ie(Ln,`RPC '${e}' ${o} failed with status:`,h,"response text:",l.getResponseText()),h>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const f=d==null?void 0:d.error;if(f&&f.status&&f.message){const p=function(m){const y=m.toLowerCase().replace(/_/g,"-");return Object.values(oe).indexOf(y)>=0?y:oe.UNKNOWN}(f.status);a(new Re(p,f.message))}else a(new Re(oe.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new Re(oe.UNAVAILABLE,"Connection failed."));break;default:Ve()}}finally{Ie(Ln,`RPC '${e}' ${o} completed.`)}});const c=JSON.stringify(s);Ie(Ln,`RPC '${e}' ${o} sending request:`,s),l.send(n,"POST",c,r,15)})}wo(e,n,r){const s=ob(),o=[this.ro,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=W5(),a=j5(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(l.xmlHttpFactory=new K5({})),this.ho(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const c=o.join("");Ie(Ln,`Creating RPC '${e}' stream ${s}: ${c}`,l);const u=i.createWebChannel(c,l);let h=!1,d=!1;const f=new _K({Wr:m=>{d?Ie(Ln,`Not sending because RPC '${e}' stream ${s} is closed:`,m):(h||(Ie(Ln,`Opening RPC '${e}' stream ${s} transport.`),u.open(),h=!0),Ie(Ln,`RPC '${e}' stream ${s} sending:`,m),u.send(m))},Hr:()=>u.close()}),p=(m,y,g)=>{m.listen(y,v=>{try{g(v)}catch(x){setTimeout(()=>{throw x},0)}})};return p(u,om.EventType.OPEN,()=>{d||Ie(Ln,`RPC '${e}' stream ${s} transport opened.`)}),p(u,om.EventType.CLOSE,()=>{d||(d=!0,Ie(Ln,`RPC '${e}' stream ${s} transport closed`),f.so())}),p(u,om.EventType.ERROR,m=>{d||(d=!0,Og(Ln,`RPC '${e}' stream ${s} transport errored:`,m),f.so(new Re(oe.UNAVAILABLE,"The operation could not be completed")))}),p(u,om.EventType.MESSAGE,m=>{var y;if(!d){const g=m.data[0];bn(!!g);const v=g,x=v.error||((y=v[0])===null||y===void 0?void 0:y.error);if(x){Ie(Ln,`RPC '${e}' stream ${s} received error:`,x);const b=x.status;let w=function(I){const S=Kt[I];if(S!==void 0)return q8(S)}(b),C=x.message;w===void 0&&(w=oe.INTERNAL,C="Unknown error status: "+b+" with message "+x.message),d=!0,f.so(new Re(w,C)),u.close()}else Ie(Ln,`RPC '${e}' stream ${s} received:`,g),f.io(g)}}),p(a,H5.STAT_EVENT,m=>{m.stat===mT.PROXY?Ie(Ln,`RPC '${e}' stream ${s} detected buffering proxy`):m.stat===mT.NOPROXY&&Ie(Ln,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{f.no()},0),f}}function ib(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t){return new X8(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e,n,r=1e3,s=1.5,o=6e4){this.Ws=e,this.timerId=n,this._o=r,this.mo=s,this.yo=o,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}reset(){this.po=0}Eo(){this.po=this.yo}Ao(e){this.cancel();const n=Math.floor(this.po+this.Ro()),r=Math.max(0,Date.now()-this.To),s=Math.max(0,n-r);s>0&&Ie("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.po} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Io=this.Ws.enqueueAfterDelay(this.timerId,s,()=>(this.To=Date.now(),e())),this.po*=this.mo,this.po<this._o&&(this.po=this._o),this.po>this.yo&&(this.po=this.yo)}vo(){this.Io!==null&&(this.Io.skipDelay(),this.Io=null)}cancel(){this.Io!==null&&(this.Io.cancel(),this.Io=null)}Ro(){return(Math.random()-.5)*this.po}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DK{constructor(e,n,r,s,o,i,a,l){this.Ws=e,this.bo=r,this.Po=s,this.connection=o,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Vo=0,this.So=null,this.Do=null,this.stream=null,this.Co=new LP(e,n)}xo(){return this.state===1||this.state===5||this.No()}No(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.ko()}async stop(){this.xo()&&await this.close(0)}Oo(){this.state=0,this.Co.reset()}$o(){this.No()&&this.So===null&&(this.So=this.Ws.enqueueAfterDelay(this.bo,6e4,()=>this.Mo()))}Fo(e){this.Bo(),this.stream.send(e)}async Mo(){if(this.No())return this.close(0)}Bo(){this.So&&(this.So.cancel(),this.So=null)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}async close(e,n){this.Bo(),this.Lo(),this.Co.cancel(),this.Vo++,e!==4?this.Co.reset():n&&n.code===oe.RESOURCE_EXHAUSTED?(Ja(n.toString()),Ja("Using maximum backoff delay to prevent overloading the backend."),this.Co.Eo()):n&&n.code===oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.qo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(n)}qo(){}auth(){this.state=1;const e=this.Uo(this.Vo),n=this.Vo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Vo===n&&this.Ko(r,s)},r=>{e(()=>{const s=new Re(oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Go(s)})})}Ko(e,n){const r=this.Uo(this.Vo);this.stream=this.Qo(e,n),this.stream.Jr(()=>{r(()=>(this.state=2,this.Do=this.Ws.enqueueAfterDelay(this.Po,1e4,()=>(this.No()&&(this.state=3),Promise.resolve())),this.listener.Jr()))}),this.stream.Zr(s=>{r(()=>this.Go(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}ko(){this.state=5,this.Co.Ao(async()=>{this.state=0,this.start()})}Go(e){return Ie("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Uo(e){return n=>{this.Ws.enqueueAndForget(()=>this.Vo===e?n():(Ie("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class OK extends DK{constructor(e,n,r,s,o,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,i),this.serializer=o,this.Ho=!1}get Jo(){return this.Ho}start(){this.Ho=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Ho&&this.Yo([])}Qo(e,n){return this.connection.wo("Write",e,n)}onMessage(e){if(bn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Ho){this.Co.reset();const n=rK(e.writeResults,e.commitTime),r=fc(e.commitTime);return this.listener.Zo(r,n)}return bn(!e.writeResults||e.writeResults.length===0),this.Ho=!0,this.listener.Xo()}tu(){const e={};e.database=eK(this.serializer),this.Fo(e)}Yo(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>nK(this.serializer,r))};this.Fo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PK extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.eu=!1}nu(){if(this.eu)throw new Re(oe.FAILED_PRECONDITION,"The client has already been terminated.")}co(e,n,r){return this.nu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.co(e,n,r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Re(oe.UNKNOWN,s.toString())})}fo(e,n,r,s){return this.nu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,i])=>this.connection.fo(e,n,r,o,i,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Re(oe.UNKNOWN,o.toString())})}terminate(){this.eu=!0}}class FK{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.su=0,this.iu=null,this.ru=!0}ou(){this.su===0&&(this.uu("Unknown"),this.iu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.iu=null,this.cu("Backend didn't respond within 10 seconds."),this.uu("Offline"),Promise.resolve())))}au(e){this.state==="Online"?this.uu("Unknown"):(this.su++,this.su>=1&&(this.hu(),this.cu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.uu("Offline")))}set(e){this.hu(),this.su=0,e==="Online"&&(this.ru=!1),this.uu(e)}uu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}cu(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ru?(Ja(n),this.ru=!1):Ie("OnlineStateTracker",n)}hu(){this.iu!==null&&(this.iu.cancel(),this.iu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LK{constructor(e,n,r,s,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.lu=[],this.fu=new Map,this.du=new Set,this.wu=[],this._u=o,this._u.qr(i=>{r.enqueueAndForget(async()=>{uf(this)&&(Ie("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=Ct(a);l.du.add(4),await cf(l),l.mu.set("Unknown"),l.du.delete(4),await vv(l)}(this))})}),this.mu=new FK(r,s)}}async function vv(t){if(uf(t))for(const e of t.wu)await e(!0)}async function cf(t){for(const e of t.wu)await e(!1)}function uf(t){return Ct(t).du.size===0}async function MP(t,e,n){if(!fv(e))throw e;t.du.add(1),await cf(t),t.mu.set("Offline"),n||(n=()=>$K(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ie("RemoteStore","Retrying IndexedDB access"),await n(),t.du.delete(1),await vv(t)})}function zP(t,e){return e().catch(n=>MP(t,n,e))}async function xv(t){const e=Ct(t),n=ji(e);let r=e.lu.length>0?e.lu[e.lu.length-1].batchId:-1;for(;MK(e);)try{const s=await EK(e.localStore,r);if(s===null){e.lu.length===0&&n.$o();break}r=s.batchId,zK(e,s)}catch(s){await MP(e,s)}BP(e)&&UP(e)}function MK(t){return uf(t)&&t.lu.length<10}function zK(t,e){t.lu.push(e);const n=ji(t);n.No()&&n.Jo&&n.Yo(e.mutations)}function BP(t){return uf(t)&&!ji(t).xo()&&t.lu.length>0}function UP(t){ji(t).start()}async function BK(t){ji(t).tu()}async function UK(t){const e=ji(t);for(const n of t.lu)e.Yo(n.mutations)}async function VK(t,e,n){const r=t.lu.shift(),s=vS.from(r,e,n);await zP(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await xv(t)}async function WK(t,e){e&&ji(t).Jo&&await async function(n,r){if(s=r.code,K8(s)&&s!==oe.ABORTED){const o=n.lu.shift();ji(n).Oo(),await zP(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,r)),await xv(n)}var s}(t,e),BP(t)&&UP(t)}async function DT(t,e){const n=Ct(t);n.asyncQueue.verifyOperationInProgress(),Ie("RemoteStore","RemoteStore received new credentials");const r=uf(n);n.du.add(3),await cf(n),r&&n.mu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.du.delete(3),await vv(n)}async function jK(t,e){const n=Ct(t);e?(n.du.delete(2),await vv(n)):e||(n.du.add(2),await cf(n),n.mu.set("Unknown"))}function ji(t){return t.pu||(t.pu=function(e,n,r){const s=Ct(e);return s.nu(),new OK(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{Jr:BK.bind(null,t),Zr:WK.bind(null,t),Xo:UK.bind(null,t),Zo:VK.bind(null,t)}),t.wu.push(async e=>{e?(t.pu.Oo(),await xv(t)):(await t.pu.stop(),t.lu.length>0&&(Ie("RemoteStore",`Stopping write stream with ${t.lu.length} pending writes`),t.lu=[]))})),t.pu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,n,r,s,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=o,this.deferred=new Ma,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(i=>{})}static createAndSchedule(e,n,r,s,o){const i=Date.now()+r,a=new CS(e,n,i,s,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function VP(t,e){if(Ja("AsyncQueue",`${e}: ${t}`),fv(t))return new Re(oe.UNAVAILABLE,`${e}: ${t}`);throw t}class GK{constructor(){this.queries=new du(e=>wP(e),bP),this.onlineState="Unknown",this.Au=new Set}}function HK(t){t.Au.forEach(e=>{e.next()})}class KK{constructor(e,n,r,s,o,i){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=i,this.nc={},this.sc=new du(a=>wP(a),bP),this.ic=new Map,this.rc=new Set,this.oc=new Sr(Pe.comparator),this.uc=new Map,this.cc=new xS,this.ac={},this.hc=new Map,this.lc=Fc.bn(),this.onlineState="Unknown",this.fc=void 0}get isPrimaryClient(){return this.fc===!0}}async function qK(t,e,n){const r=JK(t);try{const s=await function(o,i){const a=Ct(o),l=yn.now(),c=i.reduce((d,f)=>d.add(f.key),Un());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=zg(),p=Un();return a.Ki.getEntries(d,c).next(m=>{f=m,f.forEach((y,g)=>{g.isValidDocument()||(p=p.add(y))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(m=>{u=m;const y=[];for(const g of i){const v=W8(g,u.get(g.key).overlayedDocument);v!=null&&y.push(new xl(g.key,v,fP(v.value.mapValue),No.exists(!0)))}return a.mutationQueue.addMutationBatch(d,l,y,i)}).next(m=>{h=m;const y=m.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,m.batchId,y)})}).then(()=>({batchId:h.batchId,changes:IP(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,i,a){let l=o.ac[o.currentUser.toKey()];l||(l=new Sr(dt)),l=l.insert(i,a),o.ac[o.currentUser.toKey()]=l}(r,s.batchId,n),await bv(r,s.changes),await xv(r.remoteStore)}catch(s){const o=VP(s,"Failed to persist write");n.reject(o)}}function OT(t,e,n){const r=Ct(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.sc.forEach((o,i)=>{const a=i.view.Ru(e);a.snapshot&&s.push(a.snapshot)}),function(o,i){const a=Ct(o);a.onlineState=i;let l=!1;a.queries.forEach((c,u)=>{for(const h of u.listeners)h.Ru(i)&&(l=!0)}),l&&HK(a)}(r.eventManager,e),s.length&&r.nc.zo(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function XK(t,e){const n=Ct(t),r=e.batch.batchId;try{const s=await kK(n.localStore,e);jP(n,r,null),WP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await bv(n,s)}catch(s){await uP(s)}}async function YK(t,e,n){const r=Ct(t);try{const s=await function(o,i){const a=Ct(o);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.mutationQueue.lookupMutationBatch(l,i).next(u=>(bn(u!==null),c=u.keys(),a.mutationQueue.removeMutationBatch(l,u))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,c,i)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>a.localDocuments.getDocuments(l,c))})}(r.localStore,e);jP(r,e,n),WP(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await bv(r,s)}catch(s){await uP(s)}}function WP(t,e){(t.hc.get(e)||[]).forEach(n=>{n.resolve()}),t.hc.delete(e)}function jP(t,e,n){const r=Ct(t);let s=r.ac[r.currentUser.toKey()];if(s){const o=s.get(e);o&&(n?o.reject(n):o.resolve(),s=s.remove(e)),r.ac[r.currentUser.toKey()]=s}}async function bv(t,e,n){const r=Ct(t),s=[],o=[],i=[];r.sc.isEmpty()||(r.sc.forEach((a,l)=>{i.push(r.dc(l,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){s.push(c);const u=wS.Di(l.targetId,c);o.push(u)}}))}),await Promise.all(i),r.nc.zo(s),await async function(a,l){const c=Ct(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>se.forEach(l,h=>se.forEach(h.Vi,d=>c.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>se.forEach(h.Si,d=>c.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!fv(u))throw u;Ie("LocalStore","Failed to update sequence numbers: "+u)}for(const u of l){const h=u.targetId;if(!u.fromCache){const d=c.Li.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);c.Li=c.Li.insert(h,p)}}}(r.localStore,o))}async function QK(t,e){const n=Ct(t);if(!n.currentUser.isEqual(e)){Ie("SyncEngine","User change. New user:",e.toKey());const r=await FP(n.localStore,e);n.currentUser=e,function(s,o){s.hc.forEach(i=>{i.forEach(a=>{a.reject(new Re(oe.CANCELLED,o))})}),s.hc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await bv(n,r.Qi)}}function JK(t){const e=Ct(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XK.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=YK.bind(null,e),e}class PT{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=yv(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return SK(this.persistence,new CK,e.initialUser,this.serializer)}createPersistence(e){return new bK(bS.Fs,this.serializer)}createSharedClientState(e){return new NK}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ZK{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>OT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=QK.bind(null,this.syncEngine),await jK(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new GK}createDatastore(e){const n=yv(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new AK(s));var s;return function(o,i,a,l){return new PK(o,i,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,o=a=>OT(this.syncEngine,a,0),i=AT.D()?new AT:new TK,new LK(n,r,s,o,i);var n,r,s,o,i}createSyncEngine(e,n){return function(r,s,o,i,a,l,c){const u=new KK(r,s,o,i,a,l);return c&&(u.fc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=Ct(e);Ie("RemoteStore","RemoteStore shutting down."),n.du.add(5),await cf(n),n._u.shutdown(),n.mu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e9{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Mn.UNAUTHENTICATED,this.clientId=cP.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async o=>{Ie("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Ie("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Re(oe.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ma;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=VP(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ab(t,e){t.asyncQueue.verifyOperationInProgress(),Ie("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await FP(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function FT(t,e){t.asyncQueue.verifyOperationInProgress();const n=await n9(t);Ie("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>DT(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,o)=>DT(e.remoteStore,o)),t._onlineComponents=e}function t9(t){return t.name==="FirebaseError"?t.code===oe.FAILED_PRECONDITION||t.code===oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function n9(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ie("FirestoreClient","Using user provided OfflineComponentProvider");try{await ab(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!t9(n))throw n;Og("Error using user provided cache. Falling back to memory cache: "+n),await ab(t,new PT)}}else Ie("FirestoreClient","Using default OfflineComponentProvider"),await ab(t,new PT);return t._offlineComponents}async function r9(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ie("FirestoreClient","Using user provided OnlineComponentProvider"),await FT(t,t._uninitializedComponentsProvider._online)):(Ie("FirestoreClient","Using default OnlineComponentProvider"),await FT(t,new ZK))),t._onlineComponents}function s9(t){return r9(t).then(e=>e.syncEngine)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GP(t,e,n){if(!n)throw new Re(oe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function o9(t,e,n,r){if(e===!0&&r===!0)throw new Re(oe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function MT(t){if(!Pe.isDocumentKey(t))throw new Re(oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function zT(t){if(Pe.isDocumentKey(t))throw new Re(oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function IS(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ve()}function HP(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Re(oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=IS(t);throw new Re(oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new Re(oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Re(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,o9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BT({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Re(oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Re(oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BT(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new X5;switch(n.type){case"firstParty":return new Z5(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Re(oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=LT.get(e);n&&(Ie("ComponentProvider","Removing Datastore"),LT.delete(e),n.terminate())}(this),Promise.resolve()}}function i9(t,e,n,r={}){var s;const o=(t=HP(t,wv))._getSettings();if(o.host!=="firestore.googleapis.com"&&o.host!==e&&Og("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let i,a;if(typeof r.mockUserToken=="string")i=r.mockUserToken,a=Mn.MOCK_USER;else{i=$H(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new Re(oe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new Mn(l)}t._authCredentials=new Y5(new lP(i,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Oi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new To(this.firestore,e,this._key)}}class SS{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new SS(this.firestore,e,this._query)}}class Oi extends SS{constructor(e,n,r){super(e,n,$8(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new To(this.firestore,null,new Pe(e))}withConverter(e){return new Oi(this.firestore,e,this._path)}}function fu(t,e,...n){if(t=Ir(t),GP("collection","path",e),t instanceof wv){const r=Pt.fromString(e,...n);return zT(r),new Oi(t,null,r)}{if(!(t instanceof To||t instanceof Oi))throw new Re(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Pt.fromString(e,...n));return zT(r),new Oi(t.firestore,null,r)}}function a9(t,e,...n){if(t=Ir(t),arguments.length===1&&(e=cP.A()),GP("doc","path",e),t instanceof wv){const r=Pt.fromString(e,...n);return MT(r),new To(t,null,new Pe(r))}{if(!(t instanceof To||t instanceof Oi))throw new Re(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Pt.fromString(e,...n));return MT(r),new To(t.firestore,t instanceof Oi?t.converter:null,new Pe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(){this.Nc=Promise.resolve(),this.kc=[],this.Oc=!1,this.$c=[],this.Mc=null,this.Fc=!1,this.Bc=!1,this.Lc=[],this.Co=new LP(this,"async_queue_retry"),this.qc=()=>{const n=ib();n&&Ie("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Co.vo()};const e=ib();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.qc)}get isShuttingDown(){return this.Oc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Uc(),this.Kc(e)}enterRestrictedMode(e){if(!this.Oc){this.Oc=!0,this.Bc=e||!1;const n=ib();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.qc)}}enqueue(e){if(this.Uc(),this.Oc)return new Promise(()=>{});const n=new Ma;return this.Kc(()=>this.Oc&&this.Bc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.kc.push(e),this.Gc()))}async Gc(){if(this.kc.length!==0){try{await this.kc[0](),this.kc.shift(),this.Co.reset()}catch(e){if(!fv(e))throw e;Ie("AsyncQueue","Operation failed with retryable error: "+e)}this.kc.length>0&&this.Co.Ao(()=>this.Gc())}}Kc(e){const n=this.Nc.then(()=>(this.Fc=!0,e().catch(r=>{this.Mc=r,this.Fc=!1;const s=function(o){let i=o.message||"";return o.stack&&(i=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),i}(r);throw Ja("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Fc=!1,r))));return this.Nc=n,n}enqueueAfterDelay(e,n,r){this.Uc(),this.Lc.indexOf(e)>-1&&(n=0);const s=CS.createAndSchedule(this,e,n,r,o=>this.Qc(o));return this.$c.push(s),s}Uc(){this.Mc&&Ve()}verifyOperationInProgress(){}async zc(){let e;do e=this.Nc,await e;while(e!==this.Nc)}jc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Wc(e){return this.zc().then(()=>{this.$c.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Hc(e){this.Lc.push(e)}Qc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}class KP extends wv{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new l9,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||qP(this),this._firestoreClient.terminate()}}function c9(t,e){const n=typeof t=="object"?t:rO(),r=typeof t=="string"?t:e||"(default)",s=jI(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const o=IH("firestore");o&&i9(s,...o)}return s}function u9(t){return t._firestoreClient||qP(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function qP(t){var e,n,r;const s=t._freezeSettings(),o=function(i,a,l,c){return new f8(i,a,l,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new e9(t._authCredentials,t._appCheckCredentials,t._queue,o),!((n=s.cache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.cache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ud(Lo.fromBase64String(e))}catch(n){throw new Re(oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ud(Lo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Re(oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Re(oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Re(oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return dt(this._lat,e._lat)||dt(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h9=/^__.*__$/;class d9{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new xl(e,this.data,this.fieldMask,n,this.fieldTransforms):new lf(e,this.data,n,this.fieldTransforms)}}function JP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ve()}}class kS{constructor(e,n,r,s,o,i){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,o===void 0&&this.Jc(),this.fieldTransforms=o||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Yc(){return this.settings.Yc}Zc(e){return new kS(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Xc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Zc({path:r,ta:!1});return s.ea(e),s}na(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Zc({path:r,ta:!1});return s.Jc(),s}sa(e){return this.Zc({path:void 0,ta:!0})}ia(e){return Vg(e,this.settings.methodName,this.settings.ra||!1,this.path,this.settings.oa)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Jc(){if(this.path)for(let e=0;e<this.path.length;e++)this.ea(this.path.get(e))}ea(e){if(e.length===0)throw this.ia("Document fields must not be empty");if(JP(this.Yc)&&h9.test(e))throw this.ia('Document fields cannot begin and end with "__"')}}class f9{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||yv(e)}ua(e,n,r,s=!1){return new kS({Yc:e,methodName:n,oa:r,path:Wn.emptyPath(),ta:!1,ra:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function p9(t){const e=t._freezeSettings(),n=yv(t._databaseId);return new f9(t._databaseId,!!e.ignoreUndefinedProperties,n)}function m9(t,e,n,r,s,o={}){const i=t.ua(o.merge||o.mergeFields?2:0,e,n,s);nF("Data must be an object, but it was:",i,r);const a=eF(r,i);let l,c;if(o.merge)l=new Ss(i.fieldMask),c=i.fieldTransforms;else if(o.mergeFields){const u=[];for(const h of o.mergeFields){const d=g9(e,h,n);if(!i.contains(d))throw new Re(oe.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);x9(u,d)||u.push(d)}l=new Ss(u),c=i.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=i.fieldTransforms;return new d9(new Is(a),l,c)}function ZP(t,e){if(tF(t=Ir(t)))return nF("Unsupported field value:",e,t),eF(t,e);if(t instanceof YP)return function(n,r){if(!JP(r.Yc))throw r.ia(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ia(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.ta&&e.Yc!==4)throw e.ia("Nested arrays are not supported");return function(n,r){const s=[];let o=0;for(const i of n){let a=ZP(i,r.sa(o));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),o++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=Ir(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return L8(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=yn.fromDate(n);return{timestampValue:nw(r.serializer,s)}}if(n instanceof yn){const s=new yn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:nw(r.serializer,s)}}if(n instanceof QP)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ud)return{bytesValue:Y8(r.serializer,n._byteString)};if(n instanceof To){const s=r.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw r.ia(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:OP(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.ia(`Unsupported field value: ${IS(n)}`)}(t,e)}function eF(t,e){const n={};return dP(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):af(t,(r,s)=>{const o=ZP(s,e.Xc(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function tF(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof yn||t instanceof QP||t instanceof ud||t instanceof To||t instanceof YP)}function nF(t,e,n){if(!tF(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=IS(n);throw r==="an object"?e.ia(t+" a custom object"):e.ia(t+" "+r)}}function g9(t,e,n){if((e=Ir(e))instanceof XP)return e._internalPath;if(typeof e=="string")return v9(t,e);throw Vg("Field path arguments must be of type string or ",t,!1,void 0,n)}const y9=new RegExp("[~\\*/\\[\\]]");function v9(t,e,n){if(e.search(y9)>=0)throw Vg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new XP(...e.split("."))._internalPath}catch{throw Vg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Vg(t,e,n,r,s){const o=r&&!r.isEmpty(),i=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||i)&&(l+=" (found",o&&(l+=` in field ${r}`),i&&(l+=` in document ${s}`),l+=")"),new Re(oe.INVALID_ARGUMENT,a+t+l)}function x9(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b9(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}function pu(t,e){const n=HP(t.firestore,KP),r=a9(t),s=b9(t.converter,e);return w9(n,[m9(p9(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,No.exists(!1))]).then(()=>r)}function w9(t,e){return function(n,r){const s=new Ma;return n.asyncQueue.enqueueAndForget(async()=>qK(await s9(n),r,s)),s.promise}(u9(t),e)}(function(t,e=!0){(function(n){hu=n})(lu),Tc(new Xa("firestore",(n,{instanceIdentifier:r,options:s})=>{const o=n.getProvider("app").getImmediate(),i=new KP(new Q5(n.getProvider("auth-internal")),new t8(n.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Re(oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lg(a.options.projectId,l)}(o,r),o);return s=Object.assign({useFetchStreams:e},s),i._setSettings(s),i},"PUBLIC").setMultipleInstances(!0)),Di(gT,"3.10.1",t),Di(gT,"3.10.1","esm2017")})();function $S(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function rF(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const C9=rF,sF=new Xd("auth","Firebase",rF());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wg=new VI("@firebase/auth");function I9(t,...e){Wg.logLevel<=Xe.WARN&&Wg.warn(`Auth (${lu}): ${t}`,...e)}function Wm(t,...e){Wg.logLevel<=Xe.ERROR&&Wg.error(`Auth (${lu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(t,...e){throw ES(t,...e)}function to(t,...e){return ES(t,...e)}function S9(t,e,n){const r=Object.assign(Object.assign({},C9()),{[e]:n});return new Xd("auth","Firebase",r).create(e,{appName:t.name})}function ES(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return sF.create(t,...e)}function Ne(t,e,...n){if(!t)throw ES(e,...n)}function So(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Wm(e),new Error(e)}function Mo(t,e){t||So(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function k9(){return UT()==="http:"||UT()==="https:"}function UT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(k9()||NH()||"connection"in navigator)?navigator.onLine:!0}function E9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,n){this.shortDelay=e,this.longDelay=n,Mo(n>e,"Short delay should be less than long delay!"),this.isMobile=EH()||TH()}get(){return $9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(t,e){Mo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oF{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;So("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;So("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;So("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T9=new hf(3e4,6e4);function mu(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function gu(t,e,n,r,s={}){return iF(t,s,async()=>{let o={},i={};r&&(e==="GET"?i=r:o={body:JSON.stringify(r)});const a=Yd(Object.assign({key:t.config.apiKey},i)).slice(1),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode),oF.fetch()(aF(t,t.config.apiHost,n,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},o))})}async function iF(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},N9),e);try{const s=new R9(t),o=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const i=await o.json();if("needConfirmation"in i)throw um(t,"account-exists-with-different-credential",i);if(o.ok&&!("errorMessage"in i))return i;{const a=o.ok?i.errorMessage:i.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw um(t,"credential-already-in-use",i);if(l==="EMAIL_EXISTS")throw um(t,"email-already-in-use",i);if(l==="USER_DISABLED")throw um(t,"user-disabled",i);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw S9(t,u,c);As(t,u)}}catch(s){if(s instanceof Ko)throw s;As(t,"network-request-failed",{message:String(s)})}}async function df(t,e,n,r,s={}){const o=await gu(t,e,n,r,s);return"mfaPendingCredential"in o&&As(t,"multi-factor-auth-required",{_serverResponse:o}),o}function aF(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?NS(t.config,s):`${t.config.apiScheme}://${s}`}class R9{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(to(this.auth,"network-request-failed")),T9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function um(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=to(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _9(t,e){return gu(t,"POST","/v1/accounts:delete",e)}async function A9(t,e){return gu(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function D9(t,e=!1){const n=Ir(t),r=await n.getIdToken(e),s=TS(r);Ne(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,i=o==null?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:Rh(lb(s.auth_time)),issuedAtTime:Rh(lb(s.iat)),expirationTime:Rh(lb(s.exp)),signInProvider:i||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function lb(t){return Number(t)*1e3}function TS(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Wm("JWT malformed, contained fewer than 3 sections"),null;try{const s=QD(n);return s?JSON.parse(s):(Wm("Failed to decode base64 JWT payload"),null)}catch(s){return Wm("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function O9(t){const e=TS(t);return Ne(e,"internal-error"),Ne(typeof e.exp<"u","internal-error"),Ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hd(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ko&&P9(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function P9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lF{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rh(this.lastLoginAt),this.creationTime=Rh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jg(t){var e;const n=t.auth,r=await t.getIdToken(),s=await hd(t,A9(n,{idToken:r}));Ne(s==null?void 0:s.users.length,n,"internal-error");const o=s.users[0];t._notifyReloadListener(o);const i=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?z9(o.providerUserInfo):[],a=M9(t.providerData,i),l=t.isAnonymous,c=!(t.email&&o.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new lF(o.createdAt,o.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function L9(t){const e=Ir(t);await jg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function M9(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function z9(t){return t.map(e=>{var{providerId:n}=e,r=$S(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B9(t,e){const n=await iF(t,{},async()=>{const r=Yd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=t.config,i=aF(t,s,"/v1/token",`key=${o}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",oF.fetch()(i,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ne(e.idToken,"internal-error"),Ne(typeof e.idToken<"u","internal-error"),Ne(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):O9(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return Ne(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:o}=await B9(e,n);this.updateTokensAndExpiration(r,s,Number(o))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:o}=n,i=new dd;return r&&(Ne(typeof r=="string","internal-error",{appName:e}),i.refreshToken=r),s&&(Ne(typeof s=="string","internal-error",{appName:e}),i.accessToken=s),o&&(Ne(typeof o=="number","internal-error",{appName:e}),i.expirationTime=o),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dd,this.toJSON())}_performRefresh(){return So("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(t,e){Ne(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class za{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,o=$S(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new F9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new lF(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const n=await hd(this,this.stsTokenManager.getToken(this.auth,e));return Ne(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return D9(this,e)}reload(){return L9(this)}_assign(e){this!==e&&(Ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new za(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await jg(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await hd(this,_9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,o,i,a,l,c,u;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,d=(s=n.email)!==null&&s!==void 0?s:void 0,f=(o=n.phoneNumber)!==null&&o!==void 0?o:void 0,p=(i=n.photoURL)!==null&&i!==void 0?i:void 0,m=(a=n.tenantId)!==null&&a!==void 0?a:void 0,y=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,g=(c=n.createdAt)!==null&&c!==void 0?c:void 0,v=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:x,emailVerified:b,isAnonymous:w,providerData:C,stsTokenManager:I}=n;Ne(x&&I,e,"internal-error");const S=dd.fromJSON(this.name,I);Ne(typeof x=="string",e,"internal-error"),si(h,e.name),si(d,e.name),Ne(typeof b=="boolean",e,"internal-error"),Ne(typeof w=="boolean",e,"internal-error"),si(f,e.name),si(p,e.name),si(m,e.name),si(y,e.name),si(g,e.name),si(v,e.name);const $=new za({uid:x,auth:e,email:d,emailVerified:b,displayName:h,isAnonymous:w,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:S,createdAt:g,lastLoginAt:v});return C&&Array.isArray(C)&&($.providerData=C.map(E=>Object.assign({},E))),y&&($._redirectEventId=y),$}static async _fromIdTokenResponse(e,n,r=!1){const s=new dd;s.updateFromServerResponse(n);const o=new za({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await jg(o),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT=new Map;function ko(t){Mo(t instanceof Function,"Expected a class definition");let e=VT.get(t);return e?(Mo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,VT.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}cF.type="NONE";const WT=cF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jm(t,e,n){return`firebase:${t}:${e}:${n}`}class pc{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:o}=this.auth;this.fullUserKey=jm(this.userKey,s.apiKey,o),this.fullPersistenceKey=jm("persistence",s.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?za._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new pc(ko(WT),e,r);const s=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let o=s[0]||ko(WT);const i=jm(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const u=await c._get(i);if(u){const h=za._fromJSON(e,u);c!==o&&(a=h),o=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!o._shouldAllowMigration||!l.length?new pc(o,e,r):(o=l[0],a&&await o._set(i,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==o)try{await c._remove(i)}catch{}})),new pc(o,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dF(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uF(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pF(e))return"Blackberry";if(mF(e))return"Webos";if(RS(e))return"Safari";if((e.includes("chrome/")||hF(e))&&!e.includes("edge/"))return"Chrome";if(fF(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function uF(t=Xn()){return/firefox\//i.test(t)}function RS(t=Xn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hF(t=Xn()){return/crios\//i.test(t)}function dF(t=Xn()){return/iemobile/i.test(t)}function fF(t=Xn()){return/android/i.test(t)}function pF(t=Xn()){return/blackberry/i.test(t)}function mF(t=Xn()){return/webos/i.test(t)}function Cv(t=Xn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function U9(t=Xn()){var e;return Cv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function V9(){return RH()&&document.documentMode===10}function gF(t=Xn()){return Cv(t)||fF(t)||mF(t)||pF(t)||/windows phone/i.test(t)||dF(t)}function W9(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yF(t,e=[]){let n;switch(t){case"Browser":n=jT(Xn());break;case"Worker":n=`${jT(Xn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${lu}/${r}`}async function vF(t,e){return gu(t,"GET","/v2/recaptchaConfig",mu(t,e))}function GT(t){return t!==void 0&&t.enterprise!==void 0}class xF{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(n=>n.provider==="EMAIL_PASSWORD_PROVIDER"&&n.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function bF(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const o=to("internal-error");o.customData=s,n(o)},r.type="text/javascript",r.charset="UTF-8",j9().appendChild(r)})}function G9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const H9="https://www.google.com/recaptcha/enterprise.js?render=",K9="recaptcha-enterprise";class wF{constructor(e){this.type=K9,this.auth=yu(e)}async verify(e="verify",n=!1){async function r(o){if(!n){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(i,a)=>{vF(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new xF(l);return o.tenantId==null?o._agentRecaptchaConfig=c:o._tenantRecaptchaConfigs[o.tenantId]=c,i(c.siteKey)}}).catch(l=>{a(l)})})}function s(o,i,a){const l=window.grecaptcha;GT(l)?l.enterprise.ready(()=>{try{l.enterprise.execute(o,{action:e}).then(c=>{i(c)}).catch(c=>{a(c)})}catch(c){a(c)}}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,i)=>{r(this.auth).then(a=>{if(!n&&GT(window.grecaptcha))s(a,o,i);else{if(typeof window>"u"){i(new Error("RecaptchaVerifier is only supported in browser"));return}bF(H9+a).then(()=>{s(a,o,i)}).catch(l=>{i(l)})}}).catch(a=>{i(a)})})}}async function Gg(t,e,n,r=!1){const s=new wF(t);let o;try{o=await s.verify(n)}catch{o=await s.verify(n,!0)}const i=Object.assign({},e);return r?Object.assign(i,{captchaResp:o}):Object.assign(i,{captchaResponse:o}),Object.assign(i,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(i,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),i}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=o=>new Promise((i,a)=>{try{const l=e(o);i(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X9{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new HT(this),this.idTokenSubscription=new HT(this),this.beforeStateQueue=new q9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=sF,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ko(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await pc.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let s=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!i||i===a)&&(l!=null&&l.user)&&(s=l.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(i){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await jg(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=E9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?Ir(e):null;return n&&Ne(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(ko(e))})}async initializeRecaptchaConfig(){const e=await vF(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new xF(e);this.tenantId==null?this._agentRecaptchaConfig=n:this._tenantRecaptchaConfigs[this.tenantId]=n,n.emailPasswordEnabled&&new wF(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Xd("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ko(e)||this._popupRedirectResolver;Ne(n,this,"argument-error"),this.redirectPersistenceManager=await pc.create(this,[ko(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const o=typeof n=="function"?n:n.next.bind(n),i=this._isInitialized?Promise.resolve():this._initializationPromise;return Ne(i,this,"internal-error"),i.then(()=>o(this.currentUser)),typeof n=="function"?e.addObserver(n,r,s):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yF(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&I9(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function yu(t){return Ir(t)}class HT{constructor(e){this.auth=e,this.observer=null,this.addObserver=LH(n=>this.observer=n)}get next(){return Ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y9(t,e){const n=jI(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),o=n.getOptions();if(Sg(o,e??{}))return s;As(s,"already-initialized")}return n.initialize({options:e})}function Q9(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ko);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function J9(t,e,n){const r=yu(t);Ne(r._canInitEmulator,r,"emulator-config-failed"),Ne(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),o=CF(e),{host:i,port:a}=Z9(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${o}//${i}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:i,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||eq()}function CF(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Z9(t){const e=CF(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const o=s[1];return{host:o,port:KT(r.substr(o.length+1))}}else{const[o,i]=r.split(":");return{host:o,port:KT(i)}}}function KT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function eq(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return So("not implemented")}_getIdTokenResponse(e){return So("not implemented")}_linkToIdToken(e,n){return So("not implemented")}_getReauthenticationResolver(e){return So("not implemented")}}async function tq(t,e){return gu(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cb(t,e){return df(t,"POST","/v1/accounts:signInWithPassword",mu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nq(t,e){return df(t,"POST","/v1/accounts:signInWithEmailLink",mu(t,e))}async function rq(t,e){return df(t,"POST","/v1/accounts:signInWithEmailLink",mu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd extends _S{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new fd(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new fd(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){var n;switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((n=e._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const s=await Gg(e,r,"signInWithPassword");return cb(e,s)}else return cb(e,r).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const o=await Gg(e,r,"signInWithPassword");return cb(e,o)}else return Promise.reject(s)});case"emailLink":return nq(e,{email:this._email,oobCode:this._password});default:As(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return tq(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return rq(e,{idToken:n,email:this._email,oobCode:this._password});default:As(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mc(t,e){return df(t,"POST","/v1/accounts:signInWithIdp",mu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sq="http://localhost";class el extends _S{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new el(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):As("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,o=$S(n,["providerId","signInMethod"]);if(!r||!s)return null;const i=new el(r,s);return i.idToken=o.idToken||void 0,i.accessToken=o.accessToken||void 0,i.secret=o.secret,i.nonce=o.nonce,i.pendingToken=o.pendingToken||null,i}_getIdTokenResponse(e){const n=this.buildRequest();return mc(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,mc(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,mc(e,n)}buildRequest(){const e={requestUri:sq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Yd(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oq(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function iq(t){const e=sh(oh(t)).link,n=e?sh(oh(e)).deep_link_id:null,r=sh(oh(t)).deep_link_id;return(r?sh(oh(r)).link:null)||r||n||e||t}class AS{constructor(e){var n,r,s,o,i,a;const l=sh(oh(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,u=(r=l.oobCode)!==null&&r!==void 0?r:null,h=oq((s=l.mode)!==null&&s!==void 0?s:null);Ne(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=(o=l.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(i=l.languageCode)!==null&&i!==void 0?i:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=iq(e);try{return new AS(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(){this.providerId=vu.PROVIDER_ID}static credential(e,n){return fd._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=AS.parseLink(n);return Ne(r,"argument-error"),fd._fromEmailAndCode(e,r.code,r.tenantId)}}vu.PROVIDER_ID="password";vu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";vu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff extends IF{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui extends ff{constructor(){super("facebook.com")}static credential(e){return el._fromParams({providerId:ui.PROVIDER_ID,signInMethod:ui.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ui.credentialFromTaggedObject(e)}static credentialFromError(e){return ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ui.credential(e.oauthAccessToken)}catch{return null}}}ui.FACEBOOK_SIGN_IN_METHOD="facebook.com";ui.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi extends ff{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return el._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return hi.credential(n,r)}catch{return null}}}hi.GOOGLE_SIGN_IN_METHOD="google.com";hi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di extends ff{constructor(){super("github.com")}static credential(e){return el._fromParams({providerId:di.PROVIDER_ID,signInMethod:di.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return di.credentialFromTaggedObject(e)}static credentialFromError(e){return di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return di.credential(e.oauthAccessToken)}catch{return null}}}di.GITHUB_SIGN_IN_METHOD="github.com";di.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi extends ff{constructor(){super("twitter.com")}static credential(e,n){return el._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return fi.credential(n,r)}catch{return null}}}fi.TWITTER_SIGN_IN_METHOD="twitter.com";fi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ub(t,e){return df(t,"POST","/v1/accounts:signUp",mu(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const o=await za._fromIdTokenResponse(e,r,s),i=qT(r);return new tl({user:o,providerId:i,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=qT(r);return new tl({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function qT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg extends Ko{constructor(e,n,r,s){var o;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Hg.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Hg(e,n,r,s)}}function SF(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Hg._fromErrorAndOperation(t,o,e,r):o})}async function aq(t,e,n=!1){const r=await hd(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return tl._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lq(t,e,n=!1){const{auth:r}=t,s="reauthenticate";try{const o=await hd(t,SF(r,s,e,t),n);Ne(o.idToken,r,"internal-error");const i=TS(o.idToken);Ne(i,r,"internal-error");const{sub:a}=i;return Ne(t.uid===a,r,"user-mismatch"),tl._forOperation(t,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&As(r,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kF(t,e,n=!1){const r="signIn",s=await SF(t,r,e),o=await tl._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(o.user),o}async function cq(t,e){return kF(yu(t),e)}async function uq(t,e,n){var r;const s=yu(t),o={returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"};let i;if(!((r=s._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const c=await Gg(s,o,"signUpPassword");i=ub(s,c)}else i=ub(s,o).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const u=await Gg(s,o,"signUpPassword");return ub(s,u)}else return Promise.reject(c)});const a=await i.catch(c=>Promise.reject(c)),l=await tl._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(l.user),l}function hq(t,e,n){return cq(Ir(t),vu.credential(e,n))}function dq(t,e,n,r){return Ir(t).onIdTokenChanged(e,n,r)}function fq(t,e,n){return Ir(t).beforeAuthStateChanged(e,n)}function pq(t,e,n,r){return Ir(t).onAuthStateChanged(e,n,r)}function mq(t){return Ir(t).signOut()}const Kg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $F{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Kg,"1"),this.storage.removeItem(Kg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gq(){const t=Xn();return RS(t)||Cv(t)}const yq=1e3,vq=10;class EF extends $F{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=gq()&&W9(),this.fallbackToPolling=gF(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((i,a,l)=>{this.notifyListeners(i,l)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(r);if(e.newValue!==i)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const s=()=>{const i=this.storage.getItem(r);!n&&this.localCache[r]===i||this.notifyListeners(r,i)},o=this.storage.getItem(r);V9()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,vq):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},yq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}EF.type="LOCAL";const xq=EF;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF extends $F{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}NF.type="SESSION";const TF=NF;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bq(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Iv(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:o}=n.data,i=this.handlersMap[s];if(!(i!=null&&i.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(i).map(async c=>c(n.origin,o)),l=await bq(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Iv.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wq{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,i;return new Promise((a,l)=>{const c=DS("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);i={messageChannel:s,onMessage(h){const d=h;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),o=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(d.data.response);break;default:clearTimeout(u),clearTimeout(o),l(new Error("invalid_response"));break}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function no(){return window}function Cq(t){no().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RF(){return typeof no().WorkerGlobalScope<"u"&&typeof no().importScripts=="function"}async function Iq(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Sq(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function kq(){return RF()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F="firebaseLocalStorageDb",$q=1,qg="firebaseLocalStorage",AF="fbase_key";class pf{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Sv(t,e){return t.transaction([qg],e?"readwrite":"readonly").objectStore(qg)}function Eq(){const t=indexedDB.deleteDatabase(_F);return new pf(t).toPromise()}function ow(){const t=indexedDB.open(_F,$q);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(qg,{keyPath:AF})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(qg)?e(r):(r.close(),await Eq(),e(await ow()))})})}async function XT(t,e,n){const r=Sv(t,!0).put({[AF]:e,value:n});return new pf(r).toPromise()}async function Nq(t,e){const n=Sv(t,!1).get(e),r=await new pf(n).toPromise();return r===void 0?null:r.value}function YT(t,e){const n=Sv(t,!0).delete(e);return new pf(n).toPromise()}const Tq=800,Rq=3;class DF{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ow(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Rq)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return RF()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Iv._getInstance(kq()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Iq(),!this.activeServiceWorker)return;this.sender=new wq(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Sq()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ow();return await XT(e,Kg,"1"),await YT(e,Kg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>XT(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Nq(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>YT(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=Sv(s,!1).getAll();return new pf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:s,value:o}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Tq)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}DF.type="LOCAL";const _q=DF;new hf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Aq(t,e){return e?ko(e):(Ne(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS extends _S{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mc(e,this._buildIdpRequest())}_linkToIdToken(e,n){return mc(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return mc(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Dq(t){return kF(t.auth,new OS(t),t.bypassAuthState)}function Oq(t){const{auth:e,user:n}=t;return Ne(n,e,"internal-error"),lq(n,new OS(t),t.bypassAuthState)}async function Pq(t){const{auth:e,user:n}=t;return Ne(n,e,"internal-error"),aq(n,new OS(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OF{constructor(e,n,r,s,o=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:o,error:i,type:a}=e;if(i){this.reject(i);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Dq;case"linkViaPopup":case"linkViaRedirect":return Pq;case"reauthViaPopup":case"reauthViaRedirect":return Oq;default:As(this.auth,"internal-error")}}resolve(e){Mo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Mo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fq=new hf(2e3,1e4);class tc extends OF{constructor(e,n,r,s,o){super(e,n,s,o),this.provider=r,this.authWindow=null,this.pollId=null,tc.currentPopupAction&&tc.currentPopupAction.cancel(),tc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ne(e,this.auth,"internal-error"),e}async onExecution(){Mo(this.filter.length===1,"Popup operations only handle one event");const e=DS();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(to(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(to(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(to(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,Fq.get())};e()}}tc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lq="pendingRedirect",Gm=new Map;class Mq extends OF{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Gm.get(this.auth._key());if(!e){try{const r=await zq(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Gm.set(this.auth._key(),e)}return this.bypassAuthState||Gm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function zq(t,e){const n=Vq(e),r=Uq(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Bq(t,e){Gm.set(t._key(),e)}function Uq(t){return ko(t._redirectPersistence)}function Vq(t){return jm(Lq,t.config.apiKey,t.name)}async function Wq(t,e,n=!1){const r=yu(t),s=Aq(r,e),i=await new Mq(r,s,n).execute();return i&&!n&&(delete i.user._redirectEventId,await r._persistUserIfCurrent(i.user),await r._setRedirectUser(null,e)),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jq=10*60*1e3;class Gq{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Hq(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!PF(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(to(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jq&&this.cachedEventUids.clear(),this.cachedEventUids.has(QT(e))}saveEventToCache(e){this.cachedEventUids.add(QT(e)),this.lastProcessedEventTime=Date.now()}}function QT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function PF({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Hq(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PF(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kq(t,e={}){return gu(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qq=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Xq=/^https?/;async function Yq(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Kq(t);for(const n of e)try{if(Qq(n))return}catch{}As(t,"unauthorized-domain")}function Qq(t){const e=sw(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const i=new URL(t);return i.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&i.hostname===r}if(!Xq.test(n))return!1;if(qq.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jq=new hf(3e4,6e4);function JT(){const t=no().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function Zq(t){return new Promise((e,n)=>{var r,s,o;function i(){JT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{JT(),n(to(t,"network-request-failed"))},timeout:Jq.get()})}if(!((s=(r=no().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((o=no().gapi)===null||o===void 0)&&o.load)i();else{const a=G9("iframefcb");return no()[a]=()=>{gapi.load?i():n(to(t,"network-request-failed"))},bF(`https://apis.google.com/js/api.js?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Hm=null,e})}let Hm=null;function eX(t){return Hm=Hm||Zq(t),Hm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tX=new hf(5e3,15e3),nX="__/auth/iframe",rX="emulator/auth/iframe",sX={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oX=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function iX(t){const e=t.config;Ne(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?NS(e,rX):`https://${t.config.authDomain}/${nX}`,r={apiKey:e.apiKey,appName:t.name,v:lu},s=oX.get(t.config.apiHost);s&&(r.eid=s);const o=t._getFrameworks();return o.length&&(r.fw=o.join(",")),`${n}?${Yd(r).slice(1)}`}async function aX(t){const e=await eX(t),n=no().gapi;return Ne(n,t,"internal-error"),e.open({where:document.body,url:iX(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sX,dontclear:!0},r=>new Promise(async(s,o)=>{await r.restyle({setHideOnLeave:!1});const i=to(t,"network-request-failed"),a=no().setTimeout(()=>{o(i)},tX.get());function l(){no().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{o(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},cX=500,uX=600,hX="_blank",dX="http://localhost";class ZT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function fX(t,e,n,r=cX,s=uX){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),i=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},lX),{width:r.toString(),height:s.toString(),top:o,left:i}),c=Xn().toLowerCase();n&&(a=hF(c)?hX:n),uF(c)&&(e=e||dX,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(U9(c)&&a!=="_self")return pX(e||"",a),new ZT(null);const h=window.open(e||"",a,u);Ne(h,t,"popup-blocked");try{h.focus()}catch{}return new ZT(h)}function pX(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mX="__/auth/handler",gX="emulator/auth/handler",yX=encodeURIComponent("fac");async function e2(t,e,n,r,s,o){Ne(t.config.authDomain,t,"auth-domain-config-required"),Ne(t.config.apiKey,t,"invalid-api-key");const i={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:lu,eventId:s};if(e instanceof IF){e.setDefaultLanguage(t.languageCode),i.providerId=e.providerId||"",FH(e.getCustomParameters())||(i.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,h]of Object.entries(o||{}))i[u]=h}if(e instanceof ff){const u=e.getScopes().filter(h=>h!=="");u.length>0&&(i.scopes=u.join(","))}t.tenantId&&(i.tid=t.tenantId);const a=i;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await t._getAppCheckToken(),c=l?`#${yX}=${encodeURIComponent(l)}`:"";return`${vX(t)}?${Yd(a).slice(1)}${c}`}function vX({config:t}){return t.emulator?NS(t,gX):`https://${t.authDomain}/${mX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="webStorageSupport";class xX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=TF,this._completeRedirectFn=Wq,this._overrideRedirectResult=Bq}async _openPopup(e,n,r,s){var o;Mo((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await e2(e,n,r,sw(),s);return fX(e,i,DS())}async _openRedirect(e,n,r,s){await this._originValidation(e);const o=await e2(e,n,r,sw(),s);return Cq(o),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:o}=this.eventManagers[n];return s?Promise.resolve(s):(Mo(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await aX(e),r=new Gq(e);return n.register("authEvent",s=>(Ne(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(hb,{type:hb},s=>{var o;const i=(o=s==null?void 0:s[0])===null||o===void 0?void 0:o[hb];i!==void 0&&n(!!i),As(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Yq(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return gF()||RS()||Cv()}}const bX=xX;var t2="@firebase/auth",n2="0.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CX(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function IX(t){Tc(new Xa("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:i,authDomain:a}=r.options;Ne(i&&!i.includes(":"),"invalid-api-key",{appName:r.name}),Ne(!(a!=null&&a.includes(":")),"argument-error",{appName:r.name});const l={apiKey:i,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yF(t)},c=new X9(r,s,o,l);return Q9(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Tc(new Xa("auth-internal",e=>{const n=yu(e.getProvider("auth").getImmediate());return(r=>new wX(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Di(t2,n2,CX(t)),Di(t2,n2,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SX=5*60,kX=ZD("authIdTokenMaxAge")||SX;let r2=null;const $X=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>kX)return;const s=n==null?void 0:n.token;r2!==s&&(r2=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function EX(t=rO()){const e=jI(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Y9(t,{popupRedirectResolver:bX,persistence:[_q,xq,TF]}),r=ZD("authTokenSyncURL");if(r){const o=$X(r);fq(n,o,()=>o(n.currentUser)),dq(n,i=>o(i))}const s=JD("auth");return s&&J9(n,`http://${s}`),n}IX("Browser");const NX={apiKey:"AIzaSyDmKeY30rOvsll_662uMokyW4HDDMxMXDA",authDomain:"chicken69.firebaseapp.com",projectId:"chicken69",storageBucket:"chicken69.appspot.com",messagingSenderId:"144962953249",appId:"1:144962953249:web:5de75cd3c526f9ab054360"},FF=nO(NX),xu=c9(FF),os=EX(FF),TX=()=>{W.useState(null);const t=qd();return W.useEffect(()=>{os.currentUser||t("/")},[]),he("div",{className:"container mx-auto px-5 my-10",children:[he("div",{className:"grid grid-cols-1 md:grid-cols-2  gap-8 items-center m-16",children:[T("div",{className:"mt-8 md:mt-0 lg:order-2",children:T("img",{src:uH,alt:"Farm",className:"rounded-3xl shadow-emerald-300 shadow-md border-2 mx-auto  "})}),he("div",{className:"text-center  md:text-left lg:order-1",children:[T("h1",{className:"mb-4 text-4xl md:text-5xl lg:text-6xl font-extrabold leading-none tracking-tight text-gray-900 dark:text-black",children:"Revolutionize your crop and poultry health management."}),T("p",{className:"text-lg lg:text-xl font-normal text-gray-500 dark:text-gray-400",children:"Harness the power of technology to protect your crop and poultry from disease."})]})]}),he("div",{className:"flex flex-col justify-center items-center",children:[T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}}),T("h1",{className:"mb-10 text-3xl md:text-3xl lg:text-4xl font-extrabold leading-none tracking-tight text-gray-900   dark:text-black m-4 mt-10 ",children:"Plant Disease Detection"}),T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}})]}),he("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center mt-16",children:[T("div",{children:T("img",{src:hH,alt:"Plant",className:"rounded-3xl shadow-emerald-300 shadow-md border-2 mx-auto"})}),he("div",{className:"flex flex-col justify-center",children:[T("p",{className:"text-lg lg:text-xl font-normal text-gray-500 dark:text-gray-400",children:"With farmsense.ai , farmers can easily detect diseases in their crops and plants at an early stage, allowing for timely intervention and containment.The system is designed to help farmers and researchers in plant sciences by providing them with accurate and reliable plant identification. With FarmSense.ai, farmers can quickly identify plant diseases, pests, and nutrient deficiencies, which can help them take timely and appropriate measures to improve crop yield and quality. "}),T("div",{className:"mt-4",children:T("div",{className:"card cursor-pointer",children:T(_r,{to:"/plant",children:T("button",{className:"px-6 py-2 text-white bg-[#14b8a6] hover:bg-[#0f766e] rounded-lg hover:text-white lg:inline-block",children:"Plant Disease Detection"})})})})]})]}),he("div",{className:"flex flex-col justify-center items-center mt-20",children:[T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}}),T("h1",{className:"mb-10 text-3xl md:text-3xl lg:text-4xl font-extrabold leading-none tracking-tight text-gray-900   dark:text-black m-4 mt-10 ",children:"Chicken Disease Detection"}),T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}})]}),he("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center mt-12",children:[T("div",{children:T("img",{src:dH,alt:"Chicken",className:"rounded-3xl shadow-emerald-300 shadow-md border-2 mx-auto"})}),he("div",{className:"flex flex-col justify-center",children:[T("p",{className:"text-lg lg:text-xl font-normal text-gray-500 dark:text-gray-400",children:"Chicken disease detection is a technology that uses computer vision and machine learning to identify and diagnose diseases in poultry. By analyzing images of chickens, the system can detect signs of illness and provide early warning to farmers, helping them to take preventative measures and avoid significant losses in their flocks."}),T("div",{className:"card cursor-pointer mt-4",children:T(_r,{to:"/chicken",children:T("button",{className:"block mt-4 lg:inline-block lg:mt-0 hover:text-white mr-4  px-6 py-2  text-white bg-[#14b8a6]  rounded-lg hover:bg-[#0f766e]",children:"Poultry Disease Detection"})})})]})]}),he("div",{className:"flex flex-col justify-center items-center mt-20",children:[T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}}),T("h1",{className:"mb-10 text-3xl md:text-3xl lg:text-4xl font-extrabold leading-none tracking-tight text-gray-900   dark:text-black m-4 mt-10 ",children:"Egg Incubation"}),T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}})]}),he("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center mt-12",children:[T("div",{children:T("img",{src:fH,alt:"egg",className:"rounded-3xl shadow-emerald-300 shadow-md border-2 mx-auto"})}),he("div",{className:"flex flex-col justify-center",children:[T("p",{className:"text-lg lg:text-xl font-normal text-gray-500 dark:text-gray-400",children:"Using farmSense.ai enables you to easily determine if an egg is fertilized or not, as well as detect any defects in the egg. Whether you're an experienced farmer or a beginner, you can rely on my egg incubation feature to help you optimize your egg hatching process and increase your chances of successful incubation."}),T("div",{className:"card cursor-pointer mt-4",children:T(_r,{to:"/egg",children:T("button",{className:"block mt-4 lg:inline-block lg:mt-0 hover:text-white mr-4  px-6 py-2  text-white bg-[#14b8a6]  rounded-lg hover:bg-[#0f766e]",children:"Egg Incubation"})})})]})]}),he("div",{className:"flex flex-col justify-center items-center mt-20",children:[T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}}),T("h1",{className:"mb-10 text-3xl md:text-3xl lg:text-4xl font-extrabold leading-none tracking-tight text-gray-900   dark:text-black m-4 mt-10 ",children:"Invasive Plant Detection"}),T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}})]}),he("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center mt-12",children:[T("div",{children:T("img",{src:pH,alt:"invasive",className:"rounded-3xl shadow-emerald-300 shadow-md border-2 mx-auto"})}),he("div",{className:"flex flex-col justify-center",children:[T("p",{className:"text-lg lg:text-xl font-normal text-gray-500 dark:text-gray-400",children:"Detection of invasive plants in agriculture fields is a crucial task for maintaining the productivity and sustainability of crop yields. Invasive plant species can outcompete native plants, reduce biodiversity, and cause economic losses. My app, Farmsense AI, uses advanced image recognition technology to detect and classify invasive plants in real-time. With this technology, farmers can take proactive measures to manage invasive species and prevent further damage to their crops and the environment."}),T("div",{className:"card cursor-pointer mt-4",children:T(_r,{to:"/invasive",children:T("button",{className:"block mt-4 lg:inline-block lg:mt-0 hover:text-white mr-4  px-6 py-2  text-white bg-[#14b8a6]  rounded-lg hover:bg-[#0f766e]",children:"Invasive Plant Detection"})})})]})]}),he("div",{className:"flex flex-col justify-center items-center mt-20",children:[T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}}),T("h1",{className:"mb-10 text-3xl md:text-3xl lg:text-4xl font-extrabold leading-none tracking-tight text-gray-900   dark:text-black m-4 mt-10 ",children:"Poultry Feed"}),T("hr",{className:"border-0 w-1/2 h-1 bg-white shadow",style:{boxShadow:"0px 0px 5px #14b8a6"}})]}),he("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-center mt-12",children:[T("div",{children:T("img",{src:mH,alt:"feed",className:"rounded-3xl shadow-emerald-300 shadow-md border-2 mx-auto"})}),he("div",{className:"flex flex-col justify-center",children:[T("p",{className:"text-lg lg:text-xl font-normal text-gray-500 dark:text-gray-400",children:"Our poultry feed recommendation app helps farmers determine the most appropriate feed for their chicks, taking into account their breed, age, and nutritional needs. The app provides information on the best type of feed to use for optimal growth and development, as well as tips on how to feed and care for the chicks. By using the app, farmers can ensure that their chicks receive the necessary nutrients to thrive and achieve their full potential. This can result in healthier and more productive birds, which can ultimately lead to increased profits for the farmer. Our poultry feed recommendation app is a valuable tool for any farmer looking to optimize their poultry production and maximize their returns."}),T("div",{className:"card cursor-pointer mt-4",children:T(_r,{to:"/feed",children:T("button",{className:"block mt-4 lg:inline-block lg:mt-0 hover:text-white mr-4  px-6 py-2  text-white bg-[#14b8a6]  rounded-lg hover:bg-[#0f766e]",children:"Poultry Feed"})})})]})]})]})},s2=t=>{const e=qd(),[n,r]=W.useState({email:"",password:"",name:"",state:"",city:""});W.useEffect(()=>{pq(os,l=>{l&&e("/home")})},[]);const s=l=>{r({...n,[l.target.name]:l.target.value})},o=async l=>{l.preventDefault(),hq(os,n.email,n.password).then(()=>{e("/home")}).catch(c=>{alert(c.message)})},i=async l=>{try{const c=await pu(fu(xu,"user"),{name:n.name,email:n.email,state:n.state,city:n.city});alert("User added to database")}catch{}};return T("div",{children:T("form",{onSubmit:async l=>{l.preventDefault();try{const{user:c}=await uq(os,n.email,n.password);i(),e("/")}catch(c){console.error(c)}},children:t.title=="SignUp"?T(_o,{children:T("div",{className:"flex items-center justify-center min-h-screen bg-gray-300 m-auto w-full",children:he("div",{className:"px-8 py-6 mx-4 mt-4 text-left bg-gray-100 rounded-xl shadow-lg md:w-1/3 lg:w-1/3 sm:w-1/3",children:[T("h3",{className:"text-2xl font-bold text-center text-[#115e59]",children:"Sign Up"}),T("div",{children:he("div",{className:"mt-4",children:[T("div",{children:he("label",{className:"block text-lg text-[#0f766e]",children:["Name",T("label",{children:T("input",{type:"text",placeholder:"Name",onChange:l=>s(l),value:n.name,name:"name",required:!0,className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600"})})]})}),T("div",{className:"mt-4",children:he("label",{className:"block text-lg text-[#0f766e]",children:["Email",T("label",{children:T("input",{type:"email",placeholder:"Email",onChange:l=>s(l),value:n.email,name:"email",required:!0,className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600"})})]})}),T("div",{className:"mt-4",children:he("label",{className:"block text-lg text-[#0f766e]",children:["Password",T("label",{children:T("input",{onChange:l=>s(l),value:n.password,name:"password",type:"Password",required:!0,placeholder:"Password",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600"})})]})}),T("div",{className:"mt-4",children:he("label",{className:"block text-lg text-[#0f766e]",children:["State",T("label",{children:T("input",{onChange:l=>s(l),value:n.state,name:"state",type:"text",required:!0,placeholder:"State",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600"})})]})}),T("div",{className:"mt-4",children:he("label",{className:"block text-lg text-[#0f766e]",children:["City",T("label",{children:T("input",{onChange:l=>s(l),value:n.city,name:"city",type:"text",required:!0,placeholder:"City",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600"})})]})}),T("div",{className:"flex",children:T("button",{type:"submit",className:"w-full px-6 py-2 mt-4 text-white bg-[#14b8a6] rounded-lg hover:bg-[#0f766e]",children:"Create Account"})}),he("div",{className:"mt-6 text-grey-dark",children:["Already have an account?",T("a",{className:"text-[#14b8a6] hover:underline",href:"/",children:"Log In"})]})]})})]})})}):T("div",{className:"flex items-center justify-center min-h-screen bg-gray-300 m-auto w-full",children:he("div",{className:"px-8 py-6 mx-4 mt-4 text-left bg-gray-100 rounded-xl shadow-lg md:w-1/3 lg:w-1/3 sm:w-1/3",children:[T("h3",{className:"text-2xl font-bold text-[#115e59] text-center",children:"Log In"}),T("div",{children:he("div",{className:"mt-4",children:[T("div",{className:"mt-4",children:he("label",{className:"block text-lg text-[#0f766e]",children:["Email",T("label",{children:T("input",{type:"email",placeholder:"Email",onChange:l=>s(l),value:n.email,name:"email",required:!0,className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600"})})]})}),T("div",{className:"mt-4",children:he("label",{className:"block text-lg text-[#0f766e]",children:["Password",T("label",{children:T("input",{onChange:l=>s(l),value:n.password,name:"password",type:"Password",required:!0,placeholder:"Password",className:"w-full px-4 py-2 mt-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-600"})})]})}),T("div",{className:"flex",children:T("button",{onClick:o,className:"w-full px-6 py-2 mt-4 text-white bg-[#14b8a6] rounded-lg hover:bg-[#0f766e]",children:"Log In"})}),he("div",{className:"mt-6 text-grey-dark",children:["Don't have an account?",T("a",{className:"text-[#14b8a6] hover:underline",href:"/signup",children:"Sign Up"})]})]})})]})})})})};var LF={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o2=q.createContext&&q.createContext(LF),Pi=globalThis&&globalThis.__assign||function(){return Pi=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},Pi.apply(this,arguments)},RX=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};function MF(t){return t&&t.map(function(e,n){return q.createElement(e.tag,Pi({key:n},e.attr),MF(e.child))})}function zF(t){return function(e){return q.createElement(_X,Pi({attr:Pi({},t.attr)},e),MF(t.child))}}function _X(t){var e=function(n){var r=t.attr,s=t.size,o=t.title,i=RX(t,["attr","size","title"]),a=s||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),q.createElement("svg",Pi({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,i,{className:l,style:Pi(Pi({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),o&&q.createElement("title",null,o),t.children)};return o2!==void 0?q.createElement(o2.Consumer,null,function(n){return e(n)}):e(LF)}const AX=()=>{const t=qd();W.useState(!0);const[e,n]=W.useState("light-theme");W.useState(!1),W.useEffect(()=>{document.body.className=e},[e]);const r=()=>{mq(os).then(()=>{t("/")}).catch(a=>{alert(a.message)})},[s,o]=W.useState(!1);function i(){o(!s)}return he(_o,{children:[he("nav",{className:"flex items-center justify-between flex-wrap bg-gray-800 p-6",children:[T("div",{className:"flex items-center flex-shrink-0 text-white mr-6",children:T(_r,{to:"/",className:"font-semibold text-3xl tracking-tight hover:text-[#14b8a6]",children:"farmSense.ai"})}),T("div",{className:"block lg:hidden",children:T("button",{className:"flex items-center px-3 py-2 border rounded text-gray-200 border-gray-400 hover:text-white hover:border-white",onClick:i,children:he("svg",{className:"fill-current h-3 w-3",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[T("title",{children:"Menu"}),T("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})]})})}),he("div",{className:`${s?"":"hidden"} w-full block ] lg:flex lg:items-center lg:w-auto`,children:[T("div",{className:"text-sm lg:flex-grow",children:T(_r,{to:"/home",className:"block mt-4 lg:inline-block lg:mt-0  text-gray-200 hover:text-[#14b8a6] mr-4 text-lg",children:"Home"})}),T("div",{className:"text-sm lg:flex-grow",children:T(_r,{to:"/dashboard",className:"block mt-4 lg:inline-block lg:mt-0 text-gray-200 hover:text-[#14b8a6] mr-4 text-lg",children:"Dashboard"})}),T("div",{children:os.currentUser?T("button",{className:"block mt-4 lg:inline-block lg:mt-0 hover:text-white mr-4  px-6 py-2  text-white bg-[#14b8a6]  rounded-lg hover:bg-[#0f766e]",onClick:r,children:"Logout"}):T("button",{className:"block mt-4 lg:inline-block lg:mt-0 hover:text-white mr-4  px-6 py-2  text-white bg-[#14b8a6]  rounded-lg hover:bg-[#0f766e]",onClick:()=>{t("/signup")},children:"Register"})})]})]}),T("div",{className:"flex flex-wrap bg-gray-800 justify-center mt-px ",children:he("div",{className:"flex items-center justify-center flex-shrink-0 text-white w-1/2 mb-3 mt-3 ",children:[T("div",{className:"text-sm lg:flex-grow",children:T(_r,{to:"/plant",className:"block mt-4 lg:inline-block lg:mt-0 text-white hover:text-[#14b8a6] hover:underline mr-4 text-lg",children:"Plant"})}),T("div",{className:"text-sm lg:flex-grow",children:T(_r,{to:"/chicken",className:"block mt-4 lg:inline-block lg:mt-0 text-white hover:text-[#14b8a6] hover:underline mr-4 text-lg",children:"Chicken"})}),T("div",{className:"text-sm lg:flex-grow",children:T(_r,{to:"/egg",className:"block mt-4 lg:inline-block lg:mt-0 text-white hover:underline hover:text-[#14b8a6] mr-4 text-lg",children:"Eggs"})}),T("div",{className:"text-sm lg:flex-grow",children:T(_r,{to:"/invasive",className:"block mt-4 lg:inline-block lg:mt-0 text-white hover:underline hover:text-[#14b8a6] mr-4 text-lg",children:"Invasive"})}),T("div",{className:"text-sm lg:flex-grow",children:T(_r,{to:"/feed",className:"block mt-4 lg:inline-block lg:mt-0 text-white hover:text-[#14b8a6] hover:underline mr-4 text-lg",children:"Crops"})})]})})]})};function DX(t,e,n){W.useEffect(()=>{if(!document)return;const r=document.querySelector('script[src="'.concat(t,'"]'));if(r!=null&&r.dataset.loaded){e==null||e();return}const s=r||document.createElement("script");r||(s.src=t);const o=()=>{s.dataset.loaded="1",e==null||e()};return s.addEventListener("load",o),n&&s.addEventListener("error",n),r||document.head.append(s),()=>{s.removeEventListener("load",o),n&&s.removeEventListener("error",n)}},[])}function OX(t){let{chartVersion:e="current",chartPackages:n=["corechart","controls"],chartLanguage:r="en",mapsApiKey:s}=t;const[o,i]=W.useState(null),[a,l]=W.useState(!1);return DX("https://www.gstatic.com/charts/loader.js",()=>{const c=window==null?void 0:window.google;c&&(c.charts.load(e,{packages:n,language:r,mapsApiKey:s}),c.charts.setOnLoadCallback(()=>{i(c)}))},()=>{l(!0)}),[o,a]}function PX(t){let{onLoad:e,onError:n,...r}=t;const[s,o]=OX(r);return W.useEffect(()=>{s&&e&&e(s)},[s]),W.useEffect(()=>{o&&n&&n()},[o]),null}const BF={legend_toggle:!1,options:{},legendToggle:!1,getChartWrapper:()=>{},spreadSheetQueryParameters:{headers:1,gid:1},rootProps:{},chartWrapperParams:{}};let i2=0;const FX=()=>(i2+=1,"reactgooglegraph-".concat(i2)),LX=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],MX=async function(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise((r,s)=>{const o="".concat(n.headers?"headers=".concat(n.headers):"headers=0"),i="".concat(n.query?"&tq=".concat(encodeURIComponent(n.query)):""),a="".concat(n.gid?"&gid=".concat(n.gid):""),l="".concat(n.sheet?"&sheet=".concat(n.sheet):""),c="".concat(n.access_token?"&access_token=".concat(n.access_token):""),u="".concat(o).concat(a).concat(l).concat(i).concat(c),h="".concat(e,"/gviz/tq?").concat(u);new t.visualization.Query(h).send(f=>{f.isError()?s("Error in query:  ".concat(f.getMessage()," ").concat(f.getDetailedMessage())):r(f.getDataTable())})})},{Provider:zX,Consumer:BX}=W.createContext(BF),UX=t=>{let{children:e,value:n}=t;return W.createElement(zX,{value:n},e)},UF=t=>{let{render:e}=t;return W.createElement(BX,null,n=>e(n))},VX="#CCCCCC";class WX extends W.Component{componentDidMount(){this.draw(this.props),window.addEventListener("resize",this.onResize),(this.props.legend_toggle||this.props.legendToggle)&&this.listenToLegendToggle()}componentWillUnmount(){const{google:e,googleChartWrapper:n}=this.props;window.removeEventListener("resize",this.onResize),e.visualization.events.removeAllListeners(n),n.getChartType()==="Timeline"&&n.getChart()&&n.getChart().clearChart()}componentDidUpdate(){this.draw(this.props)}render(){return null}constructor(...e){super(...e),this.state={hiddenColumns:[]},this.listenToLegendToggle=()=>{const{google:n,googleChartWrapper:r}=this.props;n.visualization.events.addListener(r,"select",()=>{const o=r.getChart().getSelection(),i=r.getDataTable();if(o.length===0||o[0].row||!i)return;const a=o[0].column,l=this.getColumnID(i,a);this.state.hiddenColumns.includes(l)?this.setState(c=>({...c,hiddenColumns:[...c.hiddenColumns.filter(u=>u!==l)]})):this.setState(c=>({...c,hiddenColumns:[...c.hiddenColumns,l]}))})},this.applyFormatters=(n,r)=>{const{google:s}=this.props;for(let o of r)switch(o.type){case"ArrowFormat":{new s.visualization.ArrowFormat(o.options).format(n,o.column);break}case"BarFormat":{new s.visualization.BarFormat(o.options).format(n,o.column);break}case"ColorFormat":{const i=new s.visualization.ColorFormat(o.options),{ranges:a}=o;for(let l of a)i.addRange(...l);i.format(n,o.column);break}case"DateFormat":{new s.visualization.DateFormat(o.options).format(n,o.column);break}case"NumberFormat":{new s.visualization.NumberFormat(o.options).format(n,o.column);break}case"PatternFormat":{new s.visualization.PatternFormat(o.options).format(n,o.column);break}}},this.getColumnID=(n,r)=>n.getColumnId(r)||n.getColumnLabel(r),this.draw=async n=>{let{data:r,diffdata:s,rows:o,columns:i,options:a,legend_toggle:l,legendToggle:c,chartType:u,formatters:h,spreadSheetUrl:d,spreadSheetQueryParameters:f}=n;const{google:p,googleChartWrapper:m}=this.props;let y,g=null;if(s){const b=p.visualization.arrayToDataTable(s.old),w=p.visualization.arrayToDataTable(s.new);g=p.visualization[u].prototype.computeDiff(b,w)}r!==null?Array.isArray(r)?y=p.visualization.arrayToDataTable(r):y=new p.visualization.DataTable(r):o&&i?y=p.visualization.arrayToDataTable([i,...o]):d?y=await MX(p,d,f):y=p.visualization.arrayToDataTable([]);const v=y.getNumberOfColumns();for(let b=0;b<v;b+=1){const w=this.getColumnID(y,b);if(this.state.hiddenColumns.includes(w)){const C=y.getColumnLabel(b),I=y.getColumnId(b),S=y.getColumnType(b);y.removeColumn(b),y.addColumn({label:C,id:I,type:S})}}const x=m.getChart();m.getChartType()==="Timeline"&&x&&x.clearChart(),m.setChartType(u),m.setOptions(a||{}),m.setDataTable(y),m.draw(),this.props.googleChartDashboard!==null&&this.props.googleChartDashboard.draw(y),g&&(m.setDataTable(g),m.draw()),h&&(this.applyFormatters(y,h),m.setDataTable(y),m.draw()),(c===!0||l===!0)&&this.grayOutHiddenColumns({options:a})},this.grayOutHiddenColumns=n=>{let{options:r}=n;const{googleChartWrapper:s}=this.props,o=s.getDataTable();if(!o)return;const i=o.getNumberOfColumns();if(this.state.hiddenColumns.length>0===!1)return;const l=Array.from({length:i-1}).map((c,u)=>{const h=this.getColumnID(o,u+1);return this.state.hiddenColumns.includes(h)?VX:r&&r.colors?r.colors[u]:LX[u]});s.setOptions({...r,colors:l}),s.draw()},this.onResize=()=>{const{googleChartWrapper:n}=this.props;n.draw()}}}class jX extends W.Component{componentDidMount(){}componentWillUnmount(){}shouldComponentUpdate(){return!1}render(){const{google:e,googleChartWrapper:n,googleChartDashboard:r}=this.props;return W.createElement(UF,{render:s=>W.createElement(WX,Object.assign({},s,{google:e,googleChartWrapper:n,googleChartDashboard:r}))})}}class GX extends W.Component{shouldComponentUpdate(){return!1}listenToEvents(e){let{chartEvents:n,google:r,googleChartWrapper:s}=e;if(n){r.visualization.events.removeAllListeners(s);for(let i of n){var o=this;const{eventName:a,callback:l}=i;r.visualization.events.addListener(s,a,function(){for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];l({chartWrapper:s,props:o.props,google:r,eventArgs:u})})}}}render(){const{google:e,googleChartWrapper:n}=this.props;return W.createElement(UF,{render:r=>(this.listenToEvents({chartEvents:r.chartEvents||null,google:e,googleChartWrapper:n}),null)})}}let a2=0;class HX extends W.Component{componentDidMount(){const{options:e,google:n,chartType:r,chartWrapperParams:s,toolbarItems:o,getChartEditor:i,getChartWrapper:a}=this.props,l={chartType:r,options:e,containerId:this.getGraphID(),...s},c=new n.visualization.ChartWrapper(l);c.setOptions(e||{}),a&&a(c,n);const u=new n.visualization.Dashboard(this.dashboard_ref),h=this.addControls(c,u);o&&n.visualization.drawToolbar(this.toolbar_ref.current,o);let d=null;i&&(d=new n.visualization.ChartEditor,i({chartEditor:d,chartWrapper:c,google:n})),this.setState({googleChartEditor:d,googleChartControls:h,googleChartDashboard:u,googleChartWrapper:c,isReady:!0})}componentDidUpdate(){if(!this.state.googleChartWrapper||!this.state.googleChartDashboard||!this.state.googleChartControls)return;const{controls:e}=this.props;if(e)for(let n=0;n<e.length;n+=1){const{controlType:r,options:s,controlWrapperParams:o}=e[n];o&&"state"in o&&this.state.googleChartControls[n].control.setState(o.state),this.state.googleChartControls[n].control.setOptions(s),this.state.googleChartControls[n].control.setControlType(r)}}shouldComponentUpdate(e,n){return this.state.isReady!==n.isReady||e.controls!==this.props.controls}render(){const{width:e,height:n,options:r,style:s}=this.props,o={height:n||r&&r.height,width:e||r&&r.width,...s};return this.props.render?W.createElement("div",{ref:this.dashboard_ref,style:o},W.createElement("div",{ref:this.toolbar_ref,id:"toolbar"}),this.props.render({renderChart:this.renderChart,renderControl:this.renderControl,renderToolbar:this.renderToolBar})):W.createElement("div",{ref:this.dashboard_ref,style:o},this.renderControl(i=>{let{controlProp:a}=i;return a.controlPosition!=="bottom"}),this.renderChart(),this.renderControl(i=>{let{controlProp:a}=i;return a.controlPosition==="bottom"}),this.renderToolBar())}constructor(...e){var n;super(),n=this,this.state={googleChartWrapper:null,googleChartDashboard:null,googleChartControls:null,googleChartEditor:null,isReady:!1},this.graphID=null,this.dashboard_ref=W.createRef(),this.toolbar_ref=W.createRef(),this.getGraphID=()=>{const{graphID:r,graph_id:s}=this.props;let o;return!r&&!s?this.graphID?o=this.graphID:o=FX():r&&!s?o=r:s&&!r?o=s:o=r,this.graphID=o,this.graphID},this.getControlID=(r,s)=>{a2+=1;let o;return typeof r>"u"?o="googlechart-control-".concat(s,"-").concat(a2):o=r,o},this.addControls=(r,s)=>{const{google:o,controls:i}=this.props,a=i?i.map((c,u)=>{const{controlID:h,controlType:d,options:f,controlWrapperParams:p}=c,m=this.getControlID(h,u);return{controlProp:c,control:new o.visualization.ControlWrapper({containerId:m,controlType:d,options:f,...p})}}):null;if(!a)return null;s.bind(a.map(c=>{let{control:u}=c;return u}),r);for(let c of a){const{control:u,controlProp:h}=c,{controlEvents:d=[]}=h;for(let f of d){var l=this;const{callback:p,eventName:m}=f;o.visualization.events.removeListener(u,m,p),o.visualization.events.addListener(u,m,function(){for(var y=arguments.length,g=new Array(y),v=0;v<y;v++)g[v]=arguments[v];p({chartWrapper:r,controlWrapper:u,props:l.props,google:o,eventArgs:g})})}}return a},this.renderChart=()=>{const{width:r,height:s,options:o,style:i,className:a,rootProps:l,google:c}=this.props,u={height:s||o&&o.height,width:r||o&&o.width,...i};return W.createElement("div",Object.assign({id:this.getGraphID(),style:u,className:a},l),this.state.isReady&&this.state.googleChartWrapper!==null?W.createElement(W.Fragment,null,W.createElement(jX,{googleChartWrapper:this.state.googleChartWrapper,google:c,googleChartDashboard:this.state.googleChartDashboard}),W.createElement(GX,{googleChartWrapper:this.state.googleChartWrapper,google:c})):null)},this.renderControl=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s=>!0;return n.state.isReady&&n.state.googleChartControls!==null?W.createElement(W.Fragment,null,n.state.googleChartControls.filter(s=>{let{controlProp:o,control:i}=s;return r({control:i,controlProp:o})}).map(s=>{let{control:o,controlProp:i}=s;return W.createElement("div",{key:o.getContainerId(),id:o.getContainerId()})})):null},this.renderToolBar=()=>this.props.toolbarItems?W.createElement("div",{ref:this.toolbar_ref}):null}}class PS extends W.Component{render(){const{chartLanguage:e,chartPackages:n,chartVersion:r,mapsApiKey:s,loader:o,errorElement:i}=this.props;return W.createElement(UX,{value:this.props},this.state.loadingStatus==="ready"&&this.state.google!==null?W.createElement(HX,Object.assign({},this.props,{google:this.state.google})):this.state.loadingStatus==="errored"&&i?i:o,W.createElement(PX,{chartLanguage:e,chartPackages:n,chartVersion:r,mapsApiKey:s,onLoad:this.onLoad,onError:this.onError}))}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}isFullyLoaded(e){const{controls:n,toolbarItems:r,getChartEditor:s}=this.props;return e&&e.visualization&&e.visualization.ChartWrapper&&e.visualization.Dashboard&&(!n||e.visualization.ChartWrapper)&&(!s||e.visualization.ChartEditor)&&(!r||e.visualization.drawToolbar)}constructor(...e){super(...e),this._isMounted=!1,this.state={loadingStatus:"loading",google:null},this.onLoad=n=>{if(this.props.onLoad&&this.props.onLoad(n),this.isFullyLoaded(n))this.onSuccess(n);else{const r=setInterval(()=>{const s=window.google;this._isMounted?s&&this.isFullyLoaded(s)&&(clearInterval(r),this.onSuccess(s)):clearInterval(r)},1e3)}},this.onSuccess=n=>{this.setState({loadingStatus:"ready",google:n})},this.onError=()=>{this.setState({loadingStatus:"errored"})}}}PS.defaultProps=BF;var l2;(function(t){t.annotation="annotation",t.annotationText="annotationText",t.certainty="certainty",t.emphasis="emphasis",t.interval="interval",t.scope="scope",t.style="style",t.tooltip="tooltip",t.domain="domain"})(l2||(l2={}));const KX=[["Task","Hours per Day"],["Work",1],["Eat",2],["Commute",2],["Watch TV",2],["Sleep",7]],qX={title:"Animal Disease"},XX=()=>T(PS,{chartType:"PieChart",data:KX,options:qX,width:"100%",height:"400px"}),YX=[["Task","Hours per Day"],["Work",1],["Eat",2],["Commute",2],["Watch TV",2],["Sleep",7]],QX={title:"Plant Disease"},JX=()=>T(PS,{chartType:"PieChart",data:YX,options:QX,width:"100%",height:"400px"}),ZX=()=>{const t=qd();W.useEffect(()=>{os.currentUser||t("/")},[]);const e=[{name:"John Doe",time:"10:30 AM",city:"New York",disease:"Dutch Elm Disease"},{name:"Jane Smith",time:"2:45 PM",city:"Los Angeles",disease:"Late Blight"},{name:"David Johnson",time:"4:15 PM",city:"Chicago",disease:"Citrus Greening"}],n=[{name:"Emily Davis",time:"9:00 AM",city:"Seattle",disease:"Avian Influenza"},{name:"Ryan Lee",time:"11:30 AM",city:"Miami",disease:"Marek's Disease"},{name:"Avery Johnson",time:"3:45 PM",city:"Dallas",disease:"Coccidiosis"}],[r,s]=W.useState("Animal"),[o,i]=W.useState(!1);return he("div",{className:" container mx-auto my-8",children:[he("div",{className:"tableTitle",children:[he("h1",{className:"lg:text-2xl text-xl textcolor font-bold mb-4  flex items-center justify-center",children:["Dashboard:-",r]}),he("button",{className:"bg-[#0f766e] text-white hover:bg-[#14b8a6] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center mb-5",onClick:()=>{i(!o),s(o?"Animal":"Plant")},children:["Toggle To  ",r," Table"]})]}),o?he(_o,{children:[T("div",{className:"bg-white shadow-md rounded-md overflow-hidden",children:T("div",{className:"overflow-x-auto",children:he("table",{className:"w-full table-auto",children:[T("thead",{children:he("tr",{children:[T("th",{className:"px-4 py-2",children:"Person Name"}),T("th",{className:"px-4 py-2 sm:w-1/4",children:"Time"}),T("th",{className:"px-4 py-2 sm:w-1/4",children:"City"}),T("th",{className:"px-4 py-2 sm:w-1/4",children:"Disease Found"})]})}),T("tbody",{children:e.map((l,c)=>he("tr",{children:[T("td",{className:"border px-4 py-2",children:l.name}),T("td",{className:"border px-4 py-2 sm:w-1/4",children:l.time}),T("td",{className:"border px-4 py-2 sm:w-1/4",children:l.city}),T("td",{className:"border px-4 py-2 sm:w-1/4",children:l.disease})]},c))})]})})}),T(JX,{})]}):he(_o,{children:[T("div",{className:"bg-white shadow-md rounded-md overflow-hidden",children:T("div",{className:"overflow-x-auto",children:he("table",{className:"w-full table-auto",children:[T("thead",{children:he("tr",{children:[T("th",{className:"px-4 py-2",children:"Person Name"}),T("th",{className:"px-4 py-2 sm:w-1/4",children:"Time"}),T("th",{className:"px-4 py-2 sm:w-1/4",children:"City"}),T("th",{className:"px-4 py-2 sm:w-1/4",children:"Disease Found"})]})}),T("tbody",{children:n.map((l,c)=>he("tr",{children:[T("td",{className:"border px-4 py-2",children:l.name}),T("td",{className:"border px-4 py-2 sm:w-1/4",children:l.time}),T("td",{className:"border px-4 py-2 sm:w-1/4",children:l.city}),T("td",{className:"border px-4 py-2 sm:w-1/4",children:l.disease})]},c))})]})})}),he("div",{children:[T(XX,{}),T("barChartChicken",{})]})]})]})};var ae={},e7={get exports(){return ae},set exports(t){ae=t}},t7="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",n7=t7,r7=n7;function VF(){}function WF(){}WF.resetWarningCache=VF;var s7=function(){function t(r,s,o,i,a,l){if(l!==r7){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:WF,resetWarningCache:VF};return n.PropTypes=n,n};e7.exports=s7();var ke="cs",iw={},o7={get exports(){return iw},set exports(t){iw=t}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],s=0;s<arguments.length;s++){var o=arguments[s];if(o){var i=typeof o;if(i==="string"||i==="number")r.push(o);else if(Array.isArray(o)){if(o.length){var a=n.apply(null,o);a&&r.push(a)}}else if(i==="object"){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var l in o)e.call(o,l)&&o[l]&&r.push(l)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(o7);const Be=iw;var jF=["available","unavailable","away","dnd","invisible","eager"],GF=["xs","sm","md","lg","fluid"];function pd(t){return pd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pd(t)}var i7=["status","size","className","name","selected","children"];function aw(){return aw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},aw.apply(this,arguments)}function c2(t,e,n){return e=a7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a7(t){var e=l7(t,"string");return pd(e)==="symbol"?e:String(e)}function l7(t,e){if(pd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(pd(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function c7(t,e){if(t==null)return{};var n=u7(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function u7(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var FS=function(e){var n=e.status,r=e.size,s=e.className,o=e.name,i=e.selected,a=e.children,l=c7(e,i7),c="".concat(ke,"-status"),u=q.createElement("div",{className:"".concat(c,"__bullet")}),h=o||a;return q.createElement("div",aw({},l,{"aria-selected":i===!0?"":null,className:Be(c,"".concat(c,"--").concat(r),"".concat(c,"--").concat(n),c2({},"".concat(c,"--selected"),i),c2({},"".concat(c,"--named"),h),s)}),u,h&&q.createElement("div",{className:"".concat(c,"__name")},o||a))};FS.defaultProps={size:"md"};function md(t){return md=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},md(t)}var h7=["name","src","size","status","className","active","children"];function lw(){return lw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lw.apply(this,arguments)}function d7(t,e,n){return e=f7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f7(t){var e=p7(t,"string");return md(e)==="symbol"?e:String(e)}function p7(t,e){if(md(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(md(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m7(t,e){if(t==null)return{};var n=g7(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function g7(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function LS(t,e){var n=t.name,r=t.src,s=t.size,o=t.status,i=t.className,a=t.active,l=t.children,c=m7(t,h7),u="".concat(ke,"-avatar"),h=typeof s<"u"?" ".concat(u,"--").concat(s):"",d=W.useRef();return W.useImperativeHandle(e,function(){return{focus:function(){return d.current.focus()}}}),q.createElement("div",lw({ref:d},c,{className:Be("".concat(u).concat(h),d7({},"".concat(u,"--active"),a),i)}),l||q.createElement(q.Fragment,null,q.createElement("img",{src:r,alt:n}),typeof o=="string"&&q.createElement(FS,{status:o,size:s})," "))}var bu=W.forwardRef(LS);bu.displayName="Avatar";bu.propTypes={children:ae.node,name:ae.string,src:ae.string,size:ae.oneOf(GF),status:ae.oneOf(jF),active:ae.bool,className:ae.string};LS.defaultProps={name:"",src:"",size:"md",active:!1};bu.defaultProps=LS.defaultProps;function u2(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function hm(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?u2(Object(n),!0).forEach(function(r){y7(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u2(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function y7(t,e,n){return e=v7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v7(t){var e=x7(t,"string");return Gi(e)==="symbol"?e:String(e)}function x7(t,e){if(Gi(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Gi(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gi(t){return Gi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gi(t)}var Km=function(){},b7=function(e){return e==null||Array.isArray(e)&&e.length===0},mf=function(e,n){var r=[],s=n.map(function(o){return o.displayName||o.name});return q.Children.toArray(e).forEach(function(o){var i=n.indexOf(o.type);if(i!==-1)r[i]=o;else{var a,l,c,u=(a=o==null||(l=o.props)===null||l===void 0?void 0:l.as)!==null&&a!==void 0?a:o==null||(c=o.props)===null||c===void 0?void 0:c.is,h=Gi(u);if(h==="function"){var d=n.indexOf(u);d!==-1&&(r[d]=q.cloneElement(o,hm(hm({},o.props),{},{as:null})))}else if(h==="object"){var f=u.name||u.displayName,p=s.indexOf(f);p!==-1&&(r[p]=q.cloneElement(o,hm(hm({},o.props),{},{as:null})))}else if(h==="string"){var m=s.indexOf(u);m!==-1&&(r[m]=o)}}}),r},HF=function(e){if(typeof e=="string")return e;if("type"in e){var n=Gi(e.type);if(n==="function"||n==="object"){if("displayName"in e.type)return e.type.displayName;if("name"in e.type)return e.type.name}else if(n==="string")return e.type;return"undefined"}return"undefined"},KF=function(e){return function(n,r,s){var o=e.map(function(u){return u.name||u.displayName}),i=q.Children.toArray(n[r]).find(function(u){if(typeof u=="string"&&u.trim().length===0)return!1;if(e.indexOf(u.type)===-1){var h,d,f=(u==null||(h=u.props)===null||h===void 0?void 0:h.as)||(u==null||(d=u.props)===null||d===void 0?void 0:d.is),p=Gi(f);if(p==="function")return e.indexOf(f)===-1;if(p==="object"){var m=f.name||f.displayName;return o.indexOf(m)===-1}else return p==="string"?o.indexOf(f)===-1:!0}});if(typeof i<"u"){var a=HF(i),l=e.map(function(u){return u.name||u.displayName}).join(", "),c='"'.concat(a,'" is not a valid child for ').concat(s,". Allowed types: ").concat(l);return new Error(c)}}},w7=["children","size","className","max","activeIndex","hoverToFront"];function cw(){return cw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cw.apply(this,arguments)}function C7(t,e){if(t==null)return{};var n=I7(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function I7(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var MS=function(e){var n=e.children,r=e.size,s=e.className,o=e.max,i=e.activeIndex,a=e.hoverToFront,l=C7(e,w7),c="".concat(ke,"-avatar-group"),u=typeof o=="number"&&q.Children.count(n)>o?q.Children.toArray(n).reverse().slice(0,o):q.Children.toArray(n).reverse(),h=typeof i=="number"?u.length-i-1:void 0;return q.createElement("div",cw({},l,{className:Be(c,"".concat(c,"--").concat(r),s)}),u.map(function(d,f){var p=typeof h=="number"?{active:h===f}:{};return a===!0&&(p.className=Be("".concat(ke,"-avatar--active-on-hover"),d.props.className)),q.cloneElement(d,p)}))};MS.displayName="AvatarGroup";MS.defaultProps={size:"md"};var S7=["children","className","icon","border","labelPosition"];function uw(){return uw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},uw.apply(this,arguments)}function k7(t,e){if(t==null)return{};var n=$7(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function $7(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var kv=function(e){var n=e.children,r=e.className,s=e.icon,o=e.border,i=e.labelPosition,a=k7(e,S7),l="".concat(ke,"-button"),c=typeof i<"u"?i:"right",u=q.Children.count(n)>0?"".concat(l,"--").concat(c):"",h=o===!0?"".concat(l,"--border"):"";return q.createElement("button",uw({},a,{className:Be(l,u,h,r)}),c==="left"&&n,s,c==="right"&&n)};kv.defaultProps={children:void 0,className:"",icon:void 0,labelPosition:void 0,border:!1};/*!
 * Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 */function _h(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_h=function(e){return typeof e}:_h=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_h(t)}function E7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function N7(t,e,n){return e&&h2(t.prototype,e),n&&h2(t,n),t}function T7(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Je(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),r.forEach(function(s){T7(t,s,n[s])})}return t}function qF(t,e){return R7(t)||_7(t,e)||A7()}function R7(t){if(Array.isArray(t))return t}function _7(t,e){var n=[],r=!0,s=!1,o=void 0;try{for(var i=t[Symbol.iterator](),a;!(r=(a=i.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(l){s=!0,o=l}finally{try{!r&&i.return!=null&&i.return()}finally{if(s)throw o}}return n}function A7(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var d2=function(){},zS={},XF={},D7=null,YF={mark:d2,measure:d2};try{typeof window<"u"&&(zS=window),typeof document<"u"&&(XF=document),typeof MutationObserver<"u"&&(D7=MutationObserver),typeof performance<"u"&&(YF=performance)}catch{}var O7=zS.navigator||{},f2=O7.userAgent,p2=f2===void 0?"":f2,$v=zS,rr=XF,dm=YF;$v.document;var BS=!!rr.documentElement&&!!rr.head&&typeof rr.addEventListener=="function"&&typeof rr.createElement=="function";~p2.indexOf("MSIE")||~p2.indexOf("Trident/");var zo="___FONT_AWESOME___",QF="fa",JF="svg-inline--fa",P7="data-fa-i2svg";(function(){try{return!0}catch{return!1}})();var db={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},ZF=$v.FontAwesomeConfig||{};function F7(t){var e=rr.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}function L7(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}if(rr&&typeof rr.querySelector=="function"){var M7=[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];M7.forEach(function(t){var e=qF(t,2),n=e[0],r=e[1],s=L7(F7(n));s!=null&&(ZF[r]=s)})}var z7={familyPrefix:QF,replacementClass:JF,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},hw=Je({},z7,ZF);hw.autoReplaceSvg||(hw.observeMutations=!1);var Lr=Je({},hw);$v.FontAwesomeConfig=Lr;var Bo=$v||{};Bo[zo]||(Bo[zo]={});Bo[zo].styles||(Bo[zo].styles={});Bo[zo].hooks||(Bo[zo].hooks={});Bo[zo].shims||(Bo[zo].shims=[]);var Xs=Bo[zo],B7=[],U7=function t(){rr.removeEventListener("DOMContentLoaded",t),dw=1,B7.map(function(e){return e()})},dw=!1;BS&&(dw=(rr.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(rr.readyState),dw||rr.addEventListener("DOMContentLoaded",U7));var US="pending",eL="settled",Xg="fulfilled",Yg="rejected",V7=function(){},tL=typeof global<"u"&&typeof global.process<"u"&&typeof global.process.emit=="function",W7=typeof setImmediate>"u"?setTimeout:setImmediate,lh=[],fw;function j7(){for(var t=0;t<lh.length;t++)lh[t][0](lh[t][1]);lh=[],fw=!1}function Qg(t,e){lh.push([t,e]),fw||(fw=!0,W7(j7,0))}function G7(t,e){function n(s){VS(e,s)}function r(s){gd(e,s)}try{t(n,r)}catch(s){r(s)}}function nL(t){var e=t.owner,n=e._state,r=e._data,s=t[n],o=t.then;if(typeof s=="function"){n=Xg;try{r=s(r)}catch(i){gd(o,i)}}rL(o,r)||(n===Xg&&VS(o,r),n===Yg&&gd(o,r))}function rL(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&(typeof e=="function"||_h(e)==="object")){var r=e.then;if(typeof r=="function")return r.call(e,function(s){n||(n=!0,e===s?sL(t,s):VS(t,s))},function(s){n||(n=!0,gd(t,s))}),!0}}catch(s){return n||gd(t,s),!0}return!1}function VS(t,e){(t===e||!rL(t,e))&&sL(t,e)}function sL(t,e){t._state===US&&(t._state=eL,t._data=e,Qg(H7,t))}function gd(t,e){t._state===US&&(t._state=eL,t._data=e,Qg(K7,t))}function oL(t){t._then=t._then.forEach(nL)}function H7(t){t._state=Xg,oL(t)}function K7(t){t._state=Yg,oL(t),!t._handled&&tL&&global.process.emit("unhandledRejection",t._data,t)}function q7(t){global.process.emit("rejectionHandled",t)}function is(t){if(typeof t!="function")throw new TypeError("Promise resolver "+t+" is not a function");if(!(this instanceof is))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],G7(t,this)}is.prototype={constructor:is,_state:US,_then:null,_data:void 0,_handled:!1,then:function(e,n){var r={owner:this,then:new this.constructor(V7),fulfilled:e,rejected:n};return(n||e)&&!this._handled&&(this._handled=!0,this._state===Yg&&tL&&Qg(q7,this)),this._state===Xg||this._state===Yg?Qg(nL,r):this._then.push(r),r.then},catch:function(e){return this.then(null,e)}};is.all=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new is(function(e,n){var r=[],s=0;function o(l){return s++,function(c){r[l]=c,--s||e(r)}}for(var i=0,a;i<t.length;i++)a=t[i],a&&typeof a.then=="function"?a.then(o(i),n):r[i]=a;s||e(r)})};is.race=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new is(function(e,n){for(var r=0,s;r<t.length;r++)s=t[r],s&&typeof s.then=="function"?s.then(e,n):e(s)})};is.resolve=function(t){return t&&_h(t)==="object"&&t.constructor===is?t:new is(function(e){e(t)})};is.reject=function(t){return new is(function(e,n){n(t)})};var nc={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function X7(t){if(!(!t||!BS)){var e=rr.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;for(var n=rr.head.childNodes,r=null,s=n.length-1;s>-1;s--){var o=n[s],i=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(i)>-1&&(r=o)}return rr.head.insertBefore(e,r),t}}var Y7="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Jg(){for(var t=12,e="";t-- >0;)e+=Y7[Math.random()*62|0];return e}function iL(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Q7(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,'="').concat(iL(t[n]),'" ')},"").trim()}function aL(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,": ").concat(t[n],";")},"")}function lL(t){return t.size!==nc.size||t.x!==nc.x||t.y!==nc.y||t.rotate!==nc.rotate||t.flipX||t.flipY}function cL(t){var e=t.transform,n=t.containerWidth,r=t.iconWidth,s={transform:"translate(".concat(n/2," 256)")},o="translate(".concat(e.x*32,", ").concat(e.y*32,") "),i="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)"),l={transform:"".concat(o," ").concat(i," ").concat(a)},c={transform:"translate(".concat(r/2*-1," -256)")};return{outer:s,inner:l,path:c}}var fb={x:0,y:0,width:"100%",height:"100%"};function m2(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function J7(t){return t.tag==="g"?t.children:[t]}function Z7(t){var e=t.children,n=t.attributes,r=t.main,s=t.mask,o=t.maskId,i=t.transform,a=r.width,l=r.icon,c=s.width,u=s.icon,h=cL({transform:i,containerWidth:c,iconWidth:a}),d={tag:"rect",attributes:Je({},fb,{fill:"white"})},f=l.children?{children:l.children.map(m2)}:{},p={tag:"g",attributes:Je({},h.inner),children:[m2(Je({tag:l.tag,attributes:Je({},l.attributes,h.path)},f))]},m={tag:"g",attributes:Je({},h.outer),children:[p]},y="mask-".concat(o||Jg()),g="clip-".concat(o||Jg()),v={tag:"mask",attributes:Je({},fb,{id:y,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[d,m]},x={tag:"defs",children:[{tag:"clipPath",attributes:{id:g},children:J7(u)},v]};return e.push(x,{tag:"rect",attributes:Je({fill:"currentColor","clip-path":"url(#".concat(g,")"),mask:"url(#".concat(y,")")},fb)}),{children:e,attributes:n}}function eY(t){var e=t.children,n=t.attributes,r=t.main,s=t.transform,o=t.styles,i=aL(o);if(i.length>0&&(n.style=i),lL(s)){var a=cL({transform:s,containerWidth:r.width,iconWidth:r.width});e.push({tag:"g",attributes:Je({},a.outer),children:[{tag:"g",attributes:Je({},a.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:Je({},r.icon.attributes,a.path)}]}]})}else e.push(r.icon);return{children:e,attributes:n}}function tY(t){var e=t.children,n=t.main,r=t.mask,s=t.attributes,o=t.styles,i=t.transform;if(lL(i)&&n.found&&!r.found){var a=n.width,l=n.height,c={x:a/l/2,y:.5};s.style=aL(Je({},o,{"transform-origin":"".concat(c.x+i.x/16,"em ").concat(c.y+i.y/16,"em")}))}return[{tag:"svg",attributes:s,children:e}]}function nY(t){var e=t.prefix,n=t.iconName,r=t.children,s=t.attributes,o=t.symbol,i=o===!0?"".concat(e,"-").concat(Lr.familyPrefix,"-").concat(n):o;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:Je({},s,{id:i}),children:r}]}]}function rY(t){var e=t.icons,n=e.main,r=e.mask,s=t.prefix,o=t.iconName,i=t.transform,a=t.symbol,l=t.title,c=t.maskId,u=t.titleId,h=t.extra,d=t.watchable,f=d===void 0?!1:d,p=r.found?r:n,m=p.width,y=p.height,g=s==="fak",v=g?"":"fa-w-".concat(Math.ceil(m/y*16)),x=[Lr.replacementClass,o?"".concat(Lr.familyPrefix,"-").concat(o):"",v].filter(function(E){return h.classes.indexOf(E)===-1}).filter(function(E){return E!==""||!!E}).concat(h.classes).join(" "),b={children:[],attributes:Je({},h.attributes,{"data-prefix":s,"data-icon":o,class:x,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(m," ").concat(y)})},w=g&&!~h.classes.indexOf("fa-fw")?{width:"".concat(m/y*16*.0625,"em")}:{};f&&(b.attributes[P7]=""),l&&b.children.push({tag:"title",attributes:{id:b.attributes["aria-labelledby"]||"title-".concat(u||Jg())},children:[l]});var C=Je({},b,{prefix:s,iconName:o,main:n,mask:r,maskId:c,transform:i,symbol:a,styles:Je({},w,h.styles)}),I=r.found&&n.found?Z7(C):eY(C),S=I.children,$=I.attributes;return C.children=S,C.attributes=$,a?nY(C):tY(C)}var g2=function(){};Lr.measurePerformance&&dm&&dm.mark&&dm.measure;var sY=function(e,n){return function(r,s,o,i){return e.call(n,r,s,o,i)}},pb=function(e,n,r,s){var o=Object.keys(e),i=o.length,a=s!==void 0?sY(n,s):n,l,c,u;for(r===void 0?(l=1,u=e[o[0]]):(l=0,u=r);l<i;l++)c=o[l],u=a(u,e[c],c,e);return u};function uL(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.skipHooks,s=r===void 0?!1:r,o=Object.keys(e).reduce(function(i,a){var l=e[a],c=!!l.icon;return c?i[l.iconName]=l.icon:i[a]=l,i},{});typeof Xs.hooks.addPack=="function"&&!s?Xs.hooks.addPack(t,o):Xs.styles[t]=Je({},Xs.styles[t]||{},o),t==="fas"&&uL("fa",e)}var y2=Xs.styles,oY=Xs.shims,hL=function(){var e=function(s){return pb(y2,function(o,i,a){return o[a]=pb(i,s,{}),o},{})};e(function(r,s,o){return s[3]&&(r[s[3]]=o),r}),e(function(r,s,o){var i=s[2];return r[o]=o,i.forEach(function(a){r[a]=o}),r});var n="far"in y2;pb(oY,function(r,s){var o=s[0],i=s[1],a=s[2];return i==="far"&&!n&&(i="fas"),r[o]={prefix:i,iconName:a},r},{})};hL();Xs.styles;function v2(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}function dL(t){var e=t.tag,n=t.attributes,r=n===void 0?{}:n,s=t.children,o=s===void 0?[]:s;return typeof t=="string"?iL(t):"<".concat(e," ").concat(Q7(r),">").concat(o.map(dL).join(""),"</").concat(e,">")}var iY=function(e){var n={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e?e.toLowerCase().split(" ").reduce(function(r,s){var o=s.toLowerCase().split("-"),i=o[0],a=o.slice(1).join("-");if(i&&a==="h")return r.flipX=!0,r;if(i&&a==="v")return r.flipY=!0,r;if(a=parseFloat(a),isNaN(a))return r;switch(i){case"grow":r.size=r.size+a;break;case"shrink":r.size=r.size-a;break;case"left":r.x=r.x-a;break;case"right":r.x=r.x+a;break;case"up":r.y=r.y-a;break;case"down":r.y=r.y+a;break;case"rotate":r.rotate=r.rotate+a;break}return r},n):n};function pw(t){this.name="MissingIcon",this.message=t||"Icon unavailable",this.stack=new Error().stack}pw.prototype=Object.create(Error.prototype);pw.prototype.constructor=pw;var Ev={fill:"currentColor"},fL={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};Je({},Ev,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"});var WS=Je({},fL,{attributeName:"opacity"});Je({},Ev,{cx:"256",cy:"364",r:"28"}),Je({},fL,{attributeName:"r",values:"28;14;28;28;14;28;"}),Je({},WS,{values:"1;0;1;1;0;1;"});Je({},Ev,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),Je({},WS,{values:"1;0;0;0;0;1;"});Je({},Ev,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),Je({},WS,{values:"0;0;1;1;0;0;"});Xs.styles;function x2(t){var e=t[0],n=t[1],r=t.slice(4),s=qF(r,1),o=s[0],i=null;return Array.isArray(o)?i={tag:"g",attributes:{class:"".concat(Lr.familyPrefix,"-").concat(db.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Lr.familyPrefix,"-").concat(db.SECONDARY),fill:"currentColor",d:o[0]}},{tag:"path",attributes:{class:"".concat(Lr.familyPrefix,"-").concat(db.PRIMARY),fill:"currentColor",d:o[1]}}]}:i={tag:"path",attributes:{fill:"currentColor",d:o}},{found:!0,width:e,height:n,icon:i}}Xs.styles;var aY=`svg:not(:root).svg-inline--fa {
  overflow: visible;
}

.svg-inline--fa {
  display: inline-block;
  font-size: inherit;
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.225em;
}
.svg-inline--fa.fa-w-1 {
  width: 0.0625em;
}
.svg-inline--fa.fa-w-2 {
  width: 0.125em;
}
.svg-inline--fa.fa-w-3 {
  width: 0.1875em;
}
.svg-inline--fa.fa-w-4 {
  width: 0.25em;
}
.svg-inline--fa.fa-w-5 {
  width: 0.3125em;
}
.svg-inline--fa.fa-w-6 {
  width: 0.375em;
}
.svg-inline--fa.fa-w-7 {
  width: 0.4375em;
}
.svg-inline--fa.fa-w-8 {
  width: 0.5em;
}
.svg-inline--fa.fa-w-9 {
  width: 0.5625em;
}
.svg-inline--fa.fa-w-10 {
  width: 0.625em;
}
.svg-inline--fa.fa-w-11 {
  width: 0.6875em;
}
.svg-inline--fa.fa-w-12 {
  width: 0.75em;
}
.svg-inline--fa.fa-w-13 {
  width: 0.8125em;
}
.svg-inline--fa.fa-w-14 {
  width: 0.875em;
}
.svg-inline--fa.fa-w-15 {
  width: 0.9375em;
}
.svg-inline--fa.fa-w-16 {
  width: 1em;
}
.svg-inline--fa.fa-w-17 {
  width: 1.0625em;
}
.svg-inline--fa.fa-w-18 {
  width: 1.125em;
}
.svg-inline--fa.fa-w-19 {
  width: 1.1875em;
}
.svg-inline--fa.fa-w-20 {
  width: 1.25em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: 0.3em;
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: 0.3em;
  width: auto;
}
.svg-inline--fa.fa-border {
  height: 1.5em;
}
.svg-inline--fa.fa-li {
  width: 2em;
}
.svg-inline--fa.fa-fw {
  width: 1.25em;
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: #ff253a;
  border-radius: 1em;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  color: #fff;
  height: 1.5em;
  line-height: 1;
  max-width: 5em;
  min-width: 1.5em;
  overflow: hidden;
  padding: 0.25em;
  right: 0;
  text-overflow: ellipsis;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: 0;
  right: 0;
  top: auto;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: 0;
  left: 0;
  right: auto;
  top: auto;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  right: 0;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: 0;
  right: auto;
  top: 0;
  -webkit-transform: scale(0.25);
          transform: scale(0.25);
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-lg {
  font-size: 1.3333333333em;
  line-height: 0.75em;
  vertical-align: -0.0667em;
}

.fa-xs {
  font-size: 0.75em;
}

.fa-sm {
  font-size: 0.875em;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: 2.5em;
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: -2em;
  position: absolute;
  text-align: center;
  width: 2em;
  line-height: inherit;
}

.fa-border {
  border: solid 0.08em #eee;
  border-radius: 0.1em;
  padding: 0.2em 0.25em 0.15em;
}

.fa-pull-left {
  float: left;
}

.fa-pull-right {
  float: right;
}

.fa.fa-pull-left,
.fas.fa-pull-left,
.far.fa-pull-left,
.fal.fa-pull-left,
.fab.fa-pull-left {
  margin-right: 0.3em;
}
.fa.fa-pull-right,
.fas.fa-pull-right,
.far.fa-pull-right,
.fal.fa-pull-right,
.fab.fa-pull-right {
  margin-left: 0.3em;
}

.fa-spin {
  -webkit-animation: fa-spin 2s infinite linear;
          animation: fa-spin 2s infinite linear;
}

.fa-pulse {
  -webkit-animation: fa-spin 1s infinite steps(8);
          animation: fa-spin 1s infinite steps(8);
}

@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}

@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {
  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

:root .fa-rotate-90,
:root .fa-rotate-180,
:root .fa-rotate-270,
:root .fa-flip-horizontal,
:root .fa-flip-vertical,
:root .fa-flip-both {
  -webkit-filter: none;
          filter: none;
}

.fa-stack {
  display: inline-block;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: #fff;
}

.sr-only {
  border: 0;
  clip: rect(0, 0, 0, 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

.sr-only-focusable:active, .sr-only-focusable:focus {
  clip: auto;
  height: auto;
  margin: 0;
  overflow: visible;
  position: static;
  width: auto;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: 1;
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: 0.4;
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: 0.4;
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: 1;
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse {
  color: #fff;
}`;function lY(){var t=QF,e=JF,n=Lr.familyPrefix,r=Lr.replacementClass,s=aY;if(n!==t||r!==e){var o=new RegExp("\\.".concat(t,"\\-"),"g"),i=new RegExp("\\--".concat(t,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");s=s.replace(o,".".concat(n,"-")).replace(i,"--".concat(n,"-")).replace(a,".".concat(r))}return s}var cY=function(){function t(){E7(this,t),this.definitions={}}return N7(t,[{key:"add",value:function(){for(var n=this,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];var i=s.reduce(this._pullDefinitions,{});Object.keys(i).forEach(function(a){n.definitions[a]=Je({},n.definitions[a]||{},i[a]),uL(a,i[a]),hL()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(n,r){var s=r.prefix&&r.iconName&&r.icon?{0:r}:r;return Object.keys(s).map(function(o){var i=s[o],a=i.prefix,l=i.iconName,c=i.icon;n[a]||(n[a]={}),n[a][l]=c}),n}}]),t}();function uY(){Lr.autoAddCss&&!w2&&(X7(lY()),w2=!0)}function hY(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(function(r){return dL(r)})}}),Object.defineProperty(t,"node",{get:function(){if(BS){var r=rr.createElement("div");return r.innerHTML=t.html,r.children}}}),t}function b2(t){var e=t.prefix,n=e===void 0?"fa":e,r=t.iconName;if(r)return v2(fY.definitions,n,r)||v2(Xs.styles,n,r)}function dY(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=(e||{}).icon?e:b2(e||{}),s=n.mask;return s&&(s=(s||{}).icon?s:b2(s||{})),t(r,Je({},n,{mask:s}))}}var fY=new cY,w2=!1,mw={transform:function(e){return iY(e)}},pY=dY(function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.transform,r=n===void 0?nc:n,s=e.symbol,o=s===void 0?!1:s,i=e.mask,a=i===void 0?null:i,l=e.maskId,c=l===void 0?null:l,u=e.title,h=u===void 0?null:u,d=e.titleId,f=d===void 0?null:d,p=e.classes,m=p===void 0?[]:p,y=e.attributes,g=y===void 0?{}:y,v=e.styles,x=v===void 0?{}:v;if(t){var b=t.prefix,w=t.iconName,C=t.icon;return hY(Je({type:"icon"},t),function(){return uY(),Lr.autoA11y&&(h?g["aria-labelledby"]="".concat(Lr.replacementClass,"-title-").concat(f||Jg()):(g["aria-hidden"]="true",g.focusable="false")),rY({icons:{main:x2(C),mask:a?x2(a.icon):{found:!1,width:null,height:null,icon:{}}},prefix:b,iconName:w,transform:Je({},nc,r),symbol:o,title:h,maskId:c,titleId:f,extra:{attributes:g,styles:x,classes:m}})})}});function C2(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function yi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?C2(Object(n),!0).forEach(function(r){rc(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C2(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Zg(t){return Zg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zg(t)}function rc(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function pL(t,e){if(t==null)return{};var n=mY(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function gw(t){return gY(t)||yY(t)||vY(t)||xY()}function gY(t){if(Array.isArray(t))return yw(t)}function yY(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function vY(t,e){if(t){if(typeof t=="string")return yw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yw(t,e)}}function yw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function xY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bY(t){var e,n=t.beat,r=t.fade,s=t.beatFade,o=t.bounce,i=t.shake,a=t.flash,l=t.spin,c=t.spinPulse,u=t.spinReverse,h=t.pulse,d=t.fixedWidth,f=t.inverse,p=t.border,m=t.listItem,y=t.flip,g=t.size,v=t.rotation,x=t.pull,b=(e={"fa-beat":n,"fa-fade":r,"fa-beat-fade":s,"fa-bounce":o,"fa-shake":i,"fa-flash":a,"fa-spin":l,"fa-spin-reverse":u,"fa-spin-pulse":c,"fa-pulse":h,"fa-fw":d,"fa-inverse":f,"fa-border":p,"fa-li":m,"fa-flip":y===!0,"fa-flip-horizontal":y==="horizontal"||y==="both","fa-flip-vertical":y==="vertical"||y==="both"},rc(e,"fa-".concat(g),typeof g<"u"&&g!==null),rc(e,"fa-rotate-".concat(v),typeof v<"u"&&v!==null&&v!==0),rc(e,"fa-pull-".concat(x),typeof x<"u"&&x!==null),rc(e,"fa-swap-opacity",t.swapOpacity),e);return Object.keys(b).map(function(w){return b[w]?w:null}).filter(function(w){return w})}function wY(t){return t=t-0,t===t}function mL(t){return wY(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(e,n){return n?n.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))}var CY=["style"];function IY(t){return t.charAt(0).toUpperCase()+t.slice(1)}function SY(t){return t.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,n){var r=n.indexOf(":"),s=mL(n.slice(0,r)),o=n.slice(r+1).trim();return s.startsWith("webkit")?e[IY(s)]=o:e[s]=o,e},{})}function gL(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var r=(e.children||[]).map(function(l){return gL(t,l)}),s=Object.keys(e.attributes||{}).reduce(function(l,c){var u=e.attributes[c];switch(c){case"class":l.attrs.className=u,delete e.attributes.class;break;case"style":l.attrs.style=SY(u);break;default:c.indexOf("aria-")===0||c.indexOf("data-")===0?l.attrs[c.toLowerCase()]=u:l.attrs[mL(c)]=u}return l},{attrs:{}}),o=n.style,i=o===void 0?{}:o,a=pL(n,CY);return s.attrs.style=yi(yi({},s.attrs.style),i),t.apply(void 0,[e.tag,yi(yi({},s.attrs),a)].concat(gw(r)))}var yL=!1;try{yL=!0}catch{}function kY(){if(!yL&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function I2(t){if(t&&Zg(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(mw.icon)return mw.icon(t);if(t===null)return null;if(t&&Zg(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}function mb(t,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?rc({},t,e):{}}var $Y=["forwardedRef"];function co(t){var e=t.forwardedRef,n=pL(t,$Y),r=n.icon,s=n.mask,o=n.symbol,i=n.className,a=n.title,l=n.titleId,c=n.maskId,u=I2(r),h=mb("classes",[].concat(gw(bY(n)),gw(i.split(" ")))),d=mb("transform",typeof n.transform=="string"?mw.transform(n.transform):n.transform),f=mb("mask",I2(s)),p=pY(u,yi(yi(yi(yi({},h),d),f),{},{symbol:o,title:a,titleId:l,maskId:c}));if(!p)return kY("Could not find icon",u),null;var m=p.abstract,y={ref:e};return Object.keys(n).forEach(function(g){co.defaultProps.hasOwnProperty(g)||(y[g]=n[g])}),EY(m[0],y)}co.displayName="FontAwesomeIcon";co.propTypes={beat:ae.bool,border:ae.bool,beatFade:ae.bool,bounce:ae.bool,className:ae.string,fade:ae.bool,flash:ae.bool,mask:ae.oneOfType([ae.object,ae.array,ae.string]),maskId:ae.string,fixedWidth:ae.bool,inverse:ae.bool,flip:ae.oneOf([!0,!1,"horizontal","vertical","both"]),icon:ae.oneOfType([ae.object,ae.array,ae.string]),listItem:ae.bool,pull:ae.oneOf(["right","left"]),pulse:ae.bool,rotation:ae.oneOf([0,90,180,270]),shake:ae.bool,size:ae.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:ae.bool,spinPulse:ae.bool,spinReverse:ae.bool,symbol:ae.oneOfType([ae.bool,ae.string]),title:ae.string,titleId:ae.string,transform:ae.oneOfType([ae.string,ae.object]),swapOpacity:ae.bool};co.defaultProps={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1};var EY=gL.bind(null,q.createElement),vL={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e="fas",n="arrow-up",r=448,s=512,o=[],i="f062",a="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z";t.definition={prefix:e,iconName:n,icon:[r,s,o,i,a]},t.faArrowUp=t.definition,t.prefix=e,t.iconName=n,t.width=r,t.height=s,t.ligatures=o,t.unicode=i,t.svgPathData=a})(vL);var xL={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e="fas",n="arrow-right",r=448,s=512,o=[],i="f061",a="M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z";t.definition={prefix:e,iconName:n,icon:[r,s,o,i,a]},t.faArrowRight=t.definition,t.prefix=e,t.iconName=n,t.width=r,t.height=s,t.ligatures=o,t.unicode=i,t.svgPathData=a})(xL);var bL={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e="fas",n="arrow-down",r=448,s=512,o=[],i="f063",a="M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z";t.definition={prefix:e,iconName:n,icon:[r,s,o,i,a]},t.faArrowDown=t.definition,t.prefix=e,t.iconName=n,t.width=r,t.height=s,t.ligatures=o,t.unicode=i,t.svgPathData=a})(bL);var wL={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e="fas",n="arrow-left",r=448,s=512,o=[],i="f060",a="M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z";t.definition={prefix:e,iconName:n,icon:[r,s,o,i,a]},t.faArrowLeft=t.definition,t.prefix=e,t.iconName=n,t.width=r,t.height=s,t.ligatures=o,t.unicode=i,t.svgPathData=a})(wL);var NY=["className","direction","children"];function vw(){return vw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vw.apply(this,arguments)}function TY(t,e){if(t==null)return{};var n=RY(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function RY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var CL=function(e){var n=e.className,r=e.direction,s=e.children,o=TY(e,NY),i="".concat(ke,"-button--arrow"),a=function(){if(r==="up")return vL.faArrowUp;if(r==="right")return xL.faArrowRight;if(r==="down")return bL.faArrowDown;if(r==="left")return wL.faArrowLeft}();return q.createElement(kv,vw({},o,{className:Be(i,n),icon:q.createElement(co,{icon:a})}),s)};CL.defaultProps={className:"",direction:"right"};var IL={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e="fas",n="ellipsis-v",r=192,s=512,o=[],i="f142",a="M96 184c39.8 0 72 32.2 72 72s-32.2 72-72 72-72-32.2-72-72 32.2-72 72-72zM24 80c0 39.8 32.2 72 72 72s72-32.2 72-72S135.8 8 96 8 24 40.2 24 80zm0 352c0 39.8 32.2 72 72 72s72-32.2 72-72-32.2-72-72-72-72 32.2-72 72z";t.definition={prefix:e,iconName:n,icon:[r,s,o,i,a]},t.faEllipsisV=t.definition,t.prefix=e,t.iconName=n,t.width=r,t.height=s,t.ligatures=o,t.unicode=i,t.svgPathData=a})(IL);var SL={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e="fas",n="paper-plane",r=512,s=512,o=[],i="f1d8",a="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z";t.definition={prefix:e,iconName:n,icon:[r,s,o,i,a]},t.faPaperPlane=t.definition,t.prefix=e,t.iconName=n,t.width=r,t.height=s,t.ligatures=o,t.unicode=i,t.svgPathData=a})(SL);var _Y=["className","children"];function xw(){return xw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xw.apply(this,arguments)}function AY(t,e){if(t==null)return{};var n=DY(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function DY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var kL=function(e){var n=e.className,r=e.children,s=AY(e,_Y),o="".concat(ke,"-button--send");return q.createElement(kv,xw({},s,{className:Be(o,n),icon:q.createElement(co,{icon:SL.faPaperPlane})}),r)};kL.defaultProps={className:""};var $L={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e="fas",n="paperclip",r=448,s=512,o=[],i="f0c6",a="M43.246 466.142c-58.43-60.289-57.341-157.511 1.386-217.581L254.392 34c44.316-45.332 116.351-45.336 160.671 0 43.89 44.894 43.943 117.329 0 162.276L232.214 383.128c-29.855 30.537-78.633 30.111-107.982-.998-28.275-29.97-27.368-77.473 1.452-106.953l143.743-146.835c6.182-6.314 16.312-6.422 22.626-.241l22.861 22.379c6.315 6.182 6.422 16.312.241 22.626L171.427 319.927c-4.932 5.045-5.236 13.428-.648 18.292 4.372 4.634 11.245 4.711 15.688.165l182.849-186.851c19.613-20.062 19.613-52.725-.011-72.798-19.189-19.627-49.957-19.637-69.154 0L90.39 293.295c-34.763 35.56-35.299 93.12-1.191 128.313 34.01 35.093 88.985 35.137 123.058.286l172.06-175.999c6.177-6.319 16.307-6.433 22.626-.256l22.877 22.364c6.319 6.177 6.434 16.307.256 22.626l-172.06 175.998c-59.576 60.938-155.943 60.216-214.77-.485z";t.definition={prefix:e,iconName:n,icon:[r,s,o,i,a]},t.faPaperclip=t.definition,t.prefix=e,t.iconName=n,t.width=r,t.height=s,t.ligatures=o,t.unicode=i,t.svgPathData=a})($L);var OY=["className","children"];function bw(){return bw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bw.apply(this,arguments)}function PY(t,e){if(t==null)return{};var n=FY(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function FY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var EL=function(e){var n=e.className,r=e.children,s=PY(e,OY),o="".concat(ke,"-button--attachment");return q.createElement(kv,bw({},s,{className:Be(o,n),icon:q.createElement(co,{icon:$L.faPaperclip})}),r)};EL.defaultProps={className:""};var LY=["onClick","children","className"];function ww(){return ww=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ww.apply(this,arguments)}function MY(t,e){if(t==null)return{};var n=zY(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function zY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Nv=function(e){var n=e.onClick,r=e.children,s=e.className,o=MY(e,LY),i="".concat(ke,"-conversation-header__back");return q.createElement("div",ww({},o,{className:Be(i,s)}),typeof r<"u"?r:q.createElement(CL,{direction:"left",onClick:n}))};Nv.displayName="ConversationHeader.Back";Nv.defaultProps={children:void 0,onClick:function(){}};var BY=["children","className"];function Cw(){return Cw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Cw.apply(this,arguments)}function UY(t,e){if(t==null)return{};var n=VY(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function VY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Tv=function(e){var n=e.children,r=e.className,s=UY(e,BY),o="".concat(ke,"-conversation-header__actions");return q.createElement("section",Cw({},s,{className:Be(o,r)}),n)};Tv.displayName="ConversationHeader.Actions";Tv.defaultProps={children:void 0};var WY=["userName","info","children","className"];function Iw(){return Iw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Iw.apply(this,arguments)}function jY(t,e){if(t==null)return{};var n=GY(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function GY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Rv=function(e){var n=e.userName,r=e.info,s=e.children,o=e.className,i=jY(e,WY),a="".concat(ke,"-conversation-header__content");return q.createElement("div",Iw({},i,{className:Be(a,o)}),typeof s<"u"?s:q.createElement(q.Fragment,null,q.createElement("div",{className:"".concat(ke,"-conversation-header__user-name")},n),q.createElement("div",{className:"".concat(ke,"-conversation-header__info")},r)))};Rv.displayName="ConversationHeader.Content";Rv.defaultProps={children:void 0,userName:"",info:""};var HY=["children","className"];function Sw(){return Sw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Sw.apply(this,arguments)}function KY(t,e){return QY(t)||YY(t,e)||XY(t,e)||qY()}function qY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XY(t,e){if(t){if(typeof t=="string")return S2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S2(t,e)}}function S2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function YY(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,o,i,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return a}}function QY(t){if(Array.isArray(t))return t}function JY(t,e){if(t==null)return{};var n=ZY(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function ZY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var wu=function(e){var n=e.children,r=e.className,s=JY(e,HY),o="".concat(ke,"-conversation-header"),i=mf(n,[Nv,bu,MS,Rv,Tv]),a=KY(i,5),l=a[0],c=a[1],u=a[2],h=a[3],d=a[4];return q.createElement("div",Sw({},s,{className:Be(o,r)}),l,c&&q.createElement("div",{className:"".concat(o,"__avatar")},c),!c&&u&&q.createElement("div",{className:"".concat(o,"__avatar")},u),h,d)};wu.displayName="ConversationHeader";wu.defaultProps={children:void 0};wu.Back=Nv;wu.Actions=Tv;wu.Content=Rv;/*!
 * perfect-scrollbar v1.5.0
 * Copyright 2020 Hyunje Jun, MDBootstrap and Contributors
 * Licensed under MIT
 */function Ys(t){return getComputedStyle(t)}function mr(t,e){for(var n in e){var r=e[n];typeof r=="number"&&(r=r+"px"),t.style[n]=r}return t}function fm(t){var e=document.createElement("div");return e.className=t,e}var k2=typeof Element<"u"&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function vi(t,e){if(!k2)throw new Error("No element matching method supported");return k2.call(t,e)}function sc(t){t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t)}function $2(t,e){return Array.prototype.filter.call(t.children,function(n){return vi(n,e)})}var qt={main:"ps",rtl:"ps__rtl",element:{thumb:function(e){return"ps__thumb-"+e},rail:function(e){return"ps__rail-"+e},consuming:"ps__child--consume"},state:{focus:"ps--focus",clicking:"ps--clicking",active:function(e){return"ps--active-"+e},scrolling:function(e){return"ps--scrolling-"+e}}},NL={x:null,y:null};function TL(t,e){var n=t.element.classList,r=qt.state.scrolling(e);n.contains(r)?clearTimeout(NL[e]):n.add(r)}function RL(t,e){NL[e]=setTimeout(function(){return t.isAlive&&t.element.classList.remove(qt.state.scrolling(e))},t.settings.scrollingThreshold)}function eQ(t,e){TL(t,e),RL(t,e)}var gf=function(e){this.element=e,this.handlers={}},_L={isEmpty:{configurable:!0}};gf.prototype.bind=function(e,n){typeof this.handlers[e]>"u"&&(this.handlers[e]=[]),this.handlers[e].push(n);var r=["touchstart","wheel","touchmove"];r.indexOf(e)!==-1?this.element.addEventListener(e,n,{passive:!1}):this.element.addEventListener(e,n,!1)};gf.prototype.unbind=function(e,n){var r=this;this.handlers[e]=this.handlers[e].filter(function(s){return n&&s!==n?!0:(r.element.removeEventListener(e,s,!1),!1)})};gf.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)};_L.isEmpty.get=function(){var t=this;return Object.keys(this.handlers).every(function(e){return t.handlers[e].length===0})};Object.defineProperties(gf.prototype,_L);var Cu=function(){this.eventElements=[]};Cu.prototype.eventElement=function(e){var n=this.eventElements.filter(function(r){return r.element===e})[0];return n||(n=new gf(e),this.eventElements.push(n)),n};Cu.prototype.bind=function(e,n,r){this.eventElement(e).bind(n,r)};Cu.prototype.unbind=function(e,n,r){var s=this.eventElement(e);s.unbind(n,r),s.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(s),1)};Cu.prototype.unbindAll=function(){this.eventElements.forEach(function(e){return e.unbindAll()}),this.eventElements=[]};Cu.prototype.once=function(e,n,r){var s=this.eventElement(e),o=function i(a){s.unbind(n,i),r(a)};s.bind(n,o)};function pm(t){if(typeof window.CustomEvent=="function")return new CustomEvent(t);var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,void 0),e}function ey(t,e,n,r,s,o){r===void 0&&(r=!0),s===void 0&&(s=!1);var i;if(e==="top")i=["contentHeight","containerHeight","scrollTop","y","up","down"];else if(e==="left")i=["contentWidth","containerWidth","scrollLeft","x","left","right"];else throw new Error("A proper axis should be provided");tQ(t,n,i,r,s,o)}function tQ(t,e,n,r,s,o){var i=n[0],a=n[1],l=n[2],c=n[3],u=n[4],h=n[5];r===void 0&&(r=!0),s===void 0&&(s=!1);var d=t.element;t.reach[c]=null;var f=o===!0?t[i]!==t[a]:!0;f&&d[l]<1&&(t.reach[c]="start"),f&&d[l]>t[i]-t[a]-1&&(t.reach[c]="end"),e&&(d.dispatchEvent(pm("ps-scroll-"+c)),e<0?d.dispatchEvent(pm("ps-scroll-"+u)):e>0&&d.dispatchEvent(pm("ps-scroll-"+h)),r&&eQ(t,c)),t.reach[c]&&(e||s)&&d.dispatchEvent(pm("ps-"+c+"-reach-"+t.reach[c]))}function Rt(t){return parseInt(t,10)||0}function nQ(t){return vi(t,"input,[contenteditable]")||vi(t,"select,[contenteditable]")||vi(t,"textarea,[contenteditable]")||vi(t,"button,[contenteditable]")}function rQ(t){var e=Ys(t);return Rt(e.width)+Rt(e.paddingLeft)+Rt(e.paddingRight)+Rt(e.borderLeftWidth)+Rt(e.borderRightWidth)}var ch={isWebKit:typeof document<"u"&&"WebkitAppearance"in document.documentElement.style,supportsTouch:typeof window<"u"&&("ontouchstart"in window||"maxTouchPoints"in window.navigator&&window.navigator.maxTouchPoints>0||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:typeof navigator<"u"&&navigator.msMaxTouchPoints,isChrome:typeof navigator<"u"&&/Chrome/i.test(navigator&&navigator.userAgent)};function Uo(t){var e=t.element,n=Math.floor(e.scrollTop),r=e.getBoundingClientRect();t.containerWidth=Math.round(r.width),t.containerHeight=Math.round(r.height),t.contentWidth=e.scrollWidth,t.contentHeight=e.scrollHeight,e.contains(t.scrollbarXRail)||($2(e,qt.element.rail("x")).forEach(function(s){return sc(s)}),e.appendChild(t.scrollbarXRail)),e.contains(t.scrollbarYRail)||($2(e,qt.element.rail("y")).forEach(function(s){return sc(s)}),e.appendChild(t.scrollbarYRail)),!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth?(t.scrollbarXActive=!0,t.railXWidth=t.containerWidth-t.railXMarginWidth,t.railXRatio=t.containerWidth/t.railXWidth,t.scrollbarXWidth=E2(t,Rt(t.railXWidth*t.containerWidth/t.contentWidth)),t.scrollbarXLeft=Rt((t.negativeScrollAdjustment+e.scrollLeft)*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))):t.scrollbarXActive=!1,!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight?(t.scrollbarYActive=!0,t.railYHeight=t.containerHeight-t.railYMarginHeight,t.railYRatio=t.containerHeight/t.railYHeight,t.scrollbarYHeight=E2(t,Rt(t.railYHeight*t.containerHeight/t.contentHeight)),t.scrollbarYTop=Rt(n*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))):t.scrollbarYActive=!1,t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth&&(t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth),t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight&&(t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight),sQ(e,t),t.scrollbarXActive?e.classList.add(qt.state.active("x")):(e.classList.remove(qt.state.active("x")),t.scrollbarXWidth=0,t.scrollbarXLeft=0,e.scrollLeft=t.isRtl===!0?t.contentWidth:0),t.scrollbarYActive?e.classList.add(qt.state.active("y")):(e.classList.remove(qt.state.active("y")),t.scrollbarYHeight=0,t.scrollbarYTop=0,e.scrollTop=0)}function E2(t,e){return t.settings.minScrollbarLength&&(e=Math.max(e,t.settings.minScrollbarLength)),t.settings.maxScrollbarLength&&(e=Math.min(e,t.settings.maxScrollbarLength)),e}function sQ(t,e){var n={width:e.railXWidth},r=Math.floor(t.scrollTop);e.isRtl?n.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth-e.contentWidth:n.left=t.scrollLeft,e.isScrollbarXUsingBottom?n.bottom=e.scrollbarXBottom-r:n.top=e.scrollbarXTop+r,mr(e.scrollbarXRail,n);var s={top:r,height:e.railYHeight};e.isScrollbarYUsingRight?e.isRtl?s.right=e.contentWidth-(e.negativeScrollAdjustment+t.scrollLeft)-e.scrollbarYRight-e.scrollbarYOuterWidth-9:s.right=e.scrollbarYRight-t.scrollLeft:e.isRtl?s.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth*2-e.contentWidth-e.scrollbarYLeft-e.scrollbarYOuterWidth:s.left=e.scrollbarYLeft+t.scrollLeft,mr(e.scrollbarYRail,s),mr(e.scrollbarX,{left:e.scrollbarXLeft,width:e.scrollbarXWidth-e.railBorderXWidth}),mr(e.scrollbarY,{top:e.scrollbarYTop,height:e.scrollbarYHeight-e.railBorderYWidth})}function oQ(t){t.element,t.event.bind(t.scrollbarY,"mousedown",function(e){return e.stopPropagation()}),t.event.bind(t.scrollbarYRail,"mousedown",function(e){var n=e.pageY-window.pageYOffset-t.scrollbarYRail.getBoundingClientRect().top,r=n>t.scrollbarYTop?1:-1;t.element.scrollTop+=r*t.containerHeight,Uo(t),e.stopPropagation()}),t.event.bind(t.scrollbarX,"mousedown",function(e){return e.stopPropagation()}),t.event.bind(t.scrollbarXRail,"mousedown",function(e){var n=e.pageX-window.pageXOffset-t.scrollbarXRail.getBoundingClientRect().left,r=n>t.scrollbarXLeft?1:-1;t.element.scrollLeft+=r*t.containerWidth,Uo(t),e.stopPropagation()})}function iQ(t){N2(t,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]),N2(t,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])}function N2(t,e){var n=e[0],r=e[1],s=e[2],o=e[3],i=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=t.element,d=null,f=null,p=null;function m(v){v.touches&&v.touches[0]&&(v[s]=v.touches[0].pageY),h[l]=d+p*(v[s]-f),TL(t,c),Uo(t),v.stopPropagation(),v.preventDefault()}function y(){RL(t,c),t[u].classList.remove(qt.state.clicking),t.event.unbind(t.ownerDocument,"mousemove",m)}function g(v,x){d=h[l],x&&v.touches&&(v[s]=v.touches[0].pageY),f=v[s],p=(t[r]-t[n])/(t[o]-t[a]),x?t.event.bind(t.ownerDocument,"touchmove",m):(t.event.bind(t.ownerDocument,"mousemove",m),t.event.once(t.ownerDocument,"mouseup",y),v.preventDefault()),t[u].classList.add(qt.state.clicking),v.stopPropagation()}t.event.bind(t[i],"mousedown",function(v){g(v)}),t.event.bind(t[i],"touchstart",function(v){g(v,!0)})}function aQ(t){var e=t.element,n=function(){return vi(e,":hover")},r=function(){return vi(t.scrollbarX,":focus")||vi(t.scrollbarY,":focus")};function s(o,i){var a=Math.floor(e.scrollTop);if(o===0){if(!t.scrollbarYActive)return!1;if(a===0&&i>0||a>=t.contentHeight-t.containerHeight&&i<0)return!t.settings.wheelPropagation}var l=e.scrollLeft;if(i===0){if(!t.scrollbarXActive)return!1;if(l===0&&o<0||l>=t.contentWidth-t.containerWidth&&o>0)return!t.settings.wheelPropagation}return!0}t.event.bind(t.ownerDocument,"keydown",function(o){if(!(o.isDefaultPrevented&&o.isDefaultPrevented()||o.defaultPrevented)&&!(!n()&&!r())){var i=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(i){if(i.tagName==="IFRAME")i=i.contentDocument.activeElement;else for(;i.shadowRoot;)i=i.shadowRoot.activeElement;if(nQ(i))return}var a=0,l=0;switch(o.which){case 37:o.metaKey?a=-t.contentWidth:o.altKey?a=-t.containerWidth:a=-30;break;case 38:o.metaKey?l=t.contentHeight:o.altKey?l=t.containerHeight:l=30;break;case 39:o.metaKey?a=t.contentWidth:o.altKey?a=t.containerWidth:a=30;break;case 40:o.metaKey?l=-t.contentHeight:o.altKey?l=-t.containerHeight:l=-30;break;case 32:o.shiftKey?l=t.containerHeight:l=-t.containerHeight;break;case 33:l=t.containerHeight;break;case 34:l=-t.containerHeight;break;case 36:l=t.contentHeight;break;case 35:l=-t.contentHeight;break;default:return}t.settings.suppressScrollX&&a!==0||t.settings.suppressScrollY&&l!==0||(e.scrollTop-=l,e.scrollLeft+=a,Uo(t),s(a,l)&&o.preventDefault())}})}function lQ(t){var e=t.element;function n(i,a){var l=Math.floor(e.scrollTop),c=e.scrollTop===0,u=l+e.offsetHeight===e.scrollHeight,h=e.scrollLeft===0,d=e.scrollLeft+e.offsetWidth===e.scrollWidth,f;return Math.abs(a)>Math.abs(i)?f=c||u:f=h||d,f?!t.settings.wheelPropagation:!0}function r(i){var a=i.deltaX,l=-1*i.deltaY;return(typeof a>"u"||typeof l>"u")&&(a=-1*i.wheelDeltaX/6,l=i.wheelDeltaY/6),i.deltaMode&&i.deltaMode===1&&(a*=10,l*=10),a!==a&&l!==l&&(a=0,l=i.wheelDelta),i.shiftKey?[-l,-a]:[a,l]}function s(i,a,l){if(!ch.isWebKit&&e.querySelector("select:focus"))return!0;if(!e.contains(i))return!1;for(var c=i;c&&c!==e;){if(c.classList.contains(qt.element.consuming))return!0;var u=Ys(c);if(l&&u.overflowY.match(/(scroll|auto)/)){var h=c.scrollHeight-c.clientHeight;if(h>0&&(c.scrollTop>0&&l<0||c.scrollTop<h&&l>0))return!0}if(a&&u.overflowX.match(/(scroll|auto)/)){var d=c.scrollWidth-c.clientWidth;if(d>0&&(c.scrollLeft>0&&a<0||c.scrollLeft<d&&a>0))return!0}c=c.parentNode}return!1}function o(i){var a=r(i),l=a[0],c=a[1];if(!s(i.target,l,c)){var u=!1;t.settings.useBothWheelAxes?t.scrollbarYActive&&!t.scrollbarXActive?(c?e.scrollTop-=c*t.settings.wheelSpeed:e.scrollTop+=l*t.settings.wheelSpeed,u=!0):t.scrollbarXActive&&!t.scrollbarYActive&&(l?e.scrollLeft+=l*t.settings.wheelSpeed:e.scrollLeft-=c*t.settings.wheelSpeed,u=!0):(e.scrollTop-=c*t.settings.wheelSpeed,e.scrollLeft+=l*t.settings.wheelSpeed),Uo(t),u=u||n(l,c),u&&!i.ctrlKey&&(i.stopPropagation(),i.preventDefault())}}typeof window.onwheel<"u"?t.event.bind(e,"wheel",o):typeof window.onmousewheel<"u"&&t.event.bind(e,"mousewheel",o)}function cQ(t){if(!ch.supportsTouch&&!ch.supportsIePointer)return;var e=t.element;function n(p,m){var y=Math.floor(e.scrollTop),g=Math.ceil(e.scrollLeft),v=Math.abs(p),x=Math.abs(m);if(!t.settings.wheelPropagation)return!0;if(x>v){if(t.settings.suppressScrollY)return!1;if(m>0)return y!==0;if(m<0)return y<t.contentHeight-t.containerHeight}else if(v>x){if(t.settings.suppressScrollX)return!1;if(p>0)return g!==0;if(m<0)return g<t.contentWidth-t.containerWidth}return!0}function r(p,m){e.scrollTop-=m,e.scrollLeft-=p,Uo(t)}var s={},o=0,i={},a=null;function l(p){return p.targetTouches?p.targetTouches[0]:p}function c(p){return p.pointerType&&p.pointerType==="pen"&&p.buttons===0?!1:!!(p.targetTouches&&p.targetTouches.length===1||p.pointerType&&p.pointerType!=="mouse"&&p.pointerType!==p.MSPOINTER_TYPE_MOUSE)}function u(p){if(c(p)){var m=l(p);s.pageX=m.pageX,s.pageY=m.pageY,o=new Date().getTime(),a!==null&&clearInterval(a)}}function h(p,m,y){if(!e.contains(p))return!1;for(var g=p;g&&g!==e;){if(g.classList.contains(qt.element.consuming))return!0;var v=Ys(g);if(y&&v.overflowY.match(/(scroll|auto)/)){var x=g.scrollHeight-g.clientHeight;if(x>0&&(g.scrollTop>0&&y<0||g.scrollTop<x&&y>0))return!0}if(m&&v.overflowX.match(/(scroll|auto)/)){var b=g.scrollWidth-g.clientWidth;if(b>0&&(g.scrollLeft>0&&m<0||g.scrollLeft<b&&m>0))return!0}g=g.parentNode}return!1}function d(p){if(c(p)){var m=l(p),y={pageX:m.pageX,pageY:m.pageY},g=y.pageX-s.pageX,v=y.pageY-s.pageY;if(h(p.target,g,v))return;r(g,v),s=y;var x=new Date().getTime(),b=x-o;b>0&&(i.x=g/b,i.y=v/b,o=x),p.cancelable&&n(g,v)&&p.preventDefault()}}function f(){t.settings.swipeEasing&&(clearInterval(a),a=setInterval(function(){if(t.isInitialized){clearInterval(a);return}if(!i.x&&!i.y){clearInterval(a);return}if(Math.abs(i.x)<.01&&Math.abs(i.y)<.01){clearInterval(a);return}r(i.x*30,i.y*30),i.x*=.8,i.y*=.8},10))}ch.supportsTouch?(t.event.bind(e,"touchstart",u),t.event.bind(e,"touchmove",d),t.event.bind(e,"touchend",f)):ch.supportsIePointer&&(window.PointerEvent?(t.event.bind(e,"pointerdown",u),t.event.bind(e,"pointermove",d),t.event.bind(e,"pointerup",f)):window.MSPointerEvent&&(t.event.bind(e,"MSPointerDown",u),t.event.bind(e,"MSPointerMove",d),t.event.bind(e,"MSPointerUp",f)))}var uQ=function(){return{handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1}},hQ={"click-rail":oQ,"drag-thumb":iQ,keyboard:aQ,wheel:lQ,touch:cQ},yf=function(e,n){var r=this;if(n===void 0&&(n={}),typeof e=="string"&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");this.element=e,e.classList.add(qt.main),this.settings=uQ();for(var s in n)this.settings[s]=n[s];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var o=function(){return e.classList.add(qt.state.focus)},i=function(){return e.classList.remove(qt.state.focus)};this.isRtl=Ys(e).direction==="rtl",this.isRtl===!0&&e.classList.add(qt.rtl),this.isNegativeScroll=function(){var c=e.scrollLeft,u=null;return e.scrollLeft=-1,u=e.scrollLeft<0,e.scrollLeft=c,u}(),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new Cu,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=fm(qt.element.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=fm(qt.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",o),this.event.bind(this.scrollbarX,"blur",i),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var a=Ys(this.scrollbarXRail);this.scrollbarXBottom=parseInt(a.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=Rt(a.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=Rt(a.borderLeftWidth)+Rt(a.borderRightWidth),mr(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=Rt(a.marginLeft)+Rt(a.marginRight),mr(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=fm(qt.element.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=fm(qt.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",o),this.event.bind(this.scrollbarY,"blur",i),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var l=Ys(this.scrollbarYRail);this.scrollbarYRight=parseInt(l.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=Rt(l.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?rQ(this.scrollbarY):null,this.railBorderYWidth=Rt(l.borderTopWidth)+Rt(l.borderBottomWidth),mr(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=Rt(l.marginTop)+Rt(l.marginBottom),mr(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(c){return hQ[c](r)}),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",function(c){return r.onScroll(c)}),Uo(this)};yf.prototype.update=function(e){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,mr(this.scrollbarXRail,{display:"block"}),mr(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=Rt(Ys(this.scrollbarXRail).marginLeft)+Rt(Ys(this.scrollbarXRail).marginRight),this.railYMarginHeight=Rt(Ys(this.scrollbarYRail).marginTop)+Rt(Ys(this.scrollbarYRail).marginBottom),mr(this.scrollbarXRail,{display:"none"}),mr(this.scrollbarYRail,{display:"none"}),Uo(this),ey(this,"top",0,!1,!0,e),ey(this,"left",0,!1,!0,e),mr(this.scrollbarXRail,{display:""}),mr(this.scrollbarYRail,{display:""}))};yf.prototype.onScroll=function(e){this.isAlive&&(Uo(this),ey(this,"top",this.element.scrollTop-this.lastScrollTop),ey(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)};yf.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),sc(this.scrollbarX),sc(this.scrollbarY),sc(this.scrollbarXRail),sc(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)};yf.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(e){return!e.match(/^ps([-_].+|)$/)}).join(" ")};function Lc(t){return Lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lc(t)}var dQ=["className","style","option","options","containerRef","onScrollY","onScrollX","onScrollUp","onScrollDown","onScrollLeft","onScrollRight","onYReachStart","onYReachEnd","onXReachStart","onXReachEnd","component","onSync","children"];function kw(){return kw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kw.apply(this,arguments)}function fQ(t,e){if(t==null)return{};var n=pQ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function pQ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function mQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yQ(r.key),r)}}function gQ(t,e,n){return e&&T2(t.prototype,e),n&&T2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yQ(t){var e=vQ(t,"string");return Lc(e)==="symbol"?e:String(e)}function vQ(t,e){if(Lc(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Lc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xQ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$w(t,e)}function $w(t,e){return $w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},$w(t,e)}function bQ(t){var e=CQ();return function(){var r=ty(t),s;if(e){var o=ty(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return wQ(this,s)}}function wQ(t,e){if(e&&(Lc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AL(t)}function AL(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function CQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ty(t){return ty=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ty(t)}var qm={"ps-scroll-y":"onScrollY","ps-scroll-x":"onScrollX","ps-scroll-up":"onScrollUp","ps-scroll-down":"onScrollDown","ps-scroll-left":"onScrollLeft","ps-scroll-right":"onScrollRight","ps-y-reach-start":"onYReachStart","ps-y-reach-end":"onYReachEnd","ps-x-reach-start":"onXReachStart","ps-x-reach-end":"onXReachEnd"};Object.freeze(qm);var jS=function(t){xQ(n,t);var e=bQ(n);function n(r){var s;return mQ(this,n),s=e.call(this,r),s.handleRef=s.handleRef.bind(AL(s)),s._handlerByEvent={},s}return gQ(n,[{key:"componentDidMount",value:function(){this.props.option&&console.warn('react-perfect-scrollbar: the "option" prop has been deprecated in favor of "options"'),this._ps=new yf(this._container,this.props.options||this.props.option),this._updateEventHook(),this._updateClassName()}},{key:"componentDidUpdate",value:function(s){this._updateEventHook(s),this.updateScroll(),s.className!==this.props.className&&this._updateClassName()}},{key:"componentWillUnmount",value:function(){var s=this;Object.keys(this._handlerByEvent).forEach(function(o){var i=s._handlerByEvent[o];i&&s._container.removeEventListener(o,i,!1)}),this._handlerByEvent={},this._ps.destroy(),this._ps=null}},{key:"_updateEventHook",value:function(){var s=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.keys(qm).forEach(function(i){var a=s.props[qm[i]],l=o[qm[i]];if(a!==l){if(l){var c=s._handlerByEvent[i];s._container.removeEventListener(i,c,!1),s._handlerByEvent[i]=null}if(a){var u=function(){return a(s._container)};s._container.addEventListener(i,u,!1),s._handlerByEvent[i]=u}}})}},{key:"_updateClassName",value:function(){var s=this.props.className,o=this._container.className.split(" ").filter(function(i){return i.match(/^ps([-_].+|)$/)}).join(" ");this._container&&(this._container.className="scrollbar-container".concat(s?" ".concat(s):"").concat(o?" ".concat(o):""))}},{key:"updateScroll",value:function(){this.props.onSync(this._ps)}},{key:"handleRef",value:function(s){this._container=s,this.props.containerRef(s)}},{key:"render",value:function(){var s=this.props;s.className;var o=s.style;s.option,s.options,s.containerRef,s.onScrollY,s.onScrollX,s.onScrollUp,s.onScrollDown,s.onScrollLeft,s.onScrollRight,s.onYReachStart,s.onYReachEnd,s.onXReachStart,s.onXReachEnd;var i=s.component;s.onSync;var a=s.children,l=fQ(s,dQ),c=i;return q.createElement(c,kw({style:o,ref:this.handleRef},l),a)}}]),n}(W.Component);jS.defaultProps={className:"",style:void 0,option:void 0,options:void 0,containerRef:function(){},onScrollY:void 0,onScrollX:void 0,onScrollUp:void 0,onScrollDown:void 0,onScrollLeft:void 0,onScrollRight:void 0,onYReachStart:void 0,onYReachEnd:void 0,onXReachStart:void 0,onXReachEnd:void 0,onSync:function(e){return e.update()},component:"div"};function yd(t){return yd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yd(t)}var IQ=["className","variant","children"];function Ew(){return Ew=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ew.apply(this,arguments)}function SQ(t,e,n){return e=kQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kQ(t){var e=$Q(t,"string");return yd(e)==="symbol"?e:String(e)}function $Q(t,e){if(yd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(yd(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EQ(t,e){if(t==null)return{};var n=NQ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function NQ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Nw=function(e){var n=e.className,r=e.variant,s=e.children,o=EQ(e,IQ),i="".concat(ke,"-loader"),a=q.Children.count(s)>0?"".concat(i,"--content"):"";return q.createElement("div",Ew({},o,{className:Be(i,a,SQ({},"".concat(i,"--variant-").concat(r),r!=="default"),n),role:"status"}),s)};Nw.defaultProps={className:void 0,title:void 0,variant:"default"};function vd(t){return vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vd(t)}var TQ=["className","children","blur","grayscale"];function Tw(){return Tw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Tw.apply(this,arguments)}function R2(t,e,n){return e=RQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RQ(t){var e=_Q(t,"string");return vd(e)==="symbol"?e:String(e)}function _Q(t,e){if(vd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(vd(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AQ(t,e){if(t==null)return{};var n=DQ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function DQ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var DL=function(e){var n=e.className,r=e.children,s=e.blur,o=e.grayscale,i=AQ(e,TQ),a="".concat(ke,"-overlay"),l="".concat(a,"--blur"),c="".concat(a,"--grayscale");return q.createElement("div",Tw({},i,{className:Be(a,R2({},l,s),R2({},c,o),n)}),q.createElement("div",{className:"".concat(a,"__content")},r))};DL.defaultProps={className:"",children:void 0,blur:!1,grayscale:!1};var OQ=["sender","sentTime","children","className"];function Rw(){return Rw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Rw.apply(this,arguments)}function PQ(t,e){if(t==null)return{};var n=FQ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function FQ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var _v=function(e){var n=e.sender,r=e.sentTime,s=e.children,o=e.className,i=PQ(e,OQ),a="".concat(ke,"-message__header");return q.createElement("div",Rw({},i,{className:Be(a,o)}),typeof s<"u"?s:q.createElement(q.Fragment,null,q.createElement("div",{className:"".concat(ke,"-message__sender-name")},n),q.createElement("div",{className:"".concat(ke,"-message__sent-time")},r)))};_v.displayName="Message.Header";_v.defaultProps={sender:"",sentTime:"",children:void 0};var LQ=["sender","sentTime","children","className"];function _w(){return _w=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_w.apply(this,arguments)}function MQ(t,e){if(t==null)return{};var n=zQ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function zQ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Av=function(e){var n=e.sender,r=e.sentTime,s=e.children,o=e.className,i=MQ(e,LQ),a="".concat(ke,"-message__footer");return q.createElement("div",_w({},i,{className:Be(a,o)}),typeof s<"u"?s:q.createElement(q.Fragment,null,q.createElement("div",{className:"".concat(ke,"-message__sender-name")},n),q.createElement("div",{className:"".concat(ke,"-message__sent-time")},r)))};Av.displayName="Message.Footer";Av.defaultProps={sender:"",sentTime:"",children:void 0};var Dv=function(e){var n=e.children,r=e.className,s="".concat(ke,"-message__custom-content");return q.createElement("div",{className:Be(s,r)},n)};Dv.displayName="Message.CustomContent";Dv.defaultProps={};var xd=function(e){var n=e.src,r=e.width,s=e.height,o=e.alt,i=e.className,a="".concat(ke,"-message__image-content"),l={width:typeof r=="number"?"".concat(r,"px"):typeof r=="string"?r:void 0,height:typeof s=="number"?"".concat(s,"px"):typeof s=="string"?s:void 0};return q.createElement("div",{className:Be(a,i)},q.createElement("img",{src:n,style:l,alt:o}))};xd.displayName="Message.ImageContent";xd.defaultProps={};var bd=function(e){var n=e.html,r=e.className,s="".concat(ke,"-message__html-content"),o=function(){return{__html:n}};return q.createElement("div",{className:Be(s,r),dangerouslySetInnerHTML:o()})};bd.displayName="Message.HtmlContent";bd.defaultProps={};var wd=function(e){var n=e.text,r=e.className,s=e.children,o="".concat(ke,"-message__text-content"),i=s??n;return q.createElement("div",{className:Be(o,r)},i)};wd.displayName="Message.TextContent";wd.defaultProps={};var BQ=["model","avatarSpacer","avatarPosition","type","payload","children","className"];function Aw(){return Aw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Aw.apply(this,arguments)}function _2(t,e,n){return e=UQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UQ(t){var e=VQ(t,"string");return Mc(e)==="symbol"?e:String(e)}function VQ(t,e){if(Mc(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Mc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mc(t){return Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mc(t)}function WQ(t,e){return KQ(t)||HQ(t,e)||GQ(t,e)||jQ()}function jQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GQ(t,e){if(t){if(typeof t=="string")return A2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A2(t,e)}}function A2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function HQ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,o,i,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return a}}function KQ(t){if(Array.isArray(t))return t}function qQ(t,e){if(t==null)return{};var n=XQ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function XQ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var qo=function(e){var n,r,s=e.model,o=s.message,i=s.sentTime,a=s.sender,l=s.direction,c=s.position,u=s.type,h=s.payload,d=e.avatarSpacer,f=e.avatarPosition,p=e.type,m=e.payload,y=e.children,g=e.className,v=qQ(e,BQ),x="".concat(ke,"-message"),b=mf(y,[bu,_v,Av,bd,wd,xd,Dv]),w=WQ(b,7),C=w[0],I=w[1],S=w[2],$=w[3],E=w[4],A=w[5],M=w[6],B=function(){if(l===0||l==="incoming")return"".concat(x,"--incoming");if(l===1||l==="outgoing")return"".concat(x,"--outgoing")}(),U=function(D){var z="".concat(x,"--avatar-");if(D===0||D==="top-left"||D==="tl")return"".concat(z,"tl");if(D===1||D==="top-right"||D==="tr")return"".concat(z,"tr");if(D===2||D==="bottom-right"||D==="br")return"".concat(z,"br");if(D===3||D==="bottom-left"||D==="bl")return"".concat(z,"bl");if(D===4||D==="center-left"||D==="cl")return"".concat(z,"cl");if(D===5||D==="center-right"||D==="cr")return"".concat(z,"cr")}(f),V=function(D){var z="".concat(ke,"-message--");if(D==="single"||D===0)return"".concat(z,"single");if(D==="first"||D===1)return"".concat(z,"first");if(D==="normal"||D===2)return"";if(D==="last"||D===3)return"".concat(z,"last")}(c),H=function(){return(a==null?void 0:a.length)>0&&(i==null?void 0:i.length)>0?"".concat(a,": ").concat(i):(a==null?void 0:a.length)>0&&(typeof i>"u"||(i==null?void 0:i.length)===0)?a:null}(),K=(n=(r=$??E)!==null&&r!==void 0?r:A)!==null&&n!==void 0?n:M,R=K??function(){var D=u??p,z=h??o,Q=z??m,J=Mc(Q)==="object"?HF(Q):"";if(D==="html"&&J!=="Message.CustomContent")return q.createElement(bd,{html:Q});if(D==="text")return q.createElement(wd,{text:Q});if(D==="image")return q.createElement(xd,Q);if(D==="custom"||J==="Message.CustomContent")return Q}();return q.createElement("section",Aw({},v,{"aria-label":H,className:Be(x,B,_2({},"".concat(x,"--avatar-spacer"),d),V,U,g)},_2({},"data-".concat(ke,"-message"),"")),typeof C<"u"&&q.createElement("div",{className:"".concat(x,"__avatar")},C),q.createElement("div",{className:"".concat(x,"__content-wrapper")},I,q.createElement("div",{className:"".concat(x,"__content")},R),S))};qo.defaultProps={model:{message:"",sentTime:"",sender:"",direction:1},avatarSpacer:!1,avatarPosition:void 0,type:"html"};qo.Header=_v;qo.HtmlContent=bd;qo.TextContent=wd;qo.ImageContent=xd;qo.CustomContent=Dv;qo.Footer=Av;var YQ=["children","className"];function Dw(){return Dw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dw.apply(this,arguments)}function QQ(t,e){if(t==null)return{};var n=JQ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function JQ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Ov=function(e){var n=e.children,r=e.className,s=QQ(e,YQ),o="".concat(ke,"-message-group__header");return q.createElement("div",Dw({},s,{className:Be(o,r)}),n)};Ov.displayName="MessageGroup.Header";Ov.defaultProps={children:void 0};var ZQ=["children","className"];function Ow(){return Ow=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ow.apply(this,arguments)}function eJ(t,e){if(t==null)return{};var n=tJ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function tJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Pv=function(e){var n=e.children,r=e.className,s=eJ(e,ZQ),o="".concat(ke,"-message-group__footer");return q.createElement("div",Ow({},s,{className:Be(o,r)}),n)};Pv.displayName="MessageGroup.Footer";Pv.defaultProps={children:void 0};var nJ=["children","className"];function Pw(){return Pw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pw.apply(this,arguments)}function rJ(t,e){if(t==null)return{};var n=sJ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function sJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Fv=function(e){var n=e.children,r=e.className,s=rJ(e,nJ),o="".concat(ke,"-message-group");return q.createElement("div",Pw({},s,{className:Be("".concat(o,"__messages"),r)}),n)};Fv.displayName="MessageGroup.Messages";Fv.defaultProps={children:void 0};function Cd(t){return Cd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cd(t)}var oJ=["direction","avatarPosition","sender","sentTime","children","className"];function Fw(){return Fw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Fw.apply(this,arguments)}function iJ(t,e,n){return e=aJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aJ(t){var e=lJ(t,"string");return Cd(e)==="symbol"?e:String(e)}function lJ(t,e){if(Cd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Cd(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cJ(t,e){return fJ(t)||dJ(t,e)||hJ(t,e)||uJ()}function uJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hJ(t,e){if(t){if(typeof t=="string")return D2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D2(t,e)}}function D2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dJ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,o,i,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return a}}function fJ(t){if(Array.isArray(t))return t}function pJ(t,e){if(t==null)return{};var n=mJ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function mJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var vf=function(e){var n=e.direction,r=e.avatarPosition,s=e.sender,o=e.sentTime,i=e.children,a=e.className,l=pJ(e,oJ),c="".concat(ke,"-message-group"),u=function(){if(n===0||n==="incoming")return"".concat(c,"--incoming");if(n===1||n==="outgoing")return"".concat(c,"--outgoing")}(),h=function(){var x="".concat(c,"--avatar-");if(typeof r=="string"&&(r==="tl"||r==="top-left"||r==="tr"||r==="top-right"||r==="bl"||r==="bottom-right"||r==="br"||r==="bottom-right"||r==="cl"||r==="center-left"||r==="cr"||r==="center-right"))return"".concat(x).concat(r)}(),d=mf(i,[bu,Ov,Pv,Fv]),f=cJ(d,4),p=f[0],m=f[1],y=f[2],g=f[3],v=function(){return s.length>0&&o.length>0?"".concat(s,": ").concat(o):s.length>0&&o.length===0?s:null}();return q.createElement("section",Fw({"aria-label":v},l,{className:Be(c,u,h,a)},iJ({},"data-".concat(ke,"-message-group"),"")),typeof p<"u"&&q.createElement("div",{className:"".concat(c,"__avatar")},p),q.createElement("div",{className:"".concat(c,"__content")},m,g,y))};vf.defaultProps={direction:"incoming",sentTime:"",sender:"",avatarPosition:void 0};vf.Header=Ov;vf.Footer=Pv;vf.Messages=Fv;var gJ=["content","as","children","className"];function Lw(){return Lw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Lw.apply(this,arguments)}function yJ(t,e){if(t==null)return{};var n=vJ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function vJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var OL=function t(e){var n=e.content,r=e.as,s=e.children,o=e.className,i=yJ(e,gJ),a="".concat(ke,"-message-separator"),l=function(){return typeof r=="string"&&r.length>0?r:t.defaultProps.as}();return q.createElement(l,Lw({},i,{className:Be(a,o)}),b7(s)===!0?n:s)};OL.defaultProps={children:void 0,content:void 0,as:"div"};var xJ=["className","children"];function Mw(){return Mw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Mw.apply(this,arguments)}function bJ(t,e){if(t==null)return{};var n=wJ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function wJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var Lv=function(e){var n=e.className,r=e.children,s=bJ(e,xJ);return q.createElement("div",Mw({},s,{className:n}),r)};Lv.displayName="MessageList.Content";var CJ=["children","typingIndicator","loading","loadingMore","loadingMorePosition","onYReachStart","onYReachEnd","className","disableOnYReachWhenNoScroll","scrollBehavior","autoScrollToBottom","autoScrollToBottomOnMount"];function zc(t){return zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zc(t)}function Id(){return Id=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Id.apply(this,arguments)}function IJ(t,e){return EJ(t)||$J(t,e)||kJ(t,e)||SJ()}function SJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kJ(t,e){if(t){if(typeof t=="string")return O2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O2(t,e)}}function O2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $J(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,o,i,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return a}}function EJ(t){if(Array.isArray(t))return t}function NJ(t,e){if(t==null)return{};var n=TJ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function TJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function RJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function P2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,PL(r.key),r)}}function _J(t,e,n){return e&&P2(t.prototype,e),n&&P2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function AJ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zw(t,e)}function zw(t,e){return zw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},zw(t,e)}function DJ(t){var e=PJ();return function(){var r=ny(t),s;if(e){var o=ny(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return OJ(this,s)}}function OJ(t,e){if(e&&(zc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ml(t)}function Ml(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ny(t){return ny=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ny(t)}function pa(t,e,n){return e=PL(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PL(t){var e=FJ(t,"string");return zc(e)==="symbol"?e:String(e)}function FJ(t,e){if(zc(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(zc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var GS=function(t){AJ(n,t);var e=DJ(n);function n(r){var s;return RJ(this,n),s=e.call(this,r),pa(Ml(s),"handleResize",function(){s.containerRef.current.clientHeight<s.lastClientHeight&&s.scrollToEnd(s.props.scrollBehavior),s.scrollRef.current.updateScroll()}),pa(Ml(s),"handleContainerResize",function(){s.resizeTicking===!1&&(window.requestAnimationFrame(function(){var o=s.containerRef.current;if(o){var i=o.clientHeight,a=i-s.lastClientHeight;a>=1?s.preventScrollTop===!1&&(o.scrollTop=Math.round(o.scrollTop)-a):o.scrollTop=o.scrollTop-a,s.lastClientHeight=o.clientHeight,s.scrollRef.current.updateScroll()}s.resizeTicking=!1}),s.resizeTicking=!0)}),pa(Ml(s),"isSticked",function(){var o=s.containerRef.current;return o.scrollHeight===Math.round(o.scrollTop+o.clientHeight)}),pa(Ml(s),"handleScroll",function(){s.scrollTicking===!1&&(window.requestAnimationFrame(function(){s.noScroll===!1?s.preventScrollTop=s.isSticked():s.noScroll=!1,s.scrollTicking=!1}),s.scrollTicking=!0)}),pa(Ml(s),"getLastMessageOrGroup",function(){var o=s.containerRef.current.querySelector("[data-".concat(ke,"-message-list]>[data-").concat(ke,"-message]:last-of-type,[data-").concat(ke,"-message-list]>[data-").concat(ke,"-message-group]:last-of-type")),i=o==null?void 0:o.querySelector("[data-".concat(ke,"-message]:last-of-type"));return{lastElement:o,lastMessageInGroup:i}}),s.scrollPointRef=q.createRef(),s.containerRef=q.createRef(),s.scrollRef=q.createRef(),s.lastClientHeight=0,s.preventScrollTop=!1,s.resizeObserver=void 0,s.scrollTicking=!1,s.resizeTicking=!1,s.noScroll=void 0,s}return _J(n,[{key:"getSnapshotBeforeUpdate",value:function(){var s=this.containerRef.current,o=Math.round(s.scrollTop+s.clientHeight),i=s.scrollHeight===o||s.scrollHeight+1===o||s.scrollHeight-1===o;return{sticky:i,clientHeight:s.clientHeight,scrollHeight:s.scrollHeight,lastMessageOrGroup:this.getLastMessageOrGroup(),diff:s.scrollHeight-s.scrollTop}}},{key:"componentDidMount",value:function(){this.props.autoScrollToBottomOnMount===!0&&this.scrollToEnd(this.props.scrollBehavior),this.lastClientHeight=this.containerRef.current.clientHeight,window.addEventListener("resize",this.handleResize),typeof window.ResizeObserver=="function"&&(this.resizeObserver=new ResizeObserver(this.handleContainerResize),this.resizeObserver.observe(this.containerRef.current)),this.containerRef.current.addEventListener("scroll",this.handleScroll)}},{key:"componentDidUpdate",value:function(s,o,i){var a=this.props.autoScrollToBottom;if(typeof i<"u"){var l=this.containerRef.current,c=this.getLastMessageOrGroup(),u=c.lastElement,h=c.lastMessageInGroup;if(u===i.lastMessageOrGroup.lastElement&&(typeof h>"u"||h===i.lastMessageOrGroup.lastMessageInGroup)&&(l.scrollTop=l.scrollHeight-i.diff+(this.lastClientHeight-l.clientHeight)),i.sticky===!0)a===!0&&this.scrollToEnd(this.props.scrollBehavior),this.preventScrollTop=!0;else if(i.clientHeight<this.lastClientHeight){var d=l.scrollTop+this.lastClientHeight;l.scrollHeight===d||l.scrollHeight+1===d||l.scrollHeight-1===d?a===!0&&(this.scrollToEnd(this.props.scrollBehavior),this.preventScrollTop=!0):this.preventScrollTop=!1}else this.preventScrollTop=!1,u===i.lastMessageOrGroup.lastElement&&(typeof h>"u"||h===i.lastMessageOrGroup.lastMessageInGroup)&&l.scrollTop===0&&l.scrollHeight>i.scrollHeight&&(l.scrollTop=l.scrollHeight-i.scrollHeight);this.lastClientHeight=i.clientHeight}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),typeof this.resizeObserver<"u"&&this.resizeObserver.disconnect(),this.containerRef.current.removeEventListener("scroll",this.handleScroll)}},{key:"scrollToEnd",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.scrollBehavior,o=this.containerRef.current,i=this.scrollPointRef.current,a=o.getBoundingClientRect(),l=i.getBoundingClientRect(),c=l.top+o.scrollTop-a.top;o.scrollBy?o.scrollBy({top:c,behavior:s}):o.scrollTop=c,this.lastClientHeight=o.clientHeight,this.noScroll=!0}},{key:"render",value:function(){var s=this,o=this.props,i=o.children,a=o.typingIndicator,l=o.loading,c=o.loadingMore,u=o.loadingMorePosition,h=o.onYReachStart,d=o.onYReachEnd,f=o.className,p=o.disableOnYReachWhenNoScroll;o.scrollBehavior,o.autoScrollToBottom,o.autoScrollToBottomOnMount;var m=NJ(o,CJ),y="".concat(ke,"-message-list"),g=mf(i,[Lv]),v=IJ(g,1),x=v[0];return q.createElement("div",Id({},m,{className:Be(y,f)}),c&&q.createElement("div",{className:Be("".concat(y,"__loading-more"),pa({},"".concat(y,"__loading-more--bottom"),u==="bottom"))},q.createElement(Nw,null)),l&&q.createElement(DL,null,q.createElement(Nw,null)),q.createElement(jS,Id({onYReachStart:h,onYReachEnd:d,onSync:function(w){return w.update(p)},className:"".concat(y,"__scroll-wrapper"),ref:this.scrollRef,containerRef:function(w){return s.containerRef.current=w},options:{suppressScrollX:!0}},pa({},"data-".concat(ke,"-message-list"),""),{style:{overscrollBehaviorY:"none",overflowAnchor:"auto",touchAction:"none"}}),x||i,q.createElement("div",{className:"".concat(y,"__scroll-to"),ref:this.scrollPointRef})),typeof a<"u"&&q.createElement("div",{className:"".concat(y,"__typing-indicator-container")},a))}}]),n}(q.Component);GS.displayName="MessageList";function LJ(t,e){var n=W.useRef(),r=function(o){return n.current.scrollToEnd(o)};return W.useImperativeHandle(e,function(){return{scrollToBottom:r}}),q.createElement(GS,Id({ref:n},t))}var Iu=W.forwardRef(LJ);Iu.propTypes={children:KF([qo,vf,OL,Lv]),typingIndicator:ae.node,loading:ae.bool,loadingMore:ae.bool,loadingMorePosition:ae.oneOf(["top","bottom"]),onYReachStart:ae.func,onYReachEnd:ae.func,disableOnYReachWhenNoScroll:ae.bool,autoScrollToBottom:ae.bool,autoScrollToBottomOnMount:ae.bool,scrollBehavior:ae.oneOf(["auto","smooth"]),className:ae.string};Iu.defaultProps={typingIndicator:void 0,loading:!1,loadingMore:!1,loadingMorePosition:"top",disableOnYReachWhenNoScroll:!1,autoScrollToBottom:!0,autoScrollToBottomOnMount:!0,scrollBehavior:"auto"};GS.defaultProps=Iu.defaultProps;Iu.Content=Lv;function Bc(t){return Bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bc(t)}function MJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,FL(r.key),r)}}function zJ(t,e,n){return e&&F2(t.prototype,e),n&&F2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function BJ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bw(t,e)}function Bw(t,e){return Bw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Bw(t,e)}function UJ(t){var e=WJ();return function(){var r=ry(t),s;if(e){var o=ry(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return VJ(this,s)}}function VJ(t,e){if(e&&(Bc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ba(t)}function ba(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WJ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ry(t){return ry=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ry(t)}function gb(t,e,n){return e=FL(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FL(t){var e=jJ(t,"string");return Bc(e)==="symbol"?e:String(e)}function jJ(t,e){if(Bc(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Bc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var GJ=function(e,n){var r=document.activeElement===e,s=document.createTextNode("");if(e.appendChild(s),s!==null&&s.nodeValue!==null&&(r||n)){var o=window.getSelection();if(o!==null){var i=document.createRange();i.setStart(s,s.nodeValue.length),i.collapse(!0),o.removeAllRanges(),o.addRange(i)}}},LL=function(t){BJ(n,t);var e=UJ(n);function n(r){var s;return MJ(this,n),s=e.call(this,r),gb(ba(s),"innerHTML",function(){var o=ba(s),i=o.props.value;return{__html:typeof i<"u"?i:""}}),gb(ba(s),"handleKeyPress",function(o){var i=ba(s),a=i.props.onKeyPress;a(o)}),gb(ba(s),"handleInput",function(o){var i=ba(s),a=i.props.onChange,l=o.target;a(l.innerHTML,l.textContent,l.innerText)}),s.msgRef=q.createRef(),s}return zJ(n,[{key:"focus",value:function(){typeof this.msgRef.current<"u"&&this.msgRef.current.focus()}},{key:"componentDidMount",value:function(){this.props.autoFocus===!0&&this.msgRef.current.focus()}},{key:"shouldComponentUpdate",value:function(s){var o=this.msgRef,i=this.props,a=i.placeholder,l=i.disabled,c=i.activateAfterChange;return typeof o.current>"u"||s.value!==o.current.innerHTML?!0:a!==s.placeholder||l!==s.disabled||c!==s.activateAfterChange}},{key:"componentDidUpdate",value:function(){var s=this.msgRef,o=this.props,i=o.value,a=o.activateAfterChange;i!==s.current.innerHTML&&(s.current.innerHTML=typeof i=="string"?i:""),GJ(s.current,a)}},{key:"render",value:function(){var s=this.msgRef,o=this.handleInput,i=this.handleKeyPress,a=this.innerHTML,l=this.props,c=l.placeholder,u=l.disabled,h=l.className,d=typeof c=="string"?c:"";return q.createElement("div",{ref:s,className:h,contentEditable:u===!1,disabled:u,"data-placeholder":d,onInput:o,onKeyPress:i,dangerouslySetInnerHTML:a()})}}]),n}(W.Component);LL.defaultProps={value:void 0,placeholder:"",disabled:!1,activateAfterChange:!1,autoFocus:!1,onChange:function(){},onKeyPress:function(){}};function Uc(t){return Uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uc(t)}var HJ=["fancyScroll","children","forwardedRef"],KJ=["value","onSend","onChange","autoFocus","placeholder","fancyScroll","className","activateAfterChange","disabled","sendDisabled","sendOnReturnDisabled","attachDisabled","sendButton","attachButton","onAttachClick"];function qJ(t,e,n){return e=zL(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uw(t,e){return JJ(t)||QJ(t,e)||YJ(t,e)||XJ()}function XJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YJ(t,e){if(t){if(typeof t=="string")return L2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return L2(t,e)}}function L2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function QJ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,o,i,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return a}}function JJ(t){if(Array.isArray(t))return t}function gc(){return gc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gc.apply(this,arguments)}function ML(t,e){if(t==null)return{};var n=ZJ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function ZJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function eZ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M2(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zL(r.key),r)}}function tZ(t,e,n){return e&&M2(t.prototype,e),n&&M2(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function zL(t){var e=nZ(t,"string");return Uc(e)==="symbol"?e:String(e)}function nZ(t,e){if(Uc(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Uc(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rZ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vw(t,e)}function Vw(t,e){return Vw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Vw(t,e)}function sZ(t){var e=aZ();return function(){var r=sy(t),s;if(e){var o=sy(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return oZ(this,s)}}function oZ(t,e){if(e&&(Uc(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iZ(t)}function iZ(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aZ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sy(t){return sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},sy(t)}function lZ(){var t=function(e){rZ(r,e);var n=sZ(r);function r(){return eZ(this,r),n.apply(this,arguments)}return tZ(r,[{key:"render",value:function(){var o=this.props,i=o.fancyScroll,a=o.children,l=o.forwardedRef,c=ML(o,HJ);return q.createElement(q.Fragment,null,i===!0&&q.createElement(jS,gc({ref:function(h){return l.current=h}},c,{options:{suppressScrollX:!0}}),a),i===!1&&q.createElement("div",gc({ref:l},c),a))}}]),r}(W.Component);return q.forwardRef(function(e,n){return q.createElement(t,gc({forwardedRef:n},e))})}var cZ=lZ(),z2=function(e,n){var r=typeof e<"u"?e:n,s=W.useState(r),o=Uw(s,2),i=o[0],a=o[1],l=typeof e<"u"?e:i;return[l,function(c){a(c)}]};function BL(t,e){var n=t.value,r=t.onSend,s=t.onChange,o=t.autoFocus,i=t.placeholder,a=t.fancyScroll,l=t.className,c=t.activateAfterChange,u=t.disabled,h=t.sendDisabled,d=t.sendOnReturnDisabled,f=t.attachDisabled,p=t.sendButton,m=t.attachButton,y=t.onAttachClick,g=ML(t,KJ),v=W.useRef(),x=W.useRef(),b=z2(n,""),w=Uw(b,2),C=w[0],I=w[1],S=z2(h,!0),$=Uw(S,2),E=$[0],A=$[1],M=function(){typeof x.current<"u"&&x.current.focus()};W.useImperativeHandle(e,function(){return{focus:M}}),W.useEffect(function(){o===!0&&M()},[]),W.useEffect(function(){typeof v.current.updateScroll=="function"&&v.current.updateScroll()});var B=function(){var z=x.current.msgRef.current;return[z.textContent,z.innerText,z.cloneNode(!0).childNodes]},U=function(){if(C.length>0){n===void 0&&I(""),typeof h>"u"&&A(!0);var z=B();r(C,z[0],z[1],z[2])}},V=function(z){z.key==="Enter"&&z.shiftKey===!1&&d===!1&&(z.preventDefault(),U())},H=function(z,Q,J){I(z),typeof h>"u"&&A(Q.length===0),typeof v.current.updateScroll=="function"&&v.current.updateScroll();var ee=B();s(z,Q,J,ee[2])},K="".concat(ke,"-message-input"),R=typeof i=="string"?i:"";return q.createElement("div",gc({},g,{className:Be(K,qJ({},"".concat(K,"--disabled"),u),l)}),m===!0&&q.createElement("div",{className:"".concat(K,"__tools")},q.createElement(EL,{onClick:y,disabled:u===!0||f===!0})),q.createElement("div",{className:"".concat(K,"__content-editor-wrapper")},q.createElement(cZ,{fancyScroll:a,ref:v,className:"".concat(K,"__content-editor-container")},q.createElement(LL,{ref:x,className:"".concat(K,"__content-editor"),disabled:u,placeholder:R,onKeyPress:V,onChange:H,activateAfterChange:c,value:C}))),p===!0&&q.createElement("div",{className:"".concat(K,"__tools")},q.createElement(kL,{onClick:U,disabled:u===!0||E===!0})))}var Su=W.forwardRef(BL);Su.displayName="MessageInput";Su.propTypes={value:ae.string,placeholder:ae.string,disabled:ae.bool,sendOnReturnDisabled:ae.bool,sendDisabled:ae.bool,fancyScroll:ae.bool,activateAfterChange:ae.bool,autoFocus:ae.bool,onChange:ae.func,onSend:ae.func,className:ae.string,sendButton:ae.bool,attachButton:ae.bool,attachDisabled:ae.bool,onAttachClick:ae.func};Su.defaultProps={value:void 0,placeholder:"",disabled:!1,sendOnReturnDisabled:!1,fancyScroll:!0,activateAfterChange:!1,autoFocus:!1,sendButton:!0,attachButton:!0,attachDisabled:!1,onAttachClick:Km,onChange:Km,onSend:Km};BL.defaultProps=Su.defaultProps;var uZ=["className","children"];function Ww(){return Ww=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ww.apply(this,arguments)}function hZ(t,e){if(t==null)return{};var n=dZ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function dZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var HS=function(e){var n=e.className,r=e.children,s=hZ(e,uZ),o="".concat(ke,"-input-toolbox");return q.createElement("div",Ww({},s,{className:Be(o,n)}),r)};HS.displayName="InputToolbox";HS.defaultProps={};var fZ=["children","className"];function jw(){return jw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jw.apply(this,arguments)}function pZ(t,e){return vZ(t)||yZ(t,e)||gZ(t,e)||mZ()}function mZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gZ(t,e){if(t){if(typeof t=="string")return B2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B2(t,e)}}function B2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function yZ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,o,i,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return a}}function vZ(t){if(Array.isArray(t))return t}function xZ(t,e){if(t==null)return{};var n=bZ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function bZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var UL=function(e){var n=e.children,r=e.className,s=xZ(e,fZ),o="".concat(ke,"-chat-container"),i=mf(n,[wu,Iu,Su,HS]),a=pZ(i,4),l=a[0],c=a[1],u=a[2],h=a[3];return q.createElement("div",jw({},s,{className:Be(o,r)}),l,c,u,h)};UL.defaultProps={children:void 0};var Ba="".concat(ke,"-conversation");function Sd(t){return Sd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sd(t)}var wZ=["children","className","visible"];function Gw(){return Gw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gw.apply(this,arguments)}function CZ(t,e,n){return e=IZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IZ(t){var e=SZ(t,"string");return Sd(e)==="symbol"?e:String(e)}function SZ(t,e){if(Sd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Sd(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kZ(t,e){if(t==null)return{};var n=$Z(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function $Z(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var VL=function(e){var n=e.children,r=e.className,s=e.visible,o=kZ(e,wZ);return q.createElement("div",Gw({},o,{className:Be("".concat(Ba,"__operations"),CZ({},"".concat(Ba,"__operations--visible"),s),r)}),q.Children.count(n)>0?n:q.createElement(co,{icon:IL.faEllipsisV}))};VL.displayName="Conversation.Operations";VL.defaultProps={};var EZ=["lastSenderName","info","name","children","className"];function Hw(){return Hw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hw.apply(this,arguments)}function Kw(t){return Kw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kw(t)}function NZ(t,e){if(t==null)return{};var n=TZ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function TZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var RZ=function(e){var n=e.name;return q.createElement(q.Fragment,null,q.createElement("div",{className:"".concat(Ba,"__last-sender")},n),":")},_Z=function(e){var n=e.info;return q.createElement("div",{className:"".concat(Ba,"__info-content")},n)},WL=function(e){var n=e.lastSenderName,r=e.info,s=e.name,o=e.children,i=e.className,a=NZ(e,EZ),l=Kw(n);return q.createElement("div",Hw({},a,{className:Be("".concat(Ba,"__content"),i)}),q.Children.count(o)>0?o:q.createElement(q.Fragment,null,q.createElement("div",{className:"".concat(Ba,"__name")},s),q.createElement("div",{className:"".concat(Ba,"__info")},l!=="undefined"?q.createElement(q.Fragment,null,l==="string"?q.createElement(RZ,{name:n}):n," "):null,typeof r<"u"&&q.createElement(_Z,{info:r}))))};WL.displayName="Conversation.Content";WL.defaultProps={};function kd(t){return kd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kd(t)}var AZ=["responsive","children","className"];function qw(){return qw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qw.apply(this,arguments)}function DZ(t,e,n){return e=OZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OZ(t){var e=PZ(t,"string");return kd(e)==="symbol"?e:String(e)}function PZ(t,e){if(kd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(kd(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FZ(t,e){if(t==null)return{};var n=LZ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function LZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var jL=function(e){var n=e.responsive,r=e.children,s=e.className,o=FZ(e,AZ),i="".concat(ke,"-main-container");return q.createElement("div",qw({},o,{className:Be(i,DZ({},"".concat(i,"--responsive"),n),s)}),r)};jL.defaultProps={children:void 0,responsive:!1};/*!
 * Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 */var MZ={prefix:"fas",iconName:"search",icon:[512,512,[],"f002","M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"]},zZ={prefix:"fas",iconName:"times",icon:[352,512,[],"f00d","M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"]};function $d(t){return $d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$d(t)}var BZ=["placeholder","value","onChange","onClearClick","className","disabled"];function Xw(){return Xw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xw.apply(this,arguments)}function U2(t,e,n){return e=UZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UZ(t){var e=VZ(t,"string");return $d(e)==="symbol"?e:String(e)}function VZ(t,e){if($d(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if($d(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V2(t,e){return HZ(t)||GZ(t,e)||jZ(t,e)||WZ()}function WZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jZ(t,e){if(t){if(typeof t=="string")return W2(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W2(t,e)}}function W2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function GZ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,o,i,a=[],l=!0,c=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&n.return!=null&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw s}}return a}}function HZ(t){if(Array.isArray(t))return t}function KZ(t,e){if(t==null)return{};var n=qZ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function qZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var XZ=function(e,n){return typeof n>"u"?W.useState(e):[n,function(){}]};function GL(t,e){var n=t.placeholder,r=t.value,s=t.onChange,o=t.onClearClick,i=t.className,a=t.disabled,l=KZ(t,BZ),c="".concat(ke,"-search"),u=W.useMemo(function(){return typeof r<"u"},[]),h=XZ("",r),d=V2(h,2),f=d[0],p=d[1],m=W.useState(u?f.length>0:!1),y=V2(m,2),g=y[0],v=y[1];if(u!==typeof r<"u")throw"Search: Changing from controlled to uncontrolled component and vice versa is not allowed";var x=W.useRef(void 0),b=function(){typeof x.current<"u"&&x.current.focus()};W.useImperativeHandle(e,function(){return{focus:b}});var w=function(S){var $=S.target.value;v($.length>0),u===!1&&p($),s($)},C=function(){u===!1&&p(""),v(!1),o()};return q.createElement("div",Xw({},l,{className:Be(c,U2({},"".concat(c,"--disabled"),a),i)}),q.createElement(co,{icon:MZ,className:"".concat(c,"__search-icon")}),q.createElement("input",{ref:x,type:"text",className:"".concat(c,"__input"),placeholder:n,onChange:w,disabled:a,value:f}),q.createElement(co,{icon:zZ,className:Be("".concat(c,"__clear-icon"),U2({},"".concat(c,"__clear-icon--active"),g)),onClick:C}))}var Mv=W.forwardRef(GL);Mv.displayName="Search";Mv.propTypes={placeholder:ae.string,value:ae.string,onChange:ae.func,onClearClick:ae.func,className:ae.string,disabled:ae.bool};Mv.defaultProps={placeholder:"",value:void 0,onChange:function(){},onClearClick:function(){},disabled:!1};GL.defaultProps=Mv.defaultProps;var YZ=["content","className"];function Yw(){return Yw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Yw.apply(this,arguments)}function QZ(t,e){if(t==null)return{};var n=JZ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function JZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var HL=function(e){var n=e.content,r=e.className,s=QZ(e,YZ),o="".concat(ke,"-typing-indicator");return q.createElement("div",Yw({},s,{className:Be(o,r)}),q.createElement("div",{className:"".concat(o,"__indicator")},q.createElement("div",{className:"".concat(o,"__dot")}),q.createElement("div",{className:"".concat(o,"__dot")}),q.createElement("div",{className:"".concat(o,"__dot")})),q.createElement("div",{className:"".concat(o,"__text")},n))};HL.defaultProps={content:""};function Ed(t){return Ed=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ed(t)}var ZZ=["className","children","size","selected","onChange","itemsTabIndex"];function Qw(){return Qw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Qw.apply(this,arguments)}function eee(t,e,n){return e=tee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tee(t){var e=nee(t,"string");return Ed(e)==="symbol"?e:String(e)}function nee(t,e){if(Ed(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Ed(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ree(t,e){if(t==null)return{};var n=see(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function see(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function KL(t,e){var n=t.className,r=t.children,s=t.size,o=t.selected,i=t.onChange,a=t.itemsTabIndex,l=ree(t,ZZ),c="".concat(ke,"-status-list"),u=W.useRef();W.useImperativeHandle(e,function(){return{focus:function(f){var p=Array.from(u.current.querySelectorAll("li")),m=p.filter(function(y){return y.parentNode===u.current});typeof m[f]<"u"&&m[f].focus()}}});var h=a;return q.createElement("ul",Qw({ref:u},l,{className:Be(c,n,eee({},"".concat(c,"--").concat(s),s))}),q.Children.map(r,function(d){var f={};o&&(f.selected=d.props.status===o),i&&(f.onClick=function(y){i(d.props.status),d.onClick&&d.onClick(y)});var p=function(g){i&&g.key==="Enter"&&g.shiftKey===!1&&g.altKey===!1&&i(d.props.status)},m=function(){if(typeof h=="number")return h>0?h++:h}();return q.createElement("li",{tabIndex:m,onKeyPress:p},q.cloneElement(d,f))}))}var zv=W.forwardRef(KL);zv.displayName="StatusList";zv.propTypes={children:KF([FS]),selected:ae.oneOf(jF),size:ae.oneOf(GF),itemsTabIndex:ae.number,className:ae.string,onChange:ae.func};zv.defaultProps={onChange:Km};KL.defaultProps=zv.defaultProps;const j2={}.VITE_API_KEY,Vc=()=>{const[t,e]=W.useState(!1),[n,r]=W.useState([{message:"Hola !  This is Anny farmSense's official support. How can I help you? ",sender:"ChatGPT"}]),s=async i=>{const a={message:i,sender:"user",direction:"outgoing"},l=[...n,a];r(l),e(!0),await o(l)};async function o(i){let a=i.map(u=>{let h="";return u.sender==="ChatGPT"?h="assistant":h="user",{role:h,content:u.message}});const c={model:"gpt-3.5-turbo",messages:[{role:"system",content:"speak like a doctor"},...a]};console.log(j2),await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer "+j2,"Content-Type":"application/json"},body:JSON.stringify(c)}).then(u=>u.json()).then(u=>{console.log(u),console.log(u.choices[0].message.content),r([...i,{message:u.choices[0].message.content,sender:"ChatGPT"}]),e(!1)})}return T("div",{className:"App",children:T("div",{className:"chatbot flex h-[350px] flex-col justify-between  lg:w-[500px]  lg:h-[600px] border-solid border-[2px] lg:m-3 m-5  ",children:T(jL,{children:he(UL,{children:[T(Iu,{scrollBehavior:"smooth",typingIndicator:t?T(HL,{content:"Wait"}):null,children:n.map((i,a)=>T(qo,{model:i},a))}),T(Su,{placeholder:"What happened to your Chick!",onSend:s})]})})})})};var ku={},KS={};Object.defineProperty(KS,"__esModule",{value:!0});var G2=function(){function t(e,n){var r=[],s=!0,o=!1,i=void 0;try{for(var a=e[Symbol.iterator](),l;!(s=(l=a.next()).done)&&(r.push(l.value),!(n&&r.length===n));s=!0);}catch(c){o=!0,i=c}finally{try{!s&&a.return&&a.return()}finally{if(o)throw i}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_a=W;function oee(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}else return Array.from(t)}var H2=function(e,n){var r=(0,_a.useRef)(function(){throw new Error("Cannot call an event handler while rendering.")});return(0,_a.useEffect)(function(){r.current=e},[e].concat(oee(n))),(0,_a.useCallback)(function(s){var o=r.current;return o(s)},[r])},iee=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.onEnd,r=n===void 0?function(){}:n,s=e.onResult,o=s===void 0?function(){}:s,i=e.onError,a=i===void 0?function(){}:i,l=(0,_a.useRef)(null),c=(0,_a.useState)(!1),u=G2(c,2),h=u[0],d=u[1],f=(0,_a.useState)(!1),p=G2(f,2),m=p[0],y=p[1],g=function(C){var I=Array.from(C.results).map(function(S){return S[0]}).map(function(S){return S.transcript}).join("");o(I)},v=function(C){C.error==="not-allowed"&&(l.current.onend=function(){},d(!1)),a(C)},x=H2(function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(h||!m)){var C=w.lang,I=C===void 0?"":C,S=w.interimResults,$=S===void 0?!0:S,E=w.continuous,A=E===void 0?!1:E,M=w.maxAlternatives,B=M===void 0?1:M,U=w.grammars;d(!0),l.current.lang=I,l.current.interimResults=$,l.current.onresult=g,l.current.onerror=v,l.current.continuous=A,l.current.maxAlternatives=B,U&&(l.current.grammars=U),l.current.onend=function(){return l.current.start()},l.current.start()}},[h,m,l]),b=H2(function(){!h||!m||(l.current.onresult=function(){},l.current.onend=function(){},l.current.onerror=function(){},d(!1),l.current.stop(),r())},[h,m,l,r]);return(0,_a.useEffect)(function(){typeof window>"u"||(window.SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition,window.SpeechRecognition&&(y(!0),l.current=new window.SpeechRecognition))},[]),{listen:x,listening:h,stop:b,supported:m}};KS.default=iee;var qS={};Object.defineProperty(qS,"__esModule",{value:!0});var yb=function(){function t(e,n){var r=[],s=!0,o=!1,i=void 0;try{for(var a=e[Symbol.iterator](),l;!(s=(l=a.next()).done)&&(r.push(l.value),!(n&&r.length===n));s=!0);}catch(c){o=!0,i=c}finally{try{!s&&a.return&&a.return()}finally{if(o)throw i}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),mm=W,aee=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.onEnd,r=n===void 0?function(){}:n,s=(0,mm.useState)([]),o=yb(s,2),i=o[0],a=o[1],l=(0,mm.useState)(!1),c=yb(l,2),u=c[0],h=c[1],d=(0,mm.useState)(!1),f=yb(d,2),p=f[0],m=f[1],y=function(C){a(C)},g=function(){var C=window.speechSynthesis.getVoices();if(C.length>0){y(C);return}window.speechSynthesis.onvoiceschanged=function(I){C=I.target.getVoices(),y(C)}},v=function(){h(!1),r()};(0,mm.useEffect)(function(){typeof window<"u"&&window.speechSynthesis&&(m(!0),g())},[]);var x=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=C.voice,S=I===void 0?null:I,$=C.text,E=$===void 0?"":$,A=C.rate,M=A===void 0?1:A,B=C.pitch,U=B===void 0?1:B,V=C.volume,H=V===void 0?1:V;if(p){h(!0);var K=new window.SpeechSynthesisUtterance;K.text=E,K.voice=S,K.onend=v,K.rate=M,K.pitch=U,K.volume=H,window.speechSynthesis.speak(K)}},b=function(){p&&(h(!1),window.speechSynthesis.cancel())};return{supported:p,speak:x,speaking:u,cancel:b,voices:i}};qS.default=aee;(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=KS;Object.defineProperty(t,"useSpeechRecognition",{enumerable:!0,get:function(){return r(e).default}});var n=qS;Object.defineProperty(t,"useSpeechSynthesis",{enumerable:!0,get:function(){return r(n).default}});function r(s){return s&&s.__esModule?s:{default:s}}})(ku);const qL=async(t,e)=>{try{const r=await(await fetch("http://ip172-18-0-6-chbgqqg1k7jg00fbruf0-8000.direct.labs.play-with-docker.com/predictions/"+e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json();return console.log(r),r.prediction}catch(n){console.log(n)}},lee=async t=>{try{const n=await(await fetch("http://ip172-18-0-6-chbgqqg1k7jg00fbruf0-8000.direct.labs.play-with-docker.com/predictions/crop_yield",{method:"GET",headers:{"Content-Type":"application/json"}})).json();return console.log(n),n}catch(e){console.log(e)}},cee=()=>{const[t,e]=W.useState(null),[n,r]=W.useState(null),[s,o]=W.useState({name:"",prompt:"",photo:""}),[i,a]=W.useState("No Disease"),{speak:l}=ku.useSpeechSynthesis(),c=()=>{l({text:i})};W.useEffect(()=>{c()},[i]),console.log(t);const u=p=>{const m=p.target.files[0];if(e(m),m&&m.type.substr(0,5)==="image"){const y=new FileReader;y.onloadend=()=>{o({...s,photo:y.result})},y.readAsDataURL(m)}else alert("Please upload animage")},h=os.currentUser,d=async p=>{try{const m=await pu(fu(xu,"chickendisease"),{name:i,time:new Date().toLocaleString(),user:h.uid})}catch{}};return T(_o,{children:he("div",{className:"main flex lg:flex-row flex-col    justify-between mt-10 lg:mt-5",children:[he("div",{className:"model flex flex-col  justify-center items-center  lg:w-[950px]  lg:h-[600px] border-solid border-[2px] lg:m-3 m-5 ",children:[T("h1",{className:"lg:text-2xl text-1xl mb-10  font-bold",children:"Upload image to detect chicken disease"}),he("form",{className:"flex flex-col items-center justify center",onSubmit:async p=>{p.preventDefault();const m=new FileReader;m.readAsDataURL(t),m.onloadend=()=>r(m.result);const y=await qL(n,"poultry_diseases");a(y);try{d()}catch(g){console.log(g)}},children:[T("div",{className:"lg:text-xl text-1xl flex justify-center items-center   md:w-[500px] md:h-[300px] border-solid border-2 rounded-[15px]",children:s.photo?T("img",{src:s.photo,alt:"uploaded",className:" w-[400px] h-[199px]  md:w-[500px] md:h-[299px]  border-2 lg:w-[500px] lg:h-[300px] border-solid border-4 rounded:-[5px] md:rounded-[15px]"}):T("h1",{className:" font-bold",children:"No Image Uploaded"})}),he("div",{className:"flex",children:[he("label",{htmlFor:"photo",className:"cursor-pointer",children:[T("div",{className:"mt-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",children:"Upload"}),T("input",{type:"file",accept:"image/*",capture:"environment",name:"photo",id:"photo",className:"sr-only",onChange:u})]}),T("button",{className:"m-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",type:"submit",children:"Predict"})]})]}),T("h1",{className:"lg:text-2xl text-1xl font-bold  m-5",children:i})]}),T("h1",{className:"font-bold flex justify-center lg:hidden",children:"HelperBot"}),T(Vc,{})]})})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uee=1e-7,hee=1e-4;class XL{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class XS{refCount(e){return fr("refCount")}incRef(e){return fr("incRef")}timerAvailable(){return!0}time(e){return fr("time")}read(e){return fr("read")}readSync(e){return fr("readSync")}readToGPU(e,n){return fr("readToGPU")}numDataIds(){return fr("numDataIds")}disposeData(e,n){return fr("disposeData")}write(e,n,r){return fr("write")}move(e,n,r,s,o){return fr("move")}createTensorFromGPUData(e,n,r){return fr("createTensorFromGPUData")}memory(){return fr("memory")}floatPrecision(){return fr("floatPrecision")}epsilon(){return this.floatPrecision()===32?uee:hee}dispose(){return fr("dispose")}}function fr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dee(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,zl(t,e,n)}function nl(t,e,n){return Math.max(t,Math.min(e,n))}function YS(t){return t%2===0?t:t+1}function zl(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function fee(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function k(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function QS(t,e,n=""){k(Qe(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function YL(t){k(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Y(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Qe(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Wc(t){return t%1===0}function Jw(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function yc(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function K2(t,e=s=>0,n,r){return new Promise((s,o)=>{let i=0;const a=()=>{if(t()){s();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function QL(t,e){let n=1,r=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function Le(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),k(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),k(t.every(r=>Wc(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function sa(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:Le(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function Rn(t,e){return Ft(t,e)}function Ft(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function pee(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function mee(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function JL(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function oy(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function gee(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function xf(t){return typeof t=="string"||t instanceof String}function yee(t){return typeof t=="boolean"}function Zw(t){return typeof t=="number"}function $u(t){return Array.isArray(t)?$u(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Zw(t)?"float32":xf(t)?"string":yee(t)?"bool":"float32"}function eC(t){return!!(t&&t.constructor&&t.call&&t.apply)}function tC(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function xe(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function ZL(t,e,n,r=!1){const s=new Array;if(e.length===1){const o=e[0]*(r?2:1);for(let i=0;i<o;i++)s[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<o;l++)s[l]=ZL(t+l*a,i,n,r)}return s}function Ns(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,o)=>s*o)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return ZL(0,t,e,n)}function vee(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function JS(t,e){const n=_n(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function _n(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function eM(t,e){const n=t.reduce((r,s)=>r*s,1);if(e==null||e==="float32")return Ns(t,new Float32Array(n));if(e==="int32")return Ns(t,new Int32Array(n));if(e==="bool")return Ns(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function Xo(t){t.forEach(e=>{k(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function ro(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function Eu(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function ZS(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q2="tfjsflags";class xee{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=bee,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(G().getBool("IS_TEST")||G().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];G().getBool("IS_TEST")||G().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(ZS(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);q2 in e&&e[q2].split(",").forEach(r=>{const[s,o]=r.split(":");this.urlFlags[s]=Cee(s,o)})}}function bee(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(wee(e,r[0],r[1]),r.join("="))),e}function wee(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Cee(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function G(){return tM}let tM=null;function Iee(t){tM=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let vb;function nM(){if(vb==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");vb=t}return vb}function See(){const t=nM();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function ek(t,e){const n=See();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Bv="Abs",bf="Acos",wf="Acosh",Nu="Add",tk="AddN",nk="All",rk="Any",Uv="ArgMax",Vv="ArgMin",Cf="Asin",If="Asinh",Sf="Atan",kf="Atanh",$f="Atan2",Wv="AvgPool",sk="AvgPoolGrad",jv="AvgPool3D",ok="AvgPool3DGrad",Gv="BatchMatMul",Hv="BatchToSpaceND",ik="Bincount",kee="BroadcastTo",rM="BroadcastArgs",Ef="Cast",Nf="Ceil",Tf="ClipByValue",ak="Complex",Kv="ComplexAbs",qv="Concat",Xv="Conv2D",lk="Conv2DBackpropFilter",Yv="Conv2DBackpropInput",Qv="Conv3D",ck="Conv3DBackpropFilterV2",uk="Conv3DBackpropInputV2",Rf="Cos",_f="Cosh",hk="Cumprod",Jv="Cumsum",dk="CropAndResize",fk="DenseBincount",pk="DepthToSpace",Zv="DepthwiseConv2dNative",mk="DepthwiseConv2dNativeBackpropFilter",gk="DepthwiseConv2dNativeBackpropInput",sM="Diag",e0="Dilation2D",nC="Dilation2DBackpropInput",rC="Dilation2DBackpropFilter",Af="RealDiv",oM="Einsum",Df="Elu",yk="EluGrad",Of="Erf",t0="Equal",Pf="Exp",n0="ExpandDims",Ff="Expm1",vk="FFT",xk="Fill",bk="FlipLeftRight",Lf="Floor",Mf="FloorDiv",r0="FusedBatchNorm",s0="GatherV2",iM="GatherNd",o0="Greater",zf="GreaterEqual",Bf="Identity",wk="IFFT",Ck="Imag",Uf="IsFinite",Vf="IsInf",Wf="IsNan",i0="LeakyRelu",a0="Less",l0="LessEqual",aM="LinSpace",jf="Log",Gf="Log1p",c0="LogicalAnd",u0="LogicalNot",h0="LogicalOr",$ee="LogSoftmax",d0="LRN",Ik="LRNGrad",f0="Max",Hf="Maximum",p0="MaxPool",Sk="MaxPoolGrad",m0="MaxPool3D",kk="MaxPool3DGrad",lM="MaxPoolWithArgmax",g0="Mean",y0="Min",Kf="Minimum",v0="MirrorPad",qf="Mod",cM="Multinomial",Xf="Multiply",x0="Neg",b0="NotEqual",$k="NonMaxSuppressionV3",Ek="NonMaxSuppressionV4",Nk="NonMaxSuppressionV5",w0="OnesLike",C0="OneHot",I0="Pack",S0="PadV2",Yf="Pow",k0="Prelu",$0="Prod",uM="RaggedGather",hM="RaggedRange",dM="RaggedTensorToTensor",Tk="Range",Rk="Real",Qf="Reciprocal",Jf="Relu",E0="Reshape",N0="ResizeNearestNeighbor",_k="ResizeNearestNeighborGrad",T0="ResizeBilinear",Ak="ResizeBilinearGrad",Zf="Relu6",R0="Reverse",ep="Round",tp="Rsqrt",fM="ScatterNd",pM="TensorScatterUpdate",mM="SearchSorted",_0="Select",np="Selu",A0="Slice",rp="Sin",sp="Sinh",op="Sign",ip="Sigmoid",ap="Softplus",lp="Sqrt",D0="Sum",O0="SpaceToBatchND",P0="SplitV",F0="Softmax",gM="SparseFillEmptyRows",yM="SparseReshape",vM="SparseSegmentMean",xM="SparseSegmentSum",bM="SparseToDense",cp="SquaredDifference",Dk="Square",Ok="StaticRegexReplace",Pk="StridedSlice",wM="StringNGrams",CM="StringSplit",IM="StringToHashBucketFast",up="Sub",hp="Tan",dp="Tanh",fp="Tile",Fk="TopK",Lk="Transform",vc="Transpose",Mk="Unique",L0="Unpack",M0="UnsortedSegmentSum",z0="ZerosLike",pp="Step",Eee="FromPixels",zk="RotateWithOffset",iy="_FusedMatMul",ay="FusedConv2D",SM="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ar(...t){G().getBool("IS_TEST")||G().getBool("PROD")||console.warn(...t)}function Nee(...t){G().getBool("IS_TEST")||G().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ly=ek("kernelRegistry",()=>new Map),sC=ek("gradRegistry",()=>new Map);function X2(t,e){const n=$M(t,e);return ly.get(n)}function Y2(t){return sC.get(t)}function Q2(t){const e=ly.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[o,i]=s,[a]=o.split("_");a===t&&n.push(i)}return n}function kM(t){const{kernelName:e,backendName:n}=t,r=$M(e,n);ly.has(r)&&Ar(`The kernel '${e}' for backend '${n}' is already registered`),ly.set(r,t)}function Tee(t){const{kernelName:e}=t;sC.has(e)&&G().getBool("DEBUG")&&Ar(`Overriding the gradient for '${e}'`),sC.set(e,t)}function $M(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EM(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var oC=mt,Zr=null;try{Zr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function mt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}mt.prototype.__isLong__;Object.defineProperty(mt.prototype,"__isLong__",{value:!0});function Nr(t){return(t&&t.__isLong__)===!0}mt.isLong=Nr;var J2={},Z2={};function bl(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=Z2[t],r)?r:(n=gt(t,(t|0)<0?-1:0,!0),s&&(Z2[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=J2[t],r)?r:(n=gt(t,t<0?-1:0,!1),s&&(J2[t]=n),n))}mt.fromInt=bl;function es(t,e){if(isNaN(t))return e?Aa:ts;if(e){if(t<0)return Aa;if(t>=NM)return _M}else{if(t<=-tR)return xr;if(t+1>=tR)return RM}return t<0?es(-t,e).neg():gt(t%jc|0,t/jc|0,e)}mt.fromNumber=es;function gt(t,e,n){return new mt(t,e,n)}mt.fromBits=gt;var cy=Math.pow;function Bk(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return ts;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Bk(t.substring(1),e,n).neg();for(var s=es(cy(n,8)),o=ts,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var c=es(cy(n,a));o=o.mul(c).add(es(l))}else o=o.mul(s),o=o.add(es(l))}return o.unsigned=e,o}mt.fromString=Bk;function Ls(t,e){return typeof t=="number"?es(t,e):typeof t=="string"?Bk(t,e):gt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}mt.fromValue=Ls;var eR=1<<16,Ree=1<<24,jc=eR*eR,NM=jc*jc,tR=NM/2,nR=bl(Ree),ts=bl(0);mt.ZERO=ts;var Aa=bl(0,!0);mt.UZERO=Aa;var oc=bl(1);mt.ONE=oc;var TM=bl(1,!0);mt.UONE=TM;var iC=bl(-1);mt.NEG_ONE=iC;var RM=gt(-1,2147483647,!1);mt.MAX_VALUE=RM;var _M=gt(-1,-1,!0);mt.MAX_UNSIGNED_VALUE=_M;var xr=gt(0,-2147483648,!1);mt.MIN_VALUE=xr;var ce=mt.prototype;ce.toInt=function(){return this.unsigned?this.low>>>0:this.low};ce.toNumber=function(){return this.unsigned?(this.high>>>0)*jc+(this.low>>>0):this.high*jc+(this.low>>>0)};ce.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(xr)){var n=es(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=es(cy(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),c=i.sub(l.mul(o)).toInt()>>>0,u=c.toString(e);if(i=l,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};ce.getHighBits=function(){return this.high};ce.getHighBitsUnsigned=function(){return this.high>>>0};ce.getLowBits=function(){return this.low};ce.getLowBitsUnsigned=function(){return this.low>>>0};ce.getNumBitsAbs=function(){if(this.isNegative())return this.eq(xr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ce.isZero=function(){return this.high===0&&this.low===0};ce.eqz=ce.isZero;ce.isNegative=function(){return!this.unsigned&&this.high<0};ce.isPositive=function(){return this.unsigned||this.high>=0};ce.isOdd=function(){return(this.low&1)===1};ce.isEven=function(){return(this.low&1)===0};ce.equals=function(e){return Nr(e)||(e=Ls(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ce.eq=ce.equals;ce.notEquals=function(e){return!this.eq(e)};ce.neq=ce.notEquals;ce.ne=ce.notEquals;ce.lessThan=function(e){return this.comp(e)<0};ce.lt=ce.lessThan;ce.lessThanOrEqual=function(e){return this.comp(e)<=0};ce.lte=ce.lessThanOrEqual;ce.le=ce.lessThanOrEqual;ce.greaterThan=function(e){return this.comp(e)>0};ce.gt=ce.greaterThan;ce.greaterThanOrEqual=function(e){return this.comp(e)>=0};ce.gte=ce.greaterThanOrEqual;ce.ge=ce.greaterThanOrEqual;ce.compare=function(e){if(Nr(e)||(e=Ls(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ce.comp=ce.compare;ce.negate=function(){return!this.unsigned&&this.eq(xr)?xr:this.not().add(oc)};ce.neg=ce.negate;ce.add=function(e){Nr(e)||(e=Ls(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,h=0,d=0,f=0;return f+=o+c,d+=f>>>16,f&=65535,d+=s+l,h+=d>>>16,d&=65535,h+=r+a,u+=h>>>16,h&=65535,u+=n+i,u&=65535,gt(d<<16|f,u<<16|h,this.unsigned)};ce.subtract=function(e){return Nr(e)||(e=Ls(e)),this.add(e.neg())};ce.sub=ce.subtract;ce.multiply=function(e){if(this.isZero())return ts;if(Nr(e)||(e=Ls(e)),Zr){var n=Zr.mul(this.low,this.high,e.low,e.high);return gt(n,Zr.get_high(),this.unsigned)}if(e.isZero())return ts;if(this.eq(xr))return e.isOdd()?xr:ts;if(e.eq(xr))return this.isOdd()?xr:ts;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(nR)&&e.lt(nR))return es(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,h=0,d=0,f=0,p=0;return p+=i*u,f+=p>>>16,p&=65535,f+=o*u,d+=f>>>16,f&=65535,f+=i*c,d+=f>>>16,f&=65535,d+=s*u,h+=d>>>16,d&=65535,d+=o*c,h+=d>>>16,d&=65535,d+=i*l,h+=d>>>16,d&=65535,h+=r*u+s*c+o*l+i*a,h&=65535,gt(f<<16|p,h<<16|d,this.unsigned)};ce.mul=ce.multiply;ce.divide=function(e){if(Nr(e)||(e=Ls(e)),e.isZero())throw Error("division by zero");if(Zr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Zr.div_u:Zr.div_s)(this.low,this.high,e.low,e.high);return gt(n,Zr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Aa:ts;var r,s,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Aa;if(e.gt(this.shru(1)))return TM;o=Aa}else{if(this.eq(xr)){if(e.eq(oc)||e.eq(iC))return xr;if(e.eq(xr))return oc;var i=this.shr(1);return r=i.div(e).shl(1),r.eq(ts)?e.isNegative()?oc:iC:(s=this.sub(e.mul(r)),o=r.add(s.div(e)),o)}else if(e.eq(xr))return this.unsigned?Aa:ts;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=ts}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:cy(2,a-48),c=es(r),u=c.mul(e);u.isNegative()||u.gt(s);)r-=l,c=es(r,this.unsigned),u=c.mul(e);c.isZero()&&(c=oc),o=o.add(c),s=s.sub(u)}return o};ce.div=ce.divide;ce.modulo=function(e){if(Nr(e)||(e=Ls(e)),Zr){var n=(this.unsigned?Zr.rem_u:Zr.rem_s)(this.low,this.high,e.low,e.high);return gt(n,Zr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ce.mod=ce.modulo;ce.rem=ce.modulo;ce.not=function(){return gt(~this.low,~this.high,this.unsigned)};ce.and=function(e){return Nr(e)||(e=Ls(e)),gt(this.low&e.low,this.high&e.high,this.unsigned)};ce.or=function(e){return Nr(e)||(e=Ls(e)),gt(this.low|e.low,this.high|e.high,this.unsigned)};ce.xor=function(e){return Nr(e)||(e=Ls(e)),gt(this.low^e.low,this.high^e.high,this.unsigned)};ce.shiftLeft=function(e){return Nr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?gt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):gt(0,this.low<<e-32,this.unsigned)};ce.shl=ce.shiftLeft;ce.shiftRight=function(e){return Nr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?gt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):gt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ce.shr=ce.shiftRight;ce.shiftRightUnsigned=function(e){if(Nr(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return gt(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?gt(n,0,this.unsigned):gt(n>>>e-32,0,this.unsigned)};ce.shru=ce.shiftRightUnsigned;ce.shr_u=ce.shiftRightUnsigned;ce.toSigned=function(){return this.unsigned?gt(this.low,this.high,!1):this};ce.toUnsigned=function(){return this.unsigned?this:gt(this.low,this.high,!0)};ce.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ce.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ce.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};mt.fromBytes=function(e,n,r){return r?mt.fromBytesLE(e,n):mt.fromBytesBE(e,n)};mt.fromBytesLE=function(e,n){return new mt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};mt.fromBytesBE=function(e,n){return new mt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const _ee=A_({__proto__:null,default:oC},[oC]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ca=oC||_ee;function B0(t){return Ca.fromString(t,!0,16)}const AM=B0("c3a5c85c97cb3127"),wa=B0("b492b66fbe98f273"),Vn=B0("9ae16a3b2f90404f");function aC(t){return t.xor(t.shru(47))}function DM(t,e,n){const r=t.slice(e,e+n);return Ca.fromBytes(Array.from(r),!0,!0)}function lt(t,e){return DM(t,e,8)}function rR(t,e){return DM(t,e,4)}function rn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Fi(t,e,n=B0("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function Aee(t,e,n,r,s,o){s=s.add(t),o=rn(o.add(s).add(r),21);const i=s;return s=s.add(e),s=s.add(n),o=o.add(rn(s,44)),[s.add(r),o.add(i)]}function gm(t,e,n,r){return Aee(lt(t,e),lt(t,e+8),lt(t,e+16),lt(t,e+24),n,r)}function Dee(t,e=t.length){if(e>=8){const n=Vn.add(e*2),r=lt(t,0).add(Vn),s=lt(t,e-8),o=rn(s,37).mul(n).add(r),i=rn(r,25).add(s).mul(n);return Fi(o,i,n)}if(e>=4){const n=Vn.add(e*2),r=rR(t,0);return Fi(r.shl(3).add(e),rR(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],o=n+(r<<8),i=e+(s<<2);return aC(Vn.mul(o).xor(AM.mul(i))).mul(Vn)}return Vn}function Oee(t,e=t.length){const n=Vn.add(e*2),r=lt(t,0).mul(wa),s=lt(t,8),o=lt(t,e-8).mul(n),i=lt(t,e-16).mul(Vn);return Fi(rn(r.add(s),43).add(rn(o,30)).add(i),r.add(rn(s.add(Vn),18)).add(o),n)}function Pee(t,e=t.length){const n=Vn.add(e*2),r=lt(t,0).mul(Vn),s=lt(t,8),o=lt(t,e-8).mul(n),i=lt(t,e-16).mul(Vn),a=rn(r.add(s),43).add(rn(o,30)).add(i),l=Fi(a,r.add(rn(s.add(Vn),18)).add(o),n),c=lt(t,16).mul(n),u=lt(t,24),h=a.add(lt(t,e-32)).mul(n),d=l.add(lt(t,e-24)).mul(n);return Fi(rn(c.add(u),43).add(rn(h,30)).add(d),c.add(rn(u.add(r),18)).add(h),n)}function Fee(t,e=t.length){const n=Ca.fromNumber(81,!0);if(e<=32)return e<=16?Dee(t,e):Oee(t,e);if(e<=64)return Pee(t,e);let r=n,s=n.mul(wa).add(113),o=aC(s.mul(Vn).add(113)).mul(Vn),i=[Ca.UZERO,Ca.UZERO],a=[Ca.UZERO,Ca.UZERO];r=r.mul(Vn).add(lt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do r=rn(r.add(s).add(i[0]).add(lt(t,l+8)),37).mul(wa),s=rn(s.add(i[1]).add(lt(t,l+48)),42).mul(wa),r=r.xor(a[1]),s=s.add(i[0]).add(lt(t,l+40)),o=rn(o.add(a[0]),33).mul(wa),i=gm(t,l,i[1].mul(wa),r.add(a[0])),a=gm(t,l+32,o.add(a[1]),s.add(lt(t,l+16))),[o,r]=[r,o],l+=64;while(l!==c);const h=wa.add(o.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=rn(r.add(s).add(i[0]).add(lt(t,l+8)),37).mul(h),s=rn(s.add(i[1]).add(lt(t,l+48)),42).mul(h),r=r.xor(a[1].mul(9)),s=s.add(i[0].mul(9).add(lt(t,l+40))),o=rn(o.add(a[0]),33).mul(h),i=gm(t,l,i[1].mul(h),r.add(a[0])),a=gm(t,l+32,o.add(a[1]),s.add(lt(t,l+16))),[o,r]=[r,o],Fi(Fi(i[0],a[0],h).add(aC(s).mul(AM)).add(o),Fi(i[1],a[1],h).add(r),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oa(t,e){return e==="string"?Li(t):wl([t],e)}function Lee(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function wl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=rl(t)),G().getBool("DEBUG")&&pee(t,e),Lee(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function er(){return G().platform.now()}function Li(t,e="utf-8"){return e=e||"utf-8",G().platform.encode(t,e)}function Hi(t,e="utf-8"){return e=e||"utf-8",G().platform.decode(t,e)}function Ds(t){return G().platform.isTypedArray!=null?G().platform.isTypedArray(t):EM(t)}function rl(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||ZS(t)||t==null||Ds(t)&&n)e.push(t);else if(Array.isArray(t)||Ds(t))for(let r=0;r<t.length;++r)rl(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)rl(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mee{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Bee)}profileKernel(e,n,r){let s;const o=()=>{s=r()};let i;const a=er();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const c of s)c.dataSync();i=Promise.resolve({kernelMs:er()-a})}if(G().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<s.length;c++){const u=s[c];u.data().then(h=>{zee(h,u.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:o,extraInfo:i}=e;r.forEach(a=>{Promise.all([a.data(),s,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function zee(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class Bee{logKernelProfile(e,n,r,s,o,i){const a=typeof s=="number"?yc(`${s}ms`,9):s.error,l=yc(e,25),c=n.rank,u=n.size,h=yc(n.shape.toString(),14);let d="";for(const f in o){const p=o[f];if(p!=null){const m=p.shape||n.shape,y=m.length;d+=`${f}: ${y}D ${y>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${h}	%c${u}	%c${d}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const h in u){const d=u[h];let f=!1;for(let p=0;p<e.length;p++)if(r[d.id]){c.outputs.forEach(m=>r[m.id]=!0),f=!0,s[c.id]=!0;break}if(f)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let h=0;h<c.outputs.length;h++)if(o[c.outputs[h].id]){for(const d in u)o[u[d].id]=!0,i[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(s[c.id]&&i[c.id]){const u={};for(const d in c.inputs){const f=c.inputs[d];r[f.id]&&(u[d]=f)}const h=Object.assign({},c);h.inputs=u,h.outputs=c.outputs,a.push(h)}}return a}function Vee(t,e,n,r){for(let s=e.length-1;s>=0;s--){const o=e[s],i=[];if(o.outputs.forEach(l=>{const c=t[l.id];c!=null?i.push(c):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=o.inputs[l];if(!Qe(c.shape,u.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const h=t[u.id];t[u.id]=r(h,c),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sR=20,Qu=3,xb=7;function Wee(t,e,n,r){const s=xe(e),o=jee(t,e,n,s),i=e.length,a=Xm(t,e,n,s,o),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function jee(t,e,n,r){const s=Y(e),o=r[r.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?hh(t):t;if(a>1)for(let c=0;c<s/o;c++){const u=c*o;for(let h=0;h<o;h++)i[h]=Math.max(i[h],uh(l[u+h],0,n).length)}return i}function uh(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(xb))} + ${parseFloat(t[1].toFixed(xb))}j`:xf(t)?r=`'${t}'`:n==="bool"?r=OM(t):r=parseFloat(t.toFixed(xb)).toString(),yc(r,e)}function OM(t){return t===0?"false":"true"}function Xm(t,e,n,r,s,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=hh(t);return[uh(m[0],0,n)]}return n==="bool"?[OM(t[0])]:[t[0].toString()]}if(l===1){if(a>sR){const y=Qu*i;let g=Array.from(t.slice(0,y)),v=Array.from(t.slice((a-Qu)*i,a*i));return n==="complex64"&&(g=hh(g),v=hh(v)),["["+g.map((x,b)=>uh(x,s[b],n)).join(", ")+", ..., "+v.map((x,b)=>uh(x,s[a-Qu+b],n)).join(", ")+"]"]}return["["+(n==="complex64"?hh(t):Array.from(t)).map((y,g)=>uh(y,s[g],n)).join(", ")+"]"]}const c=e.slice(1),u=r.slice(1),h=r[0]*i,d=[];if(a>sR){for(let m=0;m<Qu;m++){const y=m*h,g=y+h;d.push(...Xm(t.slice(y,g),c,n,u,s,!1))}d.push("...");for(let m=a-Qu;m<a;m++){const y=m*h,g=y+h;d.push(...Xm(t.slice(y,g),c,n,u,s,m===a-1))}}else for(let m=0;m<a;m++){const y=m*h,g=y+h;d.push(...Xm(t.slice(y,g),c,n,u,s,m===a-1))}const f=l===2?",":"";d[0]="["+(a>0?d[0]+f:"");for(let m=1;m<d.length-1;m++)d[m]=" "+d[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(o?"":p),d}function hh(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vn{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=Y(e),r!=null){const s=r.length;k(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Ft(n,this.size),this.strides=xe(e)}set(e,...n){n.length===0&&(n=[0]),k(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return ws().makeTensor(this.values,this.shape,this.dtype)}}let ws=null,Bl=null;function Gee(t){ws=t}function Hee(t){Bl=t}class Wt{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Y(e),this.strides=xe(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Bl.buffer(this.shape,this.dtype,e)}bufferSync(){return Bl.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Ns(this.shape,e,this.dtype==="complex64")}arraySync(){return Ns(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ws().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Hi(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ws().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ws().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Hi(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ws().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(ws().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Bl.print(this,e)}clone(){return this.throwIfDisposed(),Bl.clone(this)}toString(e=!1){const n=this.dataSync();return Wee(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Bl.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),ws().makeVariable(this,e,n,r)}}Object.defineProperty(Wt,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function X(){return ek("Tensor",()=>Wt)}X();class uy extends Wt{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Qe(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ws().disposeTensor(this),this.dataId=e.dataId,ws().incRef(this,null)}dispose(){ws().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(uy,Symbol.hasInstance,{value:t=>t instanceof Wt&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var oR;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(oR||(oR={}));var lC;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(lC||(lC={}));var cC;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(cC||(cC={}));var uC;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(uC||(uC={}));var hC;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(hC||(hC={}));const Kee={float32:uC,int32:lC,bool:cC,complex64:hC};function kr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return Kee[t][e]}function Uk(t){return kr(t,"int32")}function PM(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function FM(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zt(t,e){if(t.dtype===e.dtype)return[t,e];const n=kr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function LM(t){const e=[];return MM(t,e,new Set),e}function MM(t,e,n){if(t==null)return;if(t instanceof Wt){e.push(t);return}if(!qee(t))return;const r=t;for(const s in r){const o=r[s];n.has(o)||(n.add(o),MM(o,e,n))}}function qee(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bb(t){return t.kernelName!=null}class iR{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Gc{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new iR}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Ar(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Mee(this.backendInstance),!0}setupRegisteredKernels(){Q2(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Q2(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof XS)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,o=r.then(i=>s<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Ar(`Initialization of backend ${e} failed`),Ar(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Ar(`Initialization of backend ${e} failed`),Ar(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:o}=this.initializeBackend(r);if(o||s)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,o=this.readSync(n),i=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,o,r.shape,r.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return Gc.nextTensorId++}nextVariableId(){return Gc.nextVariableId++}clone(e){const n=P.runKernel(Bf,{x:e}),r={x:e},s=i=>({x:()=>{const a="float32",l={x:i},c={dtype:a};return P.runKernel(Ef,l,c)}}),o=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,o,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(X2(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let o=0;r.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=bb(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(bb(e)){const{kernelName:p,inputs:m,attrs:y}=e;this.backendName==null&&this.backend;const g=X2(p,this.backendName);k(g!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const v=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:y,backend:this.backend});const x=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,v,x);const b=x.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(s){const w=this.getTensorsForGradient(p,m,b);r=this.saveTensorsForBackwardMode(w)}return b}}else{const{forwardFunc:p}=e,m=y=>{s&&(r=y.map(g=>this.keep(this.clone(g))))};a=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,y,g),g}}const{inputs:u,attrs:h}=e,d=bb(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),s&&this.addTapeNode(c,u,n,d,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=Y2(e);if(s!=null){const o=s.inputsToSave||[],i=s.outputsToSave||[];let a;s.saveAllInputs?(k(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=o.map(c=>n[c]);const l=r.filter((c,u)=>i[u]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let o=e;r==="string"&&xf(e[0])&&(o=e.map(l=>Li(l)));const i=s.write(o,n,r),a=new Wt(n,r,i,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(i),c=gee(o);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const o={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(o,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:o}=e,i=new Wt(s,o,r,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new uy(e,n,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*oy(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof uy||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*oy(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:o},l=Y2(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=c=>(c=c.map((u,h)=>{if(u==null){const d=r[h],f=_n(d.size,d.dtype);return this.makeTensor(f,d.shape,d.dtype)}return u}),s(c.length>1?c:c[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=LM(e),r=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!r.has(i.id)&&i.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,n,r,s=!1){if(k(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));k(o instanceof Wt,()=>"The result y returned by f() must be a tensor.");const i=Uee(this.state.activeTape,n,o);if(!s&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=r??Xee(o.shape),Vee(a,i,c=>this.tidy(c),Yee);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return k(eC(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{k(n.every(a=>a instanceof Wt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const o=(a,l)=>(r=e(...n,l),k(r.value instanceof Wt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),k(eC(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i=(a,l)=>{const c=r.gradFunc(a,l),u=Array.isArray(c)?c:[c];k(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),k(u.every(d=>d instanceof Wt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return u.forEach((d,f)=>{h[f]=()=>d}),h};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=er(),r=await this.backend.time(e);return r.wallMs=er()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new iR;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Gc.nextTensorId=0;Gc.nextVariableId=0;function Xee(t){const e=JS(Y(t),"float32");return P.makeTensor(e,t,"float32")}function zM(){const t=nM();if(t._tfengine==null){const e=new xee(t);t._tfengine=new Gc(e)}return Iee(t._tfengine.ENV),Gee(()=>t._tfengine),t._tfengine}const P=zM();function Yee(t,e){const n={a:t,b:e};return P.runKernel(Nu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(){return typeof navigator<"u"&&navigator!=null}function BM(t){if(t||Qee()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function UM(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ar=G();ar.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ar.registerFlag("IS_BROWSER",()=>UM());ar.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ar.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ar.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ar.registerFlag("PROD",()=>!1);ar.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ar.getBool("DEBUG"));ar.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ar.registerFlag("IS_TEST",()=>!1);ar.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ar.getBool("DEBUG"));ar.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ar.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ar.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U0(t,e){let n=t;if(Ds(t))return e==="string"?[]:[t.length];if(PM(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(FM(t))return[t.buffer.size/(e==null?4:oy(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Ds(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&G().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&VM(t,r,[]),r}function VM(t,e,n){if(n=n||[],!Array.isArray(t)&&!Ds(t)){k(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}k(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),k(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)VM(t[s],r,n.concat(s))}function aR(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function N(t,e,n,r="numeric"){if(t instanceof Wt)return aR(r,t.dtype,e,n),t;let s=$u(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),aR(r,s,e,n),t==null||!Ds(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=U0(t,s);!Ds(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?wl(t,s):rl(t,[],!0);return P.makeTensor(a,o,s)}function WM(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>N(o,`${e}[${i}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jee="__op";function L(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Jee;const s=(...o)=>{P.startScope(n);try{const i=r(...o);return ZS(i)&&console.error("Cannot return a Promise inside of tidy."),P.endScope(i),i}catch(i){throw P.endScope(null),i}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t,e){const n=N(t,"real","complex"),r=N(e,"imag","complex");QS(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return P.runKernel(ak,s)}const Hc=L({complex_:Zee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0(t,e,n,r){if(r==null)r=$u(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(FM(t)||PM(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return P.backend.createTensorFromGPUData(t,e||n,r)}if(!Ds(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Xo(e);const s=Y(e),o=Y(n);k(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==Y(e.slice(i)):!0;k(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Ds(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?wl(t,r):rl(t,[],!0),P.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jM(t,e,n){const r=U0(t,n);return V0(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lR=4;async function cR(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<s.length;++i){const a=s[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async h=>{const d=await l.bytes(),f=d.reduce((y,g)=>y+g.length,0)+lR*d.length,p=new Uint8Array(f);let m=0;for(let y=0;y<d.length;y++){const g=d[y],v=new Uint8Array(new Uint32Array([g.length]).buffer);p.set(v,m),m+=lR,p.set(g,m),m+=g.length}h(p)});r.push(u)}else r.push(l.data());e!=null&&(c.group=e),n.push(c)}const o=await Promise.all(r);return{data:ete(o),specs:n}}function ete(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(o=>{r.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),r.buffer}const Vk=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function uR(t){return Vk?Buffer.byteLength(t):new Blob([t]).size}function tte(t){if(Vk)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function nte(t){if(Vk){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function GM(t){if(t.length===1)return t[0];let e=0;t.forEach(s=>{e+=s.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(s=>{n.set(new Uint8Array(s),r),r+=s.byteLength}),n.buffer}function HM(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function rte(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function ste(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),rte(t,n,r)}function W0(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:uR(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:uR(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}function ote(t){const e=[];for(const n of t)e.push(...n.weights);return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return tn.instance==null&&(tn.instance=new tn),tn.instance}static registerSaveRouter(e){tn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){tn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return tn.getHandlers(e,"save")}static getLoadHandlers(e,n){return tn.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?tn.getInstance().loadRouters:tn.getInstance().saveRouters).forEach(i=>{const a=i(e,r);a!==null&&s.push(a)}),s}}const ite=t=>tn.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dC="tensorflowjs",fC=1,Da="models_store",xi="model_info_store";function KM(){if(!G().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function pC(t){const e=t.result;e.createObjectStore(Da,{keyPath:"modelPath"}),e.createObjectStore(xi,{keyPath:"modelPath"})}class sl{constructor(e){if(this.indexedDB=KM(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const o=this.indexedDB.open(dC,fC);o.onupgradeneeded=()=>pC(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(Da,"readonly"),c=a.objectStore(Da).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=u=>(i.close(),s(c.error)),a.oncomplete=()=>i.close()}else{const a=W0(n),l=i.transaction(xi,"readwrite");let c=l.objectStore(xi),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(d){return s(d)}let h;u.onsuccess=()=>{h=i.transaction(Da,"readwrite");const d=h.objectStore(Da);let f;try{f=d.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return s(p)}f.onsuccess=()=>r({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(xi);const m=c.delete(this.modelPath);m.onsuccess=()=>(i.close(),s(f.error)),m.onerror=y=>(i.close(),s(f.error))}},u.onerror=d=>(i.close(),s(u.error)),l.oncomplete=()=>{h==null?i.close():h.oncomplete=()=>i.close()}}},o.onerror=i=>s(o.error)})}}sl.URL_SCHEME="indexeddb://";const qM=t=>G().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(sl.URL_SCHEME)?ate(t.slice(sl.URL_SCHEME.length)):null;tn.registerSaveRouter(qM);tn.registerLoadRouter(qM);function ate(t){return new sl(t)}function lte(t){return t.startsWith(sl.URL_SCHEME)?t.slice(sl.URL_SCHEME.length):t}class cte{constructor(){this.indexedDB=KM()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(dC,fC);r.onupgradeneeded=()=>pC(r),r.onsuccess=()=>{const s=r.result,o=s.transaction(xi,"readonly"),a=o.objectStore(xi).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),o.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=lte(e),new Promise((n,r)=>{const s=this.indexedDB.open(dC,fC);s.onupgradeneeded=()=>pC(s),s.onsuccess=()=>{const o=s.result,i=o.transaction(xi,"readwrite"),a=i.objectStore(xi),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return o.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),h=()=>{c=o.transaction(Da,"readwrite");const f=c.objectStore(Da).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>r(l.error)};u.onsuccess=h,u.onerror=d=>(h(),o.close(),r(l.error))}},l.onerror=u=>(o.close(),r(l.error)),i.oncomplete=()=>{c==null?o.close():c.oncomplete=()=>o.close()}},s.onerror=o=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bo="/",Ul="tensorflowjs_models",XM="info",ute="model_topology",hte="weight_specs",dte="weight_data",fte="model_metadata";function YM(t){return{info:[Ul,t,XM].join(bo),topology:[Ul,t,ute].join(bo),weightSpecs:[Ul,t,hte].join(bo),weightData:[Ul,t,dte].join(bo),modelMetadata:[Ul,t,fte].join(bo)}}function QM(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function pte(t){const e=t.split(bo);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(bo)}function mte(t){return t.startsWith(ol.URL_SCHEME)?t.slice(ol.URL_SCHEME.length):t}class ol{constructor(e){if(!G().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=YM(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=W0(e);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,tte(e.weightData));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw QM(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=nte(i),n}}ol.URL_SCHEME="localstorage://";const JM=t=>G().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ol.URL_SCHEME)?gte(t.slice(ol.URL_SCHEME.length)):null;tn.registerSaveRouter(JM);tn.registerLoadRouter(JM);function gte(t){return new ol(t)}class yte{constructor(){k(G().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),k(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Ul+bo,r=bo+XM;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(n)&&o.endsWith(r)){const i=pte(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=mte(e);const n=YM(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return QM(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hR="://";class Ws{constructor(){this.managers={}}static getInstance(){return Ws.instance==null&&(Ws.instance=new Ws),Ws.instance}static registerManager(e,n){k(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(hR)&&(e=e.slice(0,e.indexOf(hR))),k(e.length>0,()=>"scheme must not be an empty string.");const r=Ws.getInstance();k(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=Ws.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(Ws.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vte{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!G().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return EM(e)}}if(G().get("IS_BROWSER")){G().setPlatform("browser",new vte);try{Ws.registerManager(ol.URL_SCHEME,new yte)}catch{}try{Ws.registerManager(sl.URL_SCHEME,new cte)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xte={importFetch:()=>require("node-fetch")};let wb;class bte{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return G().global.fetch!=null?G().global.fetch(e,n):(wb==null&&(wb=xte.importFetch()),wb(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}G().get("IS_NODE")&&!G().get("IS_BROWSER")&&G().setPlatform("node",new bte);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fe(t,e="float32",n){return e=e||"float32",Xo(t),new vn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(t,e){const n=N(t,"x","cast");if(!mee(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return P.runKernel(Ef,r,s)}const fe=L({cast_:wte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(t){const n={x:N(t,"x","clone","string_or_numeric")};return P.runKernel(Bf,n)}const Ua=L({clone_:Cte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ite(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */zM();const Ste={buffer:Fe,cast:fe,clone:Ua,print:Ite};Hee(Ste);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vs(){return P}function mC(){return P.memory()}function j(t,e){return P.tidy(t,e)}function ze(t){LM(t).forEach(n=>n.dispose())}function so(t){return P.keep(t)}function ZM(t,e,n=1){return P.registerBackend(t,e,n)}function kte(){return P.backend}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(t,e){let n=N(t,"a","add"),r=N(e,"b","add");[n,r]=zt(n,r);const s={a:n,b:r};return P.runKernel(Nu,s)}const te=L({add_:$te});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(t,e){let n=N(t,"a","floorDiv"),r=N(e,"b","floorDiv");[n,r]=zt(n,r);const s={a:n,b:r};return P.runKernel(Mf,s)}const e3=L({floorDiv_:Ete});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t,e){let n=N(t,"a","div"),r=N(e,"b","div");if([n,r]=zt(n,r),n.dtype==="int32"&&r.dtype==="int32")return e3(n,r);const s={a:n,b:r},o={};return P.runKernel(Af,s,o)}const Ce=L({div_:Nte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tte(t,e){let n=N(t,"a","mul"),r=N(e,"b","mul");[n,r]=zt(n,r);const s={a:n,b:r};return P.runKernel(Xf,s)}const O=L({mul_:Tte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rte(t){const e=N(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return P.runKernel(Kv,n)}else{const n={x:e};return P.runKernel(Bv,n)}}const zn=L({abs_:Rte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _te(t){const n={x:N(t,"x","acos")};return P.runKernel(bf,n)}const Ate=L({acos_:_te});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dte(t){const n={x:N(t,"x","acosh")};return P.runKernel(wf,n)}const Ote=L({acosh_:Dte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pte(t,e=null,n=!1){const s={x:N(t,"x","all","bool")},o={axis:e,keepDims:n};return P.runKernel(nk,s,o)}const t3=L({all_:Pte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t,e=null,n=!1){const s={x:N(t,"x","any","bool")},o={axis:e,keepDims:n};return P.runKernel(rk,s,o)}const gC=L({any_:Fte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t,e=0){const r={x:N(t,"x","argMax")},s={axis:e};return P.runKernel(Uv,r,s)}const Nd=L({argMax_:Lte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(t,e=0){const r={x:N(t,"x","argMin")},s={axis:e};return P.runKernel(Vv,r,s)}const zte=L({argMin_:Mte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bte(t){const n={x:N(t,"x","asin")};return P.runKernel(Cf,n)}const Ute=L({asin_:Bte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t){const n={x:N(t,"x","asinh")};return P.runKernel(If,n)}const Wte=L({asinh_:Vte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jte(t){const n={x:N(t,"x","atan")};return P.runKernel(Sf,n)}const Gte=L({atan_:jte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(t,e){let n=N(t,"a","atan2"),r=N(e,"b","atan2");[n,r]=zt(n,r);const s={a:n,b:r};return P.runKernel($f,s)}const Kte=L({atan2_:Hte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qte(t){const n={x:N(t,"x","atanh")};return P.runKernel(kf,n)}const Xte=L({atanh_:qte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mp(t,e,n,r,s="NHWC",o){const i=t[3],a=[...e,i],l=Qo(s);return wn(t,a,n,o,r,null,null,l)}function us(t,e,n,r,s,o,i="channelsLast"){const[a,l]=Td(e);let c;if(i==="channelsLast")c=[a,l,t[3],t[3]];else if(i==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return wn(t,c,n,r,s,o,!1,i)}function Yo(t,e,n,r,s,o,i="NDHWC"){const[a,l,c]=yC(e);let u,h;if(i==="NDHWC")h="channelsLast",u=[a,l,c,t[4],t[4]];else if(i==="NCDHW")h="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return ia(t,u,n,r,s,!1,h,o)}function wn(t,e,n,r,s,o,i=!1,a="channelsLast"){let[l,c,u,h]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,h]=t;else if(a==="channelsFirst")[l,h,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[d,f,,p]=e,[m,y]=Td(n),[g,v]=Td(r),x=xc(d,g),b=xc(f,v),{padInfo:w,outHeight:C,outWidth:I}=Jte(s,c,u,m,y,x,b,o,a),S=i?p*h:p;let $;return a==="channelsFirst"?$=[l,S,C,I]:a==="channelsLast"&&($=[l,C,I,S]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:h,outHeight:C,outWidth:I,outChannels:S,padInfo:w,strideHeight:m,strideWidth:y,filterHeight:d,filterWidth:f,effectiveFilterHeight:x,effectiveFilterWidth:b,dilationHeight:g,dilationWidth:v,inShape:t,outShape:$,filterShape:e}}function ia(t,e,n,r,s,o=!1,i="channelsLast",a){let[l,c,u,h,d]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,h,d]=t;else if(i==="channelsFirst")[l,d,c,u,h]=t;else throw new Error(`Unknown dataFormat ${i}`);const[f,p,m,,y]=e,[g,v,x]=yC(n),[b,w,C]=yC(r),I=xc(f,b),S=xc(p,w),$=xc(m,C),{padInfo:E,outDepth:A,outHeight:M,outWidth:B}=Zte(s,c,u,h,g,v,x,I,S,$,a),U=o?y*d:y;let V;return i==="channelsFirst"?V=[l,U,A,M,B]:i==="channelsLast"&&(V=[l,A,M,B,U]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:h,inChannels:d,outDepth:A,outHeight:M,outWidth:B,outChannels:U,padInfo:E,strideDepth:g,strideHeight:v,strideWidth:x,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:I,effectiveFilterHeight:S,effectiveFilterWidth:$,dilationDepth:b,dilationHeight:w,dilationWidth:C,inShape:t,outShape:V,filterShape:e}}function Yte(t,e,n,r,s){r==null&&(r=Wk(t,e,n));const o=t[0],i=t[1],a=Rd((o-e+2*r)/n+1,s),l=Rd((i-e+2*r)/n+1,s);return[a,l]}function Qte(t,e,n,r,s,o){s==null&&(s=Wk(t,e[0],r[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(i[a]=Rd((t[a]-e[a]+2*s)/r[a]+1,o));return i}function Wk(t,e,n,r=1){const s=xc(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function Td(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function yC(t){return typeof t=="number"?[t,t,t]:t}function xc(t,e){return e<=1?t:t+(t-1)*(e-1)}function Jte(t,e,n,r,s,o,i,a,l){let c,u,h;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=Yte([e,n],o,r,t,a);u=f[0],h=f[1]}else if(t==="same"){u=Math.ceil(e/r),h=Math.ceil(n/s);const d=Math.max(0,(u-1)*r+o-e),f=Math.max(0,(h-1)*s+i-n),p=Math.floor(d/2),m=d-p,y=Math.floor(f/2),g=f-y;c={top:p,bottom:m,left:y,right:g,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-o+1)/r),h=Math.ceil((n-i+1)/s);else if(typeof t=="object"){const d=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:d,bottom:f,left:p,right:m,type:d===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=Rd((e-o+d+f)/r+1,a),h=Rd((n-i+p+m)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:h}}function Zte(t,e,n,r,s,o,i,a,l,c,u){let h,d,f,p;if(t==="valid"&&(t=0),typeof t=="number"){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=Qte([e,n,r,1],[a,l,c],1,[s,o,i],t,u);d=y[0],f=y[1],p=y[2]}else if(t==="same"){d=Math.ceil(e/s),f=Math.ceil(n/o),p=Math.ceil(r/i);const m=(d-1)*s+a-e,y=(f-1)*o+l-n,g=(p-1)*i+c-r,v=Math.floor(m/2),x=m-v,b=Math.floor(y/2),w=y-b,C=Math.floor(g/2),I=g-C;h={top:b,bottom:w,left:C,right:I,front:v,back:x,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:h,outDepth:d,outHeight:f,outWidth:p}}function Rd(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function il(t){const[e,n,r]=Td(t);return e===1&&n===1&&r===1}function Dn(t,e){return il(t)||il(e)}function al(t){return Td(t).every(e=>e>0)}function Qo(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function hr(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")k(Wc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{k(Wc(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(t,e){const r={x:N(t,"x","reshape","string_or_numeric")},s={shape:e};return P.runKernel(E0,r,s)}const F=L({reshape_:ene});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tne(t,e,n,r,s){const o=N(t,"x","avgPool","float32"),i=1;k(Dn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=F(o,[1,o.shape[0],o.shape[1],o.shape[2]])),k(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),hr("avgPool",r,s);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let h=P.runKernel(Wv,c,u);return h=fe(h,o.dtype),l?F(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const jk=L({avgPool_:tne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t,e,n,r,s,o="NDHWC"){const i=N(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=F(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),k(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),k(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),k(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),hr("avgPool3d",r,s);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o};let h=P.runKernel(jv,c,u);return h=fe(h,a.dtype),l?F(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const rne=L({avgPool3d_:nne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sne(t,e=0){k(t.length>=1,()=>"Pass at least one tensor to concat");const n=WM(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return Ua(n[0]);const r=n,s={axis:e};return P.runKernel(qv,r,s)}const ir=L({concat_:sne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t,e,n=!1,r=!1){let s=N(t,"a","matMul"),o=N(e,"b","matMul");[s,o]=zt(s,o);const i={a:s,b:o},a={transposeA:n,transposeB:r};return P.runKernel(Gv,i,a)}const Ye=L({matMul_:one});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ine(t){const n={x:N(t,"x","sigmoid","float32")};return P.runKernel(ip,n)}const Tu=L({sigmoid_:ine});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(t,e,n){const r=N(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},o={begin:e,size:n};return P.runKernel(A0,s,o)}const ct=L({slice_:ane});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lne(t){const n={x:N(t,"x","tanh","float32")};return P.runKernel(dp,n)}const Gk=L({tanh_:lne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(t,e,n){const r=N(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);k(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),k(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),k(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:r},i={blockShape:e,crops:n};return P.runKernel(Hv,o,i)}const Hk=L({batchToSpaceND_:cne});function une(t){let e;return t.rank===0||t.rank===1?e=F(t,[1,1,1,t.size]):t.rank===2?e=F(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=F(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(t,e,n,r,s,o){o==null&&(o=.001);const i=N(t,"x","batchNorm"),a=N(e,"mean","batchNorm"),l=N(n,"variance","batchNorm");let c;s!=null&&(c=N(s,"scale","batchNorm"));let u;r!=null&&(u=N(r,"offset","batchNorm")),k(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),k(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),k(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:une(i),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:o},p=P.runKernel(r0,d,f);return F(p,i.shape)}const j0=L({batchNorm_:hne});function dne(t,e,n,r,s,o){const i=N(t,"x","batchNorm"),a=N(e,"mean","batchNorm"),l=N(n,"variance","batchNorm");let c;s!=null&&(c=N(s,"scale","batchNorm"));let u;return r!=null&&(u=N(r,"offset","batchNorm")),k(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),k(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),k(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&k(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&k(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),j0(i,a,l,u,c,o)}const fne=L({batchNorm2d_:dne});function pne(t,e,n,r,s,o){const i=N(t,"x","batchNorm"),a=N(e,"mean","batchNorm"),l=N(n,"variance","batchNorm");let c;s!=null&&(c=N(s,"scale","batchNorm"));let u;return r!=null&&(u=N(r,"offset","batchNorm")),k(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),k(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),k(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&k(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&k(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),j0(i,a,l,u,c,o)}const mne=L({batchNorm3d_:pne});function gne(t,e,n,r,s,o){const i=N(t,"x","batchNorm"),a=N(e,"mean","batchNorm"),l=N(n,"variance","batchNorm");let c;s!=null&&(c=N(s,"scale","batchNorm"));let u;return r!=null&&(u=N(r,"offset","batchNorm")),k(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),k(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),k(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&k(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&k(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),j0(i,a,l,u,c,o)}const yne=L({batchNorm4d_:gne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vne(t,e,n){const r=N(t,"x","bincount"),s=N(e,"weights","bincount");k(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),k(n>=0,()=>`size must be non-negative, but got ${n}.`),k(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const o={x:r,weights:s},i={size:n};return P.runKernel(ik,o,i)}const xne=L({bincount_:vne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(t,e){let n=N(t,"broadcastTo","x");const r=n.shape;if(Xo(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=F(n,c)}const s=n.shape,o=Array.from(e);for(let c=e.length-1;c>=0;c--)if(s[c]===e[c])o[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(o.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Ua(n);const a={x:n},l={reps:o};return P.runKernel(fp,a,l)}const Ah=L({broadcastTo_:bne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(t){const n={x:N(t,"x","ceil","float32")};return P.runKernel(Nf,n)}const Cne=L({ceil_:wne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0(t,e,n){Xo(t),n=n||$u(e);const r={shape:t,value:e,dtype:n};return P.runKernel(xk,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t,e,n){const r=N(t,"x","clipByValue");if(k(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return G0(r.shape,e,r.dtype);const s={x:r},o={clipValueMin:e,clipValueMax:n};return P.runKernel(Tf,s,o)}const Ur=L({clipByValue_:Ine});function Sne(t){return ir(t,0)}const kne=L({concat1d_:Sne});function $ne(t,e){return ir(t,e)}const Ene=L({concat2d_:$ne});function Nne(t,e){return ir(t,e)}const Tne=L({concat3d_:Nne});function Rne(t,e){return ir(t,e)}const _ne=L({concat4d_:Rne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t,e,n,r,s="NHWC",o=[1,1],i){const a=N(t,"x","conv2d","float32"),l=N(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=F(a,[1,a.shape[0],a.shape[1],a.shape[2]])),k(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),k(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),hr("conv2d",r,i);const h=s==="NHWC"?c.shape[3]:c.shape[1];k(h===l.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${l.shape[2]}.`),k(Dn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),k(al(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),k(al(n),()=>"Error in conv2D: Strides should be larger than 0.");const d={x:c,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},p=P.runKernel(Xv,d,f);return u?F(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const ll=L({conv2d_:Ane});function Dne(t,e,n,r,s="NWC",o=1,i){const a=N(t,"x","conv1d"),l=N(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=F(a,[1,a.shape[0],a.shape[1]])),k(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),k(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),hr("conv1d",r,i),k(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),k(Dn(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),k(al(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),k(al(n),()=>"Error in conv1D: Stride should be larger than 0."),k(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const h=F(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=F(c,[c.shape[0],1,c.shape[1],c.shape[2]]),y=ll(d,h,[1,n],r,"NHWC",[1,o],i);return u?F(y,[y.shape[2],y.shape[3]]):F(y,[y.shape[0],y.shape[2],y.shape[3]])}const n3=L({conv1d_:Dne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function One(t,e,n,r,s,o="NHWC",i){k(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=F(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),k(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),k(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),k(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=o==="NHWC"?a[3]:a[1],h=o==="NHWC"?l.shape[3]:l.shape[1];k(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),k(h===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${n.shape[3]}.`),hr("conv2dDerInput",s,i);const d={dy:l,filter:n},f={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,inputShape:a},p=P.runKernel(Yv,d,f);return c?F(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Kk=L({conv2DBackpropInput_:One});function Pne(t,e,n,r,s,o){const i=N(t,"x","conv2dTranspose"),a=N(e,"filter","conv2dTranspose");return Kk(n,i,a,r,s,"NHWC",o)}const r3=L({conv2dTranspose_:Pne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fne(t,e,n,r,s="NDHWC",o=[1,1,1]){const i=N(t,"x","conv3d"),a=N(e,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=F(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),k(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),k(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),k(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),k(Dn(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),k(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),k(al(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),k(al(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},h={strides:n,pad:r,dataFormat:s,dilations:o},d=P.runKernel(Qv,u,h);return c?F(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Lne=L({conv3d_:Fne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mne(t,e,n,r,s){k(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=F(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],c=i.shape[4];k(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),k(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),k(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),k(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),k(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:i,filter:n},h={pad:s,strides:r,inputShape:o},d=P.runKernel(uk,u,h);return a?F(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const s3=L({conv3DBackpropInput_:Mne});function zne(t,e,n,r,s){const o=N(t,"x","conv3dTranspose"),i=N(e,"filter","conv3dTranspose");return s3(n,o,i,r,s)}const Bne=L({conv3dTranspose_:zne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(t){const n={x:N(t,"x","cos","float32")};return P.runKernel(Rf,n)}const qk=L({cos_:Une});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t){const n={x:N(t,"x","cosh","float32")};return P.runKernel(_f,n)}const o3=L({cosh_:Vne});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(t,e=0,n=!1,r=!1){const o={x:N(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return P.runKernel(hk,o,i)}const vC=L({cumprod_:Wne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(t,e=0,n=!1,r=!1){const o={x:N(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return P.runKernel(Jv,o,i)}const i3=L({cumsum_:jne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(t,e,n,r=!1){const s=N(t,"x","denseBincount"),o=N(e,"weights","denseBincount");k(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),k(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),k(n>=0,()=>`size must be non-negative, but got ${n}.`),k(o.size===s.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${o.shape}.`);const i={x:s,weights:o},a={size:n,binaryOutput:r};return P.runKernel(fk,i,a)}const dR=L({denseBincount_:Gne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(t,e,n="NHWC"){const r=N(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];k(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),k(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),k(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${r.shape}`),k(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return P.runKernel(pk,a,l)}const Kne=L({depthToSpace_:Hne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(t,e,n,r,s="NHWC",o=[1,1],i){const a=N(t,"x","depthwiseConv2d","float32"),l=N(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=F(a,[1,a.shape[0],a.shape[1],a.shape[2]])),k(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),k(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const h=s==="NHWC"?c.shape[3]:c.shape[1];k(h===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${l.shape[2]}.`),hr("depthwiseConv2d",r,i);const d={x:c,filter:l},f={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},p=P.runKernel(Zv,d,f);return u?F(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Xk=L({depthwiseConv2d_:qne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(t,e,n,r,s=[1,1],o="NHWC"){const i=N(t,"x","dilation2d"),a=N(e,"filter","dilation2d");k(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),k(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),k(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,c=!1;i.rank===3&&(l=F(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),k(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},h={strides:n,pad:r,dilations:s},d=P.runKernel(e0,u,h);return c?F(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Yne=L({dilation2d_:Xne});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kc(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const o=n-1-s,i=t[o]||1;(e[e.length-1-s]||1)>1&&i===1&&r.unshift(o)}return r}function en(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],o=e.length-r-1,i=e[o];(s==null||s===1&&i>1)&&n.unshift(o)}return n}function _e(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let o=t[t.length-s-1];o==null&&(o=1);let i=e[e.length-s-1];if(i==null&&(i=1),o===1)r[n-s-1]=i;else if(i===1)r[n-s-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t,e){let n=N(t,"a","equal","string_or_numeric"),r=N(e,"b","equal","string_or_numeric");[n,r]=zt(n,r),_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(t0,s)}const uo=L({equal_:Qne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jne(t,e,n){const r=N(e,"a","where"),s=N(n,"b","where"),o=N(t,"condition","where","bool"),i=_e(_e(o.shape,r.shape),s.shape),a=Ah(o,i),l=Ah(r,i),c=Ah(s,i),u={condition:a,t:l,e:c};return P.runKernel(_0,u)}const Kn=L({where_:Jne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(t){const n={x:N(t,"x","zerosLike")};return P.runKernel(z0,n)}const je=L({zerosLike_:Zne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ere(t,e){let n=N(t,"a","div"),r=N(e,"b","div");[n,r]=zt(n,r);const s=Ce(n,r),o=je(s),i=uo(r,o);return Kn(i,o,s)}const tre=L({divNoNan_:ere});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nre(t,e){const n=N(t,"t1","dot"),r=N(e,"t2","dot");k((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];if(k(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),n.rank===1&&r.rank===1){const i=F(n,[1,-1]),a=F(r,[-1,1]),l=Ye(i,a);return F(l,[])}else if(n.rank===1&&r.rank===2){const i=F(n,[1,-1]),a=F(r,[r.shape[0],r.shape[1]]),l=Ye(i,a);return F(l,[l.size])}else if(n.rank===2&&r.rank===1){const i=F(r,[-1,1]),a=Ye(n,i);return F(a,[a.size])}else{const i=F(r,[r.shape[0],r.shape[1]]);return Ye(n,i)}}const rre=L({dot_:nre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sre(t){const n={x:N(t,"x","elu","float32")};return P.runKernel(Df,n)}const H0=L({elu_:sre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ore(t){let e=N(t,"x","erf");k(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=fe(e,"float32"));const n={x:e};return P.runKernel(Of,n)}const ire=L({erf_:ore});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yk(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function a3(t,e,n){const r=t.length+e.length,s=[];let o=0,i=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[o++]):s.push(e[i++]);return s}function cn(t,e){const n=[],r=t.length;for(let o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);const s=e.map(o=>t[o]);return[n,s]}function Gt(t,e){const n=e.map(r=>1);return a3(t,n,e)}function Cn(t,e,n){k(Yk(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Et(t,e){if(Yk(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function aa(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Bt(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function are(t,e=null,n=!1){const s={x:N(t,"x","max")},o={reductionIndices:e,keepDims:n};return P.runKernel(f0,s,o)}const Ts=L({max_:are});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lre(t,e=null,n=!1){const s={x:N(t,"x","min")},o={axis:e,keepDims:n};return P.runKernel(y0,s,o)}const hy=L({min_:lre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cre(t,e){let n=N(t,"base","pow"),r=N(e,"exp","pow");[n,r]=zt(n,r);const s={a:n,b:r};return P.runKernel(Yf,s)}const qc=L({pow_:cre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(t,e){if((Ds(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Ds(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return V0(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ure(t){const n={x:N(t,"x","sqrt","float32")};return P.runKernel(lp,n)}const Yn=L({sqrt_:ure});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hre(t){const e=N(t,"x","square"),n={};return P.runKernel("Square",{x:e},n)}const pt=L({square_:hre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dre(t,e=null,n=!1){let r=N(t,"x","sum");r.dtype==="bool"&&(r=fe(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return P.runKernel(D0,s,o)}const be=L({sum_:dre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fre(t,e="euclidean",n=null,r=!1){t=N(t,"x","norm");const s=l3(t,e,n);let o=s.shape;if(r){const i=Le(n,t.shape);o=Gt(s.shape,i)}return F(s,o)}function l3(t,e,n=null){if(t.rank===0)return zn(t);if(t.rank!==1&&n===null)return l3(F(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return be(zn(t),n);if(e===1/0)return Ts(zn(t),n);if(e===-1/0)return hy(zn(t),n);if(e==="euclidean"||e===2)return Yn(be(qc(zn(t),Ze(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Ts(be(zn(t),n[0]),n[1]-1);if(e===1/0)return Ts(be(zn(t),n[1]),n[0]);if(e===-1/0)return hy(be(zn(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Yn(be(pt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const K0=L({norm_:fre});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pre(t,e=null,n=!1){return K0(t,"euclidean",e,n)}const mre=L({euclideanNorm_:pre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gre(t){const n={x:N(t,"x","exp")};return P.runKernel(Pf,n)}const Vo=L({exp_:gre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yre(t,e=0){const n=N(t,"x","expandDims","string_or_numeric");k(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return P.runKernel(n0,r,s)}const gr=L({expandDims_:yre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(t){const n={x:N(t,"x","expm1")};return P.runKernel(Ff,n)}const xre=L({expm1_:vre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bre(t,e){const n=N(t,"x","tile","string_or_numeric");k(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return P.runKernel(fp,r,s)}const ks=L({tile_:bre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wre(t,e,n,r="float32"){e==null&&(e=t);const s=Fe([t,e],r),o=t<=e?t:e;for(let a=0;a<o;++a)s.set(1,a,a);const i=F(s.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return ks(gr(i,0),[n[0],1,1]);if(n.length===2)return ks(gr(gr(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return ks(gr(gr(gr(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const c3=L({eye_:wre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cre(t){const n={x:N(t,"x","floor","float32")};return P.runKernel(Lf,n)}const q0=L({floor_:Cre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ire(t,e,n=0,r=0){const s=N(t,"x","gather"),o=N(e,"indices","gather","int32"),i={x:s,indices:o},a={axis:n,batchDims:r};return P.runKernel(s0,i,a)}const Qk=L({gather_:Ire});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(t,e){let n=N(t,"a","greater","string_or_numeric"),r=N(e,"b","greater","string_or_numeric");[n,r]=zt(n,r),_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(o0,s)}const jr=L({greater_:Sre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kre(t,e){let n=N(t,"a","greaterEqual","string_or_numeric"),r=N(e,"b","greaterEqual","string_or_numeric");[n,r]=zt(n,r),_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(zf,s)}const Cl=L({greaterEqual_:kre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $re(t){const n={input:N(t,"input","imag")};return P.runKernel(Ck,n)}const Jk=L({imag_:$re});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ere(t){const n={x:N(t,"x","isFinite")};return P.runKernel(Uf,n)}const Nre=L({isFinite_:Ere});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tre(t){const n={x:N(t,"x","isInf")};return P.runKernel(Vf,n)}const Rre=L({isInf_:Tre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t){const n={x:N(t,"x","isNaN")};return P.runKernel(Wf,n)}const Are=L({isNaN_:_re});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t,e=.2){const r={x:N(t,"x","leakyRelu")},s={alpha:e};return P.runKernel(i0,r,s)}const Zk=L({leakyRelu_:Dre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(t,e){let n=N(t,"a","less","string_or_numeric"),r=N(e,"b","less","string_or_numeric");[n,r]=zt(n,r),_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(a0,s)}const dy=L({less_:Ore});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pre(t,e){let n=N(t,"a","lessEqual","string_or_numeric"),r=N(e,"b","lessEqual","string_or_numeric");[n,r]=zt(n,r),_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(l0,s)}const Ru=L({lessEqual_:Pre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fre(t,e=5,n=1,r=1,s=.5){const o=N(t,"x","localResponseNormalization");k(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),k(Wc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=F(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},c={depthRadius:e,bias:n,alpha:r,beta:s},u=P.runKernel(d0,l,c);return a?F(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Lre=L({localResponseNormalization_:Fre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mre(t){const n={x:N(t,"x","log","float32")};return P.runKernel(jf,n)}const ho=L({log_:Mre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zre(t){const n={x:N(t,"x","log1p")};return P.runKernel(Gf,n)}const u3=L({log1p_:zre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bre(t,e){k(eC(t),()=>"The f passed in variableGrads(f) must be a function"),k(e==null||Array.isArray(e)&&e.every(c=>c instanceof uy),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in P.registeredVariables)e.push(P.registeredVariables[c])}const r=n?e.filter(c=>!c.trainable):null,s=e.length;e=e.filter(c=>c.trainable),k(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const o=!0,{value:i,grads:a}=P.gradients(t,e,null,o);k(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),k(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:i,grads:l}}function Xc(t){return P.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ure(t){const n={x:N(t,"x","neg")};return P.runKernel(x0,n)}const Lt=L({neg_:Ure});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(t){const n={x:N(t,"x","softplus")};return P.runKernel(ap,n)}const gp=L({softplus_:Vre});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wre(t){const e=N(t,"x","logSigmoid");return Xc(r=>({value:Lt(gp(Lt(r))),gradFunc:i=>O(i,Tu(Lt(r)))}))(e)}const jre=L({logSigmoid_:Wre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(t,e){let n=N(t,"a","sub"),r=N(e,"b","sub");[n,r]=zt(n,r);const s={a:n,b:r};return P.runKernel(up,s)}const Ee=L({sub_:Gre});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(t,e=-1){const n=N(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Xc((s,o)=>{const a=Ts(s,e,!0),l=Ee(s,a),c=Ee(fe(l,"float32"),ho(be(Vo(l),e,!0)));return o([c]),{value:c,gradFunc:(h,d)=>{const[f]=d,p=!0,m=Vo(f);return Ee(h,O(be(h,e,p),m))}}})(n)}const h3=L({logSoftmax_:Hre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kre(t,e=null,n=!1){const r=N(t,"x","logSumExp"),s=Le(e,r.shape),o=Ts(r,s,!0),i=Ee(r,o),a=Vo(i),l=be(a,s),c=ho(l),u=te(F(o,c.shape),c);if(n){const h=Gt(u.shape,s);return F(u,h)}return u}const qre=L({logSumExp_:Kre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t,e){const n=N(t,"a","logicalAnd","bool"),r=N(e,"b","logicalAnd","bool");_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(c0,s)}const Wo=L({logicalAnd_:Xre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(t){const n={x:N(t,"x","logicalNot","bool")};return P.runKernel(u0,n)}const e$=L({logicalNot_:Yre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t,e){const n=N(t,"a","logicalOr","bool"),r=N(e,"b","logicalOr","bool");_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(h0,s)}const d3=L({logicalOr_:Qre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jre(t,e){const n=N(t,"a","logicalXor","bool"),r=N(e,"b","logicalXor","bool");return _e(n.shape,r.shape),Wo(d3(t,e),e$(Wo(t,e)))}const Zre=L({logicalXor_:Jre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t,e,n,r,s){const o=N(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=F(o,[1,o.shape[0],o.shape[1],o.shape[2]])),k(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),k(Dn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),hr("maxPool",r,s);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s},h=P.runKernel(p0,c,u);return l?F(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const t$=L({maxPool_:ese});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tse(t,e=[1,1,1],n,r,s,o="NDHWC"){const i=N(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=F(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),k(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),k(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),hr("maxPool3d",r,s);const c={x:a},u={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o},h=P.runKernel(m0,c,u);return l?F(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const nse=L({maxPool3d_:tse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rse(t,e){let n=N(t,"a","maximum"),r=N(e,"b","maximum");[n,r]=zt(n,r),n.dtype==="bool"&&(n=fe(n,"int32"),r=fe(r,"int32")),_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(Hf,s)}const la=L({maximum_:rse});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sse(t,e=null,n=!1){const s={x:N(t,"x","mean")},o={axis:e,keepDims:n};return P.runKernel(g0,s,o)}const jt=L({mean_:sse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sn(t,e="float32"){if(Xo(t),e==="complex64"){const r=sn(t,"float32"),s=sn(t,"float32");return Hc(r,s)}const n=_n(Y(t),e);return P.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Il(t,e="float32"){if(Xo(t),e==="complex64"){const r=Il(t,"float32"),s=sn(t,"float32");return Hc(r,s)}const n=JS(Y(t),e);return P.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t,e){let n=N(t,"a","minimum"),r=N(e,"b","minimum");[n,r]=zt(n,r),n.dtype==="bool"&&(n=fe(n,"int32"),r=fe(r,"int32")),_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(Kf,s)}const _d=L({minimum_:ose});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ise(t,e,n){k(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=N(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");k(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)k(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),k(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const o={paddings:e,mode:n},i={x:r};return P.runKernel(v0,i,o)}const ase=L({mirrorPad_:ise});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t,e){let n=N(t,"a","mod"),r=N(e,"b","mod");[n,r]=zt(n,r);const s={a:n,b:r};return P.runKernel(qf,s)}const cse=L({mod_:lse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function use(t,e=null,n=!1){t=N(t,"x","moments");const r=Le(e,t.shape),s=jt(t,r,n);let o=s.shape;n||(o=Gt(s.shape,r));const i=pt(Ee(fe(t,"float32"),F(s,o))),a=jt(i,r,n);return{mean:s,variance:a}}const n$=L({moments_:use});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hse(t,e){let n=N(t,"a","notEqual","string_or_numeric"),r=N(e,"b","notEqual","string_or_numeric");[n,r]=zt(n,r),_e(n.shape,r.shape);const s={a:n,b:r};return P.runKernel(b0,s)}const fy=L({notEqual_:hse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dse(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:N(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return P.runKernel(C0,i,a)}const f3=L({oneHot_:dse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t){const n={x:N(t,"x","onesLike")};return P.runKernel(w0,n)}const cs=L({onesLike_:fse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pse(t,e,n=0){const r=N(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},o={x:r};return P.runKernel(S0,o,s)}const r$=L({pad_:pse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mse(t,e,n){const r=N(t,"x","spaceToBatchND");k(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),k(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),k(r.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},o={blockShape:e,paddings:n};return P.runKernel(O0,s,o)}const s$=L({spaceToBatchND_:mse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(t,e,n,r,s,o,i){s==null&&(s=[1,1]),o==null&&(o=1),r===0&&(r="valid");const a=N(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=F(a,[1,a.shape[0],a.shape[1],a.shape[2]])),k(Dn(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const u=us(l.shape,e,o,s,r),h=[u.dilationHeight,u.dilationWidth];let d;r==="same"?d=vse([u.filterHeight,u.filterWidth],h):d=[[0,0],[0,0]];const f=h[0]===1&&h[1]===1,[p,m]=yse([u.inHeight,u.inWidth],h,d),y=f?r:"valid",g=f?l:s$(l,h,p),x=(n==="avg"?()=>jk(g,e,o,y,i):()=>t$(g,e,o,y,i))(),b=f?x:Hk(x,h,m);return c?F(b,[b.shape[1],b.shape[2],b.shape[3]]):b}function yse(t,e,n){const r=n.map(u=>u[0]),s=n.map(u=>u[1]),o=t.concat(r,s),i=e.map((u,h)=>(u-o[h]%u)%u),a=s.map((u,h)=>u+i[h]),l=e.map((u,h)=>[r[h],a[h]]),c=e.map((u,h)=>[0,i[h]]);return[l,c]}function vse(t,e){const r=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),s=r.map(i=>Math.floor(i/2)),o=r.map((i,a)=>i-s[a]);return r.map((i,a)=>[s[a],o[a]])}const xse=L({pool_:gse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bse(t,e){const n=N(t,"x","prelu"),r=N(e,"alpha","prelu"),s={x:n,alpha:r};return P.runKernel(k0,s)}const o$=L({prelu_:bse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t,e=null,n=!1){let r=N(t,"x","prod");r.dtype==="bool"&&(r=fe(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return P.runKernel($0,s,o)}const Cse=L({prod_:wse});var xC={},Ise={get exports(){return xC},set exports(t){xC=t}};(function(t){(function(e,n,r){function s(l){var c=this,u=a();c.next=function(){var h=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=h|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function o(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var u=new s(l),h=c&&c.state,d=u.next;return d.int32=function(){return u.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&o(h,u),d.state=function(){return o(u,{})}),d}function a(){var l=4022871197,c=function(u){u=String(u);for(var h=0;h<u.length;h++){l+=u.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.alea=i})(ml,t,!1)})(Ise);var bC={},Sse={get exports(){return bC},set exports(t){bC=t}};(function(t){(function(e,n,r){function s(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var c=new s(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&o(u,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xor128=i})(ml,t,!1)})(Sse);var wC={},kse={get exports(){return wC},set exports(t){wC=t}};(function(t){(function(e,n,r){function s(a){var l=this,c="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var c=new s(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&o(u,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xorwow=i})(ml,t,!1)})(kse);var CC={},$se={get exports(){return CC},set exports(t){CC=t}};(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var u=l.x,h=l.i,d,f;return d=u[h],d^=d>>>7,f=d^d<<24,d=u[h+1&7],f^=d^d>>>10,d=u[h+3&7],f^=d^d>>>3,d=u[h+4&7],f^=d^d<<7,d=u[h+7&7],d=d^d<<13,f^=d^d<<9,u[h]=f,l.i=h+1&7,f};function c(u,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],u.x=f,u.i=0,d=256;d>0;--d)u.next()}c(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var c=new s(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.x&&o(u,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xorshift7=i})(ml,t,!1)})($se);var IC={},Ese={get exports(){return IC},set exports(t){IC=t}};(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var u=l.w,h=l.X,d=l.i,f,p;return l.w=u=u+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(u^u>>>16)|0};function c(u,h){var d,f,p,m,y,g=[],v=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,v=Math.max(v,h.length)),p=0,m=-32;m<v;++m)h&&(f^=h.charCodeAt((m+32)%h.length)),m===0&&(y=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(y=y+1640531527|0,d=g[m&127]^=f+y,p=d==0?p+1:0);for(p>=128&&(g[(h&&h.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=g[p+34&127],d=g[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[p]=f^d;u.w=y,u.X=g,u.i=p}c(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var c=new s(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(u.X&&o(u,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xor4096=i})(ml,t,!1)})(Ese);var SC={},Nse={get exports(){return SC},set exports(t){SC=t}};(function(t){(function(e,n,r){function s(a){var l=this,c="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var c=new s(a),u=l&&l.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=c.next,h.quick=h,u&&(typeof u=="object"&&o(u,c),h.state=function(){return o(c,{})}),h}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.tychei=i})(ml,t,!1)})(Nse);var kC={},Tse={get exports(){return kC},set exports(t){kC=t}};const Rse={},_se=Object.freeze(Object.defineProperty({__proto__:null,default:Rse},Symbol.toStringTag,{value:"Module"})),Ase=PV(_se);(function(t){(function(e,n,r){var s=256,o=6,i=52,a="random",l=r.pow(s,o),c=r.pow(2,i),u=c*2,h=s-1,d;function f(b,w,C){var I=[];w=w==!0?{entropy:!0}:w||{};var S=g(y(w.entropy?[b,x(n)]:b??v(),3),I),$=new p(I),E=function(){for(var A=$.g(o),M=l,B=0;A<c;)A=(A+B)*s,M*=s,B=$.g(1);for(;A>=u;)A/=2,M/=2,B>>>=1;return(A+B)/M};return E.int32=function(){return $.g(4)|0},E.quick=function(){return $.g(4)/4294967296},E.double=E,g(x($.S),n),(w.pass||C||function(A,M,B,U){return U&&(U.S&&m(U,$),A.state=function(){return m($,{})}),B?(r[a]=A,M):A})(E,S,"global"in w?w.global:this==r,w.state)}function p(b){var w,C=b.length,I=this,S=0,$=I.i=I.j=0,E=I.S=[];for(C||(b=[C++]);S<s;)E[S]=S++;for(S=0;S<s;S++)E[S]=E[$=h&$+b[S%C]+(w=E[S])],E[$]=w;(I.g=function(A){for(var M,B=0,U=I.i,V=I.j,H=I.S;A--;)M=H[U=h&U+1],B=B*s+H[h&(H[U]=H[V=h&V+M])+(H[V]=M)];return I.i=U,I.j=V,B})(s)}function m(b,w){return w.i=b.i,w.j=b.j,w.S=b.S.slice(),w}function y(b,w){var C=[],I=typeof b,S;if(w&&I=="object")for(S in b)try{C.push(y(b[S],w-1))}catch{}return C.length?C:I=="string"?b:b+"\0"}function g(b,w){for(var C=b+"",I,S=0;S<C.length;)w[h&S]=h&(I^=w[h&S]*19)+C.charCodeAt(S++);return x(w)}function v(){try{var b;return d&&(b=d.randomBytes)?b=b(s):(b=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(b)),x(b)}catch{var w=e.navigator,C=w&&w.plugins;return[+new Date,e,C,e.screen,x(n)]}}function x(b){return String.fromCharCode.apply(0,b)}if(g(r.random(),n),t.exports){t.exports=f;try{d=Ase}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:ml,[],Math)})(Tse);var Dse=xC,Ose=bC,Pse=wC,Fse=CC,Lse=IC,Mse=SC,Sl=kC;Sl.alea=Dse;Sl.xor128=Ose;Sl.xorwow=Pse;Sl.xorshift7=Fse;Sl.xor4096=Lse;Sl.tychei=Mse;var i$=Sl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p3{constructor(e,n,r,s,o){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=i$.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,o,i;do s=2*this.random()-1,o=2*this.random()-1,i=s*s+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class zse{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=i$.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bse(t,e=0,n=1,r,s){if(Xo(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const o=new p3(e,n,r,!1,s),i=Fe(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Use=L({randomNormal_:Bse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vse(t,e=0,n=1,r="float32",s){Xo(t);const o=Fe(t,r),i=new zse(e,n,null,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const yp=L({randomUniform_:Vse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ad(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return P.runKernel(Tk,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(t){const n={input:N(t,"input","real")};return P.runKernel(Rk,n)}const py=L({real_:Wse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(t){const n={x:N(t,"x","reciprocal")};return P.runKernel(Qf,n)}const Gse=L({reciprocal_:jse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(t){const n={x:N(t,"x","relu")};return P.runKernel(Jf,n)}const kl=L({relu_:Hse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kse(t){const n={x:N(t,"x","relu6")};return P.runKernel(Zf,n)}const m3=L({relu6_:Kse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qse(t,e){const r={x:N(t,"x","reverse")},s={dims:e};return P.runKernel(R0,r,s)}const cl=L({reverse_:qse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xse(t){const n={x:N(t,"x","round")};return P.runKernel(ep,n)}const g3=L({round_:Xse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yse(t){const n={x:N(t,"x","rsqrt","float32")};return P.runKernel(tp,n)}const y3=L({rsqrt_:Yse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(t){const n={x:N(t,"x","selu")};return P.runKernel(np,n)}const v3=L({selu_:Qse});function Jse(t,e,n,r,s,o=[1,1],i="NHWC"){const a=N(t,"x","separableConv2d"),l=N(e,"depthwiseFilter","separableConv2d"),c=N(n,"pointwiseFilter","separableConv2d");let u=a,h=!1;if(a.rank===3&&(h=!0,u=F(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");k(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),k(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),k(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),k(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),k(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=l.shape[2],f=l.shape[3];k(c.shape[2]===d*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${c.shape[2]}.`);const p=Xk(u,l,r,s,i,o),y=ll(p,c,1,"valid",i);return h?F(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const x3=L({separableConv2d_:Jse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zse(t){const n={x:N(t,"x","sign")};return P.runKernel(op,n)}const eoe=L({sign_:Zse});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function toe(t){const n={x:N(t,"x","sin","float32")};return P.runKernel(rp,n)}const b3=L({sin_:toe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(t){const n={x:N(t,"x","sinh")};return P.runKernel(sp,n)}const w3=L({sinh_:noe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(t,e,n){const r=N(t,"x","slice1d");return k(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),ct(r,[e],[n])}const a$=L({slice1d_:roe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function soe(t,e,n){const r=N(t,"x","slice2d");return k(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),ct(r,e,n)}const C3=L({slice2d_:soe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ooe(t,e,n){const r=N(t,"x","slice3d");return k(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),ct(r,e,n)}const l$=L({slice3d_:ooe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(t,e,n){const r=N(t,"x","slice4d");return k(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),ct(r,e,n)}const my=L({slice4d_:ioe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aoe(t,e=-1){const n=N(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return P.runKernel(F0,r,s)}const c$=L({softmax_:aoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t){k(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return P.runKernel(vk,e)}const I3=L({fft_:loe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(t){k(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return P.runKernel(wk,e)}const $C=L({ifft_:coe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uoe(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=F(t,[n,e]);r=$C(s)}else{const s=[n,2*(e-1)],o=F(py(t),[n,e]),i=F(Jk(t),[n,e]),a=cl(ct(o,[0,1],[n,e-2]),1),l=O(cl(ct(i,[0,1],[n,e-2]),1),Ze(-1)),c=ir([o,a],1),u=ir([i,l],1),h=F(Hc(c,u),[s[0],s[1]]);r=$C(h)}if(r=py(r),t.rank===3&&t.shape[0]!==0){const s=r,o=t.shape[0];r=F(r,[o,r.shape[0]/o,r.shape[1]]),s.dispose()}return r}const hoe=L({irfft_:uoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t,e,n=0){const s={x:N(t,"x","split")},o={numOrSizeSplits:e,axis:n};return P.runKernel(P0,s,o)}const Mr=L({split_:doe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe(t,e){k(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const p=t.shape.map(y=>0),m=t.shape.map(y=>y);m[t.shape.length-1]=e,s=ct(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,s=ir([t,sn(p)],t.shape.length-1),n=e}else s=t;const o=je(s),i=F(Hc(s,o),[r,n]),a=I3(i),l=Math.floor(n/2)+1,c=py(a),u=Jk(a),h=Mr(c,[l,n-l],c.shape.length-1),d=Mr(u,[l,n-l],u.shape.length-1),f=s.shape.slice();return f[s.shape.length-1]=l,F(Hc(h[0],d[0]),f)}const poe=L({rfft_:foe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function moe(t,e){let n=N(t,"a","squaredDifference"),r=N(e,"b","squaredDifference");[n,r]=zt(n,r),_e(n.shape,r.shape);const s={a:n,b:r},o={};return P.runKernel(cp,s,o)}const goe=L({squaredDifference_:moe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yoe(t,e){const n=N(t,"x","squeeze","string_or_numeric");return F(n,sa(n.shape,e).newShape)}const vp=L({squeeze_:yoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function voe(t,e=0){const n=WM(t,"tensors","stack","string_or_numeric");k(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&k(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return P.runKernel(I0,r,s)}const Ki=L({stack_:voe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(t,e=0){const r={x:N(t,"x","step")},s={alpha:e};return P.runKernel(pp,r,s)}const xp=L({step_:xoe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function boe(t,e,n,r,s=0,o=0,i=0,a=0,l=0){const u={x:N(t,"x","stridedSlice","string_or_numeric")},h={begin:e,end:n,strides:r,beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return P.runKernel(Pk,u,h)}const woe=L({stridedSlice_:boe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Coe(t){const n={x:N(t,"x","tan","float32")};return P.runKernel(hp,n)}const Ioe=L({tan_:Coe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Or(t,e){YL(t);const n=U0(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return V0(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cb(t,e,n){if(YL(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=U0(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return V0(t,e,r,n)}function S3(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(o+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(o+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(o+` update.rank != ${s+t.length-r}`);for(let i=0;i<s;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-s;++i)if(n.shape[i+s]!==t[i+r])throw new Error(o+` updates.shape[${i+s}] (${n.shape[i+s]}) != shape[${i+s}] (${t[i+s]})`)}function Soe(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}S3(n,e,t)}function $l(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,o=n.length;let i=1;for(let h=s;h<o;++h)i*=n[h];const a=s<1?1:s,l=Y(e.shape)/a,c=[...xe(n.slice(0,s)),1],u=Y(n);return{sliceRank:s,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(t,e=1,n=!0){const r=N(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:r},i={k:e,sorted:n},[a,l]=P.runKernel(Fk,o,i);return{values:a,indices:l}}const $oe=L({topk_:koe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t,e=0,n=1,r,s){if(Xo(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new p3(e,n,r,!0,s),i=Fe(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const k3=L({truncatedNormal_:Eoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Noe(t,e=0){const n=N(t,"x","unique","string_or_numeric");k(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[o,i]=P.runKernel(Mk,r,s);return{values:o,indices:i}}const Toe=L({unique_:Noe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Roe(t,e,n){const r=N(t,"x","unsortedSegmentSum"),s=N(e,"segmentIds","unsortedSegmentSum","int32");k(Wc(n),()=>"numSegments must be of dtype int");const o={x:r,segmentIds:s},i={numSegments:n};return P.runKernel(M0,o,i)}const $3=L({unsortedSegmentSum_:Roe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _oe(t,e=0){const n=N(t,"x","unstack","string_or_numeric");k(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return P.runKernel(L0,r,s)}const ul=L({unstack_:_oe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aoe(t,e=!0,n,r){return P.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E3(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const r=Fe(t,"int32"),s=Fe([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=r.indexToLoc(n[o]),a=o*t.length;s.values.set(i,a)}return s.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(t,e,n){const r=N(t,"x","transpose");if(e==null&&(e=r.shape.map((i,a)=>a).reverse()),k(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(i=>{k(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},o={perm:e};return r.dtype==="complex64"?j(()=>{let i=py(r),a=Jk(r);return i=P.runKernel(vc,{x:i},o),a=P.runKernel(vc,{x:a},o),n&&(a=Lt(a)),Hc(i,a)}):P.runKernel(vc,s,o)}const We=L({transpose_:Doe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ooe(t,e){if(e==null)return t.shape.slice();if(Qe(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(t,e,n,r){const s=N(t,"x","dropout");if(k(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),k(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Wt?s.clone():s;const o=Ooe(s,n),i=1-e,a=Ce(q0(te(yp(o,0,1,"float32",r),i)),i);return O(s,a)}const Foe=L({dropout_:Poe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Loe(t,e,n,r,s,o="NHWC",i){let a=t;t.rank===3&&(a=F(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=F(e,[1,e.shape[0],e.shape[1],e.shape[2]])),k(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),k(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),k(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=o==="NHWC"?a.shape[3]:a.shape[1],u=o==="NHWC"?l.shape[3]:l.shape[1];k(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),k(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),hr("conv2dDerFilter",s,i);const h={x:a,dy:l},d={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,filterShape:n};return P.runKernel(lk,h,d)}const u$=L({conv2DBackpropFilter_:Loe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h$(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return O(t,xp(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function d$(t,e){let n=e;const r=en(t.shape,e.shape);return r.length>0&&(n=be(n,r)),F(n,t.shape)}function f$(t,e,n,r){if(e==="linear")return t;if(e==="relu")return kl(t);if(e==="elu")return H0(t);if(e==="relu6")return m3(t);if(e==="prelu")return o$(t,n);if(e==="leakyrelu")return Zk(t,r);if(e==="sigmoid")return Tu(t);throw new Error(`Unknown fused activation ${e}.`)}const p$=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Moe({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",p$(P.state.gradientDepth,l)===!1){k(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let C=ll(t,e,n,r,s,o,i);return a!=null&&(C=te(C,a)),f$(C,l,c,u)}const h=N(t,"x","conv2d","float32"),d=N(e,"filter","conv2d","float32");let f=h,p=!1;h.rank===3&&(p=!0,f=F(h,[1,h.shape[0],h.shape[1],h.shape[2]])),k(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),k(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),hr("fused conv2d",r,i);const m=s==="NHWC"?f.shape[3]:f.shape[1];k(d.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${d.shape[2]}.`),k(Dn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const y=wn(f.shape,d.shape,n,o,r,i);let g;a!=null&&(g=N(a,"bias","fused conv2d"),[g]=zt(g,h),s==="NHWC"?_e(y.outShape,g.shape):(k(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),k(g.shape.length===0||g.shape[0]===y.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let v;if(c!=null){const C=c.shape;if(k(C.length<=1||C.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${C.length}.`),C.length===1)k(C[0]===1||C[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the number of output channels (${y.outChannels}).`);else if(C.length===3)try{_e(C,y.outShape)}catch{const S=`Error in fused conv2d: PReLU activation weights (${C}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(S)}v=N(c,"prelu weights","fused conv2d")}const x=(C,I)=>{k(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[S,$,E,A]=I,M=h$(C,E,l);k(il(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const B=Kk($.shape,M,S,n,r),U=u$($,M,S.shape,n,r),V=[B,U];if(A!=null){const H=d$(A,M);V.push(H)}return V},b={x:f,filter:d,bias:g,preluActivationWeights:v},w={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?Xc((I,S,$)=>{let E=P.runKernel(ay,b,w);return $([S,I,E]),p&&(E=F(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:x}})(f,d):Xc((I,S,$,E)=>{let A=P.runKernel(ay,b,w);return E([S,I,A,$]),p&&(A=F(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:x}})(f,d,g)}const zoe=L({fusedConv2d_:Moe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(t,e,n,r,s,o=[1,1],i){let a=t;t.rank===3&&(a=F(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=F(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:r,pad:s,dimRoundingMode:i,dilations:o,filterShape:n};return P.runKernel(mk,c,u)}const Uoe=L({depthwiseConv2dNativeBackpropFilter_:Boe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Voe(t,e,n,r,s,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=F(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:r,pad:s,dimRoundingMode:i,dilations:o,inputShape:t},h=P.runKernel(gk,c,u);return l?F(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Woe=L({depthwiseConv2dNativeBackpropInput_:Voe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function joe({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(p$(P.state.gradientDepth,o)===!1){let A=Ye(t,e,n,r);return s!=null&&(A=te(A,s)),f$(A,o,i,a)}let l=N(t,"a","fused matMul"),c=N(e,"b","fused matMul");[l,c]=zt(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],h=r?c.shape[c.rank-1]:c.shape[c.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),y=Y(p),g=Y(m);k(u===h,()=>`Error in fused matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);const x=_e(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,f]),b=n?F(l,[y,u,d]):F(l,[y,d,u]),w=r?F(c,[g,f,h]):F(c,[g,h,f]);let C;s!=null&&(C=N(s,"bias","fused matMul"),[C]=zt(C,l),_e(x,C.shape));let I;i!=null&&(I=N(i,"prelu weights","fused matMul"));const S=(A,M)=>{const[B,U,V,H]=M,K=h$(F(A,V.shape),V,o);let R,D;if(!n&&!r?(R=Ye(K,U,!1,!0),D=Ye(B,K,!0,!1)):!n&&r?(R=Ye(K,U,!1,!1),D=Ye(K,B,!0,!1)):n&&!r?(R=Ye(U,K,!1,!0),D=Ye(B,K,!1,!1)):(R=Ye(U,K,!0,!0),D=Ye(K,B,!0,!0)),s!=null){const z=d$(H,K);return[R,D,z]}else return[R,D]},$={a:b,b:w,bias:C,preluActivationWeights:I},E={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:a};return s==null?Xc((M,B,U)=>{const V=P.runKernel(iy,$,E);return U([M,B,V]),{value:F(V,x),gradFunc:S}})(b,w):Xc((M,B,U,V)=>{const H=P.runKernel(iy,$,E);return V([M,B,H,U]),{value:F(H,x),gradFunc:S}})(b,w,C)}const fR=L({fusedMatMul_:joe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(t,e,n,r,s="bilinear",o=0){const i=N(t,"image","cropAndResize"),a=N(e,"boxes","cropAndResize","float32"),l=N(n,"boxInd","cropAndResize","int32"),c=a.shape[0];k(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),k(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),k(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),k(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),k(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),k(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const u={image:i,boxes:a,boxInd:l},h={method:s,extrapolationValue:o,cropSize:r};return P.runKernel(dk,u,h)}const Hoe=L({cropAndResize_:Goe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Koe(t){const e=N(t,"image","flipLeftRight","float32");k(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return P.runKernel(bk,n,{})}const qoe=L({flipLeftRight_:Koe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(t){const e=N(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];k(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),k(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,ks(e,s)}const Yoe=L({grayscaleToRGB_:Xoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qoe(t,e,n=0,r=.5){const s=N(t,"image","rotateWithOffset","float32");k(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},i={radians:e,fillValue:n,center:r};return P.runKernel(zk,o,i)}const Joe=L({rotateWithOffset_:Qoe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _u(t,e,n,r,s,o){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),k(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),k(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),k(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),k(e.rank===1,()=>"scores must be a 1D tensor"),k(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),k(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=N(t,"boxes","nonMaxSuppression","float32"),i=N(e,"scores","nonMaxSuppression","float32"),a=_u(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return P.runKernel($k,{boxes:o,scores:i},l)}const eie=L({nonMaxSuppression_:Zoe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tie(t,e,n){const r=nie(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function nie(t,e,n){return sie(t,e,n||rie)}function rie(t,e){return t>e?1:t<e?-1:0}function sie(t,e,n){let r=0,s=t.length,o=0,i=!1;for(;r<s;){o=r+(s-r>>>1);const a=n(e,t[o]);a>0?r=o+1:(s=o,i=!a)}return i?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$(t,e,n,r,s){return v$(t,e,n,r,s,0)}function g$(t,e,n,r,s,o){return v$(t,e,n,r,s,0,!1,o,!0)}function y$(t,e,n,r,s,o){return v$(t,e,n,r,s,o,!0)}function v$(t,e,n,r,s,o,i=!1,a=!1,l=!1){const c=[];for(let y=0;y<e.length;y++)e[y]>s&&c.push({score:e[y],boxIndex:y,suppressBeginIndex:0});c.sort(pR);const u=o>0?-.5/o:0,h=[],d=[];for(;h.length<n&&c.length>0;){const y=c.pop(),{score:g,boxIndex:v,suppressBeginIndex:x}=y;if(g<s)break;let b=!1;for(let w=h.length-1;w>=x;--w){const C=oie(t,v,h[w]);if(C>=r){b=!0;break}if(y.score=y.score*iie(r,u,C),y.score<=s)break}y.suppressBeginIndex=h.length,b||(y.score===g?(h.push(v),d.push(y.score)):y.score>s&&tie(c,y,pR))}const f=h.length,p=n-f;a&&p>0&&(h.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const m={selectedIndices:h};return i&&(m.selectedScores=d),l&&(m.validOutputs=f),m}function oie(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(s[0],s[2]),u=Math.min(s[1],s[3]),h=Math.max(s[0],s[2]),d=Math.max(s[1],s[3]),f=(a-o)*(l-i),p=(h-c)*(d-u);if(f<=0||p<=0)return 0;const m=Math.max(o,c),y=Math.max(i,u),g=Math.min(a,h),v=Math.min(l,d),x=Math.max(g-m,0)*Math.max(v-y,0);return x/(f+p-x)}function iie(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function pR(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function aie(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=N(t,"boxes","nonMaxSuppressionAsync"),i=N(e,"scores","nonMaxSuppressionAsync"),a=_u(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:h}=m$(c,u,n,r,s);return o!==t&&o.dispose(),i!==e&&i.dispose(),Or(h,"int32")}const lie=aie;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cie(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=N(t,"boxes","nonMaxSuppression"),a=N(e,"scores","nonMaxSuppression"),l=_u(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const c={boxes:i,scores:a},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o},h=P.runKernel(Nk,c,u);return{selectedIndices:h[0],selectedScores:h[1]}}const uie=L({nonMaxSuppressionWithScore_:cie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hie(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=N(t,"boxes","nonMaxSuppressionAsync"),a=N(e,"scores","nonMaxSuppressionAsync"),l=_u(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const c=await Promise.all([i.data(),a.data()]),u=c[0],h=c[1],{selectedIndices:d,selectedScores:f}=y$(u,h,n,r,s,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Or(d,"int32"),selectedScores:Or(f)}}const die=hie;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fie(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=N(t,"boxes","nonMaxSuppression"),a=N(e,"scores","nonMaxSuppression"),l=_u(i,a,n,r,s,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,d={boxes:i,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:h,padToMaxOutputSize:o},p=P.runKernel(Ek,d,f);return{selectedIndices:p[0],validOutputs:p[1]}}const pie=L({nonMaxSuppressionPadded_:fie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function mie(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=N(t,"boxes","nonMaxSuppressionAsync"),a=N(e,"scores","nonMaxSuppressionAsync"),l=_u(i,a,n,r,s,null),c=l.maxOutputSize,u=l.iouThreshold,h=l.scoreThreshold,[d,f]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:m}=g$(d,f,c,u,h,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Or(p,"int32"),validOutputs:Ze(m,"int32")}}const gie=mie;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yie(t,e,n=!1,r=!1){const s=N(t,"images","resizeBilinear");k(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),k(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),k(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=F(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},c=P.runKernel(T0,a,l);return i?F(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const N3=L({resizeBilinear_:yie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vie(t,e,n=!1,r=!1){const s=N(t,"images","resizeNearestNeighbor");k(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),k(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),k(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),k(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=F(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},c=P.runKernel(N0,a,l);return i?F(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const T3=L({resizeNearestNeighbor_:vie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xie(t,e="binary",n=!1,r=.5){const s=N(t,"image","threshold"),o=.2989,i=.587,a=.114,l=s.shape[0]*s.shape[1];let c=O(Or([r]),255),u,h,d,f;if(k(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),k(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),k(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),k(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[u,h,d]=Mr(s,[1,1,1],-1);const y=O(u,o),g=O(h,i),v=O(d,a);f=te(te(y,g),v)}else f=t;if(e==="otsu"){const y=xne(fe(g3(f),"int32"),jM([]),256);c=bie(y,l)}const p=n?Ru(f,c):jr(f,c);return fe(O(p,255),"int32")}function bie(t,e){let n=Or([-1]),r=Or([0]),s=Or([0]),o,i,a,l,c,u;for(let h=0;h<t.size-1;h++){o=ct(t,0,h+1),i=ct(t,h+1),c=Ce(be(o),e),u=Ce(be(i),e);const d=be(O(o,Ad(0,o.size)));a=Ce(d,be(o));const f=G0(i.shape,o.size),p=te(Ad(0,i.size),f),m=O(i,p);l=Ce(be(m),be(i));const y=Ee(a,l),g=Ee(a,l),v=O(c,u);s=O(O(v,y),g);const x=jr(s,r);r=Kn(x,s,r),n=Kn(x,Or([h]),n)}return n}const wie=L({threshold_:xie});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cie(t,e,n="nearest",r="constant",s=0,o){const i=N(t,"image","transform","float32"),a=N(e,"transforms","transform","float32");k(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),k(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),k(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},c={interpolation:n,fillMode:r,fillValue:s,outputShape:o};return P.runKernel(Lk,l,c)}const Iie=L({transform_:Cie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(t,e,n){const r=N(t,"a","bandPart");k(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[o,i]=r.shape.slice(-2);let a,l;typeof e=="number"?(k(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),k(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=N(e<0?o:e,"numLower","bandPart")):(k(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Kn(dy(e,0),o,_d(e,o))),typeof n=="number"?(k(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),k(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=N(n<0?i:n,"numUpper","bandPart")):(k(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Kn(dy(n,0),i,_d(n,i)));const c=F(Ad(0,o,1,"int32"),[-1,1]),u=Ad(0,i,1,"int32"),h=Ee(c,u),d=Wo(Ru(h,a),Cl(h,Lt(l))),f=sn([o,i],r.dtype);return F(Ki(ul(F(r,[-1,o,i])).map(p=>Kn(d,p,f))),s)}const kie=L({bandPart_:Sie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t){let e;if(Array.isArray(t)){e=!1,k(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let o=1;o<t.length;++o)k(t[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${s})`)}else e=!0,t=Mr(t,t.shape[0],0).map(s=>vp(s,[0]));k(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(P.tidy(()=>{let o=r[s];if(s>0)for(let i=0;i<s;++i){const a=O(be(O(n[i],o)),n[i]);o=Ee(o,a)}return Ce(o,K0(o,"euclidean"))}));return e?Ki(n,0):n}const Eie=L({gramSchmidt_:$ie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(t,e=!1){if(k(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return mR(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),r=ul(F(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],o=[];r.forEach(l=>{const[c,u]=mR(l,e);s.push(c),o.push(u)});const i=F(Ki(s,0),t.shape),a=F(Ki(o,0),t.shape);return[i,a]}}function mR(t,e=!1){return P.tidy(()=>{k(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=c3(n),o=Ua(t);const i=Cb([[1]],[1,1]);let a=Ua(i);const l=n>=r?r:n;for(let c=0;c<l;++c){const u=o,h=a,d=s;[a,o,s]=P.tidy(()=>{const f=ct(o,[c,c],[n-c,1]),p=K0(f),m=ct(o,[c,c],[1,1]),y=Kn(jr(m,0),Cb([[-1]]),Cb([[1]])),g=Ee(m,O(y,p)),v=Ce(f,g);v.shape[0]===1?a=Ua(i):a=ir([i,ct(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const x=Lt(Ce(Ye(y,g),p)),b=ct(o,[c,0],[n-c,r]),w=O(x,a),C=We(a);if(c===0)o=Ee(b,Ye(w,Ye(C,b)));else{const $=Ee(b,Ye(w,Ye(C,b)));o=ir([ct(o,[0,0],[c,r]),$],0)}const I=We(w),S=ct(s,[0,c],[n,s.shape[1]-c]);if(c===0)s=Ee(S,Ye(Ye(S,a),I));else{const $=Ee(S,Ye(Ye(S,a),I));s=ir([ct(s,[0,0],[n,c]),$],1)}return[a,o,s]}),ze([u,h,d])}return!e&&n>r&&(s=ct(s,[0,0],[n,r]),o=ct(o,[0,0],[r,r])),[s,o]})}const Tie=L({qr_:Nie});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $o={flipLeftRight:qoe,grayscaleToRGB:Yoe,resizeNearestNeighbor:T3,resizeBilinear:N3,rotateWithOffset:Joe,cropAndResize:Hoe,nonMaxSuppression:eie,nonMaxSuppressionAsync:lie,nonMaxSuppressionWithScore:uie,nonMaxSuppressionWithScoreAsync:die,nonMaxSuppressionPadded:pie,nonMaxSuppressionPaddedAsync:gie,threshold:wie,transform:Iie},Rie={bandPart:kie,gramSchmidt:Eie,qr:Tie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Au{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Qr{constructor(){this.classNameMap={}}static getMap(){return Qr.instance==null&&(Qr.instance=new Qr),Qr.instance}static register(e){Qr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Z(t){k(t.className!=null,()=>"Class being registered does not have the static className property defined."),k(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),k(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Qr.register(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ca extends Au{minimize(e,n=!1,r){const{value:s,grads:o}=this.computeGradients(e,r);if(r!=null){const i=r.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return ze(o),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return Bre(e,n)}dispose(){this.iterations_!=null&&ze(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ze(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ca,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R3 extends ca{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=P.registeredVariables[r],i=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:j(()=>je(o).variable(i))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:j(()=>je(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,c=this.accumulatedUpdates[s].variable;j(()=>{const u=te(O(l,this.rho),O(pt(a),1-this.rho)),h=O(Ce(Yn(te(c,this.epsilon)),Yn(te(l,this.epsilon))),a),d=te(O(c,this.rho),O(pt(h),1-this.rho));l.assign(u),c.assign(d);const f=te(O(h,-this.learningRate),o);o.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(ze(this.accumulatedGrads.map(e=>e.variable)),ze(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _3 extends ca{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=P.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:j(()=>G0(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const a=this.accumulatedGrads[s].variable;j(()=>{const l=te(a,pt(i));a.assign(l);const c=te(O(Ce(i,Yn(te(l,P.backend.epsilon()))),-this.learningRate),o);o.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&ze(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A3 extends ca{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],j(()=>{this.accBeta1=Ze(n).variable(),this.accBeta2=Ze(r).variable()}),s==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);j(()=>{const r=Ee(1,this.accBeta1),s=Ee(1,this.accBeta2);n.forEach((o,i)=>{const a=P.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:j(()=>je(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:j(()=>je(a).variable(l))});const c=Array.isArray(e)?e[i].tensor:e[o];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,h=this.accumulatedSecondMoment[i].variable,d=te(O(u,this.beta1),O(c,1-this.beta1)),f=te(O(h,this.beta2),O(pt(c),1-this.beta2)),p=Ce(d,r),m=Ce(f,s);u.assign(d),h.assign(f);const y=te(O(Ce(p,te(Yn(m),this.epsilon)),-this.learningRate),a);a.assign(y)}),this.accBeta1.assign(O(this.accBeta1,this.beta1)),this.accBeta2.assign(O(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ze(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&ze(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),j(()=>{this.accBeta1.assign(qc(this.beta1,this.iterations_+1)),this.accBeta2.assign(qc(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D3 extends ca{static get className(){return"Adamax"}constructor(e,n,r,s=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],j(()=>{this.iteration=Ze(0).variable(),this.accBeta1=Ze(n).variable()}),s==null&&(this.epsilon=P.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);j(()=>{const r=Ee(1,this.accBeta1),s=Ce(-this.learningRate,te(O(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=P.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:je(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:je(a).variable(l)});const c=Array.isArray(e)?e[i].tensor:e[o];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,h=this.accumulatedWeightedInfNorm[i].variable,d=te(O(u,this.beta1),O(c,1-this.beta1)),f=O(h,this.beta2),p=zn(c),m=la(f,p);u.assign(d),h.assign(m);const y=te(O(Ce(s,r),Ce(d,te(m,this.epsilon))),a);a.assign(y)}),this.iteration.assign(te(this.iteration,1)),this.accBeta1.assign(O(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ze(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&ze(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x$ extends ca{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const i=P.registeredVariables[r];j(()=>{const a=te(O(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=so(Ze(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O3 extends x${static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Ze(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=P.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:j(()=>je(o).variable(!1))});const i=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&j(()=>{let l;const c=te(O(this.m,i),a);this.useNesterov?l=te(O(this.c,te(a,O(c,this.m))),o):l=te(O(this.c,c),o),i.assign(c),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&ze(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P3 extends ca{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,s==null&&(this.epsilon=P.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=P.registeredVariables[r],i=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:j(()=>je(o).variable(i))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:j(()=>je(o).variable(i))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:j(()=>je(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,c=this.accumulatedMoments[s].variable;j(()=>{const u=te(O(l,this.decay),O(pt(a),1-this.decay));if(this.centered){const h=this.accumulatedMeanGrads[s].variable,d=te(O(h,this.decay),O(a,1-this.decay)),f=Ce(O(a,this.learningRate),Yn(Ee(u,te(pt(d),this.epsilon)))),p=te(O(c,this.momentum),f);l.assign(u),h.assign(d),c.assign(p);const m=Ee(o,p);o.assign(m)}else{const h=te(O(l,this.decay),O(pt(a),1-this.decay)),d=te(O(c,this.momentum),Ce(O(a,this.learningRate),Yn(te(h,this.epsilon))));l.assign(h),c.assign(d);const f=Ee(o,d);o.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&ze(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&ze(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&ze(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ie=[R3,_3,A3,D3,O3,P3,x$];function Aie(){for(const t of _ie)Z(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Die="model",Oie=".json",Pie=".weights.bin";function gR(t){return new Promise(e=>setTimeout(e)).then(t)}class hl{constructor(e){if(!G().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(hl.URL_SCHEME)&&(e=e.slice(hl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Die),this.modelJsonFileName=e+Oie,this.weightDataFileName=e+Pie}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=HM(e,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=o,await gR(()=>i.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;a.download=this.weightDataFileName,a.href=n,await gR(()=>a.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:W0(e)}}}}hl.URL_SCHEME="downloads://";const Fie=t=>G().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(hl.URL_SCHEME)?Lie(t.slice(hl.URL_SCHEME.length)):null;tn.registerSaveRouter(Fie);function Lie(t="model"){return new hl(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yR(t,e,n,r){i(t),n=n??0,r=r??1,a(n,r);let s=0;const o=l=>(l.then(c=>{const u=n+ ++s/t.length*(r-n);return e(u),c}),l);function i(l){k(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,c){k(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),k(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),k(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Mie(t,e){e==null&&(e={});const n=e.fetchFunc==null?G().platform.fetch:e.fetchFunc,r=t.map(h=>n(h,e.requestInit,{isBinary:!0})),s=0,o=.5,a=(e.onProgress==null?await Promise.all(r):await yR(r,e.onProgress,s,o)).map(h=>h.arrayBuffer()),l=.5,c=1;return e.onProgress==null?await Promise.all(a):await yR(a,e.onProgress,l,c)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zie="application/octet-stream",Bie="application/json";class b${constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(k(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=G().platform.fetch,k(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&k(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=HM(e,r);n.body.append("model.json",new Blob([JSON.stringify(s)],{type:Bie}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:zie}),"model.weights.bin");const o=await this.fetch(this.path,n);if(o.ok)return{modelArtifactsInfo:W0(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return ste(n,o=>this.loadWeights(o))}async loadWeights(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=Uie(n),o=this.weightPathPrefix||r,i=ote(e),a=[],l=[];for(const u of e)for(const h of u.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(h)):a.push(o+h+s);this.weightUrlConverter&&a.push(...await Promise.all(l));const c=await Mie(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,GM(c)]}}b$.URL_SCHEME_REGEX=/^https?:\/\//;function Uie(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function vR(t){return t.match(b$.URL_SCHEME_REGEX)!=null}const F3=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>vR(r)):n=vR(t),n)return Vie(t,e)}return null};tn.registerSaveRouter(F3);tn.registerLoadRouter(F3);function Vie(t,e){return new b$(t,e)}function w$(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(Y(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,o=s[s.length-1];let i=1;for(let h=0;h<s.length-1;++h)i*=s[h];const a=t.shape,l=s.slice();l.pop();let c=1;for(let h=o;h<n;++h)c*=a[h],l.push(a[h]);const u=[...xe(t.shape).map(h=>h/c),1].slice(0,o);return[l,i,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EC=-2,Wie=-1;function C$(t,e,n){const r=t.shape.length;k(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),k(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)k(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function jie(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function I$(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function L3(t,e,n,r){const s=[...t];for(let o=s.length;o<r.length;o++)s.push(1);for(let o=0;o<n;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function M3(t,e,n){return n<=t?n:n-(e-1)}function z3(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function Gie(t,e,n,r,s,o,i,a,l){const c=t.length;let u=new Array(c),h=new Array(c),d=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=B3(i,f,p,r,t),h=U3(a,f,p,s,t),d=L3(o,f,p,t)}else for(let f=0;f<c;f++)u[f]=W3(i,r,o,t,f,l),h[f]=j3(a,s,o,t,f,l),d[f]=V3(o,f,l);return{begin:u,end:h,strides:d}}function B3(t,e,n,r,s){const o=[...s],i=z3(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=M3(e,n,a);let c=r[l];t&1<<l&&(c=0),o[a]=c}return o}function U3(t,e,n,r,s){const o=[...s],i=z3(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=M3(e,n,a);let c=r[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),o[a]=c}for(let a=0;a<o.length;a++){const l=s[a];o[a]<0&&(o[a]+=l),o[a]=nl(0,o[a],s[a])}return o}function V3(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function W3(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),i=nl(0,i,l-1),i}function j3(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),a>0?i=nl(0,i,l):i=nl(-1,i,l-1),i}function S$(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function k$(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function X0(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(i=>{k(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(s).fill(-1):typeof n=="number"?o=[n,...new Array(s-1).fill(-1)]:n.length<s?o=n.concat(new Array(s-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(k(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,o]}function $$(t,e,n,r,s,o,i,a,l){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let x=0;x<h.dims;x++)u&&1<<x&a&&h.numAddAxisAfterEllipsis++,1<<x&i&&(u=!0);u||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};Hie(h,d);let f=!0,p=!0,m=!0;const y=[],g=[];for(let x=0;x<t.length;++x){if(d.strides[x]===0)throw Error(`strides[${x}] must be non-zero`);const b=!!(d.shrinkAxisMask&1<<x),w=t[x];if(w===-1){y.push(b?1:-1);continue}const C=[d.beginMask&1<<x,d.endMask&1<<x],I=[d.strides[x]>0?0:-1,d.strides[x]>0?w:w-1];if(b&&d.strides[x]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&d.strides[x]===1;const S=!!(d.beginMask&1<<x&&d.endMask&1<<x);if(d.beginValid&&d.endValid){if(b){const M=d.begin[x]<0?w+d.begin[x]:d.begin[x];if(d.begin[x]=M,d.end[x]=d.begin[x]+1,M<0||M>=w)throw Error(`slice index ${d.begin[x]} of dimension ${x} out of bounds.`)}else d.begin[x]=xR(d.begin[x],0,d.strides[x],w,C,I),d.end[x]=xR(d.end[x],1,d.strides[x],w,C,I);const A=d.strides[x]===1&&d.begin[x]===0&&d.end[x]===w;f=f&&A,p=p&&(x===0&&d.strides[x]===1||A)}else f=f&&d.strides[x]===1&&S,p=p&&(x===0&&d.strides[x]===1||S);let $,E=!1;if(d.beginValid&&d.endValid?($=d.end[x]-d.begin[x],E=!0):b?($=1,E=!0):S&&w>=0&&(d.strides[x]<0?$=-w:$=w,E=!0),E){let A;$===0||$<0!=d.strides[x]<0?A=0:A=Math.trunc($/d.strides[x])+($%d.strides[x]!==0?1:0),y.push(A)}else y.push(-1)}for(let x=0;x<d.finalShapeGatherIndices.length;++x){const b=d.finalShapeGatherIndices[x];b>=0?g.push(y[b]):b===EC&&g.push(1)}return{finalShapeSparse:g.filter((x,b)=>d.finalShapeGatherIndices[b]!==EC),finalShape:g,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function Hie(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(EC),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(Wie),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function xR(t,e,n,r,s,o){if(s[e])return n>0?o[e]:o[e+1&1];{const i=t<0?r+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const Kie=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:C$,computeFlatOffset:k$,computeOutShape:I$,getNormalizedAxes:Gie,isSliceContinous:S$,maskToAxes:jie,parseSliceParams:X0,sliceInfo:$$,startForAxis:W3,startIndicesWithElidedDims:B3,stopForAxis:j3,stopIndicesWithElidedDims:U3,stridesForAxis:V3,stridesWithElidedDims:L3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qie{static sgd(e){return new x$(e)}static momentum(e,n,r=!1){return new O3(e,n,r)}static rmsprop(e,n=.9,r=0,s=null,o=!1){return new P3(e,n,r,s,o)}static adam(e=.001,n=.9,r=.999,s=null){return new A3(e,n,r,s)}static adadelta(e=.001,n=.95,r=null){return new R3(e,n,r)}static adamax(e=.002,n=.9,r=.999,s=null,o=0){return new D3(e,n,r,s,o)}static adagrad(e,n=.1){return new _3(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ol=qie;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xie=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t())();function G3(){return new Promise(t=>Xie(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$(t,e){const n=t[0].length;t.forEach((s,o)=>{k(s.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),k(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,o)=>{for(let i=0;i<n;i++)k(i===e||s[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${o}.`)})}function oo(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Cs;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Cs||(Cs={}));function H3(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const o=n[s],i=r[r.length-n.length+s],a=r[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${o} but shape[${s+t}] = ${a}`)}else r[i]=o}return r}function K3(t){const e={FIRST_DIM_SIZE:Cs.FIRST_DIM_SIZE,VALUE_ROWIDS:Cs.VALUE_ROWIDS,ROW_LENGTHS:Cs.ROW_LENGTHS,ROW_SPLITS:Cs.ROW_SPLITS,ROW_LIMITS:Cs.ROW_LIMITS,ROW_STARTS:Cs.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function q3(t){return t.length===0?0:t[0]===Cs.FIRST_DIM_SIZE?t.length-1:t.length}function X3(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const o=t[s],i=e[s+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${o} but ragged tensor input.flatValues.shape[${s-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N$=30;function Y0(t){return t<=N$?t:tC(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bp(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)s=s.concat([t[i+1]/e[i],e[i]]);s=s.concat(t.slice(o+1))}return s}function wp(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):s.push(i);r.push(...s),r.push(0),r.push(...o)}return r}function Cp(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?r?s.push(e[o-1]*t[o]):s.push(t[o]/e[o-1]):s.push(t[o]);return s}function R$(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function _$(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q0=1.7580993408473768,J0=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$=.3275911,D$=.254829592,O$=-.284496736,P$=1.421413741,F$=-1.453152027,L$=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Y3(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Q3(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function J3(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function M$(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function Z3(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function e4(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const o=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(o),r[s]=Math.sin(o)}return{real:n,imag:r}}function t4(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),o=Math.sin(r);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ib="->",Yie=/->/g,bR=",",wR="...";function z$(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(Yie,"").length)/Ib.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Ib}").`);const[r,s]=t.split(Ib);k(r.indexOf(wR)===-1,()=>`The ellipsis notation ("${wR}") is not supported yet.`);const o=r.split(bR),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<s.length;++d){const f=s[d];if(!o.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let d=0;d<r.length;++d){const f=r[d];a.indexOf(f)===-1&&f!==bR&&a.push(f)}const l=new Array(o.length);for(let d=0;d<i;++d){if(new Set(o[d].split("")).size!==o[d].length)throw new Error(`Found duplicate axes in input component ${o[d]}. Support for duplicate axes in input is not implemented yet.`);l[d]=[];for(let f=0;f<o[d].length;++f)l[d].push(a.indexOf(o[d][f]))}const c=a.length,u=s.length,h=[];for(let d=u;d<c;++d)h.push(d);return{allDims:a,summedDims:h,idDims:l}}function B$(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function U$(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const o=n[s].shape;for(let i=0;i<e[s].length;++i)r[e[s][i]]===void 0?r[e[s][i]]=o[i]:k(r[e[s][i]]===o[i],()=>`Expected dimension ${r[e[s][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function V$(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let i=0;i<s;++i)r.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=Qie(e,a);for(const c of l)o.indexOf(c)===-1&&(r[i].push(c),o.push(c))}return{path:n,steps:r}}function W$(t){return t.every((e,n)=>e===n)}function Qie(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function j$(t,e,n=0){let r=[];if(typeof e=="number")k(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);k(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}k(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function r4(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function s4(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function i4(t,e){return`size ${t} must be non-negative, not ${e}`}function a4(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function l4(t,e){const n=Y(t),r=Y(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function c4(t,e){const n=Y(t),r=Y(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NC(){return"segment ids must be >= 0"}function u4(){return"segment ids are not increasing"}function h4(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function d4(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f4(t,e){let n=!1,r;for(t<=N$?(r=t,n=!0):r=tC(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=tC(t,r+1);return r}function p4(t,e,n){const r=[],s=t.length;for(let o=0;o<s;o++)o!==e?r.push(t[o]):r.push(n);return r}function G$(t,e,n,r){const s=e.shape.length,o=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let h=0;h<r;++h)if(t.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${t.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const i=t.shape[n],a=[];let l=1,c=1,u=1;for(let h=0;h<r;++h)a.push(t.shape[h]),l*=t.shape[h];for(let h=r;h<n;h++)a.push(t.shape[h]),c*=t.shape[h];for(let h=r;h<s;h++)a.push(e.shape[h]);for(let h=n+1;h<o;h++)a.push(t.shape[h]),u*=t.shape[h];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:a}}const Jie=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:G$,computeOutShape:p4,segOpComputeOptimalWindowSize:f4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Go(t){try{return t.map(e=>Hi(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function m4(t){return t.map(e=>Li(e))}const Zie=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:D$,ERF_A2:O$,ERF_A3:P$,ERF_A4:F$,ERF_A5:L$,ERF_P:A$,PARALLELIZE_THRESHOLD:N$,get RowPartitionType(){return Cs},SELU_SCALE:J0,SELU_SCALEALPHA:Q0,applyActivation:f$,assertAndGetBroadcastShape:_e,assertAxesAreInnerMostDims:Cn,assertParamsConsistent:E$,assignToTypedArray:Z3,axesAreInnerMostDims:Yk,calculateShapes:$l,checkEinsumDimSizes:U$,checkPadOnDimRoundingMode:hr,combineLocations:a3,combineRaggedTensorToTensorShapes:H3,complexWithEvenIndex:Q3,complexWithOddIndex:J3,computeConv2DInfo:wn,computeConv3DInfo:ia,computeDefaultPad:Wk,computeDilation2DInfo:mp,computeOptimalWindowSize:Y0,computeOutAndReduceShapes:cn,computeOutShape:oo,computePool2DInfo:us,computePool3DInfo:Yo,convertConv2DDataFormat:Qo,decodeEinsumEquation:z$,eitherStridesOrDilationsAreOne:Dn,expandShapeToKeepDim:Gt,exponent:t4,exponents:e4,fromStringArrayToUint8:m4,fromUint8ToStringArray:Go,getAxesPermutation:Et,getBroadcastDims:Kc,getComplexWithIndex:M$,getEinsumComputePath:V$,getEinsumPermutation:B$,getFusedBiasGradient:d$,getFusedDyActivation:h$,getImageCenter:T$,getInnerMostAxes:Bt,getPermuted:wp,getRaggedRank:q3,getReductionAxes:en,getReshaped:bp,getReshapedPermuted:Cp,getRowPartitionTypesHelper:K3,getSliceBeginCoords:R$,getSliceSize:_$,getSparseFillEmptyRowsIndicesDenseShapeMismatch:n4,getSparseFillEmptyRowsNegativeIndexErrorMessage:r4,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:s4,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:a4,getSparseReshapeInputOutputMismatchErrorMessage:c4,getSparseReshapeInputOutputMultipleErrorMessage:l4,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:o4,getSparseReshapeNegativeOutputDimErrorMessage:i4,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:d4,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:NC,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:u4,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:h4,getUndoAxesPermutation:aa,isIdentityPermutation:W$,log:Nee,mergeRealAndImagArrays:jo,prepareAndValidate:w$,prepareSplitSize:j$,segment_util:Jie,shouldFuse:p$,slice_util:Kie,splitRealAndImagArrays:Y3,stridesOrDilationsArePositive:al,tupleValuesAreOne:il,upcastType:kr,validateDefaultValueShape:X3,validateInput:Soe,validateUpdateShape:S3,warn:Ar},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Aie();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ia={},ym={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function eae(t,e){Ia[t]=e}function Os(t,e){if(!(t in Ia)||e!=null){const r=nae(t,e);if(r!==null)Ia[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Ia[t];return n==null||n.isContextLost()?(delete Ia[t],Os(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ia[t])}function tae(t){if(!G().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function nae(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??tae(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Ia[t]},!1),G().getBool("SOFTWARE_WEBGL_ENABLED")&&(ym.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",ym)||n.getContext("experimental-webgl",ym):n.getContext("webgl2",ym)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Dd;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Dd||(Dd={}));var Pr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Pr||(Pr={}));var mn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(mn||(mn={}));function Ip(t,e){return[e,t]}function rae(t,e){return t*e}function vm(t){const e=Y(t),n=Math.ceil(e/4);return Jw(n)}function Du(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function sae(t,e){const[n,r]=Du(t,e);return n*r*4}function H$(t,e){const n=t;let r,s,o,i,a,l,c,u,h,d;return G().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,c=4,u=1,h=n.HALF_FLOAT,d=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,c=4,u=4,h=e!=null?e.HALF_FLOAT_OES:null,d=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function de(t,e){const n=e();return G().getBool("DEBUG")&&oae(t),n}function oae(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+cae(t,e))}const iae=596e-10,aae=65504;function lae(t){return!!(G().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||iae<Math.abs(t)&&Math.abs(t)<aae)}function cae(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function xm(t,e){return Jo(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function uae(t,e){const n=Jo(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(de(t,()=>t.shaderSource(n,e)),de(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function hae(t,e){const n=Jo(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(de(t,()=>t.shaderSource(n,e)),de(t,()=>t.compileShader(n)),G().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw g4(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const dae=/ERROR: [0-9]+:([0-9]+):/g;function g4(t,e){const n=dae.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),o=s.length.toString().length+2,i=s.map((h,d)=>yc((d+1).toString(),o)+h);let a=0;for(let h=0;h<i.length;h++)a=Math.max(i[h].length,a);const l=i.slice(0,r-1),c=i.slice(r-1,r),u=i.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${yc(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function fae(t){return Jo(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function pae(t,e){if(de(t,()=>t.linkProgram(e)),!G().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Sb(t,e){if(de(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function mae(t,e){const n=Jo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return de(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),de(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function gae(t,e){const n=Jo(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return de(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),de(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function yae(t){return Jo(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function vae(t,e){const n=G().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function xae(t){return Jo(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function CR(t,e,n,r,s,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(de(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),de(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,o,i)),de(t,()=>t.enableVertexAttribArray(a)),!0)}function bae(t,e,n){kae(t,n),de(t,()=>t.activeTexture(t.TEXTURE0+n)),de(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function wae(t,e,n){return Jo(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Cae(t,e,n){return t.getUniformLocation(e,n)}function Iae(t,e,n,r){de(t,()=>bae(t,e,r)),de(t,()=>t.uniform1i(n,r))}function kb(t,e,n){de(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),de(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function IR(t,e){de(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),de(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function bm(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Sae(t,e))}function Sae(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Jo(t,e,n){const r=de(t,()=>e());if(r==null)throw new Error(n);return r}function kae(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function Yc(t,e=2){return Y(t.slice(0,t.length-e))}function Qc(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function wm(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Yc(t),...Qc(t)]),e}function $ae(t,e=!1){let n=G().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=G().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&G().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?YS(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=sa(t).newShape);let s=Y(t),o=null;t.length<=1&&s<=n?o=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=Yc(t);let l=2,c=2;t.length&&([l,c]=Qc(t)),s=a*(l/2)*(c/2),o=Jw(s).map(u=>u*2)}else o=Jw(s);return o}function Cm(t){return t%2===0}function gy(t,e){if(t=t.slice(-2),e=e.slice(-2),Qe(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||Cm(n)&&Cm(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Cm(t[0])&&Cm(e[0])}let $b,Eb;function Eae(t){if($b==null){const e=Os(t);$b=e.getParameter(e.MAX_TEXTURE_SIZE)}return $b}function Nae(t){if(Eb==null){const e=Os(t);Eb=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Eb)}function Tae(t){if(t===0)return 0;let e;const n=Os(t);return ns(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:ns(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function ns(t,e){return t.getExtension(e)!=null}function SR(t){try{if(Os(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Rae(t){if(t===0)return!1;const e=Os(t);if(t===1){if(!ns(e,"OES_texture_float"))return!1}else if(!ns(e,"EXT_color_buffer_float"))return!1;return TC(e)}function _ae(t){if(t===0)return!1;const e=Os(t);if(t===1){if(!ns(e,"OES_texture_float")||!ns(e,"WEBGL_color_buffer_float"))return!1}else{if(ns(e,"EXT_color_buffer_float"))return TC(e);const r="EXT_color_buffer_half_float";if(ns(e,r)){const s=e.getExtension(r);return Aae(e,s)}return!1}return TC(e)}function TC(t){const e=H$(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=1,s=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,r,s,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function Aae(t,e){const n=H$(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const s=1,o=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,s,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}function Dae(t){return t!==2?!1:Os(t).fenceSync!=null}function Sp(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&k(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ye=G();ye.registerFlag("HAS_WEBGL",()=>ye.getNumber("WEBGL_VERSION")>0);ye.registerFlag("WEBGL_VERSION",()=>SR(2)?2:SR(1)?1:0);ye.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);ye.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>ye.get("WEBGL_VERSION")===2);ye.registerFlag("WEBGL_CPU_FORWARD",()=>!0);ye.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);ye.registerFlag("WEBGL_PACK",()=>ye.getBool("HAS_WEBGL"));ye.registerFlag("WEBGL_PACK_NORMALIZATION",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_CLIP",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_PACK_REDUCE",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_LAZILY_UNPACK",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_CONV_IM2COL",()=>ye.getBool("WEBGL_PACK"));ye.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Eae(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Nae(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=ye.getNumber("WEBGL_VERSION");return t===0?0:Tae(t)});ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>ye.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!BM());ye.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Rae(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>ye.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:ye.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));ye.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>_ae(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Dae(ye.getNumber("WEBGL_VERSION")));ye.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>ye.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);ye.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});ye.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>BM()?1:-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});ye.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);ye.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);ye.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);ye.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);ye.registerFlag("WEBGL_EXP_CONV",()=>!1);ye.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>ye.getBool("IS_TEST"));ye.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);ye.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);ye.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);ye.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jn(){let t,e,n,r,s,o,i,a,l,c;return G().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",o="outputColor",i="out vec4 outputColor;",a=G().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function El(t,e,n="index"){const r=xe(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / ${s}`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s}`:`index -= ${t[o]} * ${s}`;return`${i}; ${a};`}).join("")}function Z0(t,e,n="index"){const r=xe(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function Oae(t,e){const n=t.length,r=t.map(o=>`${e}[${o}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let o=n-3;o>=0;--o)s[o]=`(${s[o+1]} * ${r[o+1]})`;return s}function Pae(t,e,n="index"){const r=t.map((o,i)=>i),s=Oae(r,e);return s.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${s[i]}`,l=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s[i]}`:`index -= ${t[i]} * ${s[i]}`;return`${a}; ${l};`}).join("")}function K$(t){const e=xe(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function q$(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const y4=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:v4}=Zie;function Fae(t,e,n){const r=[];if(t.forEach(f=>{const p=Y(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=X$(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const s=r.join(`
`),o=t.map(f=>Lae(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=Jn(),l=Bae(a);let c,u,h=Wae(a);return e.isPacked?(c=Mae(e.logicalShape,i,n.enableShapeUniforms),u=Vae(a)):(c=zae(e.logicalShape,i,n.enableShapeUniforms),u=Uae(a)),n.packedInputs&&(h+=Kae),[h,l,u,s,c,o,n.userCode].join(`
`)}function Ou(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return ole(t,e);case 1:return ale(t,e);case 2:return cle(t,e);case 3:return hle(t,e);case 4:return fle(t,e);case 5:return ple(t);case 6:return mle(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function x4(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return sle(t);case 1:return ile(t,e);case 2:return lle(t,e);case 3:return ule(t,e);default:return dle(t,e)}}function Lae(t,e,n=!1,r){let s="";n?s+=x4(t,r):s+=Ou(t,r);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?s+=gle(t,e):s+=yle(t,e)),s}function Mae(t,e,n){switch(t.length){case 0:return b4();case 1:return qae(t,e,n);case 2:return nle(t,e,n);case 3:return Yae(t,e,n);default:return Jae(t,e,n)}}function zae(t,e,n){switch(t.length){case 0:return b4();case 1:return Xae(t,e,n);case 2:return rle(t,e,n);case 3:return Qae(t,e,n);case 4:return Zae(t,e,n);case 5:return ele(t,e);case 6:return tle(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Bae(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Uae(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Vae(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Wae(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${jae}
    ${Gae}
    ${Hae}
  `}const jae=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Gae=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Hae=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Kae=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function b4(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function qae(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Xae(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Yae(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),o=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function Qae(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Z0(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=El(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Jae(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),o=s*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)i*=t[t.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function Zae(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Z0(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=El(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function ele(t,e){const n=El(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function tle(t,e){const n=El(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function nle(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Qe(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function rle(t,e,n){return Qe(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Nl(t){return`offset${t}`}function sle(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Jn();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function ole(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,o]=t.shapeInfo.texShape;if(s===1&&o===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=Nl(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function ile(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,o=Jn();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function ale(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Pu(t)}
      }
    `;const s=t.shapeInfo.texShape,o=s[0],i=s[1];if(i===1&&o===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Nl(n);return i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function lle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=Jn();if(o!=null&&Qe(n,o))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function cle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(o!=null&&Qe(n,o)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const d=o[0],f=o[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:i,keptDims:a}=sa(n),l=i;if(l.length<n.length){const d=Fu(t,l),f=["row","col"];return`
      ${Ou(d,e)}
      float ${s}(int row, int col) {
        return ${s}(${Lu(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Pu(t)}
      }
    `;const c=o[0],u=o[1],h=Nl(r);return u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${h};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function ule(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const d=n.slice(1),f=[1,2],p=Fu(t,d),m=["b","row","col"];return`
        ${x4(p,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Lu(m,f)});
        }
      `}const a=Jn();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=i[0],c=i[1],u=Math.ceil(n[2]/2),h=u*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${h}, ${u}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function hle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=sa(n),c=a;if(c.length<n.length){const m=Fu(t,c),y=["row","col","depth"];return`
        ${Ou(m,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Lu(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${Pu(t)}
      }
    `;const u=t.shapeInfo.texShape,h=u[0],d=u[1],f=t.shapeInfo.flatOffset;if(d===o&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===i&&f==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=Nl(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function dle(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=Jn();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],h=Math.ceil(o[i-1]/2);let d=h*Math.ceil(o[i-2]/2),f="int b, int row, int col",p=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,d*=o[i-m-1],p=`b${m} * ${d} + `+p;return`
    vec4 ${r}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${s.texture2D}(${n}, uv);
    }
  `}function fle(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:c}=sa(n);if(l.length<n.length){const v=Fu(t,l),x=["row","col","depth","depth2"];return`
      ${Ou(v,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Lu(x,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${Pu(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1],p=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,y=`int stride0 = ${r}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===o&&u==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;const g=Nl(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${d}, ${f}, index + ${g});
      return sampleTexture(${r}, uv);
    }
  `}function ple(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],o=e[3]*s,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:c}=sa(e);if(l.length<e.length){const m=Fu(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${Ou(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Lu(y,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${s})) +
          depth3;
        ${Pu(t)}
      }
    `;const u=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,d=h[0],f=h[1];if(f===a&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===s&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${d}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Nl(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${s} + depth3 + ${p};
      vec2 uv = uvFromFlat(${d}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function mle(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:o}=sa(e);if(s.length<e.length){const y=Fu(t,s),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${Ou(y)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Lu(g,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Pu(t)}
      }
    `;const h=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],p=d[1];if(p===u&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Nl(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Pu(t){const e=t.name,n=Y(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function gle(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=v4(t.shapeInfo.logicalShape,e.logicalShape),l=st(i),c=i-o;let u;const h=["x","y","z","w","u","v"];o===0?u="":i<2&&a.length>=1?u="coords = 0;":u=a.map(v=>`coords.${h[v+c]} = 0;`).join(`
`);let d="";i<2&&o>0?d="coords":d=t.shapeInfo.logicalShape.map((v,x)=>`coords.${h[x+c]}`).join(", ");let f="return outputValue;";const m=Y(t.shapeInfo.logicalShape)===1,g=Y(e.logicalShape)===1;if(o===1&&!m&&!g)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const v=o-2,x=o-1;a.indexOf(v)>-1&&a.indexOf(x)>-1?f="return vec4(outputValue.x);":a.indexOf(v)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(x)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${d});
      ${f}
    }
  `}function yle(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Qe(i,o))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=st(l),u=v4(t.shapeInfo.logicalShape,e.logicalShape),h=l-a;let d;const f=["x","y","z","w","u","v"];a===0?d="":l<2&&u.length>=1?d="coords = 0;":d=u.map(m=>`coords.${f[m+h]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,y)=>`coords.${f[y+h]}`).join(", "),`
    float ${s}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${r}(${p});
    }
  `}function st(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function X$(t,e,n){const{newShape:r,keptDims:s}=sa(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):r,l=!t&&o>1&&!Qe(e,n)&&r.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function Fu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Lu(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vle(t,e,n,r){const s=n.map((u,h)=>{const d={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(d.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:d}}),o=s.map(u=>u.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=Fae(s,i,e),l=hae(t.gl,a),c=t.createProgram(l);return G().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i},w4(t,e,c))}function w4(t,e,n){const r=[],s=[];let o,i,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),G().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const h of e.variableNames){const d={name:h,uniform:t.getUniformLocation(n,h,u),offset:t.getUniformLocation(n,`offset${h}`,u)};e.enableShapeUniforms&&(d.shape=t.getUniformLocation(n,`${h}Shape`,u),d.texShape=t.getUniformLocation(n,`${h}TexShape`,u)),r.push(d)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),i=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const h of e.customUniforms)s.push(t.getUniformLocation(n,h.name,u));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:c,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function kR(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,o=e[r],i=o.shape;if(!Qe(s,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!Qe(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function xle(t,e,n,r,s){e.program.enableShapeUniforms||(kR(e.inShapeInfos,n),kR([e.outShapeInfo],[r]));const o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),G().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:h,shape:d,texShape:f}=e.variablesLocations[l];if(d){const{uniformShape:p}=X$(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(d,new Int32Array(p));break;case 2:t.gl.uniform2iv(d,new Int32Array(p));break;case 3:t.gl.uniform3iv(d,new Int32Array(p));break;case 4:t.gl.uniform4iv(d,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(Y(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&h!=null&&t.gl.uniform1i(h,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=xe(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],h=s[l];if(c.type==="float")t.gl.uniform1fv(u,h);else if(c.type==="vec2")t.gl.uniform2fv(u,h);else if(c.type==="vec3")t.gl.uniform3fv(u,h);else if(c.type==="vec4")t.gl.uniform4fv(u,h);else if(c.type==="int")t.gl.uniform1iv(u,h);else if(c.type==="ivec2")t.gl.uniform2iv(u,h);else if(c.type==="ivec3")t.gl.uniform3iv(u,h);else if(c.type==="ivec4")t.gl.uniform4iv(u,h);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function ble(t,e,n){let r="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:h}=X$(t.packedInputs,i.shape,l);let d="",f="",p="";if(u.length===1&&t.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];d=`${w[0]>1}_${w[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const w=xe(u);p=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const m=i.shape.length,y=u.length===2&&Qe(i.shape,l),g=Y(i.shape)===1,v=Kc(i.shape,n.shape),x=!t.packedInputs&&m===n.shape.length&&Qe(l,n.texData.texShape),b=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${x}_${c?h:""}_${u.length}_${g}_${v}_${y}_${d}_${f}_${p}_${b}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${a}`}});const s=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+s+`${G().getNumber("WEBGL_VERSION")}`,o}function On(t){return G().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wle{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Dd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Jn();this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Z0(["r","c","d"],e):El(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cle{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Dd.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Jn();this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Z0(["r","c","d"],e):El(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ile{constructor(e){this.variableNames=["A"],this.outTexUsage=Pr.DOWNLOAD;const n=Jn();this.outputShape=e,this.userCode=`
      ${y4}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sle{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Pr.DOWNLOAD;const n=Jn();this.outputShape=e,this.userCode=`
      ${y4}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle={R:0,G:1,B:2,A:3};class $R{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Jn();this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<r.length;a++){const l=r[a];i+=`
          if(offset == ${a}) {
            result = values[${kle[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?q$():K$(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${i}
        }
        ${s.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $le{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Jn();this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length);let s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?q$():K$(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ele(t){const e=Jn(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return uae(t,n)}function Nle(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return mae(t,e)}function Tle(t){const e=new Uint16Array([0,1,2,2,1,3]);return gae(t,e)}function kp(t,e,n,r,s,o){vae(e,n);const i=yae(t),a=t.TEXTURE_2D;return de(t,()=>t.bindTexture(a,i)),de(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),de(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),de(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),de(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),G().getNumber("WEBGL_VERSION")===1?de(t,()=>t.texImage2D(a,0,r,e,n,0,s,o,null)):de(t,()=>t.texStorage2D(a,1,r,e,n)),de(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function C4(t){return t.internalFormatFloat}function Rle(t,e,n,r){const[s,o]=Ip(e,n);return kp(t,s,o,C4(r),r.textureFormatFloat,t.FLOAT)}function I4(t){return t.internalFormatHalfFloat}function _le(t,e,n,r){const[s,o]=Ip(e,n);return kp(t,s,o,I4(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function S4(t){return t.downloadTextureFormat}function Ale(t,e,n,r){const[s,o]=Ip(e,n);return kp(t,s,o,S4(r),t.RGBA,t.UNSIGNED_BYTE)}function k4(t){return t.internalFormatPackedFloat}function Dle(t,e,n,r){const[s,o]=Du(e,n);return kp(t,s,o,k4(r),t.RGBA,t.FLOAT)}function $4(t){return t.internalFormatPackedHalfFloat}function Ole(t,e,n,r){const[s,o]=Du(e,n);return kp(t,s,o,$4(r),t.RGBA,r.textureTypeHalfFloat)}function Ple(t,e,n){return de(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),CR(t,e,"clipSpacePos",n,3,20,0)&&CR(t,e,"uv",n,2,20,12)}function Fle(t,e,n,r,s,o){de(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;s instanceof Uint8Array?(i=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*r*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(s),G().getNumber("WEBGL_VERSION")===2?de(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,i)):de(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,i)),de(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Lle(t,e,n){de(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?G().getNumber("WEBGL_VERSION")===2?de(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):de(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):G().getNumber("WEBGL_VERSION")===2?de(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):de(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),de(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Mle(t,e,n,r){const s=t.createBuffer();de(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return de(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),de(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),de(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function zle(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function Ble(t,e,n,r){const[s,o]=Ip(e,n),i=4,a=new Uint8Array(rae(e*n,i));return de(t,()=>t.readPixels(0,0,s,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Ule(t,e,n,r,s,o,i,a){const l=t,c=new Float32Array(sae(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Vle(t,e,n){const r=new Float32Array(e*n*4);return de(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nb{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=G().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,eae(n,e)):this.gl=Os(n),e=this.gl,G().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>de(o,()=>o.createVertexArray()),this.bindVertexArray=i=>de(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>de(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>de(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>de(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>de(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>de(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>de(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),G().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=xm(this.gl,o),ns(this.gl,i))this.textureHalfFloatExtension=xm(this.gl,i);else if(G().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),ns(this.gl,s))this.colorBufferHalfFloatExtension=xm(this.gl,s);else if(G().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",ns(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(ns(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Nle(this.gl),this.indexBuffer=Tle(this.gl),this.framebuffer=xae(this.gl),this.textureConfig=H$(this.gl,this.textureHalfFloatExtension)}get debug(){return G().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;de(e,()=>e.finish()),de(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),de(e,()=>e.deleteFramebuffer(this.framebuffer)),de(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),de(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),de(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Rle(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),_le(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Ale(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Lle(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),Fle(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Ole(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Dle(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(IR(this.gl,this.framebuffer),this.outputTexture=null),de(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Ble(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,o,i){return Ule(this.gl,e,n,r,s,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return zle(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=Mle(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(G().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const i=s.clientWaitSync(o,0,0);return i===s.ALREADY_SIGNALED||i===s.CONDITION_SATISFIED},n=o}else G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Vle(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Ele(n));const r=fae(n);de(n,()=>n.attachShader(r,this.vertexShader)),de(n,()=>n.attachShader(r,e)),pae(n,r);let s;return s=Object.assign(r,{vao:this.createVertexArray()}),this.bindVertexArray(s.vao),de(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),console.assert(Ple(n,s,this.vertexBuffer),"gpgpu_util.bindVertexProgramAttributeStreams not fully successful."),this.debug&&Sb(n,s),this.setProgram(s),s}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(de(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&(this.bindVertexArray(this.program.vao),this.debug&&Sb(this.gl,this.program)),de(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?wae(this.gl,e,n):Cae(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),de(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),Iae(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,o]=Du(n,r);this.setOutputMatrixTextureDriver(e,s,o)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Sb(this.gl,this.program),bm(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}de(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),de(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=xm(this.gl,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await K2(()=>this.disposed||this.isQueryAvailable(e,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=Wle(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in G().platform&&(r=G().platform.setTimeoutCustom.bind(G().platform)),K2(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),kb(this.gl,e,this.framebuffer),this.debug&&bm(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(kb(this.gl,this.outputTexture,this.framebuffer),this.debug&&bm(this.gl)):IR(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;kb(s,e,this.framebuffer),this.debug&&bm(s),this.outputTexture=e,de(s,()=>s.viewport(0,0,n,r)),de(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),de(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Wle(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function me(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&k(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const jle=t=>{const{x:e}=t.inputs,n=t.backend;me(e,"abs");let r=new Float32Array(Y(e.shape));const s=n.data.get(e.dataId).values;return r=E4(s),n.makeOutput(r,e.shape,e.dtype)},Gle={kernelName:Bv,backendName:"cpu",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t){return(e,n,r,s,o)=>{const i=_e(e,n),a=i.length,l=xe(i),c=Y(i),u=Rn(o,c),h=e.length,d=n.length,f=xe(e),p=xe(n),m=Kc(e,i),y=Kc(n,i);if(m.length+y.length===0)for(let g=0;g<u.length;++g)u[g]=t(r[g%r.length],s[g%s.length]);else for(let g=0;g<u.length;++g){const v=Eu(g,a,l),x=v.slice(-h);m.forEach(I=>x[I]=0);const b=ro(x,h,f),w=v.slice(-d);y.forEach(I=>w[I]=0);const C=ro(w,d,p);u[g]=t(r[b],s[C])}return[u,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yr(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,a=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(s.shape,"float32",i)},a}const Hle={kernelName:ak,backendName:"cpu",kernelFunc:yr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(t,e,n="float32"){if(n==="complex64"){const s=yy(t,e,"float32"),o=yy(t,e,"float32");return yr({inputs:{real:s,imag:o},backend:t})}const r=_n(Y(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fo(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Kle={kernelName:Bf,backendName:"cpu",kernelFunc:fo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dl(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,o)}const qle={kernelName:Rk,backendName:"cpu",kernelFunc:dl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=wl([0],n),[o,i]=Ht((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function qi(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return fo({inputs:{x:s},backend:n});const u=yy(n,s.shape,s.dtype),h=qi({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),d=yr({inputs:{real:h,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),d}if(s.dtype==="complex64"){const u=dl({inputs:{input:s},backend:n}),h=qi({inputs:{x:u},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(u),h}if(!JL(s.dtype,o)){const u=fo({inputs:{x:s},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:o}}const i=n.data.get(s.dataId).values,[a,l,c]=N4(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,c)}const Xle={kernelName:Ef,backendName:"cpu",kernelFunc:qi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function un(t,e,n,r){return n==null?({inputs:s,backend:o})=>{const{a:i,b:a}=s,l=o;me([i,a],t);const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,h=i.dtype==="string"?Go(c):c,d=i.dtype==="string"?Go(u):u,f=r||i.dtype,[p,m]=e(i.shape,a.shape,h,d,f);return l.makeTensorInfo(m,f,p)}:({inputs:s,backend:o})=>{const{a:i,b:a}=s,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const c=qi({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),h=u.complexTensorInfos.real,d=u.complexTensorInfos.imag,f=l.data.get(h.dataId).values,p=l.data.get(d.dataId).values,m=qi({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),y=l.data.get(m.dataId),g=y.complexTensorInfos.real,v=y.complexTensorInfos.imag,x=l.data.get(g.dataId).values,b=l.data.get(v.dataId).values,[w,C,I]=n(i.shape,a.shape,f,p,x,b),S=l.makeTensorInfo(I,"float32",w),$=l.makeTensorInfo(I,"float32",C),E=yr({inputs:{real:S,imag:$},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(S),l.disposeIntermediateTensorInfo($),E}else{const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,h=r||i.dtype,[d,f]=e(i.shape,a.shape,c,u,h);return l.makeTensorInfo(f,h,d)}}}function Y$(t){return(e,n,r,s,o,i)=>{const a=_e(e,n),l=Y(a),c=a.length,u=xe(a),h=Rn("float32",l),d=Rn("float32",l),f=Kc(e,a),p=Kc(n,a),m=jo(r,s),y=jo(o,i),g=e.length,v=xe(e),x=n.length,b=xe(n);if(f.length+p.length===0)for(let w=0;w<h.length;w++){const C=w%m.length,I=w%y.length,S=t(m[C*2],m[C*2+1],y[I*2],y[I*2+1]);h[w]=S.real,d[w]=S.imag}else for(let w=0;w<h.length;w++){const C=Eu(w,c,u),I=C.slice(-g);f.forEach(M=>I[M]=0);const S=ro(I,g,v),$=C.slice(-x);p.forEach(M=>$[M]=0);const E=ro($,x,b),A=t(m[S*2],m[S*2+1],y[E*2],y[E*2+1]);h[w]=A.real,d[w]=A.imag}return[h,d,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T4=Ht((t,e)=>t+e),Yle=Y$((t,e,n,r)=>({real:t+n,imag:e+r})),Jc=un(Nu,T4,Yle),Qle={kernelName:Nu,backendName:"cpu",kernelFunc:Jc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$(t,e,n,r,s){const o=Y(r),i=_n(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function R4(t,e,n,r=!1){const s=t.shape[0],o=t.shape[1],i=Fe([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<o;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?i.set(1,a,c):e.size>0?i.set(i.get(a,c)+e.get(a,l),a,c):i.set(i.get(a,c)+1,a,c))}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(t){return(e,n,r)=>{const s=Ft(n,e.length);for(let o=0;o<e.length;++o)s[o]=t(e[o],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tt(t,e,n){const r=po(e);return ua(t,r,n)}function ua(t,e,n){return({inputs:r,attrs:s,backend:o})=>{const{x:i}=r;me(i,t);const a=o,l=a.data.get(i.dataId).values;let c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=Go(l)}else c=l;const u=n||i.dtype,h=e(c,u,s);return a.makeTensorInfo(i.shape,u,h)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _4=po(t=>Math.ceil(t)),Jle=ua(Nf,_4),Zle={kernelName:Nf,backendName:"cpu",kernelFunc:Jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4(t,e,n,r){const s=Ft(n,Y(e));if(r&&n!=="string"){let o=0;t.forEach(i=>{const a=Y(i.shape);s.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?Go(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const u=c*e[1]+o;for(let h=0;h<i.shape[1];++h)s[u+h]=a[l++]}o+=i.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D4=Ht((t,e)=>t===e?1:0),O4=un(t0,D4,null,"bool"),ece={kernelName:t0,backendName:"cpu",kernelFunc:O4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P4=po(t=>Math.exp(t)),F4=ua(Pf,P4,"float32"),tce={kernelName:Pf,backendName:"cpu",kernelFunc:F4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L4=po(t=>Math.expm1(t)),nce=ua(Ff,L4),rce={kernelName:Ff,backendName:"cpu",kernelFunc:nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M4=po(t=>Math.floor(t)),sce=ua(Lf,M4),oce={kernelName:Lf,backendName:"cpu",kernelFunc:sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z4=Ht((t,e)=>Math.floor(t/e)),ice=un(Mf,z4,null,"int32"),ace={kernelName:Mf,backendName:"cpu",kernelFunc:ice};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4(t,e,n,r,s,o,i,a,l){const c=Fe([r,o],n);for(let u=0;u<r;u++){const h=[];let d=0;for(let f=0;f<s;f++){const p=t[u*s+f];d+=p*i[f],h.push(p)}if(d<0||d>=l/o)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let f=0;f<o;f++)c.values[u*o+f]=e.get(...e.indexToLoc(d*o+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U4(t,e,n){const r=Fe(n,t.dtype);for(let s=0;s<r.size;++s){const i=r.indexToLoc(s).slice(),a=i[0],l=i[2],c=e.locToIndex([a,l]);i[2]=e.values[c];const u=t.locToIndex(i);0<=u&&u<t.values.length&&(r.values[s]=t.values[u])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V4=Ht((t,e)=>t>e?1:0),lce=un(o0,V4,null,"bool"),cce={kernelName:o0,backendName:"cpu",kernelFunc:lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W4=Ht((t,e)=>t>=e?1:0),uce=un(zf,W4,null,"bool"),hce={kernelName:zf,backendName:"cpu",kernelFunc:uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j4=Ht((t,e)=>t<e?1:0),dce=un(a0,j4,null,"bool"),fce={kernelName:a0,backendName:"cpu",kernelFunc:dce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G4=Ht((t,e)=>t<=e?1:0),pce=un(l0,G4,null,"bool"),mce={kernelName:l0,backendName:"cpu",kernelFunc:pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H4(t,e,n){const r=(e-t)/(n-1),s=_n(n,"float32");s[0]=t;for(let o=1;o<s.length;o++)s[o]=s[o-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K4=po(t=>Math.log(t)),gce=ua(jf,K4),yce={kernelName:jf,backendName:"cpu",kernelFunc:gce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4(t,e,n,r){const s=Rn(r,Y(n));for(let o=0;o<s.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const c=t[i+l];(Number.isNaN(c)||c>a)&&(a=c)}s[o]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X4=Ht((t,e)=>Math.max(t,e)),vce=un(Hf,X4),xce={kernelName:Hf,backendName:"cpu",kernelFunc:vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y4=Ht((t,e)=>Math.min(t,e)),bce=un(Kf,Y4),wce={kernelName:Kf,backendName:"cpu",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J$=Ht((t,e)=>t*e),Cce=Y$((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),ex=un(Xf,J$,Cce),Ice={kernelName:Xf,backendName:"cpu",kernelFunc:ex};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q4(t,e,n){const r=oa(-1,n);return J$([],e,r,t,n)}function Sce(t){const{inputs:e,backend:n}=t,{x:r}=e;me(r,"neg");const s=n.data.get(r.dataId).values,[o,i]=Q4(s,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,o)}const kce={kernelName:x0,backendName:"cpu",kernelFunc:Sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J4=Ht((t,e)=>t!==e?1:0),$ce=un(b0,J4,null,"bool"),Ece={kernelName:b0,backendName:"cpu",kernelFunc:$ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$(t,e,n,r,s){const o=e.length,i=Y(e),a=xe(e),l=xe(s),c=Rn(n,Y(s));for(let u=0;u<i;++u){const h=Eu(u,o,a),d=new Array(h.length);for(let p=0;p<d.length;p++)d[p]=h[r[p]];const f=ro(d,o,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lr(t){const{inputs:e,attrs:n,backend:r}=t,{x:s}=e,{perm:o}=n;me(s,"transpose");const i=s.shape.length,a=new Array(i);for(let h=0;h<a.length;h++)a[h]=s.shape[o[h]];const l=r.data.get(s.dataId).values,c=Z$(l,s.shape,s.dtype,o,a);return{dataId:r.write(c,a,s.dtype),shape:a,dtype:s.dtype}}const Nce={kernelName:vc,backendName:"cpu",kernelFunc:lr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4(t,e,n,r){const[s,o]=cn(t,r),i=kr(e,"int32"),a=_n(Y(s),i),l=Y(o);for(let c=0;c<a.length;++c){const u=c*l;let h=1;for(let d=0;d<l;++d)h*=n[u+d];a[c]=h}return{outVals:a,outShape:s,outDtype:i}}function Tce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;me(s,"prod");const a=s.shape.length,l=Le(o,s.shape),c=Et(l,a);let u=l,h=s;const d=[];c!=null&&(h=lr({inputs:{x:s},backend:n,attrs:{perm:c}}),d.push(h),u=Bt(u.length,a));const f=n.data.get(h.dataId).values,{outVals:p,outShape:m,outDtype:y}=Z4(h.shape,h.dtype,f,u);let g=m;return i&&(g=Gt(m,l)),d.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(g,y,p)}const Rce={kernelName:$0,backendName:"cpu",kernelFunc:Tce};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const o=Eu(s,e.length,xe(e)).join(",");throw new Error(`indices[${o}] = ${r} is not in [0, ${n})`)}})}function Ace(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let o=1;o<r.length;++o)if(r[o-1]>r[o])throw new Error("Ragged splits must be sorted in ascending order")}}function Dce(t,e,n,r){const s=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);Ace(n,r);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let h=1;h<l+1;++h)a[c].push(h*u)}for(let c=0;c<t.length;++c){let u=t[c],h=t[c]+1;for(let d=0;d<n.length;++d){const f=n[d],p=d+e.length-1;if(p>=0){const m=a[p],y=m[m.length-1]-f[u];for(let g=u;g<h;++g)a[p].push(f[g+1]+y)}u=f[u],h=f[h]}h!==u&&(s.push([u,h]),o+=h-u)}return{outSplits:a,valueSlices:s,numValues:o}}function Oce(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=Ft("int32",r);e.push(s),t[n].forEach((o,i)=>s[i]=o)}return e}function ER(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function Pce(t,e,n,r,s,o){const i=ER(e,2)[1],a=ER(o,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let h=0;h<r;++h)s[l*a+h]=t[u*i+h];++l}}function Fce(t,e,n,r,s){const o=e.slice();o[0]=s;const i=Ft(n,Y(o)),a=t.length,l=a===0?0:a/e[0];return Pce(t,e,r,l,i,o),[i,o]}function ez(t,e,n,r,s,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(_ce(o,i,l),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:u,valueSlices:h,numValues:d}=Dce(o,i,t,c),f=Oce(u),p=Fce(n,r,s,h,d);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NR=2147483647;function tz(t,e,n,r,s,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,c=i.length===0,u=[];a||u.push(e[0]),l||u.push(s[0]),c||u.push(i[0]);for(let y=1;y<u.length;++y)if(u[y]!==u[y-1])throw new Error("starts, limits, and deltas must have the same shape");const h=u.length===0?1:u[0],d=Ft("int32",h+1);d[0]=0;for(let y=0;y<h;++y){const g=a?t[0]:t[y],v=l?r[0]:r[y],x=c?o[0]:o[y];if(x===0)throw new Error("Requires delta != 0");let b;if(x>0&&v<g||x<0&&v>g)b=0;else if(b=Math.ceil(Math.abs((v-g)/x)),b>NR)throw new Error(`Requires ((limit - start) / delta) <= ${NR}`);d[y+1]=d[y]+b}const f=d[h],p=Ft(n,f);let m=0;for(let y=0;y<h;++y){const g=d[y+1]-d[y];let v=a?t[0]:t[y];const x=c?o[0]:o[y];for(let b=0;b<g;++b)p[m++]=v,v+=x}return[d,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Hr=Cs;class vy{constructor(e,n,r,s,o,i,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=K3(u),this.raggedRank=q3(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Hr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Hr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Hr.VALUE_ROWIDS:return vy.getMaxWidthValueRowID(n);case Hr.ROW_SPLITS:return vy.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Hr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const o=e[s+1]-e[s];o>r&&(r=o)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==s&&(s=a,o=Math.max(i-r,o),r=i)}return Math.max(n-r,o)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return RR(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;X3(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=H3(this.raggedRank,s,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),o=[];let i=0;for(let a=0;a<s;++a,i+=n)o.push(i);for(let a=s;a<e;++a)o.push(-1);return k(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,r,s){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let c=Math.min(s,l),u=n[a];u===-1&&(c=0);for(let h=0;h<c;++h)i.push(u),u+=r;for(let h=0;h<l-c;++h)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,r,s){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];i.push(c);for(let u=1;u<o;++u){const h=e[u];if(h===l)c>=0&&(++a,a<s?c+=r:c=-1);else{if(a=0,l=h,h>=n.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${n.length}`);c=n[h]}i.push(c)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,r,s){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Hr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,r,s);case Hr.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,r,s);default:throw new Error(`Unsupported partition type: ${Hr[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Hr.FIRST_DIM_SIZE:return e[0];case Hr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Hr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Hr[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const o=RR(r,!1),i=Ft(this.valuesDType,Y(o));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,s[c],r[c]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,r,s){if(r.length===0)return;const o=this.values,i=r;let a=s.slice();a=a.slice(e+1);const l=Y(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;j(()=>{const m=F(u,p);u=Ah(m,a).dataSync()})}let h=0,d=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(d<f){const y=o.subarray(h*l),g=i.subarray(d*l),v=(f-d)*l;TR(g,y,v)}if(p>=c){const y=r.length;m=Math.floor(y/l)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const y=i.slice(f*l);TR(y,u,l),++f}m<0?(h=p+1,d=f):(h=p,d=f,f=d+1)}}}function TR(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function RR(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function nz(t,e,n,r,s,o,i,a,l,c){return new vy(t,e,n,r,s,o,i,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(t,e,n,r){const s=t===e,o=t<e&&n<0,i=e<t&&n>1;if(s||o||i)return _n(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=_n(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sz=po(t=>1/Math.sqrt(t)),Lce=ua(tp,sz),Mce={kernelName:tp,backendName:"cpu",kernelFunc:Lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(t,e,n,r,s,o,i,a,l,c){const u=[r/s,s],h=t.values,d=e.values;if(r===0)return Fe(n,e.dtype);const f=l instanceof vn?l:Fe(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<o;p++){const m=[];let y=0;for(let g=0;g<i;g++){const v=h[p*i+g];m.push(v),y+=v*a[g]}if(y<0||y>=r/s)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let g=0;g<s;g++)c?f.values[y*s+g]+=d[p*s+g]:f.values[y*s+g]=e.rank===0?d[0]:d[p*s+g]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zce=po(t=>1/(1+Math.exp(-t))),oz=tt(ip,t=>1/(1+Math.exp(-t))),Bce={kernelName:ip,backendName:"cpu",kernelFunc:oz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iz(t,e,n,r,s){const o=S$(r,e,n),i=Y(n),a=xe(r);if(o){const h=k$(e,a);return s==="string"?t.slice(h,h+i):t.subarray(h,h+i)}const l=s==="string"?Go(t):t,c=Fe(r,s,l),u=Fe(n,s);for(let h=0;h<u.size;++h){const d=u.indexToLoc(h),f=d.map((p,m)=>p+e[m]);u.set(c.get(...f),...d)}return s==="string"?m4(u.values):u.values}function fl(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r;me(s,"slice");const[a,l]=X0(s,o,i);C$(s,a,l);const c=n.data.get(s.dataId).values,u=iz(c,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,u)}const Uce={kernelName:A0,backendName:"cpu",kernelFunc:fl};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function az(t,e,n,r,s,o,i){const a=e[0],l=o[0],c=new Array(l),u=new Array(a),h=e[1];if(l===0){if(a!==0)throw new Error(n4(a));const y=Ft(n,0),g=Ft(s,0);return[y,[0,h],g,c,u]}let d=!0,f=0;const p=new Array(l).fill(0);for(let y=0;y<a;++y){const g=t[y*h];if(g<0)throw new Error(r4(y,g));if(g>=l)throw new Error(s4(y,g,l));++p[g],d=d&&g>=f,f=g}let m=!0;for(let y=0;y<l;++y){const g=p[y]===0;c[y]=g,m=m&&!g,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(m&&d){const y=t,g=r;for(let v=0;v<a;++v)u[v]=v;return[y,[a,h],g,c,u]}else{const y=p[l-1],g=Ft(n,y*h),v=Ft(s,y),x=new Array(l).fill(0);for(let b=0;b<a;++b){const w=t[b*h],C=x[w],I=(w===0?0:p[w-1])+C;x[w]++;for(let S=0;S<h;++S)g[I*h+S]=t[b*h+S];v[I]=r[b],u[b]=I}for(let b=0;b<l;++b)if(x[b]===0){const C=b===0?0:p[b-1];g[C*h+0]=b;for(let I=1;I<h;++I)g[C*h+I]=0;v[C]=i}return[g,[y,h],v,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(t,e,n,r,s){const o=Y(r),i=e[0],a=s.length,l=[];let c=1,u=-1;for(let y=0;y<a;++y){const g=s[y];if(g===-1){if(u!==-1)throw new Error(o4(u,y));u=y,l.push(1)}else{if(g<0)throw new Error(i4(y,g));c*=g,l.push(g)}}if(u!==-1){if(c<=0)throw new Error(a4());const y=Math.trunc(o/c);if(c*y!==o)throw new Error(l4(r,l));l[u]=y}if(Y(l)!==o)throw new Error(c4(r,l));const d=r.length,f=[];if(d>0){f[d-1]=1;for(let y=d-2;y>=0;--y)f[y]=f[y+1]*r[y+1]}const p=[];if(a>0){p[a-1]=1;for(let y=a-2;y>=0;--y)p[y]=p[y+1]*l[y+1]}const m=Ft(n,i*a);for(let y=0;y<i;++y){let g=0;for(let v=0;v<d;++v)g+=t[y*d+v]*f[v];for(let v=0;v<a;++v)m[y*a+v]=Math.trunc(g/p[v]),g%=p[v]}return[m,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eE(t,e,n,r,s,o=!1,i=0){const a=r.length,l=[e[0],t.length/e[0]],c=l[1],h=a>0?s[a-1]+1:0;if(h<0)throw new Error(NC());const d=e.slice();d[0]=h;const f=d.reduce((x,b)=>x*b,1),p=Ft(n,f);if(a===0)return h>0&&p.fill(i),[p,d];if(h<=0)throw new Error(NC());let m=0,y=1,g=0,v=s[m];for(;;){let x=0;if(y<a){if(x=s[y],v===x){++y;continue}if(v>=x)throw new Error(u4())}if(v<0||v>=h)throw new Error(h4(v,h));v>g&&p.fill(i,g*c,v*c);for(let b=m;b<y;++b){const w=r[b];if(w<0||w>=l[0])throw new Error(d4(b,r[b],l[0]));for(let C=0;C<c;C++)p[v*c+C]+=t[w*c+C]}if(o)for(let b=0;b<c;b++)p[v*c+b]/=y-m;if(m=y,++y,g=v+1,v=x,y>a)break}return g<h&&p.fill(i,g*c,h*c),[p,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vce=po(t=>Math.sqrt(t)),Wce=tt(lp,t=>Math.sqrt(t)),jce={kernelName:lp,backendName:"cpu",kernelFunc:Wce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cz=Ht((t,e)=>{const n=t-e;return n*n}),Gce=un(cp,cz),Hce={kernelName:cp,backendName:"cpu",kernelFunc:Gce};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uz=po((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)}),Kce=ua(Ok,uz),qce={kernelName:Ok,backendName:"cpu",kernelFunc:Kce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(t,e,n,r){const s=Fe(t,e.dtype);for(let o=0;o<s.size;o++){const i=s.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+r[l];s.set(e.get(...a),...i)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xce{constructor(e,n,r,s,o,i){this.separator=Li(e),this.nGramWidths=n,this.leftPad=Li(r),this.rightPad=Li(s),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),c=Math.max(0,l-a),u=Math.max(0,l-(o-(a+1))),h=i-(c+u),d=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let v=0;v<h;++v)f+=e[d+v].length;f+=u*this.rightPad.length;const p=c+u+h-1;f+=p*this.separator.length,r[s+a]=new Uint8Array(f);const m=r[s+a];let y=0;const g=v=>v.forEach(x=>m[y++]=x);for(let v=0;v<c;++v)g(this.leftPad),g(this.separator);for(let v=0;v<h-1;++v)g(e[d+v]),g(this.separator);if(h>0){g(e[d+h-1]);for(let v=0;v<u;++v)g(this.separator),g(this.rightPad)}else{for(let v=0;v<u-1;++v)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<s;++c){let u=n[c]>=l;if(u=u&&n[c]<=r,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${r}]`);l=n[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const o=s-1,i=Ft("int32",s);if(r===0||s===0){const l=new Array(r);for(let c=0;c<=o;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(h=>{u+=this.getNumNGrams(c,h)}),this.preserveShort&&c>0&&u===0&&(u=1),i[l]=i[l-1]+u}const a=new Array(i[o]);for(let l=0;l<o;++l){const c=n[l];let u=i[l];if(this.nGramWidths.forEach(h=>{const d=n[l+1]-n[l],f=this.getNumNGrams(d,h);this.createNGrams(e,c,a,u,f,h),u+=f}),this.preserveShort&&u===i[l]){const h=n[l+1]-n[l];if(h===0)continue;const d=h+2*this.padWidth,f=1;this.createNGrams(e,c,a,u,f,d)}}return[a,i]}}function dz(t,e,n,r,s,o,i,a){return new Xce(n,r,s,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(t,e,n,r){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)r.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&r.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(s,o);(!n||i.length!==0)&&r.push(i),s=o+1}}function fz(t,e,n){const r=t.length,s=[];let o=0,i=0;const a=new Array(r);for(let d=0;d<r;++d){const f=s.length;Yce(t[d],e,n,s);const p=s.length-f;a[d]=p,o+=p,i=Math.max(i,p)}const l=Ft("int32",o*2),c=new Array(o),u=[r,i];let h=0;for(let d=0;d<r;++d)for(let f=0;f<a[d];++f)l[h*2]=d,l[h*2+1]=f,c[h]=s[h],++h;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pz(t,e){const n=Ft("int32",t.length);for(let r=0;r<t.length;++r)n[r]=Fee(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mz=Ht((t,e)=>t-e),Qce=Y$((t,e,n,r)=>({real:t-n,imag:e-r})),tE=un(up,mz,Qce),Jce={kernelName:up,backendName:"cpu",kernelFunc:tE};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=Fe(n,t.dtype);for(let s=0;s<r.values.length;++s){const o=r.indexToLoc(s),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dh=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function yz(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),d=Math.max(n,Math.floor(e-l*u/a+h)),f=Math.min(r,Math.floor(e+(a-l)*u/a+h));yz(t,e,d,f)}const s=t[e];let o=n,i=r;for(zl(t,n,e),dh(t[r],s)>0&&zl(t,n,r);o<i;){for(zl(t,o,i),o++,i--;dh(t[o],s)<0;)o=o+1;for(;dh(t[i],s)>0;)i=i-1}dh(t[n],s)===0?zl(t,n,i):(i=i+1,zl(t,i,r)),i<=e&&(n=i+1),e<=i&&(r=i-1)}}function vz(t,e,n,r,s){const o=e[e.length-1],[i,a]=[t.length/o,o],l=Rn(n,i*r),c=Rn("int32",i*r);for(let h=0;h<i;h++){const d=h*a,f=t.subarray(d,d+a);let p=new Array(f.length);f.forEach((v,x)=>p[x]={value:v,index:x}),r<p.length&&(yz(p,r),p=p.slice(0,r)),s&&p.sort(dh);const m=h*r,y=l.subarray(m,m+r),g=c.subarray(m,m+r);for(let v=0;v<r;v++)y[v]=p[v].value,g[v]=p[v].index}const u=e.slice();return u[u.length-1]=r,[Fe(u,n,l),Fe(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(t,e,n,r){const s=Le(e,n)[0],o=[1,n[0],1];for(let p=0;p<s;p++)o[0]*=n[p];o[1]=n[s];for(let p=s+1;p<n.length;p++)o[2]*=n[p];const i=new Map,a=new Int32Array(n[s]),l=new vn(o,r,t),c=[],u=o[0]===1&&o[2]===1;for(let p=0;p<n[s];p++){let m;if(u)m=t[p].toString();else{const g=[];for(let v=0;v<o[0];v++)for(let x=0;x<o[2];x++)g.push(l.get(v,p,x));m=g.join(",")}const y=i.get(m);if(y!=null)a[p]=y;else{const g=i.size;i.set(m,g),a[p]=g,c.push(p)}}const h=o.slice();h[1]=i.size;const d=new vn(h,r);c.forEach((p,m)=>{for(let y=0;y<o[0];y++)for(let g=0;g<o[2];g++)d.set(l.get(y,p,g),y,m,g)});const f=n.slice();return f[s]=h[1],{outputValues:d.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zce=Object.freeze(Object.defineProperty({__proto__:null,addImpl:T4,bincountImpl:Q$,bincountReduceImpl:R4,castImpl:N4,ceilImpl:_4,concatImpl:A4,equalImpl:D4,expImpl:P4,expm1Impl:L4,floorDivImpl:z4,floorImpl:M4,gatherNdImpl:B4,gatherV2Impl:U4,greaterEqualImpl:W4,greaterImpl:V4,lessEqualImpl:G4,lessImpl:j4,linSpaceImpl:H4,logImpl:K4,maxImpl:q4,maximumImpl:X4,minimumImpl:Y4,multiplyImpl:J$,negImpl:Q4,notEqualImpl:J4,prodImpl:Z4,raggedGatherImpl:ez,raggedRangeImpl:tz,raggedTensorToTensorImpl:nz,rangeImpl:rz,rsqrtImpl:sz,scatterImpl:Oa,sigmoidImpl:zce,simpleAbsImpl:E4,sliceImpl:iz,sparseFillEmptyRowsImpl:az,sparseReshapeImpl:lz,sparseSegmentReductionImpl:eE,sqrtImpl:Vce,squaredDifferenceImpl:cz,staticRegexReplaceImpl:uz,stridedSliceImpl:hz,stringNGramsImpl:dz,stringSplitImpl:fz,stringToHashBucketFastImpl:pz,subImpl:mz,tileImpl:gz,topKImpl:vz,transposeImpl:Z$,uniqueImpl:xz},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:eue,bincountImpl:bz,bincountReduceImpl:tue,castImpl:nue,ceilImpl:rue,concatImpl:sue,equalImpl:oue,expImpl:iue,expm1Impl:aue,floorImpl:lue,gatherNdImpl:cue,gatherV2Impl:uue,greaterImpl:hue,greaterEqualImpl:due,lessImpl:fue,lessEqualImpl:pue,linSpaceImpl:mue,logImpl:gue,maxImpl:yue,maximumImpl:vue,minimumImpl:xue,multiplyImpl:bue,negImpl:wue,notEqualImpl:Cue,prodImpl:Iue,raggedGatherImpl:Sue,raggedRangeImpl:kue,raggedTensorToTensorImpl:$ue,rangeImpl:Eue,rsqrtImpl:Nue,scatterImpl:Tue,sigmoidImpl:Rue,simpleAbsImpl:wz,sliceImpl:_ue,sparseFillEmptyRowsImpl:Aue,sparseReshapeImpl:Due,sparseSegmentReductionImpl:Cz,sqrtImpl:Oue,staticRegexReplaceImpl:Pue,stridedSliceImpl:Fue,stringNGramsImpl:Lue,stringSplitImpl:Mue,stringToHashBucketFastImpl:zue,subImpl:Bue,tileImpl:Uue,topKImpl:Vue,transposeImpl:nE,uniqueImpl:Wue}=Zce;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iz(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function jn(t,e){return e===1?[t]:Iz(t,e)}function jue(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gue{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=On(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=jn("rc",this.rank),r=st(this.rank),s=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let o=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sz{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length);let r="";for(let s=0;s<4;s++){let o="thisRC = rc;";s%2===1&&(o+="thisRC.z += 1;"),s>1&&(o+="thisRC.y += 1;"),r+=`
        ${o}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Hue(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?q$():K$(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Hue(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Pae(["r","c","d"],"inputShape"):El(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kue{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=AR(n,r),o=DR(e,s,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=_R(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return s===mn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===mn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===mn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===mn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===mn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const o=AR(r,s),i=DR(n,o,s);i in this.freeTextures||(this.freeTextures[i]=[]);const a=_R(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=G().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[i],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function que(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function _R(t,e,n,r,s){const o=Xue(e,r);let i;if(s){const[l,c]=Du(t[0],t[1]);i=l*c}else{const[l,c]=Ip(t[0],t[1]);i=l*c}const a=que(n,o);return i*a}function Xue(t,e){switch(t){case mn.PACKED_2X2_FLOAT32:return k4(e);case mn.PACKED_2X2_FLOAT16:return $4(e);case mn.UNPACKED_FLOAT32:return C4(e);case mn.UNPACKED_FLOAT16:return I4(e);case mn.PACKED_4X1_UNSIGNED_BYTE:return S4(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Yue(t){return G().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?mn.PACKED_2X2_FLOAT32:mn.UNPACKED_FLOAT32:t?mn.PACKED_2X2_FLOAT16:mn.UNPACKED_FLOAT16}function AR(t,e){if(t===Pr.UPLOAD)return mn.PACKED_2X2_FLOAT32;if(t===Pr.RENDER||t==null)return Yue(e);if(t===Pr.DOWNLOAD||t===Pr.PIXELS)return mn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function DR(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qs{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const hs="if (isnan(x)) return x;",Que="return x;",OR="return abs(x);",Jue="return (x >= 0.0) ? x : (exp(x) - 1.0);",Zue=hs+`
  return (x < 0.0) ? 0.0 : x;
`,ehe=hs+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ai="return x;",the="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nhe="return x;",rhe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,she=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ohe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ihe="return 1.0 / (1.0 + exp(-1.0 * x));";class bi{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ahe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length);const n=e.length,r=jn("rc",n),s=st(n),o=jue(n,r),i=r.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe=E3,che=1e-7,uhe=1e-4,Im={};function hhe(t){return t in Im||(Im[t]={}),Im[t]}const dhe=G().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),fhe=600;function phe(){return G().global.screen==null?1024:G().global.screen.height*G().global.screen.width*window.devicePixelRatio*fhe/1024/1024}class tx extends XS{nextDataId(){return tx.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!G().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Nb)n=e;else{const r=Os(G().getNumber("WEBGL_VERSION"),e);n=new Nb(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Os(G().getNumber("WEBGL_VERSION"));n=new Nb(r),this.binaryCache=hhe(G().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Kue(this.gpgpu),this.numMBBeforeWarning=phe(),this.texData=new XL(this,Vs())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,o,i){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,o]},l.texShape=[s,o];const c=wm(n),u=new $R(c,!1,i),h=this.runWebGLProgram(u,[a],r,[[s,o]]);return h.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),h.dataId}write(e,n,r){if((G().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||G().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:Pr.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,o){if(G().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:Pr.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let d;l?d=new bi(a,ai):d=new Qs(a,ai);const f=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:s}],s),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const c=this.activeTimers!=null;let u;c&&(u=er());let h;if(s==="complex64"){const d=this.readSync(o.real.dataId),f=this.readSync(o.imag.dataId);h=jo(d,f)}else h=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=er()-u),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:r,shape:s,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let p;l?p=new bi(s,ai):p=new Qs(s,ai);const m=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:i}],i),y=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),y}if(r!=null)return this.convertAndCacheOnCPU(e);if(G().getBool("DEBUG")&&!G().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&G().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(i!=="complex64"&&G().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...vm(s))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],y=p[1];h=jo(m,y)}else if(c==null)h=this.getValuesFromTexture(e);else{const p=Y(s);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;de(p,()=>p.deleteBuffer(c))}const d=this.convertAndCacheOnCPU(e,h),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Vs().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:o,slice:i,dtype:a,isPacked:l,texture:c}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;l?f=new bi(o,ai):f=new Qs(o,ai);const p=this.runWebGLProgram(f,[{dataId:e,shape:o,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),h=Vs().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>Hi(s));return Fe(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Fe(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!lae(r))throw G().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),o=Y(n);if(G().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),f=this.texData.get(d.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...vm(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(d),p}const i=G().getBool("WEBGL_PACK")&&s===!0,a=i?wm(n):n,l=i?new Sle(a):new Ile(a),c=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),u=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=rl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=rl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=fee(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:i[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:er(),endMs:null}}endTimer(e){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=er(),e)}async getQueryTime(e){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,o,i)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=dhe){return G().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&Y(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Ar("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return lhe(e.shape,n)}packedUnaryOp(e,n,r){const s=new bi(e.shape,n),o=this.compileAndRun(s,[e],r);return Vs().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=wz(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,OR,e.dtype);const n=new Qs(e.shape,OR),r=this.compileAndRun(n,[e]);return Vs().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&xf(r[0])){const o=r.map(i=>Li(i));s=this.write(o,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return Vs().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new ahe(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Gue(e.shape),r=!0;return this.runWebGLProgram(n,[e],e.dtype,null,r)}packedReshape(e,n){const r=[Yc(e.shape),...Qc(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},o=[Yc(n),...Qc(n)],i=new Sz(o,r),a=!0,l=[r],c=this.runWebGLProgram(i,[s],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:o,dtype:i}=r;if(n!=null){const d=Y(o),f=n[0]*n[1]*4;k(d<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=wm(o);let l;s?l=new Cle(a):l=new wle(a);const c=!0,u=[n??vm(a)],h=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,u,c,n);return{dtype:i,shape:o,dataId:h.dataId}}runWebGLProgram(e,n,r,s,o=!1,i){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Dd.DENSE){const g=i??vm(e.outputShape);l.texShape=g.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Y(a.shape)===0)return l.values=Rn(a.dtype,0),a;const c=[],u=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(g.dataId);if(v.texture==null){if(!e.packedInputs&&Y(g.shape)<=G().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!v.isPacked!=!!e.packedInputs)g=v.isPacked?this.unpackTensor(g):this.packTensor(g),c.push(g),v=this.texData.get(g.dataId);else if(v.isPacked&&!gy(v.shape,g.shape)){const x=g,b=g.shape;g.shape=v.shape,g=this.packedReshape(g,b),c.push(g),v=this.texData.get(g.dataId),x.shape=b}return{shape:g.shape,texData:v,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:l,isUniform:!1},d=ble(e,u,h),f=this.getAndSaveBinary(d,()=>vle(this.gpgpu,e,u,h)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),G().get("ENGINE_COMPILE_ONLY")||xle(this.gpgpu,f,u,h,s),c.forEach(g=>this.disposeIntermediateTensorInfo(g)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const y=G().get("WEBGL_FLUSH_THRESHOLD");if(y>0){const g=er();g-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!G().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,r,s,o=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(G().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=j(()=>{if(!G().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=G().getBool("DEBUG");G().set("DEBUG",!1);const n=this.abs(Ze(1e-8)).dataSync()[0];if(G().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?che:uhe}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const c=this.activeTimers!=null;let u;c&&(u=er());let h=n.texShape;if(h==null&&(h=$ae(r,l),n.texShape=h),o!=null){const d=wm(r);let f,p=h[1],m=h[0];const y=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!y)&&([p,m]=Du(h[0],h[1])),l?f=new $le(d,y):f=new $R(d,y);const g=y?[m,p]:h,v=this.makeTensorInfo(g,s),x=this.texData.get(v.dataId);y?x.usage=Pr.PIXELS:x.usage=Pr.UPLOAD,x.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),p,m,o);const b=[[m,p]],w=!0,C=this.runWebGLProgram(f,[v],s,b,w),I=this.texData.get(C.dataId);n.texShape=I.texShape,n.isPacked=I.isPacked,n.usage=I.usage,G().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(n.texture=I.texture,n.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(v),c&&(this.uploadWaitMs+=er()-u)}else{const d=this.acquireTexture(h,a,s,l);n.texture=d}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=mhe(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*oy(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(o){throw o}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await G3(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(g4(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=w4(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:o,width:i,channels:a}=e,l=Vs().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(s,n,r,o,i,a);return Vs().makeTensorFromDataId(c,n,r,l)}}tx.nextDataId=0;function mhe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */UM()&&ZM("webgl",()=>new tx,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rE=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Zc{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=_e(n,r),this.enableShapeUniforms=On(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class $p{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=_e(n,r);const o=this.outputShape.length;this.enableShapeUniforms=On(o);let i="";if(s)if(o===0||Y(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${st(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=jn("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const ghe={kernelName:Bf,backendName:"webgl",kernelFunc:$r};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ha(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(o.dataId),a=$r({inputs:{x:r},backend:n}),l=$r({inputs:{x:s},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const yhe={kernelName:ak,backendName:"webgl",kernelFunc:ha};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kz="return (a < 0.) ? b * a : a;",$z=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function vhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r,i=n.makeTensorInfo([],"float32",oa(o,"float32")),a=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $p($z,s.shape,i.shape):new Zc(kz,s.shape,i.shape),l=n.runWebGLProgram(a,[s,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const xhe={kernelName:i0,backendName:"webgl",kernelFunc:vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ez="return (a < 0.) ? b * a : a;",Nz=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function bhe(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $p(Nz,r.shape,s.shape):new Zc(Ez,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],"float32")}const whe={kernelName:k0,backendName:"webgl",kernelFunc:bhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mu="if (isnan(x)) return x;";function Ge({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:o})=>{const{x:i}=s,a=o,l=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const h=a.texData.get(i.dataId),d=n(h.values,l);return a.makeTensorInfo(i.shape,l,d)}const c=G().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new bi(i.shape,e):u=new Qs(i.shape,t),a.runWebGLProgram(u,[i],l)}}function In({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:c}=i,u=a;if(r&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[y,g]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(x=>{const[b,w]=x,C={dataId:b.dataId,dtype:b.dtype,shape:l.shape},I={dataId:w.dataId,dtype:w.dtype,shape:c.shape},S=new Zc(t,l.shape,c.shape);return u.runWebGLProgram(S,[C,I],kr(b.dtype,w.dtype))}),v=ha({inputs:{real:y,imag:g},backend:u});return u.disposeIntermediateTensorInfo(y),u.disposeIntermediateTensorInfo(g),v}const h=o||kr(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&s!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,y=l.dtype==="string"?Go(p):p,g=l.dtype==="string"?Go(m):m,[v,x]=s(l.shape,c.shape,y,g,h),b=u.makeTensorInfo(x,h),w=u.texData.get(b.dataId);return w.values=v,b}const d=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return d?f=new $p(e,l.shape,c.shape,n):f=new Zc(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],h)}}function Od(t,e=!1){if(t==="linear")return e?nhe:Que;if(t==="relu")return e?she:Zue;if(t==="elu")return e?rhe:Jue;if(t==="relu6")return e?ohe:ehe;if(t==="prelu")return e?Nz:Ez;if(t==="leakyrelu")return e?$z:kz;if(t==="sigmoid")return e?ihe:the;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tz{constructor(e,n,r,s=!1,o=!1,i=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=On(this.outputShape.length);const u=s?e[1]:e[2],h=Math.ceil(u/2),d=s?"i * 2, rc.y":"rc.y, i * 2",f=o?"rc.z, i * 2":"i * 2, rc.z",p=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",g="";a&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:y=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const v=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let x="rc.x",b="rc.x";e[0]<n[0]?x=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(b=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${x};
        int batchB = ${b};
        for (int i = 0; i < ${h}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PR={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class FR{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=_e(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LR="return a * b;";function sE(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=kr(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),c=new FR(PR.REAL,r.shape,s.shape),u=new FR(PR.IMAG,r.shape,s.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=ha({inputs:{real:d,imag:f},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[c,u]=bue(r.shape,s.shape,a.values,l.values,o),h=n.makeTensorInfo(u,o),d=n.texData.get(h.dataId);return d.values=c,h}let i;return G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new $p(LR,r.shape,s.shape):i=new Zc(LR,r.shape,s.shape),n.runWebGLProgram(i,[r,s],o)}const Che={kernelName:Xf,backendName:"webgl",kernelFunc:sE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ihe(t,e,n){const r=[Yc(t.shape),...Qc(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},o=[Yc(e),...Qc(e)],i=new Sz(o,r),a=!0,l=[r],c=n.runWebGLProgram(i,[s],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function le(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:o}=r,i=n,a=Y(s.shape),l=QL(o,a),c=Y(l);k(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=i.texData.get(s.dataId);return u.isPacked&&!gy(s.shape,l)&&!(u.texture!==null&&gy(u.shape,l))?Ihe(s,l,i):(i.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const She={kernelName:E0,backendName:"webgl",kernelFunc:le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MR{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];const a=Math.floor(r/4)*4,l=r%4;let c="sumValue += dot(values, ones);";if(n!=null){const h=1/n;c=`sumValue += dot(values * ${Wc(h)?h.toPrecision(2):h}, ones);`}let u="";o%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class khe{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(r/4)*4,h=r%4;let d=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $he(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=Y0(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function Rl(t,e,n,r){const s=$he(t.shape);let o=t;for(let i=0;i<s.length;i++){const{inSize:a,windowSize:l,outSize:c}=s[i];let u,h;n==="mean"?u=i===0?new MR({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new MR({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new khe({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),h=o,o=r.runWebGLProgram(u,[o],e),h.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(h)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ehe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[n[i]];this.outputShape=r,this.rank=r.length;const s=st(this.rank),o=Nhe(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function Nhe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class The{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let u=0;u<r.length;u++)r[u]=e[n[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=st(this.rank),o=Iz("rc",this.rank),i=new Array(this.rank);for(let u=0;u<n.length;u++)i[n[u]]=o[u];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nx(t,e,n){const r=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new The(t.shape,e):new Ehe(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(t,e,n,r){const s=e,o=t.shape.length,i=Le(s,t.shape);let a=i;const l=Et(a,o),c=l!=null;let u=t;c&&(u=nx(t,l,r),a=Bt(a.length,o)),Cn("sum",a,o);const[h,d]=cn(u.shape,a);let f=h;n&&(f=Gt(h,i));const p=Y(d),y=Y(t.shape)/p,g=le({inputs:{x:u},attrs:{shape:[y,p]},backend:r}),v=Uk(t.dtype),x=Rl(g,v,"sum",r),b=le({inputs:{x},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(x),c&&r.disposeIntermediateTensorInfo(u),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rx(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return Rhe(s,o,i,n)}const _he={kernelName:D0,backendName:"webgl",kernelFunc:rx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:o}=r,i=n,a=s.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=s.shape[o[u]];let c;if(i.shouldExecuteOnCPU([s])){const h=i.texData.get(s.dataId).values,d=nE(h,s.shape,s.dtype,o,l);c=i.makeTensorInfo(l,s.dtype);const f=i.texData.get(c.dataId);f.values=d}else c=nx(s,o,i);return c}const Ahe={kernelName:vc,backendName:"webgl",kernelFunc:Qn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rz=1e3;function xy({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,h=n?t.shape[c-2]:t.shape[c-1],d=r?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=r?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),y=e.shape.slice(0,-2),g=Y(m),v=Y(y),b=_e(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);k(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const w=n?[g,h,f]:[g,f,h],C=r?[v,p,d]:[v,d,p],I=le({inputs:{x:t},backend:s,attrs:{shape:w}}),S=le({inputs:{x:e},backend:s,attrs:{shape:C}}),$=[I,S],E=Math.max(g,v),A=n?I.shape[1]:I.shape[2],M=o!=null,B=i!=null,U=l==="leakyrelu",V=l!=null?Od(l,!0):null,H=M||B||U||V!=null;let K;if((f===1||p===1)&&A>Rz&&H===!1){let D=I,z=S;n&&(D=Qn({inputs:{x:I},backend:s,attrs:{perm:[0,2,1]}}),$.push(D)),r&&(z=Qn({inputs:{x:S},backend:s,attrs:{perm:[0,2,1]}}),$.push(z));const Q=p!==1,J=p===1;let ee=D;Q&&(ee=le({inputs:{x:D},backend:s,attrs:{shape:[E,A,1]}}),$.push(ee));const ie=p===1?2:1;let re=z;J&&(re=le({inputs:{x:z},backend:s,attrs:{shape:[E,1,A]}}),$.push(re));const ue=sE({inputs:{a:ee,b:re},backend:s});K=rx({inputs:{x:ue},backend:s,attrs:{axis:ie,keepDims:!0}}),$.push(ue)}else{const D=kr(t.dtype,e.dtype),z=new Tz(w,C,[E,f,p],n,r,M,V,B,U),Q=[I,S];if(o!=null&&Q.push(o),B&&Q.push(i),U){const J=s.makeTensorInfo([],"float32",oa(a,"float32"));Q.push(J),$.push(J)}K=s.runWebGLProgram(z,Q,D)}const R=le({inputs:{x:K},backend:s,attrs:{shape:b}});$.push(K);for(const D of $)s.disposeIntermediateTensorInfo(D);return R}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dhe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=r;return xy({a:s,b:o,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:h,activation:u})}const Ohe={kernelName:iy,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zR="return abs(x);";function Phe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const o=n.texData.get(r.dataId),i=wz(o.values);return n.makeTensorInfo(r.shape,r.dtype,i)}let s;return G().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new bi(r.shape,zR):s=new Qs(r.shape,zR),n.runWebGLProgram(s,[r],r.dtype)}const Fhe={kernelName:Bv,backendName:"webgl",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lhe=hs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Mhe=Ge({opSnippet:Lhe}),zhe={kernelName:bf,backendName:"webgl",kernelFunc:Mhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bhe=hs+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Uhe=Ge({opSnippet:Bhe}),Vhe={kernelName:wf,backendName:"webgl",kernelFunc:Uhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BR="return a + b;",Whe=In({opSnippet:BR,packedOpSnippet:BR,supportsComplex:!0,cpuKernelImpl:eue}),jhe={kernelName:Nu,backendName:"webgl",kernelFunc:Whe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ghe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`float v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hhe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`vec4 v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ym(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return $r({inputs:{x:r[0]},backend:n});if(r.length>G().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),c=Ym({inputs:r.slice(0,l),backend:n}),u=Ym({inputs:r.slice(l),backend:n});return Ym({inputs:[c,u],backend:n})}const s=r.map(l=>l.dtype).reduce((l,c)=>kr(l,c)),o=r.map(l=>l.shape),a=G().getBool("WEBGL_PACK")?new Hhe(r[0].shape,o):new Ghe(r[0].shape,o);return n.runWebGLProgram(a,r,s)}const Khe={kernelName:tk,backendName:"webgl",kernelFunc:Ym};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Le(o,s.shape);let c=l;const u=Et(c,a);let h=s;u!=null&&(h=Qn({inputs:{x:s},backend:n,attrs:{perm:u}}),c=Bt(c.length,a)),Cn("all",c,a);const[d,f]=cn(h.shape,c),p=Y(f),m=le({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),y=Rl(m,m.dtype,"all",n);let g;if(i){const v=Gt(d,l);g=le({inputs:{x:y},backend:n,attrs:{shape:v}})}else g=le({inputs:{x:y},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(h),g}const Xhe={kernelName:nk,backendName:"webgl",kernelFunc:qhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Le(o,s.shape);let c=l;const u=Et(c,a);let h=s;u!=null&&(h=Qn({inputs:{x:s},backend:n,attrs:{perm:u}}),c=Bt(c.length,a)),Cn("any",c,a);const[d,f]=cn(h.shape,c),p=Y(f),m=le({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),y=Rl(m,m.dtype,"any",n);let g;if(i){const v=Gt(d,l);g=le({inputs:{x:y},backend:n,attrs:{shape:v}})}else g=le({inputs:{x:y},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(h),g}const Qhe={kernelName:rk,backendName:"webgl",kernelFunc:Yhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jhe{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:o,outSize:i}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zhe{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,k(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=st(l),u=jn("coords",l);let h,d;if(i===1){d=l+1;const S=st(d);h=`
        ${S} sourceLocR = ${S}(${u.join()}, 0);
        ++${u[l-1]};
        ${S} sourceLocG = ${S}(${u.join()}, 0);
        ++${u[l-2]};
        ${S} sourceLocA = ${S}(${u.join()}, 0);
        --${u[l-1]};
        ${S} sourceLocB = ${S}(${u.join()}, 0);
        --${u[l-2]};`}else d=l,h=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,d),p="."+f[d-1],m=f.map(S=>"int "+S),y=jn("sourceLocR",d-1).concat("inIdx.r"),g=jn("sourceLocG",d-1).concat("inIdx.g"),v=jn("sourceLocB",d-1).concat("inIdx.b"),x=jn("sourceLocA",d-1).concat("inIdx.a"),b=r==="max"?"greaterThan":"lessThan",w=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${x.join()})));`,C=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${x.join()}) : 0.)`,I=s?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${I}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${C};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${C};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _z(t,e,n,r=null){let s=e.shape[0],o=e.shape[1];r!=null&&(s=r.shape[0],o=r.shape[1]);const i=Y0(o),a={windowSize:i,inSize:o,batchSize:s,outSize:Math.ceil(o/i)},l=new Jhe(a,n,r==null),c=[e];r!=null&&c.push(r);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const h=_z(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}function Az(t,e,n,r=null){const s=r!=null?r.shape:e.shape,o=s[s.length-1],i=Y0(o),a=new Zhe(s,i,n,r==null),l=r==null?[e]:[e,r],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=Az(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function Dz(t,e,n,r){const s=[n];if(Cn("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!G().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[c,u]=cn(l.shape,s),h=Y(u),d=le({inputs:{x:l},backend:t,attrs:{shape:[-1,h]}});o.push(d);const f=_z(t,d,r);o.push(f);const p=le({inputs:{x:f},backend:t,attrs:{shape:c}});return o.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return Az(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ede(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Le(o,s.shape);const a=Et(i,s.shape.length);let l=s;const c=[];a!=null&&(l=Qn({inputs:{x:s},backend:n,attrs:{perm:a}}),c.push(l),i=Bt(i.length,l.shape.length)),Cn("argMax",[i[0]],l.shape.length);const u=Dz(n,l,i[0],"max");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const tde={kernelName:Uv,backendName:"webgl",kernelFunc:ede};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nde(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=Le(o,s.shape);const a=Et(i,s.shape.length);let l=s;const c=[];a!=null&&(l=Qn({inputs:{x:s},backend:n,attrs:{perm:a}}),c.push(l),i=Bt(i.length,l.shape.length)),Cn("argMin",[i[0]],l.shape.length);const u=Dz(n,l,i[0],"min");return c.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const rde={kernelName:Vv,backendName:"webgl",kernelFunc:nde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sde=hs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,ode=Ge({opSnippet:sde}),ide={kernelName:Cf,backendName:"webgl",kernelFunc:ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ade=hs+"return log(x + sqrt(x * x + 1.0));",lde=Ge({opSnippet:ade}),cde={kernelName:If,backendName:"webgl",kernelFunc:lde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ude=hs+`
  return atan(x);
`,hde=Ge({opSnippet:ude}),dde={kernelName:Sf,backendName:"webgl",kernelFunc:hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fde=rE+`
  return atan(a, b);
`,pde=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Tl+`
  return result;
`,mde=In({opSnippet:fde,packedOpSnippet:pde}),gde={kernelName:$f,backendName:"webgl",kernelFunc:mde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde=hs+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,vde=Ge({opSnippet:yde}),xde={kernelName:kf,backendName:"webgl",kernelFunc:vde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pd{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(m||(v="-1.0 / 1e-20"),r){const S=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${S} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?o?y:g:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const x="max";let b=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(b="avgValue / max(count, 1.0)");const w=Math.floor(i/4)*4,C=i%4,I=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${x}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${I}
          }

          int xC = xCCorner + ${w};
          if (${C===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${C===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${I}
          } else if (${C===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${I}
          }
        }
        setOutput(${b});
      }
    `}}class oE{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,h=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,y=e.padInfo.front,g=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const x=n==="avg";let b="0.0";if(x||(b="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${y}, ${g}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${E} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let C=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(C="avgValue / max(count, 1.0)");const I=Math.floor(i/4)*4,S=i%4,$=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${y}, ${g}, ${v});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${I}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${$}
            }

            int xC = xCCorner + ${I};
            if (${S===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${S===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${$}
            } else if (${S===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${$}
            }
          }
        }
        setOutput(${C});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bde(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Sp(s,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,c=1;k(Dn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=us(s.shape,o,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Qe(u.inShape,u.outShape))return $r({inputs:{x:s},backend:n});const h=new Pd(u,"avg",!1);return n.runWebGLProgram(h,[s],"float32")}const wde={kernelName:Wv,backendName:"webgl",kernelFunc:bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cde(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],h=Yo(s.shape,o,i,u,a,l,c),d=new oE(h,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const Ide={kernelName:jv,backendName:"webgl",kernelFunc:Cde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sde{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,h=c-1-e.padInfo.left,d=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class kde{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=h-1-e.padInfo.front,m=d-1-e.padInfo.top,y=f-1-e.padInfo.left,g=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${y});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $de(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,h=[1,1,1],d=Yo(i.shape,a,l,h,c,u),f=new kde(d);return n.runWebGLProgram(f,[s],i.dtype)}const Ede={kernelName:ok,backendName:"webgl",kernelFunc:$de};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;Sp([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=r,u=us(i.shape,a,l,1,c),h=new Sde(u);return n.runWebGLProgram(h,[s],i.dtype)}const Tde={kernelName:sk,backendName:"webgl",kernelFunc:Nde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rde(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;return xy({a:s,b:o,transposeA:i,transposeB:a,backend:n})}const _de={kernelName:Gv,backendName:"webgl",kernelFunc:Rde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ade{constructor(e,n,r,s,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],_e(e,n),_e(e,r);let a="0.0";s!=null&&(_e(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(_e(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dde{constructor(e,n,r,s,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],_e(e,n),_e(e,r);let a="vec4(0.0)";s!=null&&(_e(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(_e(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ode=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:o,offset:i,scale:a}=t;k(s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),k(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),k(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[r,s,o];let u=null;i!=null&&(u=i.shape,c.push(i));let h=null;a!=null&&(h=a.shape,c.push(a));const d=G().getBool("WEBGL_PACK_NORMALIZATION")?new Dde(r.shape,s.shape,o.shape,u,h,l):new Ade(r.shape,s.shape,o.shape,u,h,l);return e.runWebGLProgram(d,c,c[0].dtype)},Pde={kernelName:r0,backendName:"webgl",kernelFunc:Ode};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fde{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=st(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=Lde(this.rank);let s;const o=e.map((i,a)=>`sourceLoc.${RC[a]} = start[${a}] + coords.${RC[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const RC=["x","y","z","w","u","v"];function Lde(t){if(t===1)return"sourceLoc";if(t<=6)return RC.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mde{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=st(this.rank),r=jn("coords",this.rank),s=jn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,i=`getChannel(getSource(${s.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${i};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,h)=>`start[${h}]`).join()});`:e.map((u,h)=>`${s[h]} = ${r[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zde(t,e,n,r){const s=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),i=r.texData.get(o.dataId);Object.assign(i,s),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=k$(e,xe(t.shape));s.slice&&(a+=s.slice.flatOffset),i.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),o}function zu(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r,[a,l]=X0(s,o,i);if(C$(s,a,l),Y(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const h=n.texData.get(s.dataId),d=_ue(h.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,d)}const{isPacked:c}=n.texData.get(s.dataId),u=S$(s.shape,a,l);if(c||!u){const h=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Mde(l):new Fde(l),d=[a];return n.runWebGLProgram(h,[s],s.dtype,d)}return n.uploadToGPU(s.dataId),zde(s,a,l,n)}const Bde={kernelName:A0,backendName:"webgl",kernelFunc:zu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;k(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((v,x)=>v*x),l=bp(s.shape,o,a),c=wp(l.length,o.length),u=Cp(s.shape,o,a),h=R$(i,o.length),d=_$(u,i,o.length),f=[],p=le({inputs:{x:s},backend:n,attrs:{shape:l}}),m=Qn({inputs:{x:p},backend:n,attrs:{perm:c}}),y=le({inputs:{x:m},backend:n,attrs:{shape:u}}),g=zu({inputs:{x:y},backend:n,attrs:{begin:h,size:d}});return f.push(p),f.push(m),f.push(y),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),g},Vde={kernelName:Hv,backendName:"webgl",kernelFunc:Ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wde(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=n.readSync(s.dataId),l=n.readSync(o.dataId),c=bz(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}const jde={kernelName:ik,backendName:"webgl",kernelFunc:Wde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gde(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,o=n.readSync(r.dataId),i=n.readSync(s.dataId),a=_e(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Hde={kernelName:rM,backendName:"webgl",kernelFunc:Gde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kde="return float(a != b);",Oz=In({opSnippet:Kde,cpuKernelImpl:Cue,dtype:"bool"}),qde={kernelName:b0,backendName:"webgl",kernelFunc:Oz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ep(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return $r({inputs:{x:s.complexTensorInfos.real},backend:n})}const Xde={kernelName:Rk,backendName:"webgl",kernelFunc:Ep};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yde="return float(int(x));";function Qde(t,e){const n=new Qs(t.shape,Yde),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _C(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return $r({inputs:{x:s},backend:n});const i=sn(s.shape),a=_C({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=ha({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const i=Ep({inputs:{input:s},backend:n}),a=_C({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!JL(s.dtype,o)){const i=$r({inputs:{x:s},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId).values,[a,l,c]=nue(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,c)}if(o==="int32")return Qde(s,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",Rn("bool",1)),l=Oz({inputs:{a:s,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const Jde={kernelName:Ef,backendName:"webgl",kernelFunc:_C};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UR="return ceil(x);",Zde=Ge({opSnippet:UR,packedOpSnippet:UR,cpuKernelImpl:rue}),efe={kernelName:Nf,backendName:"webgl",kernelFunc:Zde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tfe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nfe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:o,clipValueMax:i}=r;let a;G().getBool("WEBGL_PACK_CLIP")?a=new nfe(s.shape):a=new tfe(s.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[s],s.dtype,l)}const sfe={kernelName:Tf,backendName:"webgl",kernelFunc:rfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ofe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VR(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function ife(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),o=new ofe(r.shape),i=[VR(r,s.complexTensorInfos.real),VR(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const afe={kernelName:Kv,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lfe{constructor(e){this.outputShape=[],this.outputShape=oo(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];r.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const s=n.length,o=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cfe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=oo(e,n);const r=this.outputShape,s=r.length,o=st(s),i=jn("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((m,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),h=a.join();let d=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${h}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const y=l[m-1];d+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${Sm(a,c,y)}),
            vec2(${Sm(u,c,y)}));
        }`}const f=l.length,p=l[l.length-1];d+=`
        return getChannel(
          getT${f}(${Sm(a,c,p)}),
          vec2(${Sm(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${d}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[s-1]} = ${i[s-1]} + 1;
        if (${i[s-1]} < ${r[s-1]}) {
          result.g = getValue(${i});
        }

        ${i[s-2]} = ${i[s-2]} + 1;
        if (${i[s-2]} < ${r[s-2]}) {
          result.a = getValue(${i});
        }

        ${i[s-1]} = ${i[s-1]} - 1;
        if (${i[s-2]} < ${r[s-2]} &&
            ${i[s-1]} < ${r[s-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function Sm(t,e,n){const r=t.indexOf(e);return t.map((o,i)=>i===r?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sx(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return $r({inputs:{x:s.complexTensorInfos.imag},backend:n})}const ufe={kernelName:Ck,backendName:"webgl",kernelFunc:sx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fh(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(v=>Ep({inputs:{input:v},backend:n})),p=t.map(v=>sx({inputs:{input:v},backend:n})),m=fh(f,e,n),y=fh(p,e,n),g=ha({inputs:{real:m,imag:y},backend:n});return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const f=t.map(b=>{const C=[-1,Y(b.shape.slice(e))];return le({inputs:{x:b},backend:n,attrs:{shape:C}})}),p=f.map(b=>({vals:n.readSync(b.dataId),shape:b.shape})),m=oo(f.map(b=>b.shape),1),y=f[0].shape[0]===1,g=sue(p,m,r,y),v=oo(t.map(b=>b.shape),e),x=n.makeTensorInfo(v,r,g);return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),x}const o=t.filter(f=>Y(f.shape)>0),i=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const f=i?new Qs(t[0].shape,ai):new bi(t[0].shape,ai);return n.runWebGLProgram(f,t,r)}const a=G().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const f=[];for(let m=0;m<o.length;m+=a){const y=o.slice(m,m+a);f.push(fh(y,e,n))}const p=fh(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(i){const f=new cfe(o.map(p=>p.shape),e);return n.runWebGLProgram(f,o,r)}const{tensors2D:l,outShape:c}=hfe(o,e,n),u=new lfe(l.map(f=>f.shape)),h=n.runWebGLProgram(u,l,r);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const d=le({inputs:{x:h},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(h),d}function hfe(t,e,n){const r=oo(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>le({inputs:{x:o},attrs:{shape:[-1,Y(o.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pz(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=Le(s,e[0].shape)[0],i=e.map(c=>c.shape);E$(i,o);const a=oo(e.map(c=>c.shape),o);if(Y(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>Y(c.shape)>0);return l.length===1?$r({inputs:{x:l[0]},backend:n}):fh(l,o,n)}const dfe={kernelName:qv,backendName:"webgl",kernelFunc:Pz};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fz{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,y=e.dataFormat==="channelsLast",g=y?1:2,v=y?2:3,x=y?3:1;let b="",w="";r&&(s?b=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?b=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:b=`
          float activation(float x) {
            ${r}
          }
        `,w="result = activation(result);");const C=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${x}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${C}
        ${w}
        setOutput(result);
      }
    `}}class ffe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,h=e.filterDepth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lz{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=On(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,h=u;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<u;y++)d+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<u;y++)d+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(h+1)/2;y++){const g=y*2;if(d+=`
           xC = xCCorner + ${g*l};
           `,a===1){if(g<u&&(i%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?d+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<u)){const v=i%2===0?YS(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:d+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):v===1?d+=`
                     xC${g+1} = xTexelC${g};
                     `:d+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<u&&(i%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<u&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<u&&(d+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<u&&(d+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<u&&(d+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f="",p="";r&&(s?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:o?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pfe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=On(this.outputShape.length);const{dataFormat:r}=n,s=Jn(),o=r==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let h=0;h<=1;h++)c+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function by(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function Mz({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,c=r.texData.get(t.dataId),u=n.inChannels,h=l[0]*l[1]*l[2],d=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let y;const g=[];if(o!=null){const b=by(o.shape,f);b!=null&&(o=le({inputs:{x:o},backend:r,attrs:{shape:b}}),g.push(o))}if(s!=null){const b=by(s.shape,f);b!=null&&(s=le({inputs:{x:s},backend:r,attrs:{shape:b}}),g.push(s))}if(!((h===1||d===1)&&u>Rz)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Qe(c.shape.slice(-3),l.slice(-3))){const b=l[0]*l[1]*(l[2]+1),w={dataId:t.dataId,shape:[1,b,n.inChannels],dtype:t.dtype},C=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,k(gy(c.shape,w.shape),()=>`packed reshape ${c.shape} to ${w.shape} isn't free`);const I=le({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(I);const S=xy({a:w,b:I,backend:r,transposeA:p,transposeB:m,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),$=r.texData.get(S.dataId);k($.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=C,$.shape=n.outShape,y=$r({inputs:{x:S},backend:r}),y.shape=n.outShape,g.push(S)}else{const b=n.outHeight*n.outWidth,w=le({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,b,n.inChannels]:[n.batchSize,n.inChannels,b]}}),C=le({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),I=xy({a:f?w:C,b:f?C:w,transposeA:!f,transposeB:m,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i});y=le({inputs:{x:I},backend:r,attrs:{shape:n.outShape}}),g.push(w),g.push(C),g.push(I)}for(const b of g)r.disposeIntermediateTensorInfo(b);return y}function zz({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:h,outHeight:d,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,y=d*h,g=[n.batchSize,m,y],v=!0,x=!1,b=[];if(o!=null){const R=by(o.shape,p);R!=null&&(o=le({inputs:{x:o},backend:r,attrs:{shape:R}}),b.push(o))}if(s!=null){const R=by(s.shape,p);R!=null&&(s=le({inputs:{x:s},backend:r,attrs:{shape:R}}),b.push(s))}const w=le({inputs:{x:e},backend:r,attrs:{shape:[1,m,Y(e.shape)/m]}});b.push(w);const C=new pfe(g,n),I=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],S=r.runWebGLProgram(C,[t],"float32",I),$=le({inputs:{x:S},backend:r,attrs:{shape:g}});b.push(S),b.push($);const E=s!=null,A=o!=null,M=a==="leakyrelu",B=a?Od(a,!0):null,U=new Tz(p?$.shape:w.shape,p?w.shape:$.shape,p?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],v,x,E,B,A,M),V=p?[$,w]:[w,$];if(s&&V.push(s),A&&V.push(o),M){const R=r.makeTensorInfo([],"float32",oa(i,"float32"));V.push(R),b.push(R)}const H=r.runWebGLProgram(U,V,"float32"),K=le({inputs:{x:H},backend:r,attrs:{shape:n.outShape}});b.push(H);for(const R of b)r.disposeIntermediateTensorInfo(R);return K}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r,h=Qo(l),d=wn(s.shape,o.shape,i,c,a,u,!1,h);let f;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))f=Mz({x:s,filter:o,convInfo:d,backend:n});else if(d.strideWidth<=2&&h==="channelsLast"&&G().getBool("WEBGL_EXP_CONV")){const m=new Lz(d),y=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];f=n.runWebGLProgram(m,[s,o],"float32",y)}else if(G().getBool("WEBGL_CONV_IM2COL"))f=zz({x:s,filter:o,convInfo:d,backend:n});else{const m=new Fz(d);f=n.runWebGLProgram(m,[s,o],"float32")}const p=le({inputs:{x:f},backend:n,attrs:{shape:d.outShape}});return n.disposeIntermediateTensorInfo(f),p}const gfe={kernelName:Xv,backendName:"webgl",kernelFunc:mfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yfe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class vfe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,c=i?1:2,u=i?2:3,h=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class xfe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class bfe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=r-1-e.padInfo.top,u=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,h=Qo(l),d=wn(s.shape,u,i,1,a,c,!1,h),f=new yfe(d);return n.runWebGLProgram(f,[s,o],"float32")}const Cfe={kernelName:lk,backendName:"webgl",kernelFunc:wfe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ife{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=On(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,o=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r,h=Qo(c),d=wn(i,o.shape,a,1,l,u,!1,h);if(G().getBool("WEBGL_PACK")&&h==="channelsLast"){const f=[[d.strideHeight,d.strideWidth]],p=new Ife(d);return n.runWebGLProgram(p,[s,o],"float32",f)}else{const f=new vfe(d);return n.runWebGLProgram(f,[s,o],"float32")}}const kfe={kernelName:Yv,backendName:"webgl",kernelFunc:Sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $fe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,c=ia(s.shape,o.shape,i,l,a),u=new ffe(c);return n.runWebGLProgram(u,[s,o],"float32")}const Efe={kernelName:Qv,backendName:"webgl",kernelFunc:$fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r,c=ia(s.shape,l,i,1,a),u=new xfe(c);return n.runWebGLProgram(u,[s,o],"float32")}const Tfe={kernelName:ck,backendName:"webgl",kernelFunc:Nfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:i,strides:a,inputShape:l}=r,c=ia(l,o.shape,a,1,i),u=new bfe(c);return n.runWebGLProgram(u,[s,o],"float32")}const _fe={kernelName:uk,backendName:"webgl",kernelFunc:Rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Afe=Mu+`
  return cos(x);
`,Dfe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Tl}
  return result;
`,Ofe=Ge({opSnippet:Afe,packedOpSnippet:Dfe}),Pfe={kernelName:Rf,backendName:"webgl",kernelFunc:Ofe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ffe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Lfe=Ge({opSnippet:Ffe}),Mfe={kernelName:_f,backendName:"webgl",kernelFunc:Lfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zfe{constructor(e,n,r,s,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,c]=e,[u]=n,[h,d]=r;this.outputShape=[u,h,d,c];const f=s==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[y,g,v]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[x,b,w]=d>1?[`${(l-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${x});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${b};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bfe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=r,u=new zfe(s.shape,o.shape,a,l,c);return n.runWebGLProgram(u,[s,o,i],"float32")},Ufe={kernelName:dk,backendName:"webgl",kernelFunc:Bfe};var Fd;(function(t){t.Prod="*",t.Sum="+"})(Fd||(Fd={}));class WR{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===Fd.Prod?"1.0":"0.0",a=r?i:`getX(${jR(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";r?(c=s?`end != ${l-1}`:"end != 0",u=s?"end + 1":"end - 1"):(c=s?`end + pow2 < ${l}`:"end >= pow2",u=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${st(o)} coords = getOutputCoords();
        int end = ${GR(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${GR(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${jR(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function jR(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function GR(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(t,e,n,r,s,o){const i=e.shape.length,a=Et([r],i);let l=e;a!=null&&(l=Qn({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=Bt(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const u=l.shape[c];let h=$r({inputs:{x:l},backend:n});for(let d=0;d<=Math.ceil(Math.log2(u))-1;d++){const f=new WR(t,l.shape,!1,o),p=[[d]],m=h;h=n.runWebGLProgram(f,[h],h.dtype,p),n.disposeIntermediateTensorInfo(m)}if(s){const d=new WR(t,l.shape,s,o),f=h;h=n.runWebGLProgram(d,[h],h.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const d=aa(a),f=Qn({inputs:{x:h},backend:n,attrs:{perm:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(l),f}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return Bz(Fd.Prod,s,n,o,i,a)}const Wfe={kernelName:hk,backendName:"webgl",kernelFunc:Vfe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return Bz(Fd.Sum,s,n,o,i,a)}const Gfe={kernelName:Jv,backendName:"webgl",kernelFunc:jfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),c=n.readSync(o.dataId),u=bz(l,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}else if(s.shape.length===2){const l=n.bufferSync(s),c=n.bufferSync(o),u=tue(l,c,i,a);return n.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Kfe={kernelName:fk,backendName:"webgl",kernelFunc:Hfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qfe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r,a=s.shape[0],l=i==="NHWC"?s.shape[1]:s.shape[2],c=i==="NHWC"?s.shape[2]:s.shape[3],u=i==="NHWC"?s.shape[3]:s.shape[1],h=l*o,d=c*o,f=u/(o*o),p=i==="NHWC"?[a,h,d,f]:[a,f,h,d],m=new qfe(p,o,i);return n.runWebGLProgram(m,[s],s.dtype)}const Yfe={kernelName:pk,backendName:"webgl",kernelFunc:Xfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uz{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=On(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";r&&(s?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");const h=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vz{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=On(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,d=h;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<h;g++)f+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let g=0;g<h;g++)f+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(d+1)/2;g++){const v=g*2;if(f+=`
          xC = xCCorner + ${v*c};
          `,l===1){if(v<h&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,c===1&&v>0?f+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<h)){const x=a%2===0?YS(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${x};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:f+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):x===1?f+=`
                    xC${v+1} = xTexelC${v};
                    `:f+=`
                    xCOffset = xC + ${x};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<h&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<h&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<h&&(f+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<h&&(f+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<h&&(f+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";r&&(s?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=r;let u=l;u==null&&(u=[1,1]),k(Dn(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=wn(s.shape,o.shape,i,u,a,c,!0);let d;G().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new Vz(h):d=new Uz(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(d,[s,o],"float32",f)}const Jfe={kernelName:Zv,backendName:"webgl",kernelFunc:Qfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zfe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class epe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r,h=wn(s.shape,u,i,a,l,c,!0),d=new Zfe(h);return n.runWebGLProgram(d,[s,o],"float32")}const npe={kernelName:mk,backendName:"webgl",kernelFunc:tpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rpe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r,h=wn(u,o.shape,i,a,l,c,!0),d=new epe(h);return n.runWebGLProgram(d,[s,o],"float32")}const spe={kernelName:gk,backendName:"webgl",kernelFunc:rpe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ope{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ipe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],o=Y(r.shape),i=le({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new ope(o),l=n.runWebGLProgram(a,[i],i.dtype),c=le({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}const ape={kernelName:sM,backendName:"webgl",kernelFunc:ipe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lpe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:h,left:d}=s;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,c=mp(s.shape,o.shape,i,a,"NHWC",l);let u;const h=new lpe(c);u=n.runWebGLProgram(h,[s,o],"float32");const d=le({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),d}const upe={kernelName:e0,backendName:"webgl",kernelFunc:cpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hpe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=z$(s,o.length);U$(i.length,l,o);const{path:c,steps:u}=V$(a,l),h=u.length;let d=null,f=i.length;const p=[];for(let m=0;m<h;++m){for(const y of u[m]){const{permutationIndices:g,expandDims:v}=B$(f,l[y]);let x;W$(g)?x=o[y]:(x=Qn({inputs:{x:o[y]},backend:n,attrs:{perm:g}}),p.push(x));const b=x.shape.slice();for(let w=0;w<v.length;++w)b.splice(v[w],0,1);Qe(x.shape,b)||(x=le({inputs:{x},backend:n,attrs:{shape:b}}),p.push(x)),d===null?d=x:(d=sE({inputs:{a:x,b:d},backend:n}),p.push(d))}m<h-1&&(c[m]>=0&&(d=rx({inputs:{x:d},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(d)),f--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}const dpe={kernelName:oM,backendName:"webgl",kernelFunc:hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fpe="return (x >= 0.0) ? x : (exp(x) - 1.0);",ppe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,mpe=Ge({opSnippet:fpe,packedOpSnippet:ppe}),gpe={kernelName:Df,backendName:"webgl",kernelFunc:mpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ype="return (b >= 0.0) ? a : a * (b + 1.0);",vpe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,xpe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new $p(vpe,r.shape,s.shape):new Zc(ype,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],r.dtype)},bpe={kernelName:yk,backendName:"webgl",kernelFunc:xpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wpe=`
  return vec4(equal(a, b));
`,Cpe="return float(a == b);",Ipe=In({opSnippet:Cpe,packedOpSnippet:wpe,dtype:"bool",cpuKernelImpl:oue}),Spe={kernelName:t0,backendName:"webgl",kernelFunc:Ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kpe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${A$};
  float a1 = ${D$};
  float a2 = ${O$};
  float a3 = ${P$};
  float a4 = ${F$};
  float a5 = ${L$};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,$pe=Ge({opSnippet:kpe}),Epe={kernelName:Of,backendName:"webgl",kernelFunc:$pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Npe=Mu+`
  return exp(x);
`,Tpe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Wz=Ge({opSnippet:Npe,packedOpSnippet:Tpe,cpuKernelImpl:iue,dtype:"float32"}),Rpe={kernelName:Pf,backendName:"webgl",kernelFunc:Wz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AC(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=s;return s<0&&(k(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),le({inputs:{x:o},backend:r,attrs:{shape:a}})}const _pe={kernelName:n0,backendName:"webgl",kernelFunc:AC};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HR="return exp(x) - 1.0;",Ape=Ge({opSnippet:HR,packedOpSnippet:HR,cpuKernelImpl:aue}),Dpe={kernelName:Ff,backendName:"webgl",kernelFunc:Ape};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KR{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jz(t,e,n){const r=n.texData.get(t.dataId),s=Y(t.shape),o=t.shape[t.shape.length-1],i=s/o,a=le({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,c=new KR("real",l,e),u=new KR("imag",l,e),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],d=n.runWebGLProgram(c,h,"float32"),f=n.runWebGLProgram(u,h,"float32"),p=ha({inputs:{real:d,imag:f},backend:n});n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f);const m=le({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ope(t){const{inputs:e,backend:n}=t,{input:r}=e;return jz(r,!1,n)}const Ppe={kernelName:vk,backendName:"webgl",kernelFunc:Ope};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fpe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Np(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:o}=n;if(o=o||$u(s),o==="string"){const i=Ft(o,Y(r));return i.fill(s),e.makeTensorInfo(r,o,i)}else{const i=new Fpe(r,s),a=[[s]];return e.runWebGLProgram(i,[],o,a)}}const Lpe={kernelName:xk,backendName:"webgl",kernelFunc:Np};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mpe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zpe={kernelName:bk,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new Mpe(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qR="return floor(x);",Bpe=Ge({opSnippet:qR,packedOpSnippet:qR,cpuKernelImpl:lue}),Upe={kernelName:Lf,backendName:"webgl",kernelFunc:Bpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vpe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Wpe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,jpe=In({opSnippet:Vpe,packedOpSnippet:Wpe,dtype:"int32"}),Gpe={kernelName:Mf,backendName:"webgl",kernelFunc:jpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hpe{constructor(e){this.variableNames=["A"];const n=Jn(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kpe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Jn(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qpe={kernelName:Eee,backendName:"webgl",kernelFunc:Xpe};let Pl,Tb=G().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Xpe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:o}=r,i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,c]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],u=[c,l],h=[c,l,o];if(a||i){const m=G().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Pl==null||m!==Tb)&&(Tb=m,Pl=document.createElement("canvas").getContext("2d",{willReadFrequently:Tb})),Pl.canvas.width=l,Pl.canvas.height=c,Pl.drawImage(s,0,0,l,c),s=Pl.canvas}const d=n.makeTensorInfo(u,"int32");n.texData.get(d.dataId).usage=Pr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),s);const f=G().getBool("WEBGL_PACK")?new Kpe(h):new Hpe(h),p=n.runWebGLProgram(f,[d],"int32");return n.disposeData(d.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ype(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r,m=Qo(u),y=wn(s.shape,o.shape,l,h,c,d,!1,m);let g;const v=[],x=i!=null,b=a!=null,w=f==="leakyrelu",C=()=>{const S=[s,o],$=(E,A)=>{if(A==="NCHW"&&E.shape.length===1&&E.shape[0]!==1){const M=le({inputs:{x:E},backend:n,attrs:{shape:[E.shape[0],1,1]}});return v.push(M),M}return E};if(x&&S.push($(i,u)),b&&S.push($(a,u)),w){const E=n.makeTensorInfo([],"float32",oa(p,"float32"));S.push(E),v.push(E)}return S};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))g=Mz({x:s,filter:o,convInfo:y,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(y.strideWidth<=2&&m==="channelsLast"&&G().getBool("WEBGL_EXP_CONV")){const S=f?Od(f,!0):null,$=new Lz(y,x,S,b,w),E=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],A=C();g=n.runWebGLProgram($,A,"float32",E)}else if(G().getBool("WEBGL_CONV_IM2COL"))g=zz({x:s,filter:o,convInfo:y,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const S=f?Od(f,!1):null,$=new Fz(y,x,S,b,w),E=C();g=n.runWebGLProgram($,E,"float32")}const I=le({inputs:{x:g},backend:n,attrs:{shape:y.outShape}});return v.push(g),v.forEach(S=>n.disposeIntermediateTensorInfo(S)),I}const Qpe={kernelName:ay,backendName:"webgl",kernelFunc:Ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:h,activation:d,leakyreluAlpha:f}=r,p=[];let m=u;m==null&&(m=[1,1]),k(Dn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const y=wn(s.shape,o.shape,l,m,c,h,!0),g=G().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,v=d?Od(d,g):null,x=[s,o],b=i!=null,w=a!=null,C=d==="leakyrelu";if(b&&x.push(i),w&&x.push(a),C){const E=n.makeTensorInfo([],"float32",oa(f,"float32"));x.push(E),p.push(E)}let I;g?I=new Vz(y,b,v,w,C):I=new Uz(y,b,v,w,C);const S=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],$=n.runWebGLProgram(I,x,"float32",S);return p.forEach(E=>n.disposeIntermediateTensorInfo(E)),$}const Zpe={kernelName:SM,backendName:"webgl",kernelFunc:Jpe};class eme{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const o=st(r.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tme(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=s.shape,i=o[o.length-1],a=Y(r.shape),[l,c,u,h]=w$(r,s),d=le({inputs:{x:s},backend:n,attrs:{shape:[c,i]}}),f=le({inputs:{x:r},backend:n,attrs:{shape:[Y(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const g=n.readSync(s.dataId),v=n.bufferSync(r),x=cue(g,v,r.dtype,c,i,u,h,r.shape,a);return n.makeTensorInfo(l,r.dtype,x.values)}const p=new eme(i,h,[c,u],r.shape),m=n.runWebGLProgram(p,[f,d],f.dtype),y=le({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),y}const nme={kernelName:iM,backendName:"webgl",kernelFunc:tme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rme{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=st(this.rank),s=sme(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function sme(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gz(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r,l=Le(i,s.shape)[0];if(G().get("DEBUG")){const v=n.readSync(o.dataId),x=s.shape[l];for(let b=0;b<v.length;++b){const w=v[b];k(w<=x-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${x-1}]`)}}const c=G$(s,o,l,a),u=Y(o.shape),h=[],d=le({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=le({inputs:{x:o},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});h.push(d),h.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const v=n.bufferSync(f),x=n.bufferSync(d),b=uue(x,v,p);return h.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(c.outputShape,b.dtype,b.values)}const m=new rme(d.shape,p),y=n.runWebGLProgram(m,[d,f],d.dtype);h.push(y);const g=le({inputs:{x:y},backend:n,attrs:{shape:c.outputShape}});return h.forEach(v=>n.disposeIntermediateTensorInfo(v)),g}const ome={kernelName:s0,backendName:"webgl",kernelFunc:Gz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ime="return float(a > b);",ame=`
  return vec4(greaterThan(a, b));
`,lme=In({opSnippet:ime,packedOpSnippet:ame,cpuKernelImpl:hue,dtype:"bool"}),cme={kernelName:o0,backendName:"webgl",kernelFunc:lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ume="return float(a >= b);",hme=`
  return vec4(greaterThanEqual(a, b));
`,dme=In({opSnippet:ume,packedOpSnippet:hme,dtype:"bool",cpuKernelImpl:due}),fme={kernelName:zf,backendName:"webgl",kernelFunc:dme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pme(t){const{inputs:e,backend:n}=t,{input:r}=e;return jz(r,!0,n)}const mme={kernelName:wk,backendName:"webgl",kernelFunc:pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gme="return float(!isnan(x) && !isinf(x));",yme=Ge({opSnippet:gme,dtype:"bool"}),vme={kernelName:Uf,backendName:"webgl",kernelFunc:yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xme="return float(isinf(x));",bme=Ge({opSnippet:xme,dtype:"bool"}),wme={kernelName:Vf,backendName:"webgl",kernelFunc:bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cme="return float(isnan(x));",Ime=Ge({opSnippet:Cme,dtype:"bool"}),Sme={kernelName:Wf,backendName:"webgl",kernelFunc:Ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kme="return float(a < b);",$me=`
  return vec4(lessThan(a, b));
`,Eme=In({opSnippet:kme,packedOpSnippet:$me,cpuKernelImpl:fue,dtype:"bool"}),Nme={kernelName:a0,backendName:"webgl",kernelFunc:Eme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tme="return float(a <= b);",Rme=`
  return vec4(lessThanEqual(a, b));
`,_me=In({opSnippet:Tme,packedOpSnippet:Rme,cpuKernelImpl:pue,dtype:"bool"}),Ame={kernelName:l0,backendName:"webgl",kernelFunc:_me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dme(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=mue(r,s,o);return e.makeTensorInfo([i.length],"float32",i)}const Ome={kernelName:aM,backendName:"webgl",kernelFunc:Dme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pme=Mu+`
  return x < 0.0 ? 0./0. : log(x);
`,Fme=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Lme=Ge({opSnippet:Pme,packedOpSnippet:Fme,cpuKernelImpl:gue}),Mme={kernelName:jf,backendName:"webgl",kernelFunc:Lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zme=Mu+`
  return log(1.0 + x);
`,Bme=Ge({opSnippet:zme}),Ume={kernelName:Gf,backendName:"webgl",kernelFunc:Bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vme="return float(a >= 1.0 && b >= 1.0);",Wme=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,jme=In({opSnippet:Vme,packedOpSnippet:Wme,dtype:"bool"}),Gme={kernelName:c0,backendName:"webgl",kernelFunc:jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hme="return float(!(x >= 1.0));",Kme=Ge({opSnippet:Hme}),qme={kernelName:u0,backendName:"webgl",kernelFunc:Kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xme="return float(a >= 1.0 || b >= 1.0);",Yme=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Qme=In({opSnippet:Xme,packedOpSnippet:Yme,dtype:"bool"}),Jme={kernelName:h0,backendName:"webgl",kernelFunc:Qme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zme{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ege{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tge=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r,c=G().getBool("WEBGL_PACK_NORMALIZATION")?new ege(s.shape,o,i,a,l):new Zme(s.shape,o,i,a,l);return n.runWebGLProgram(c,[s],s.dtype)},nge={kernelName:d0,backendName:"webgl",kernelFunc:tge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rge{constructor(e,n,r,s,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sge=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=r,h=new rge(s.shape,a,l,c,u);return n.runWebGLProgram(h,[s,o,i],s.dtype)},oge={kernelName:Ik,backendName:"webgl",kernelFunc:sge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ige(t,e,n,r){const s=Y(e),i=Y(t.shape)/s,a=le({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=Rl(a,t.dtype,"max",r),c=le({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r,a=s.shape.length,l=Le(o,s.shape);let c=l;const u=Et(c,a),h=u!=null,d=n.shouldExecuteOnCPU([s]);let f=s;if(h){if(d){const x=n.texData.get(f.dataId).values,b=new Array(a);for(let I=0;I<b.length;I++)b[I]=s.shape[u[I]];const w=nE(x,s.shape,s.dtype,u,b);f=n.makeTensorInfo(b,s.dtype);const C=n.texData.get(f.dataId);C.values=w}else f=nx(s,u,n);c=Bt(c.length,a)}Cn("max",c,a);const[p,m]=cn(f.shape,c);let y=p;i&&(y=Gt(p,l));let g;if(d){const x=n.texData.get(f.dataId).values,b=yue(x,Y(m),y,s.dtype);g=n.makeTensorInfo(y,s.dtype);const w=n.texData.get(g.dataId);w.values=b}else g=ige(f,m,y,n);return h&&n.disposeIntermediateTensorInfo(f),g}const age={kernelName:f0,backendName:"webgl",kernelFunc:Hz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lge=rE+`
  return max(a, b);
`,cge=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Tl+`
  return result;
`,uge=In({opSnippet:lge,packedOpSnippet:cge,cpuKernelImpl:vue}),hge={kernelName:Hf,backendName:"webgl",kernelFunc:uge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Sp(s,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,c=1;k(Dn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=us(s.shape,o,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&Qe(u.inShape,u.outShape))return $r({inputs:{x:s},backend:n});const h=new Pd(u,"max",!1);return n.runWebGLProgram(h,[s],s.dtype)}const fge={kernelName:p0,backendName:"webgl",kernelFunc:dge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],h=Yo(s.shape,o,i,u,a,c,l),d=new oE(h,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const mge={kernelName:m0,backendName:"webgl",kernelFunc:pge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gge{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,c=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class yge{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=l-1-e.padInfo.front,d=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vge(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=r,h=[1,1,1],d=Yo(i.shape,a,l,h,c,u),f=new oE(d,"max",!0),p=n.runWebGLProgram(f,[i],i.dtype),m=new yge(d),y=n.runWebGLProgram(m,[s,p],i.dtype);return n.disposeIntermediateTensorInfo(p),y}const xge={kernelName:kk,backendName:"webgl",kernelFunc:vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bge(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;Sp([o,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=r,d=us(a.shape,l,c,1,u,h),f=!0,p=new Pd(d,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),y=new gge(d),g=n.runWebGLProgram(y,[s,m],a.dtype);return n.disposeIntermediateTensorInfo(m),g}const wge={kernelName:Sk,backendName:"webgl",kernelFunc:bge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cge(t,e,n,r){let s=new Pd(n,"max",!1);const o=r.runWebGLProgram(s,[t],"float32");s=new Pd(n,"max",!0,!0,e);const i=r.runWebGLProgram(s,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ige={kernelName:lM,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;k(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];k(Dn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=us(r.shape,s,o,c,i),[h,d]=Cge(r,a,u,l);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(t,e,n,r){const s=Y(e),i=Y(t.shape)/s,a=le({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=Rl(a,"float32","mean",r),c=le({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kge={kernelName:g0,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:o}=e,i=n,a=r.shape.length,l=Le(o,r.shape);let c=l;const u=Et(c,a),h=u!=null,d=i.shouldExecuteOnCPU([r]),f=[];let p=r;if(h){if(d){const b=i.texData.get(p.dataId).values,w=new Array(a);for(let S=0;S<w.length;S++)w[S]=r.shape[u[S]];const C=nE(b,r.shape,r.dtype,u,w);p=i.makeTensorInfo(w,r.dtype);const I=i.texData.get(p.dataId);I.values=C}else p=nx(r,u,i);f.push(p),c=Bt(c.length,a)}Cn("sum",c,a);const[m,y]=cn(p.shape,c);let g=m;s&&(g=Gt(m,l));const v=Sge(p,y,g,i);for(const x of f)i.disposeIntermediateTensorInfo(x);return v}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=Le(o,s.shape);let c=l;const u=Et(c,a);let h=s;u!=null&&(h=Qn({inputs:{x:s},backend:n,attrs:{perm:u}}),c=Bt(c.length,s.shape.length)),Cn("min",c,a);const[d,f]=cn(h.shape,c),p=Y(f),m=le({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}}),y=Rl(m,m.dtype,"min",n);let g;if(i){const v=Gt(d,l);g=le({inputs:{x:y},backend:n,attrs:{shape:v}})}else g=le({inputs:{x:y},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u!=null&&n.disposeIntermediateTensorInfo(h),g}const Ege={kernelName:y0,backendName:"webgl",kernelFunc:$ge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nge=rE+`
  return min(a, b);
`,Tge=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Tl+`
  return result;
`,Rge=In({opSnippet:Nge,packedOpSnippet:Tge,cpuKernelImpl:xue}),_ge={kernelName:Kf,backendName:"webgl",kernelFunc:Rge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Age{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((u,h)=>u[0]+e[h]+u[1]);const s=e.length,o=st(s),i=n.map(u=>u[0]).join(","),a=n.map((u,h)=>u[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),c=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dge{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const s=e.length,o=st(s),i=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=jn("rc",s),c=jn("source",s),u=`${l[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${c.slice(-2).join()})`,d=r==="reflect"?0:1;let f="";if(s===1){const p=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[s-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
      `}else{const p=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${l[s-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${h});
          ${l[s-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:o}=n,i=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Dge(r.shape,s,o):new Age(r.shape,s,o);return e.runWebGLProgram(i,[r],r.dtype)},Pge={kernelName:v0,backendName:"webgl",kernelFunc:Oge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fge=`if (b == 0.0) return NAN;
  return mod(a, b);`,Lge=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Tl+`
  return result;
`,Mge=In({opSnippet:Fge,packedOpSnippet:Lge}),zge={kernelName:qf,backendName:"webgl",kernelFunc:Mge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bge{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uge=`
if (a == b) {
  return 1.0;
};
return a / b;`,Vge=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,Kz=In({opSnippet:Uge,packedOpSnippet:Vge,checkOutOfBounds:!0}),Wge={kernelName:Af,backendName:"webgl",kernelFunc:Kz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XR="return a - b;",qz=In({opSnippet:XR,packedOpSnippet:XR,supportsComplex:!0,cpuKernelImpl:Bue}),jge={kernelName:up,backendName:"webgl",kernelFunc:qz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=Le([o],s.shape),a=Hz({inputs:{x:s},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=Gt(a.shape,i),c=le({inputs:{x:a},backend:n,attrs:{shape:l}}),u=qz({inputs:{a:s,b:c},backend:n}),h=Wz({inputs:{x:u},backend:n}),d=rx({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:!1}}),f=le({inputs:{x:d},backend:n,attrs:{shape:l}}),p=Kz({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),p}const Gge={kernelName:F0,backendName:"webgl",kernelFunc:Xz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hge(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r,l=a?s:Xz({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),c=l.shape[0],u=l.shape[1],h=new Bge(c,u,o),d=[[i]],f=n.runWebGLProgram(h,[l],"int32",d);return a||n.disposeIntermediateTensorInfo(l),f}const Kge={kernelName:cM,backendName:"webgl",kernelFunc:Hge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qge=hs+`
  return -x;
`,Xge=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Yge(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId),[i,a]=wue(o.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}let s;return G().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new bi(r.shape,Xge):s=new Qs(r.shape,qge),n.runWebGLProgram(s,[r],r.dtype)}const Qge={kernelName:x0,backendName:"webgl",kernelFunc:Yge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jge=m$;function Zge(t){Ar("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,c=n.readSync(s.dataId),u=n.readSync(o.dataId),{selectedIndices:h}=Jge(c,u,i,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const eye={kernelName:$k,backendName:"webgl",kernelFunc:Zge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tye=g$;function nye(t){Ar("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(s.dataId),h=n.readSync(o.dataId),{selectedIndices:d,validOutputs:f}=tye(u,h,i,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const rye={kernelName:Ek,backendName:"webgl",kernelFunc:nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sye=y$;function oye(t){Ar("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(s.dataId),h=n.readSync(o.dataId),d=i,f=a,p=l,m=c,{selectedIndices:y,selectedScores:g}=sye(u,h,d,f,p,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const iye={kernelName:Nk,backendName:"webgl",kernelFunc:oye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aye{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lye=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r,c=Y(s.shape),u=new aye(c,i,a,l),h=le({inputs:{x:s},backend:n,attrs:{shape:[c]}}),d=n.runWebGLProgram(u,[h],o);n.disposeIntermediateTensorInfo(h);const f=[...s.shape,i],p=le({inputs:{x:d},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(d),p},cye={kernelName:C0,backendName:"webgl",kernelFunc:lye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wy(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=Ep({inputs:{input:r},backend:n}),o=wy({inputs:{x:s},backend:n}),i=sx({inputs:{input:r},backend:n}),a=wy({inputs:{x:i},backend:n}),l=ha({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return Np({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const uye={kernelName:z0,backendName:"webgl",kernelFunc:wy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yz(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=Ep({inputs:{input:r},backend:n}),o=Yz({inputs:{x:s},backend:n}),i=sx({inputs:{input:r},backend:n}),a=wy({inputs:{x:i},backend:n}),l=ha({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return Np({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const hye={kernelName:w0,backendName:"webgl",kernelFunc:Yz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dye(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return AC({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(u=>{QS(o,u.shape,"All tensors passed to stack must have matching shapes"),k(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=AC({inputs:{input:u},backend:n,attrs:{dim:s}});return a.push(h),h}),c=Pz({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const fye={kernelName:I0,backendName:"webgl",kernelFunc:dye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pye{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const s=e.length,o=st(s),i=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mye{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,y)=>m[0]+e[y]+m[1]);const s=e.length,o=st(s),i=n.map(m=>m[0]).join(","),a=n.map((m,y)=>m[0]+e[y]).join(","),l=jn("rc",s),c=jn("source",s),u=`${l[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${o} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${u}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${u}) {`],f=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,y=s===1?2:4;m<y;m++)p+=`
        ${d[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${h});
        }
      `;p+=s===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qz=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;if(Y(s.shape)===0){const c=o.map((u,h)=>u[0]+s.shape[h]+u[1]);return Np({backend:n,attrs:{shape:c,value:i,dtype:s.dtype}})}const a=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mye(s.shape,o,i):new pye(s.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[s],s.dtype,l)},gye={kernelName:S0,backendName:"webgl",kernelFunc:Qz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yye=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,vye=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Tl+`
  return result;
`,xye=In({opSnippet:yye,packedOpSnippet:vye}),bye={kernelName:Yf,backendName:"webgl",kernelFunc:xye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wye(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=[],c=Le(o,s.shape);let u=c;const h=Et(u,a);let d=s;h!=null&&(d=Qn({inputs:{x:s},backend:n,attrs:{perm:h}}),u=Bt(u.length,a),l.push(d)),Cn("prod",u,a);let f;if(n.shouldExecuteOnCPU([d])){const p=n.texData.get(d.dataId).values,{outVals:m,outShape:y,outDtype:g}=Iue(d.shape,d.dtype,p,u);f=n.makeTensorInfo(y,g,m)}else{const[p,m]=cn(d.shape,u),y=Y(m),g=le({inputs:{x:d},backend:n,attrs:{shape:[-1,y]}}),v=Uk(s.dtype),x=Rl(g,v,"prod",n);f=le({inputs:{x},backend:n,attrs:{shape:p}}),l.push(g),l.push(x)}if(i){l.push(f);const p=Gt(f.shape,c);f=le({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const Cye={kernelName:$0,backendName:"webgl",kernelFunc:wye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iye(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=r,l=s.map(g=>n.readSync(g.dataId)),c=s.map(g=>g.shape),u=n.readSync(o.dataId),h=n.readSync(i.dataId),[d,f,p]=Sue(l,c,u,o.shape,o.dtype,h,i.shape,a),m=d.map(g=>n.makeTensorInfo([g.length],"int32",g)),y=n.makeTensorInfo(p,o.dtype,f);return m.concat([y])}const Sye={kernelName:uM,backendName:"webgl",kernelFunc:Iye};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kye(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:o}=e,i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[c,u]=kue(i,r.shape,r.dtype,a,s.shape,l,o.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],r.dtype,u);return[h,d]}const $ye={kernelName:hM,backendName:"webgl",kernelFunc:kye};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eye(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,c=n.readSync(s.dataId),u=n.readSync(o.dataId),h=n.readSync(i.dataId),d=a.map(y=>n.readSync(y.dataId)),f=a.map(y=>y.shape),[p,m]=$ue(c,s.shape,u,o.shape,o.dtype,h,i.shape,d,f,l);return n.makeTensorInfo(p,o.dtype,m)}const Nye={kernelName:dM,backendName:"webgl",kernelFunc:Eye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jz=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:o,dtype:i}=n,a=Eue(r,s,o,i);return e.makeTensorInfo([a.length],i,a)},Tye={kernelName:Tk,backendName:"webgl",kernelFunc:Jz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rye="return 1.0 / x;",_ye=Ge({opSnippet:Rye}),Aye={kernelName:Qf,backendName:"webgl",kernelFunc:_ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dye=hs+`
  return (x < 0.0) ? 0.0 : x;
`,Oye=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Pye=Ge({opSnippet:Dye,packedOpSnippet:Oye}),Fye={kernelName:Jf,backendName:"webgl",kernelFunc:Pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lye=hs+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Mye=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zye=Ge({opSnippet:Lye,packedOpSnippet:Mye}),Bye={kernelName:Zf,backendName:"webgl",kernelFunc:zye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uye{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,r,c];const u=[s&&n>1?a-1:a,s&&r>1?l-1:l],h=[s&&n>1?n-1:n,s&&r>1?r-1:r];let d;o?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vye{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,r,c];const u=[s&&n>1?a-1:a,s&&r>1?l-1:l],h=[s&&n>1?n-1:n,s&&r>1?r-1:r];let d;o?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wye(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,c]=a,u=G().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Vye(s.shape,l,c,o,i):new Uye(s.shape,l,c,o,i);return n.runWebGLProgram(u,[s],"float32")}const jye={kernelName:T0,backendName:"webgl",kernelFunc:Wye};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gye{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hye(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new Gye(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const Kye={kernelName:Ak,backendName:"webgl",kernelFunc:Hye};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qye{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,r,c];const u=[s&&n>1?a-1:a,s&&r>1?l-1:l],h=[s&&n>1?n-1:n,s&&r>1?r-1:r],d=s?"0.5":"0.0";let f;o?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/h[0]},
          ${u[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xye{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,r,c];const u=[s&&n>1?a-1:a,s&&r>1?l-1:l],h=[s&&n>1?n-1:n,s&&r>1?r-1:r],d=s?"0.5":"0.0";let f;o?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/h[0]},
          ${u[1]/h[1]},
          ${u[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yye(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,c]=a,u=G().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Xye(s.shape,l,c,o,i):new qye(s.shape,l,c,o,i);return n.runWebGLProgram(u,[s],s.dtype)}const Qye={kernelName:N0,backendName:"webgl",kernelFunc:Yye};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jye{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],u=l[0]/c[0],h=l[1]/c[1],d=1/u,f=1/h,p=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zye(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new Jye(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const eve={kernelName:_k,backendName:"webgl",kernelFunc:Zye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tve{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>s(l)).join(","),i=st(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nve{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=jn("rc",r),o=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=st(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${o}){
            result.g = ${c(s.slice())};
          }
          if(${i}) {
            result.b = ${u(s.slice())};
            if(${o}) {
              result.a = ${h(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return d(p)}function c(p){return p[r-1]="("+p[r-1]+" + 1)",d(p)}function u(p){return p[r-2]="("+p[r-2]+" + 1)",d(p)}function h(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",d(p)}function d(p){const m=e.map((v,x)=>f(x,p)),y=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${g}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rve(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r,i=s.shape.length,a=Le(o,s.shape);if(i===0)return $r({inputs:{x:s},backend:n});const l=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nve(s.shape,a):new tve(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const sve={kernelName:R0,backendName:"webgl",kernelFunc:rve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ove{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ive={kernelName:zk,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=new ove(r.shape,o),[c,u]=T$(i,r.shape[1],r.shape[2]),h=[[c,u,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ave=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,lve=Ge({opSnippet:ave}),cve={kernelName:ep,backendName:"webgl",kernelFunc:lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uve="return inversesqrt(x);",hve=Ge({opSnippet:uve,cpuKernelImpl:Nue}),dve={kernelName:tp,backendName:"webgl",kernelFunc:hve};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iE{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const c=st(o.length),u=st(i.length);let h="";r===1?h="i":r===2&&(h="i, j");const d=`getIndices(${h})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fve{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const c=st(o.length),u=st(i.length);let h="";r===1?h="i":r===2&&(h="i, j");const d=`getIndices(${h})`;let f="";s===1?f="i":s===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides",v=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${v};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pve(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=$l(o,s,i),d=[h/c,c];if(h===0)return n.makeTensorInfo(i,s.dtype);const f=le({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),p=le({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;G().getBool("WEBGL_PACK")?y=new fve(l,a,f.shape.length,p.shape.length,u,d):y=new iE(l,a,f.shape.length,p.shape.length,u,d);const g=n.runWebGLProgram(y,[p,f,m],p.dtype),v=le({inputs:{x:g},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),v}const mve={kernelName:fM,backendName:"webgl",kernelFunc:pve};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gve{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=G().getNumber("WEBGL_VERSION")===2?o:i,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yve(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=new gve(s.shape[0],s.shape[1],o.shape[1],i),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,o],"int32",l)}const vve={kernelName:mM,backendName:"webgl",kernelFunc:yve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xve{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,o;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)o="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);s=l.join(),o=c.join()}const i=st(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bve(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e,i=new xve(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(i,[r,s,o],kr(s.dtype,o.dtype))}const wve={kernelName:_0,backendName:"webgl",kernelFunc:bve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cve=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Q0};
  float scale = ${J0};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Ive=Ge({opSnippet:Cve}),Sve={kernelName:np,backendName:"webgl",kernelFunc:Ive};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kve=Mu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,$ve=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Eve=Ge({opSnippet:kve,packedOpSnippet:$ve,cpuKernelImpl:Rue}),Nve={kernelName:ip,backendName:"webgl",kernelFunc:Eve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tve=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Rve=Ge({opSnippet:Tve}),_ve={kernelName:op,backendName:"webgl",kernelFunc:Rve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ave=Mu+`
  return sin(x);
`,Dve=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Tl}
  return result;
`,Ove=Ge({opSnippet:Ave,packedOpSnippet:Dve}),Pve={kernelName:rp,backendName:"webgl",kernelFunc:Ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fve=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Lve=Ge({opSnippet:Fve}),Mve={kernelName:sp,backendName:"webgl",kernelFunc:Lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zve=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Bve=Ge({opSnippet:zve}),Uve={kernelName:ap,backendName:"webgl",kernelFunc:Bve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vve=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;k(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((g,v)=>g*v),l=[[0,0]];l.push(...i);for(let g=1+o.length;g<s.shape.length;++g)l.push([0,0]);const c=[],u=Qz({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),h=bp(u.shape,o,a,!1),d=wp(h.length,o.length,!1),f=Cp(u.shape,o,a,!1),p=le({inputs:{x:u},backend:n,attrs:{shape:h}}),m=Qn({inputs:{x:p},backend:n,attrs:{perm:d}}),y=le({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(g=>n.disposeIntermediateTensorInfo(g)),y},Wve={kernelName:O0,backendName:"webgl",kernelFunc:Vve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jve(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),c=n.readSync(o.dataId),u=n.readSync(i.dataId)[0],[h,d,f,p,m]=Aue(a,r.shape,r.dtype,l,s.dtype,c,u);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],s.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(y=>Number(y)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const Gve={kernelName:gM,backendName:"webgl",kernelFunc:jve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hve(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[c,u,h]=Due(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([h.length],o.dtype,new Int32Array(h))]}const Kve={kernelName:yM,backendName:"webgl",kernelFunc:Hve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qve(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[c,u]=Cz(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(u,r.dtype,c)}const Xve={kernelName:vM,backendName:"webgl",kernelFunc:qve};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yve(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[c,u]=Cz(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(u,r.dtype,c)}const Qve={kernelName:xM,backendName:"webgl",kernelFunc:Yve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jve(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=$l(o,s,a),f=!1;if(o.dtype==="string"){const g=n.bufferSync(s),v=n.bufferSync(o),x=Hi(n.readSync(i.dataId)[0]),b=Tue(g,v,a,d,u,c,l,h,x,f);return n.makeTensorInfo(a,b.dtype,b.values)}const p=new iE(c,l,s.shape.length,o.shape.length,h,[d,1],f),m=n.runWebGLProgram(p,[o,s,i],o.dtype),y=le({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),y}const Zve={kernelName:bM,backendName:"webgl",kernelFunc:Jve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=Le(i,s.shape)[0],l=j$(s,o,a),c=s.shape.length,u=new Array(c).fill(0),h=s.shape.slice();return l.map(d=>{const f=[...h];f[a]=d;const p=zu({inputs:{x:s},backend:n,attrs:{begin:u,size:f}});return u[a]+=d,p})}const t0e={kernelName:P0,backendName:"webgl",kernelFunc:e0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YR="return sqrt(x);",n0e=Ge({opSnippet:YR,packedOpSnippet:YR,cpuKernelImpl:Oue}),r0e={kernelName:lp,backendName:"webgl",kernelFunc:n0e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s0e="return x * x;",o0e=Ge({opSnippet:s0e}),i0e={kernelName:Dk,backendName:"webgl",kernelFunc:o0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QR="return (a - b) * (a - b);",a0e=In({opSnippet:QR,packedOpSnippet:QR}),l0e={kernelName:cp,backendName:"webgl",kernelFunc:a0e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(s.dataId),i=Go(o),a=Pue(i,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const u0e={kernelName:Ok,backendName:"webgl",kernelFunc:c0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h0e({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=hs+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new Qs(r.shape,s);return n.runWebGLProgram(o,[r],r.dtype)}const d0e={kernelName:pp,backendName:"webgl",kernelFunc:h0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class f0e{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,o=st(r.length),i=st(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((c,u)=>(l++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:v,end:x,strides:b}=$$(s.shape,o,i,a,l,c,u,h,d);let w;if(m)w=le({inputs:{x:s},backend:n,attrs:{shape:p}});else if(y||g){k(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const I=I$(v,x,b),S=zu({inputs:{x:s},backend:n,attrs:{begin:v,size:I}});w=le({inputs:{x:S},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(S)}else if(n.shouldExecuteOnCPU([s])){const S=n.readSync(s.dataId),$=Fe(s.shape,s.dtype,S),E=Fue(f,$,b,v);w=n.makeTensorInfo(p,s.dtype,E.values)}else{const S=new f0e(v,b,f);w=n.runWebGLProgram(S,[s],s.dtype)}const C=le({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),C}const m0e={kernelName:Pk,backendName:"webgl",kernelFunc:p0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g0e(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:h}=e,d=n.readSync(u.dataId),f=n.readSync(h.dataId),[p,m]=Lue(d,f,s,o,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",m)]}const y0e={kernelName:wM,backendName:"webgl",kernelFunc:g0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v0e(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[c,u,h]=Mue(a,l,s),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const x0e={kernelName:CM,backendName:"webgl",kernelFunc:v0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b0e(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=zue(i,s);return n.makeTensorInfo(o.shape,"int32",a)}const w0e={kernelName:IM,backendName:"webgl",kernelFunc:b0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C0e="return tan(x);",I0e=Ge({opSnippet:C0e}),S0e={kernelName:hp,backendName:"webgl",kernelFunc:I0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k0e=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,$0e=Ge({opSnippet:k0e}),E0e={kernelName:dp,backendName:"webgl",kernelFunc:$0e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N0e(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=$l(i,o,s.shape),d=[h/c,c];if(h===0)return n.makeTensorInfo(s.shape,o.dtype);const f=le({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=le({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=le({inputs:{x:s},backend:n,attrs:{shape:d}}),y=new iE(l,a,f.shape.length,p.shape.length,u,d,!1,!0),g=n.runWebGLProgram(y,[p,f,m],m.dtype),v=le({inputs:{x:g},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),v}const T0e={kernelName:pM,backendName:"webgl",kernelFunc:N0e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R0e{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[i]*n[i];this.outputShape=r,this.rank=r.length;const s=st(this.rank),o=_0e(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function _0e(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),c=s.dtype==="string"?l.map(d=>Hi(d)):l,u=Fe(s.shape,s.dtype,c),h=Uue(u,o);return n.makeTensorInfo(h.shape,h.dtype,h.values)}const i=new R0e(s.shape,o);return n.runWebGLProgram(i,[s],s.dtype)}const A0e={kernelName:fp,backendName:"webgl",kernelFunc:Zz};class D0e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class O0e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ma(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function JR(t){let e=1;for(;e<t;)e*=2;return e}function P0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r,a=G().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=G().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=s.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([s])||u<a||o>l){const E=n.readSync(s.dataId),[A,M]=Vue(E,c,s.dtype,o,i);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(M.shape,M.dtype,M.values)]}if(o===0)return c[c.length-1]=0,[n.makeTensorInfo(c,s.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[s,Np({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const h=n.texData.get(s.dataId),d=h!==null&&h.isPacked,f=d?n.unpackTensor(s):s,m=Y(c)/u,y=le({inputs:{x:f},attrs:{shape:[m,u]},backend:n});d&&ma(n,f);const g=JR(o),v=JR(u);let x=null;const b=()=>x===null?[y,y]:[y,x],w=(E,A,M)=>{const B=b(),U=new D0e(M),H=[[u],[x===null?1:0],[Number.NEGATIVE_INFINITY],[E],[A]],K=x;x=n.runWebGLProgram(U,B,"int32",H),ma(n,K)};for(let E=1;E<g;E*=2){const A=E*2;for(let M=E;M>=1;M/=2)w(A,M,[m,v])}for(let E=v;E>g;E/=2){const A=b(),M=new O0e([m,E/2]),U=[[u],[x===null?1:0],[g]],V=x;x=n.runWebGLProgram(M,A,"int32",U),ma(n,V);const H=g/2,K=H*2;for(let R=H;R>=1;R/=2)w(K,R,x.shape)}let C=x;x=zu({inputs:{x},backend:n,attrs:{begin:0,size:[m,o]}}),ma(n,C);let I=Gz({inputs:{x:y,indices:x},backend:n,attrs:{axis:1,batchDims:1}});ma(n,y);const S=c.slice(0,-1);S.push(o),C=x,x=le({inputs:{x},attrs:{shape:S},backend:n}),ma(n,C);const $=I;return I=le({inputs:{x:I},attrs:{shape:S},backend:n}),ma(n,$),[I,x]}const F0e={kernelName:Fk,backendName:"webgl",kernelFunc:P0e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L0e{constructor(e,n,r,s,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M0e(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=r,[u,h,d,f]=s.shape,[p,m]=c??[h,d],y=[u,p,m,f],g=new L0e(h,d,i,a,l,y);return n.runWebGLProgram(g,[s,o],"float32")}const z0e={kernelName:Lk,backendName:"webgl",kernelFunc:M0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B0e(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:o}=e;Sp(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(o.dataId),{outputValues:a,outputShape:l,indices:c}=Wue(i,s,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}const U0e={kernelName:Mk,backendName:"webgl",kernelFunc:B0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0e(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s,a=i.shape.length,l=s.shape[o],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==o&&(c[u++]=i.shape[m]);const h=[],d=new Array(a).fill(0),f=i.shape.slice();f[o]=1;const p=new Array(l);for(let m=0;m<p.length;m++){d[o]=m;const y=zu({inputs:{x:i},backend:n,attrs:{begin:d,size:f}}),g=le({inputs:{x:y},backend:n,attrs:{shape:c}});p[m]=g,h.push(y)}return h.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const W0e={kernelName:L0,backendName:"webgl",kernelFunc:V0e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j0e{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/r);this.outputShape=[s,a];const l="0.0",c="sumValue",u=Math.floor(r/4)*4,h=r%4,d=`
        sumValue += dot(values, segFilter);
    `;let f="";o%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${u};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r,a=s.shape.length,l=[];let c=0;const u=Et([c],a);let h=s;u!=null&&(h=Qn({inputs:{x:s},backend:n,attrs:{perm:u}}),l.push(h),c=Bt(1,a)[0]);const d=p4(h.shape,c,i),f=Y([h.shape[c]]),p=le({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=Uk(s.dtype),y=(b,w,C,I,S)=>{const $=b.shape[0],E=b.shape[1],A=f4(E,S),M={windowSize:A,inSize:E,batchSize:$,numSegments:S},B=new j0e(M,w),U=n.compileAndRun(B,[b,C],I);if(l.push(U),U.shape[1]===S)return U;const V=Jz({backend:n,attrs:{start:0,stop:S,step:1,dtype:"float32"}}),H=Zz({inputs:{x:V},backend:n,attrs:{reps:[E/A]}});return l.push(V),l.push(H),y(U,w,H,I,S)},g=y(p,"unsortedSegmentSum",o,m,i),v=le({inputs:{x:g},backend:n,attrs:{shape:d}});let x=v;if(u!=null){l.push(v);const b=aa(u);x=Qn({inputs:{x},backend:n,attrs:{perm:b}})}return l.forEach(b=>n.disposeIntermediateTensorInfo(b)),x}const H0e={kernelName:M0,backendName:"webgl",kernelFunc:G0e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K0e=[Ohe,Fhe,zhe,Vhe,jhe,Khe,Xhe,Qhe,tde,rde,ide,cde,dde,gde,xde,wde,Ide,Ede,Tde,_de,Pde,Vde,jde,Hde,Jde,efe,sfe,yhe,afe,dfe,gfe,Cfe,kfe,Efe,Tfe,_fe,Pfe,Mfe,Ufe,Wfe,Gfe,Kfe,Yfe,Jfe,npe,spe,ape,upe,dpe,gpe,bpe,Spe,Epe,Rpe,_pe,Dpe,Ppe,Lpe,zpe,Upe,Gpe,qpe,Qpe,Zpe,nme,ome,cme,fme,ghe,mme,ufe,vme,wme,Sme,xhe,Nme,Ame,Ome,Mme,Ume,Gme,qme,Jme,nge,oge,age,hge,fge,mge,xge,wge,Ige,kge,Ege,_ge,Pge,zge,Kge,Che,Qge,eye,rye,iye,qde,cye,hye,fye,gye,bye,whe,Cye,Sye,$ye,Nye,Tye,Xde,Wge,Aye,Fye,Bye,She,jye,Kye,Qye,eve,sve,ive,cve,dve,mve,vve,wve,Sve,Nve,_ve,Pve,Mve,Bde,Gge,Uve,Wve,Gve,Kve,Xve,Qve,Zve,t0e,r0e,i0e,l0e,u0e,d0e,m0e,y0e,x0e,w0e,jge,_he,S0e,E0e,T0e,A0e,F0e,z0e,Ahe,U0e,W0e,H0e,uye];for(const t of K0e)kM(t);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q0e=E3;class ox extends XS{nextDataId(){return ox.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new XL(this,Vs())}write(e,n,r){this.firstUse&&(this.firstUse=!1,G().get("IS_NODE")&&Ar(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const s={id:this.nextDataId()};return this.data.set(s,{values:e,dtype:r,refCount:1}),s}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&xf(r[0])){const o=r.map(i=>Li(i));s=this.write(o,e,n)}else s=this.write(r,e,n);return{dataId:s,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,s,o){this.data.set(e,{values:n,dtype:s,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const s=this.readSync(r.real.dataId),o=this.readSync(r.imag.dataId);return jo(s,o)}return vee(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>Hi(s));return Fe(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Fe(e.shape,e.dtype,n)}makeOutput(e,n,r){return Vs().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=er();return e(),{kernelMs:er()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){me([e],"where");const n=this.readSync(e.dataId);return q0e(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}ox.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ZM("cpu",()=>new ox,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eB=tt(Df,t=>t>=0?t:Math.exp(t)-1),X0e={kernelName:Df,backendName:"cpu",kernelFunc:eB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tB(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r;me([s],"leakyRelu");const i=Y(s.shape),a=n.data.get(s.dataId).values,l=Rn("float32",i);for(let c=0;c<a.length;c++)l[c]=a[c]<0?o*a[c]:a[c];return n.makeTensorInfo(s.shape,"float32",l)}const Y0e={kernelName:i0,backendName:"cpu",kernelFunc:tB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q0e=Ht((t,e)=>t<0?e*t:t);function nB(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e;me([r,s],"prelu");const o=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,[a,l]=Q0e(r.shape,s.shape,o,i,"float32");return n.makeTensorInfo(l,"float32",a)}const J0e={kernelName:k0,backendName:"cpu",kernelFunc:nB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rB=tt(Jf,t=>Math.max(0,t)),Z0e={kernelName:Jf,backendName:"cpu",kernelFunc:rB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sB=tt(Zf,t=>Math.min(Math.max(0,t),6)),exe={kernelName:Zf,backendName:"cpu",kernelFunc:sB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cy(t,e,n,r,s){if(n==="linear")return fo({inputs:{x:e},backend:t});if(n==="relu")return rB({inputs:{x:e},backend:t});if(n==="elu")return eB({inputs:{x:e},backend:t});if(n==="relu6")return sB({inputs:{x:e},backend:t});if(n==="prelu")return nB({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return tB({inputs:{x:e},backend:t,attrs:{alpha:s}});if(n==="sigmoid")return oz({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ut(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:o}=r,i=Y(s.shape),a=QL(o,i),l=Y(a);k(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${s.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(s.dataId);const c=n.data.get(s.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,h=c.complexTensorInfos.imag;u.shape=a,h.shape=a}return{dataId:s.dataId,shape:a,dtype:s.dtype}}const txe={kernelName:E0,backendName:"cpu",kernelFunc:ut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;me([s,o],"matMul");const l=s.shape.length,c=o.shape.length,u=i?s.shape[l-2]:s.shape[l-1],h=a?o.shape[c-1]:o.shape[c-2],d=i?s.shape[l-1]:s.shape[l-2],f=a?o.shape[c-2]:o.shape[c-1],p=s.shape.slice(0,-2),m=o.shape.slice(0,-2),y=Y(p),g=Y(m),x=_e(s.shape.slice(0,-2),o.shape.slice(0,-2)).concat([d,f]);k(u===h,()=>`Error in matMul: inner shapes (${u}) and (${h}) of Tensors with shapes ${s.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const b=i?[y,u,d]:[y,d,u],w=a?[g,f,h]:[g,h,f],C=ut({inputs:{x:s},backend:n,attrs:{shape:b}}),I=ut({inputs:{x:o},backend:n,attrs:{shape:w}}),S=i?C.shape[1]:C.shape[2],$=i?C.shape[2]:C.shape[1],E=a?I.shape[1]:I.shape[2],A=Math.max(y,g),M=n.data.get(C.dataId).values,B=n.data.get(I.dataId).values,U=xe(C.shape),V=xe(I.shape),[H,K,R]=i?[U[0],1,U[1]]:[U[0],U[1],1],[D,z,Q]=a?[1,V[1],V[0]]:[V[1],1,V[0]],J=$*E,ee=Fe([A,$,E],C.dtype),ie=ee.values,re=n.blockSize;for(let ue=0;ue<A;ue++){const ge=ue%y,Se=ue%g;for(let we=0;we<$;we+=re){const De=Math.min(we+re,$);for(let Oe=0;Oe<E;Oe+=re){const et=Math.min(Oe+re,E);for(let it=0;it<S;it+=re){const Nt=Math.min(it+re,S);for(let at=we;at<De;at++)for(let nt=Oe;nt<et;nt++){let It=0;for(let yt=it;yt<Nt;yt++){const mo=M[ge*H+at*K+yt*R],hn=B[yt*D+nt*z+Se*Q];It+=mo*hn}ie[ue*J+(at*E+nt)]+=It}}}}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(I),n.makeTensorInfo(x,ee.dtype,ee.values)}const nxe={kernelName:Gv,backendName:"cpu",kernelFunc:oB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rxe(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:h}=r;let d,f,p;const m=[];d=oB({inputs:{a:s,b:o},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(f=Jc({inputs:{a:d,b:i},backend:n}),m.push(d),d=f),u&&(p=Cy(n,d,u,a,h),m.push(d),d=p);for(const g of m)n.disposeIntermediateTensorInfo(g);return d}const sxe={kernelName:iy,backendName:"cpu",kernelFunc:rxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oxe=tt(bf,t=>Math.acos(t)),ixe={kernelName:bf,backendName:"cpu",kernelFunc:oxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const axe=tt(wf,t=>Math.acosh(t)),lxe={kernelName:wf,backendName:"cpu",kernelFunc:axe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cxe(t){const{inputs:e,backend:n}=t,r=e;me(e,"addN");const s=r.map(a=>n.data.get(a.dataId).values),o=Fe(r[0].shape,r[0].dtype),i=o.values;for(let a=0;a<r.length;a++){const l=s[a];for(let c=0;c<i.length;c++)i[c]+=l[c]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const uxe={kernelName:tk,backendName:"cpu",kernelFunc:cxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;me(s,"all");const a=Le(o,s.shape);let l=a;const c=Et(l,s.shape.length);let u=s;c!=null&&(u=lr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=Bt(l.length,s.shape.length)),Cn("all",l,u.shape.length);const[h,d]=cn(u.shape,l),f=Y(d),p=_n(Y(h),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const v=g*f;let x=m[v];for(let b=0;b<f;++b){const w=m[v+b];x=x&&w}p[g]=x}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(h,u.dtype,p);if(i){const g=Gt(h,a),v=ut({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),v}return y}const dxe={kernelName:nk,backendName:"cpu",kernelFunc:hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;me(s,"any");const a=Le(o,s.shape);let l=a;const c=Et(l,s.shape.length);let u=s;c!=null&&(u=lr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=Bt(l.length,s.shape.length)),Cn("any",l,u.shape.length);const[h,d]=cn(u.shape,l),f=Y(d),p=_n(Y(h),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const v=g*f;let x=m[v];for(let b=0;b<f;++b){const w=m[v+b];x=x||w}p[g]=x}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(h,u.dtype,p);if(i){const g=Gt(h,a),v=ut({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),v}return y}const pxe={kernelName:rk,backendName:"cpu",kernelFunc:fxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;me(s,"argMax");let i=Le(o,s.shape);const a=Et(i,s.shape.length);let l=s;const c=[];a!=null&&(l=lr({inputs:{x:s},backend:n,attrs:{perm:a}}),c.push(l),i=Bt(i.length,l.shape.length)),i=[i[0]],Cn("argMax",i,l.shape.length);const[u,h]=cn(l.shape,i),d=Y(u),f=_n(d,"int32"),p=Y(h),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const g=y*p;let v=m[g],x=0;for(let b=0;b<p;++b){const w=m[g+b];w>v&&(v=w,x=b)}f[y]=x}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",f)}const gxe={kernelName:Uv,backendName:"cpu",kernelFunc:mxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;me(s,"argMin");let i=Le(o,s.shape);const a=Et(i,s.shape.length);let l=s;const c=[];a!=null&&(l=lr({inputs:{x:s},backend:n,attrs:{perm:a}}),c.push(l),i=Bt(i.length,l.shape.length)),i=[i[0]],Cn("argMin",i,l.shape.length);const[u,h]=cn(l.shape,i),d=Y(u),f=_n(d,"int32"),p=Y(h),m=n.data.get(l.dataId).values;for(let y=0;y<f.length;++y){const g=y*p;let v=m[g],x=0;for(let b=0;b<p;++b){const w=m[g+b];w<v&&(v=w,x=b)}f[y]=x}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(u,"int32",f)}const vxe={kernelName:Vv,backendName:"cpu",kernelFunc:yxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xxe=tt(Cf,t=>Math.asin(t)),bxe={kernelName:Cf,backendName:"cpu",kernelFunc:xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wxe=tt(If,t=>Math.asinh(t)),Cxe={kernelName:If,backendName:"cpu",kernelFunc:wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ixe=tt(Sf,t=>Math.atan(t)),Sxe={kernelName:Sf,backendName:"cpu",kernelFunc:Ixe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kxe=Ht((t,e)=>Math.atan2(t,e)),$xe=un($f,kxe),Exe={kernelName:$f,backendName:"cpu",kernelFunc:$xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nxe=tt(kf,t=>Math.atanh(t)),Txe={kernelName:kf,backendName:"cpu",kernelFunc:Nxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aE(t,e,n,r,s,o){const i=s.strideHeight,a=s.strideWidth,l=s.dilationHeight,c=s.dilationWidth,u=s.effectiveFilterHeight,h=s.effectiveFilterWidth,d=s.padInfo.top,f=s.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Fe(s.outShape,n),y=m.values,g=s.outShape[1]*s.outShape[2]*s.outShape[3],v=s.outShape[2]*s.outShape[3],x=s.outShape[3];for(let b=0;b<s.batchSize;++b){const w=b*g,C=b*r[0];for(let I=0;I<s.inChannels;++I)for(let S=0;S<s.outHeight;++S){const $=S*i-d,E=Math.max(0,$),A=Math.min(s.inHeight,u+$),M=w+S*v;for(let B=0;B<s.outWidth;++B){const U=B*a-f,V=Math.max(0,U),H=Math.min(s.inWidth,h+U);let K=p,R=0,D=0;for(let Q=E;Q<A;Q+=l){const J=C+Q*r[1];for(let ee=V;ee<H;ee+=c){const ie=J+ee*r[2],re=t[ie+I];o==="max"&&re>K?K=re:o==="avg"&&(R+=re,D++)}if(isNaN(K))break}const z=M+B*x+I;y[z]=o==="avg"?R/D:K}}}return m}function iB(t,e,n,r,s=!1,o=!1){const i=Fe(r.outShape,"int32"),a=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,m=Fe(e,n,t);for(let y=0;y<r.batchSize;++y)for(let g=0;g<r.inChannels;++g)for(let v=0;v<r.outHeight;++v){const x=v*a-f;let b=x;for(;b<0;)b+=c;const w=Math.min(r.inHeight,h+x);for(let C=0;C<r.outWidth;++C){const I=C*l-p;let S=I;for(;S<0;)S+=u;const $=Math.min(r.inWidth,d+I);let E=Number.NEGATIVE_INFINITY,A=-1;for(let M=b;M<w;M+=c){const B=M-x;for(let U=S;U<$;U+=u){const V=U-I,H=m.get(y,M,U,g);H>E&&(E=H,s?A=o?((y*r.inHeight+M)*r.inWidth+U)*r.inChannels+g:(M*r.inWidth+U)*r.inChannels+g:A=B*d+V)}}i.set(A,y,v,C,g)}}return i}function aB(t,e,n,r,s,o){const i=s.strideDepth,a=s.strideHeight,l=s.strideWidth,c=s.dilationDepth,u=s.dilationHeight,h=s.dilationWidth,d=s.effectiveFilterDepth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,m=s.padInfo.front,y=s.padInfo.top,g=s.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=Fe(s.outShape,n),b=x.values,w=s.outShape[1]*s.outShape[2]*s.outShape[3]*s.outShape[4],C=s.outShape[2]*s.outShape[3]*s.outShape[4],I=s.outShape[3]*s.outShape[4],S=s.outShape[4];for(let $=0;$<s.batchSize;++$){const E=$*w,A=$*r[0];for(let M=0;M<s.inChannels;++M)for(let B=0;B<s.outDepth;++B){const U=B*i-m;let V=U;for(;V<0;)V+=c;const H=Math.min(s.inDepth,d+U),K=E+B*C;for(let R=0;R<s.outHeight;++R){const D=R*a-y;let z=D;for(;z<0;)z+=u;const Q=Math.min(s.inHeight,f+D),J=K+R*I;for(let ee=0;ee<s.outWidth;++ee){const ie=ee*l-g;let re=ie;for(;re<0;)re+=h;const ue=Math.min(s.inWidth,p+ie),ge=J+ee*S;let Se=v,we=0,De=0;for(let et=V;et<H;et+=c){const it=A+et*r[1];for(let Nt=z;Nt<Q;Nt+=u){const at=it+Nt*r[2];for(let nt=re;nt<ue;nt+=h){const It=at+nt*r[3],yt=t[It+M];if(o==="max"&&yt>Se?Se=yt:o==="avg"&&(we+=yt,De++),isNaN(Se))break}if(isNaN(Se))break}if(isNaN(Se))break}const Oe=ge+M;b[Oe]=o==="avg"?we/Math.max(De,1):Se}}}}return x}function Rxe(t,e){const n=Fe(e.outShape,"int32"),r=e.strideDepth,s=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let y=0;y<e.inChannels;++y)for(let g=0;g<e.outDepth;++g){const v=g*r-d;let x=v;for(;x<0;)x+=i;const b=Math.min(e.inDepth,c+v);for(let w=0;w<e.outHeight;++w){const C=w*s-f;let I=C;for(;I<0;)I+=a;const S=Math.min(e.inHeight,u+C);for(let $=0;$<e.outWidth;++$){const E=$*o-p;let A=E;for(;A<0;)A+=l;const M=Math.min(e.inWidth,h+E);let B=Number.NEGATIVE_INFINITY,U=-1;for(let V=x;V<b;V+=i){const H=V-v;for(let K=I;K<S;K+=a){const R=K-C;for(let D=A;D<M;D+=l){const z=D-E,Q=t.get(m,V,K,D,y);Q>=B&&(B=Q,U=H*u*h+R*u+z)}}}n.set(U,m,g,w,$,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _xe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;me(s,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,c=1;k(Dn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=us(s.shape,o,i,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&Qe(u.inShape,u.outShape))h=fo({inputs:{x:s},backend:n});else{const d=n.data.get(s.dataId).values,f=xe(s.shape),p=aE(d,s.shape,s.dtype,f,u,"avg");h=n.makeTensorInfo(u.outShape,s.dtype,p.values)}return h}const Axe={kernelName:Wv,backendName:"cpu",kernelFunc:_xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r;me(s,"avgPool3d");const u=Yo(s.shape,o,i,1,a,l,c),h=n.data.get(s.dataId).values,d=aB(h,s.shape,s.dtype,xe(s.shape),u,"avg");return n.makeTensorInfo(d.shape,"float32",d.values)}const Oxe={kernelName:jv,backendName:"cpu",kernelFunc:Dxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pxe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=r;me([s,o],"avgPool3DGrad");const u=Yo(o.shape,i,a,1,l,c),h=u.strideDepth,d=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,y=u.filterWidth,g=u.dilationDepth,v=u.dilationHeight,x=u.dilationWidth,b=u.effectiveFilterDepth,w=u.effectiveFilterHeight,C=u.effectiveFilterWidth,I=b-1-u.padInfo.front,S=C-1-u.padInfo.left,$=w-1-u.padInfo.top,E=Fe(o.shape,"float32"),A=1/(p*m*y),M=n.bufferSync(s);for(let B=0;B<u.batchSize;++B)for(let U=0;U<u.inChannels;++U)for(let V=0;V<u.inDepth;++V)for(let H=0;H<u.inHeight;++H)for(let K=0;K<u.inWidth;++K){const R=V-I,D=H-$,z=K-S;let Q=0;for(let J=0;J<b;J+=g){const ee=(R+J)/h;if(!(ee<0||ee>=u.outDepth||Math.floor(ee)!==ee))for(let ie=0;ie<w;ie+=v){const re=(D+ie)/d;if(!(re<0||re>=u.outHeight||Math.floor(re)!==re))for(let ue=0;ue<C;ue+=x){const ge=(z+ue)/f;if(ge<0||ge>=u.outWidth||Math.floor(ge)!==ge)continue;const Se=M.get(B,ee,re,ge,U);Q+=Se}}}E.set(Q*A,B,V,H,K,U)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const Fxe={kernelName:ok,backendName:"cpu",kernelFunc:Pxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lxe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;me([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=r,u=us(i.shape,a,l,1,c),h=u.strideHeight,d=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,y=u.dilationWidth,g=u.effectiveFilterHeight,v=u.effectiveFilterWidth,x=v-1-u.padInfo.left,b=g-1-u.padInfo.top,w=Fe(i.shape,"float32"),C=1/(f*p),I=n.data.get(s.dataId).values,S=Fe(s.shape,"float32",I);for(let $=0;$<u.batchSize;++$)for(let E=0;E<u.inChannels;++E)for(let A=0;A<u.inHeight;++A)for(let M=0;M<u.inWidth;++M){const B=A-b,U=M-x;let V=0;for(let H=0;H<g;H+=m){const K=(B+H)/h;if(!(K<0||K>=u.outHeight||Math.floor(K)!==K))for(let R=0;R<v;R+=y){const D=(U+R)/d;if(D<0||D>=u.outWidth||Math.floor(D)!==D)continue;const z=S.get($,K,D,E);V+=z}}w.set(V*C,$,A,M,E)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const Mxe={kernelName:sk,backendName:"cpu",kernelFunc:Lxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,scale:o,offset:i,mean:a,variance:l}=e;k(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),k(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),k(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),me([s,a,l,o,i],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);const u=n.data.get(s.dataId).values,h=n.data.get(a.dataId).values,d=n.data.get(l.dataId).values,f=o?n.data.get(o.dataId).values:new Float32Array([1]),p=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),y=p.length,g=f.length,v=d.length,x=h.length;let b=0,w=0,C=0,I=0;for(let S=0;S<u.length;++S)m[S]=p[b++]+(u[S]-h[w++])*f[C++]/Math.sqrt(d[I++]+c),b>=y&&(b=0),w>=x&&(w=0),C>=g&&(C=0),I>=v&&(I=0);return n.makeTensorInfo(s.shape,s.dtype,m)}const Bxe={kernelName:r0,backendName:"cpu",kernelFunc:zxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;me([s],"batchToSpaceND");const a=o.reduce((g,v)=>g*v),l=bp(s.shape,o,a),c=wp(l.length,o.length),u=Cp(s.shape,o,a),h=R$(i,o.length),d=_$(u,i,o.length),f=ut({inputs:{x:s},backend:n,attrs:{shape:l}}),p=lr({inputs:{x:f},backend:n,attrs:{perm:c}}),m=ut({inputs:{x:p},backend:n,attrs:{shape:u}}),y=fl({inputs:{x:m},backend:n,attrs:{begin:h,size:d}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),y}const Vxe={kernelName:Hv,backendName:"cpu",kernelFunc:Uxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wxe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,c=Q$(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}const jxe={kernelName:ik,backendName:"cpu",kernelFunc:Wxe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gxe(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,o=n.data.get(r.dataId).values,i=n.data.get(s.dataId).values,a=_e(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Hxe={kernelName:rM,backendName:"cpu",kernelFunc:Gxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kxe=tt(Tf,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),qxe={kernelName:Tf,backendName:"cpu",kernelFunc:Kxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xxe=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(Y(e.shape)),s=n.data.get(e.dataId),o=s.complexTensorInfos.real,i=s.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],h=l[c];r[c]=Math.hypot(u,h)}return n.makeOutput(r,e.shape,"float32")},Yxe={kernelName:Kv,backendName:"cpu",kernelFunc:Xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eu(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.data.get(r.dataId).complexTensorInfos.imag,o=n.data.get(s.dataId).values;return n.makeTensorInfo(s.shape,s.dtype,o)}const Qxe={kernelName:Ck,backendName:"cpu",kernelFunc:eu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tu(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=Le(s,e[0].shape)[0],i=e.map(m=>m.shape);E$(i,o);let a=oo(e.map(m=>m.shape),o);if(Y(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>Y(m.shape)>0);if(l.length===1)return fo({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(b=>dl({inputs:{input:b},backend:n})),y=l.map(b=>eu({inputs:{input:b},backend:n})),g=tu({inputs:m,backend:n,attrs:{axis:o}}),v=tu({inputs:y,backend:n,attrs:{axis:o}}),x=yr({inputs:{real:g,imag:v},backend:n});return m.forEach(b=>n.disposeIntermediateTensorInfo(b)),y.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),x}const c=l.map(m=>{const g=[-1,Y(m.shape.slice(o))];return ut({inputs:{x:m},backend:n,attrs:{shape:g}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=oo(c.map(m=>m.shape),1);const h=c[0].shape[0]===1,d=A4(u,a,e[0].dtype,h),f=oo(l.map(m=>m.shape),o),p=n.makeTensorInfo(f,e[0].dtype,d);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Jxe={kernelName:qv,backendName:"cpu",kernelFunc:tu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=r;me([s,o],"conv2d");const h=Qo(l),d=wn(s.shape,o.shape,i,c,a,u,!1,h),f=d.filterHeight,p=d.filterWidth,m=d.dilationHeight,y=d.dilationWidth,g=d.padInfo.left,v=d.padInfo.top,x=d.dataFormat==="channelsLast",b=new vn(d.outShape,s.dtype),w=xe(s.shape),C=xe(o.shape),I=w[0],S=x?w[1]:w[2],$=x?w[2]:1,E=x?1:w[1],A=b.strides[0],M=x?b.strides[1]:b.strides[2],B=x?b.strides[2]:1,U=x?1:b.strides[1],V=n.data.get(s.dataId).values,H=n.data.get(o.dataId).values,K=b.values;for(let R=0;R<d.batchSize;++R){const D=R*I,z=R*A;for(let Q=0;Q<d.outHeight;++Q){const J=z+Q*M,ee=Q*d.strideHeight-v;for(let ie=0;ie<f;++ie){const re=ee+ie*m;if(re<0||re>=d.inHeight)continue;const ue=ie*C[0],ge=D+re*S;for(let Se=0;Se<d.outWidth;++Se){const we=J+Se*B,De=Se*d.strideWidth-g;for(let Oe=0;Oe<p;++Oe){const et=De+Oe*y;if(et<0||et>=d.inWidth)continue;const it=ue+Oe*C[1],Nt=ge+et*$;let at=it;for(let nt=0;nt<d.inChannels;++nt){const It=V[Nt+nt*E];for(let yt=0;yt<d.outChannels;++yt)K[we+yt*U]+=It*H[at+yt];at+=d.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,K)}const Zxe={kernelName:Xv,backendName:"cpu",kernelFunc:lB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ebe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;me([s,o],"conv2dBackpropFilter");const h=Qo(l),d=wn(s.shape,u,i,1,a,c,!1,h),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:y}=d,g=d.dataFormat==="channelsLast",v=new vn(d.filterShape,"float32"),x=d.padInfo.left,b=d.padInfo.top,w=n.data.get(s.dataId).values,C=n.data.get(o.dataId).values,I=new vn(s.shape,s.dtype,w),S=new vn(o.shape,o.dtype,C);for(let $=0;$<m;++$){const E=Math.max(0,Math.ceil((b-$)/f)),A=Math.min(d.outHeight,(d.inHeight+b-$)/f);for(let M=0;M<y;++M){const B=Math.max(0,Math.ceil((x-M)/p)),U=Math.min(d.outWidth,(d.inWidth+x-M)/p);for(let V=0;V<d.inChannels;++V)for(let H=0;H<d.outChannels;++H){let K=0;for(let R=0;R<d.batchSize;++R)for(let D=E;D<A;++D){const z=$+D*f-b;for(let Q=B;Q<U;++Q){const J=M+Q*p-x;g?K+=I.get(R,z,J,V)*S.get(R,D,Q,H):K+=I.get(R,V,z,J)*S.get(R,H,D,Q)}}v.set(K,$,M,V,H)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const tbe={kernelName:lk,backendName:"cpu",kernelFunc:ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nbe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=r;me([s,o],"conv2dBackpropInput");const h=xe(o.shape),d=xe(s.shape);let f=Qo(c);const p=wn(i,o.shape,a,1,l,u,!1,f),m=new vn(p.inShape,"float32"),y=m.values,g=n.data.get(s.dataId).values,v=n.data.get(o.dataId).values,[x,b,w]=h,{batchSize:C,filterHeight:I,filterWidth:S,inChannels:$,inHeight:E,inWidth:A,outChannels:M,outHeight:B,outWidth:U,strideHeight:V,strideWidth:H}=p;f=p.dataFormat;const K=I-1-p.padInfo.top,R=S-1-p.padInfo.left,D=f==="channelsLast",z=m.strides[0],Q=D?m.strides[1]:m.strides[2],J=D?m.strides[2]:1,ee=D?1:m.strides[1],ie=d[0],re=D?d[1]:d[2],ue=D?d[2]:1,ge=D?1:d[1];for(let Se=0;Se<C;++Se)for(let we=0;we<$;++we)for(let De=0;De<E;++De){const Oe=De-K,et=Math.max(0,Math.ceil(Oe/V)),it=Math.min(B,(I+Oe)/V);for(let Nt=0;Nt<A;++Nt){const at=Nt-R,nt=Math.max(0,Math.ceil(at/H)),It=Math.min(U,(S+at)/H);let yt=0;for(let hn=et;hn<it;++hn){const Zo=hn*V-Oe;for(let Tr=nt;Tr<It;++Tr){const fa=Tr*H-at,fs=ie*Se+re*hn+ue*Tr,go=x*(I-1-Zo)+b*(S-1-fa)+w*we;for(let ei=0;ei<M;++ei){const ti=g[fs+ge*ei],ni=v[go+ei];yt+=ti*ni}}}const mo=z*Se+Q*De+J*Nt+ee*we;y[mo]=yt}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const rbe={kernelName:Yv,backendName:"cpu",kernelFunc:nbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r;me([s,o],"conv3d");const c=ia(s.shape,o.shape,i,l,a),{filterDepth:u,filterHeight:h,filterWidth:d,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:y}=c,g=y.front,v=y.left,x=y.top,b=new vn(c.outShape,s.dtype),w=n.data.get(s.dataId).values,C=n.data.get(o.dataId).values,I=b.values,S=xe(s.shape),$=xe(o.shape);for(let E=0;E<c.batchSize;++E){const A=E*S[0],M=E*b.strides[0];for(let B=0;B<c.outDepth;++B){const U=M+B*b.strides[1],V=B*c.strideDepth-g;for(let H=0;H<u;++H){const K=V+H*f;if(K<0||K>=c.inDepth)continue;const R=H*$[0],D=A+K*S[1];for(let z=0;z<c.outHeight;++z){const Q=U+z*b.strides[2],J=z*c.strideHeight-x;for(let ee=0;ee<h;++ee){const ie=J+ee*p;if(ie<0||ie>=c.inHeight)continue;const re=R+ee*$[1],ue=D+ie*S[2];for(let ge=0;ge<c.outWidth;++ge){const Se=Q+ge*c.outChannels,we=ge*c.strideWidth-v;for(let De=0;De<d;++De){const Oe=we+De*m;if(Oe<0||Oe>=c.inWidth)continue;const et=re+De*$[2],it=ue+Oe*c.inChannels;let Nt=et;for(let at=0;at<c.inChannels;++at){const nt=w[it+at];for(let It=0;It<c.outChannels;++It)I[Se+It]+=nt*C[Nt+It];Nt+=c.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const obe={kernelName:Qv,backendName:"cpu",kernelFunc:sbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ibe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r;me([s,o],"conv3dBackpropFilterV2");const c=xe(s.shape),u=xe(o.shape),h=ia(s.shape,l,i,1,a),d=h.strideDepth,f=h.strideHeight,p=h.strideWidth,m=h.filterDepth,y=h.filterHeight,g=h.filterWidth,v=new vn(h.filterShape,"float32"),x=v.values,[b,w,C,I]=v.strides,S=n.data.get(o.dataId).values,[$,E,A,M]=u,B=n.data.get(s.dataId).values,[U,V,H,K]=c,R=h.padInfo.front,D=h.padInfo.left,z=h.padInfo.top;for(let Q=0;Q<m;++Q){const J=Math.max(0,Math.ceil((R-Q)/d)),ee=Math.min(h.outDepth,(h.inDepth+R-Q)/d),ie=Q*b;for(let re=0;re<y;++re){const ue=Math.max(0,Math.ceil((z-re)/f)),ge=Math.min(h.outHeight,(h.inHeight+z-re)/f),Se=re*w+ie;for(let we=0;we<g;++we){const De=Math.max(0,Math.ceil((D-we)/p)),Oe=Math.min(h.outWidth,(h.inWidth+D-we)/p),et=we*C+Se;for(let it=0;it<h.inChannels;++it){const Nt=it*I+et;for(let at=0;at<h.outChannels;++at){let nt=0;for(let It=0;It<h.batchSize;++It){const yt=It*U,mo=It*$;for(let hn=J;hn<ee;++hn){const Tr=(Q+hn*d-R)*V+yt,fa=hn*E+mo;for(let fs=ue;fs<ge;++fs){const ei=(re+fs*f-z)*H+Tr,ti=fs*A+fa;for(let ni=De;ni<Oe;++ni){const gx=(we+ni*p-D)*K+ei,yx=ni*M+ti;nt+=B[gx+it]*S[yx+at]}}}}x[Nt+at]=nt}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const abe={kernelName:ck,backendName:"cpu",kernelFunc:ibe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lbe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:i,strides:a,inputShape:l}=r;me([s],"conv3dBackpropInputV2");const c=xe(s.shape),u=xe(o.shape),h=ia(l,o.shape,a,1,i),d=new vn(h.inShape,"float32"),f=d.values,[p,m,y,g]=d.strides,v=n.data.get(s.dataId).values,[x,b,w,C]=c,I=n.data.get(o.dataId).values,[S,$,E,A]=u,{batchSize:M,filterDepth:B,filterHeight:U,filterWidth:V,inChannels:H,inDepth:K,inHeight:R,inWidth:D,outChannels:z,outDepth:Q,outHeight:J,outWidth:ee,strideDepth:ie,strideHeight:re,strideWidth:ue}=h,ge=B-1-h.padInfo.front,Se=U-1-h.padInfo.top,we=V-1-h.padInfo.left;for(let De=0;De<M;++De)for(let Oe=0;Oe<H;++Oe)for(let et=0;et<K;++et){const it=et-ge,Nt=Math.max(0,Math.ceil(it/ie)),at=Math.min(Q,(B+it)/ie);for(let nt=0;nt<R;++nt){const It=nt-Se,yt=Math.max(0,Math.ceil(It/re)),mo=Math.min(J,(U+It)/re);for(let hn=0;hn<D;++hn){const Zo=hn-we,Tr=Math.max(0,Math.ceil(Zo/ue)),fa=Math.min(ee,(V+Zo)/ue);let fs=0;for(let go=Nt;go<at;++go){const ei=go*ie-it;for(let ti=yt;ti<mo;++ti){const ni=ti*re-It;for(let Uu=Tr;Uu<fa;++Uu){const gx=Uu*ue-Zo,yx=x*De+b*go+w*ti+C*Uu,_V=S*(B-1-ei)+$*(U-1-ni)+E*(V-1-gx)+A*Oe;for(let Mp=0;Mp<z;++Mp){const AV=v[yx+Mp],DV=I[_V+Mp];fs+=AV*DV}}}}f[p*De+m*et+y*nt+g*hn+Oe]=fs}}}return n.makeTensorInfo(d.shape,d.dtype,d.values)}const cbe={kernelName:uk,backendName:"cpu",kernelFunc:lbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ube=tt(Rf,t=>Math.cos(t)),hbe={kernelName:Rf,backendName:"cpu",kernelFunc:ube};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dbe=tt(_f,t=>Math.cosh(t)),fbe={kernelName:_f,backendName:"cpu",kernelFunc:dbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pbe(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=r,[u,h,d,f]=s.shape,p=o.shape[0],[m,y]=a,g=Fe([p,m,y,f],"float32"),v=n.data.get(o.dataId).values,x=n.data.get(i.dataId).values,b=n.data.get(s.dataId).values,w=xe(s.shape),C=xe(g.shape);for(let I=0;I<p;I++){const S=I*4,$=v[S],E=v[S+1],A=v[S+2],M=v[S+3],B=x[I];if(B>=u)continue;const U=m>1?(A-$)*(h-1)/(m-1):0,V=y>1?(M-E)*(d-1)/(y-1):0;for(let H=0;H<m;H++){const K=m>1?$*(h-1)+H*U:.5*($+A)*(h-1);if(K<0||K>h-1){for(let R=0;R<y;R++)for(let D=0;D<f;D++){const z=D+R*C[2]+H*C[1]+I*C[0];g.values[z]=c}continue}if(l==="bilinear"){const R=Math.floor(K),D=Math.ceil(K),z=K-R;for(let Q=0;Q<y;Q++){const J=y>1?E*(d-1)+Q*V:.5*(E+M)*(d-1);if(J<0||J>d-1){for(let ue=0;ue<f;ue++){const ge=ue+Q*C[2]+H*C[1]+I*C[0];g.values[ge]=c}continue}const ee=Math.floor(J),ie=Math.ceil(J),re=J-ee;for(let ue=0;ue<f;ue++){let ge=ue+ee*w[2]+R*w[1]+B*w[0];const Se=b[ge];ge=ue+ie*w[2]+R*w[1]+B*w[0];const we=b[ge];ge=ue+ee*w[2]+D*w[1]+B*w[0];const De=b[ge];ge=ue+ie*w[2]+D*w[1]+B*w[0];const Oe=b[ge],et=Se+(we-Se)*re,it=De+(Oe-De)*re;ge=ue+Q*C[2]+H*C[1]+I*C[0],g.values[ge]=et+(it-et)*z}}}else for(let R=0;R<y;++R){const D=y>1?E*(d-1)+R*V:.5*(E+M)*(d-1);if(D<0||D>d-1){for(let J=0;J<f;J++){const ee=J+R*C[2]+H*C[1]+I*C[0];g.values[ee]=c}continue}const z=Math.round(D),Q=Math.round(K);for(let J=0;J<f;J++){const ee=J+z*w[2]+Q*w[1]+B*w[0],ie=J+R*C[2]+H*C[1]+I*C[0];g.values[ie]=b[ee]}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const mbe={kernelName:dk,backendName:"cpu",kernelFunc:pbe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;me(s,"cumprod");const l=Et([o],s.shape.length);let c=s;l!=null&&(c=lr({inputs:{x:s},backend:n,attrs:{perm:l}}));const u=Bt(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=kr(c.dtype,"int32"),d=JS(Y(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(g,v)=>g+p-v-1:(g,v)=>g+v;for(let g=0;g<f.length;g+=p)for(let v=0;v<p;v++){const x=m(g,v);if(v===0)d[x]=i?1:f[x];else{const b=m(g,v-1);d[x]=i?f[b]*d[b]:f[x]*d[b]}}const y=n.makeTensorInfo(c.shape,h,d);if(l!=null){const g=aa(l),v=lr({inputs:{x:y},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),v}return y}const ybe={kernelName:hk,backendName:"cpu",kernelFunc:gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;me(s,"cumsum");const l=Et([o],s.shape.length);let c=s;l!=null&&(c=lr({inputs:{x:s},backend:n,attrs:{perm:l}}));const u=Bt(1,s.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const h=kr(c.dtype,"int32"),d=_n(Y(c.shape),h),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(g,v)=>g+p-v-1:(g,v)=>g+v;for(let g=0;g<f.length;g+=p)for(let v=0;v<p;v++){const x=m(g,v);if(v===0)d[x]=i?0:f[x];else{const b=m(g,v-1);d[x]=i?f[b]+d[b]:f[x]+d[b]}}const y=n.makeTensorInfo(c.shape,h,d);if(l!=null){const g=aa(l),v=lr({inputs:{x:y},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),v}return y}const xbe={kernelName:Jv,backendName:"cpu",kernelFunc:vbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r;if(s.shape.length===1){const l=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values,u=Q$(l,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}else if(s.shape.length===2){const l=n.bufferSync(s),c=n.bufferSync(o),u=R4(l,c,i,a);return n.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const wbe={kernelName:fk,backendName:"cpu",kernelFunc:bbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r;k(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=s.shape[0],l=s.shape[1],c=s.shape[2],u=s.shape[3],h=l*o,d=c*o,f=u/(o*o),p=n.data.get(s.dataId).values,m=new Float32Array(a*h*d*f);let y=0;for(let g=0;g<a;++g)for(let v=0;v<h;++v){const x=Math.floor(v/o),b=v%o;for(let w=0;w<d;++w){const C=Math.floor(w/o),I=w%o,S=(b*o+I)*f;for(let $=0;$<f;++$){const A=$+S+u*(C+c*(x+l*g));m[y++]=p[A]}}}return n.makeTensorInfo([a,h,d,f],s.dtype,m)}const Ibe={kernelName:pk,backendName:"cpu",kernelFunc:Cbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=r;me([s,o],"depthwiseConv2DNative");const u=xe(s.shape),h=xe(o.shape);let d=l;d==null&&(d=[1,1]),k(Dn(i,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const f=wn(s.shape,o.shape,i,d,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:y,dilationWidth:g,padInfo:v}=f,x=v.left,b=v.top,w=f.outChannels/f.inChannels,C=new vn(f.outShape,s.dtype),I=n.data.get(s.dataId).values,S=n.data.get(o.dataId).values,$=C.values;for(let E=0;E<f.batchSize;++E){const A=E*u[0],M=E*C.strides[0];for(let B=0;B<f.outHeight;++B){const U=M+B*C.strides[1],V=B*f.strideHeight-b;for(let H=0;H<p;++H){const K=V+H*y;if(K<0||K>=f.inHeight)continue;const R=H*h[0],D=A+K*u[1];for(let z=0;z<f.outWidth;++z){const Q=U+z*C.strides[2],J=z*f.strideWidth-x;for(let ee=0;ee<m;++ee){const ie=J+ee*g;if(ie<0||ie>=f.inWidth)continue;const re=R+ee*h[1],ue=D+ie*f.inChannels;let ge=Q,Se=re;for(let we=0;we<f.inChannels;++we){const De=I[ue+we];for(let Oe=0;Oe<w;++Oe)$[ge+Oe]+=De*S[Se+Oe];ge+=w,Se+=w}}}}}}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Sbe={kernelName:Zv,backendName:"cpu",kernelFunc:cB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=r;me([s,o],"depthwiseConv2dNativeBackpropFilter");const h=wn(s.shape,u,i,a,l,c,!0),{strideHeight:d,strideWidth:f,filterHeight:p,filterWidth:m}=h,y=new vn(h.filterShape,"float32"),g=h.padInfo.left,v=h.padInfo.top,x=h.outChannels/h.inChannels,b=n.data.get(s.dataId).values,w=new vn(s.shape,s.dtype,b),C=n.data.get(o.dataId).values,I=new vn(o.shape,o.dtype,C);for(let S=0;S<p;++S){const $=Math.max(0,Math.ceil((v-S)/d)),E=Math.min(h.outHeight,(h.inHeight+v-S)/d);for(let A=0;A<m;++A){const M=Math.max(0,Math.ceil((g-A)/f)),B=Math.min(h.outWidth,(h.inWidth+g-A)/f);for(let U=0;U<h.outChannels;++U){const V=Math.trunc(U/x),H=U%x;let K=0;for(let R=0;R<h.batchSize;++R)for(let D=$;D<E;++D){const z=S+D*d-v;for(let Q=M;Q<B;++Q){const J=A+Q*f-g;K+=w.get(R,z,J,V)*I.get(R,D,Q,U)}}y.set(K,S,A,V,H)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const $be={kernelName:mk,backendName:"cpu",kernelFunc:kbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ebe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=r;me([s,o],"depthwiseConv2DNativeBackpropInput");const h=xe(s.shape),d=xe(o.shape),f=wn(u,o.shape,i,a,l,c,!0),p=new vn(f.inShape,"float32"),m=p.values,[y,g,v]=p.strides,x=n.data.get(s.dataId).values,[b,w,C]=h,I=n.data.get(o.dataId).values,[S,$,E]=d,{batchSize:A,filterHeight:M,filterWidth:B,inChannels:U,inHeight:V,inWidth:H,outChannels:K,outHeight:R,outWidth:D,strideHeight:z,strideWidth:Q}=f,J=M-1-f.padInfo.top,ee=B-1-f.padInfo.left,ie=K/U;for(let re=0;re<A;++re)for(let ue=0;ue<U;++ue)for(let ge=0;ge<V;++ge){const Se=ge-J,we=Math.max(0,Math.ceil(Se/z)),De=Math.min(R,(M+Se)/z);for(let Oe=0;Oe<H;++Oe){const et=Oe-ee,it=Math.max(0,Math.ceil(et/Q)),Nt=Math.min(D,(B+et)/Q);let at=0;for(let nt=we;nt<De;++nt){const It=nt*z-Se;for(let yt=it;yt<Nt;++yt){const mo=yt*Q-et,hn=b*re+w*nt+C*yt,Zo=S*(M-1-It)+$*(B-1-mo)+E*ue;for(let Tr=0;Tr<ie;++Tr){const fa=ue*ie+Tr,fs=x[hn+fa],go=I[Zo+Tr];at+=fs*go}}}m[y*re+g*ge+v*Oe+ue]=at}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Nbe={kernelName:gk,backendName:"cpu",kernelFunc:Ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tbe(t){const{inputs:e,backend:n}=t,{x:r}=e,s=Y(r.shape),o=n.data.get(r.dataId).values,i=Fe([s,s],r.dtype),a=i.values;for(let c=0;c<o.length;c++)a[c*s+c]=o[c];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const Rbe={kernelName:sM,backendName:"cpu",kernelFunc:Tbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _be={kernelName:e0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s}=t,{strides:o,pad:i,dilations:a}=n,l=e,c=l.data.get(r.dataId).values,u=r.shape.length,h=l.data.get(s.dataId).values,d=s.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:y,outHeight:g,outWidth:v,padInfo:x,strideHeight:b,strideWidth:w,filterHeight:C,filterWidth:I,dilationHeight:S,dilationWidth:$,outShape:E}=mp(r.shape,s.shape,o,i,"NHWC",a),A=Y(E),M=E.length,B=Ft(r.dtype,A);for(let V=0;V<f;++V)for(let H=0;H<g;++H){const K=H*b-x.top;for(let R=0;R<v;++R){const D=R*w-x.left;for(let z=0;z<y;++z){let Q=Number.MIN_SAFE_INTEGER;for(let ee=0;ee<C;++ee){const ie=K+ee*S;if(ie>=0&&ie<p)for(let re=0;re<I;++re){const ue=D+re*$;if(ue>=0&&ue<m){const ge=ro([V,ie,ue,z],u,xe(r.shape)),Se=ro([ee,re,z],d,xe(s.shape)),we=c[ge]+h[Se];we>Q&&(Q=we)}}}const J=ro([V,H,R,z],M,xe(E));B[J]=Q}}}return{dataId:l.write(wl(B,r.dtype),E,r.dtype),shape:E,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Abe={kernelName:rC,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:o}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=Ns(r.shape,c.data.get(r.dataId).values),h=Ns(s.shape,c.data.get(s.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:m,outHeight:y,outWidth:g,padInfo:v,strideHeight:x,strideWidth:b,filterHeight:w,filterWidth:C,dilationHeight:I,dilationWidth:S,outShape:$}=mp(r.shape,s.shape,i,a,"NHWC",l);k(o.rank===$.length,()=>`Error in ${rC}, dy must have the same rank as output ${$.length}, but got ${o.rank}`);const E=Ns($,c.data.get(o.dataId).values),A=eM(s.shape,s.dtype);for(let B=0;B<d;++B)for(let U=0;U<y;++U){const V=U*x-v.top;for(let H=0;H<g;++H){const K=H*b-v.left;for(let R=0;R<m;++R){let D=Number.MIN_SAFE_INTEGER,z=0,Q=0;for(let J=0;J<w;++J){const ee=V+J*I;if(ee>=0&&ee<f)for(let ie=0;ie<C;++ie){const re=K+ie*S;if(re>=0&&re<p){const ue=u[B][ee][re][R]+h[J][ie][R];ue>D&&(D=ue,z=J,Q=ie)}}}A[z][Q][R]+=E[B][U][H][R]}}}return{dataId:c.write(wl(A,r.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dbe={kernelName:nC,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:s,dy:o}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=Ns(r.shape,c.data.get(r.dataId).values),h=Ns(s.shape,c.data.get(s.dataId).values),{batchSize:d,inHeight:f,inWidth:p,inChannels:m,outHeight:y,outWidth:g,padInfo:v,strideHeight:x,strideWidth:b,filterHeight:w,filterWidth:C,dilationHeight:I,dilationWidth:S,outShape:$}=mp(r.shape,s.shape,i,a,"NHWC",l);k(o.rank===$.length,()=>`Error in ${nC}, dy must have the same rank as output ${$.length}, but got ${o.rank}`);const E=Ns($,c.data.get(o.dataId).values),A=eM(r.shape,r.dtype);for(let B=0;B<d;++B)for(let U=0;U<y;++U){const V=U*x-v.top;for(let H=0;H<g;++H){const K=H*b-v.left;for(let R=0;R<m;++R){let D=Number.MIN_SAFE_INTEGER,z=V<0?0:V,Q=K<0?0:K;for(let J=0;J<w;++J){const ee=V+J*I;if(ee>=0&&ee<f)for(let ie=0;ie<C;++ie){const re=K+ie*S;if(re>=0&&re<p){const ue=u[B][ee][re][R]+h[J][ie][R];ue>D&&(D=ue,z=ee,Q=re)}}}A[B][z][Q][R]+=E[B][U][H][R]}}}return{dataId:c.write(wl(A,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tp(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;me(s,"sum");let a;s.dtype==="bool"?a=qi({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):a=fo({inputs:{x:s},backend:n});const l=a.shape.length,c=Le(o,a.shape),u=Et(c,l);let h=c,d=a;u!=null&&(d=lr({inputs:{x:a},backend:n,attrs:{perm:u}}),h=Bt(h.length,l)),Cn("sum",h,d.shape.length);const[f,p]=cn(d.shape,h),m=kr(d.dtype,"int32");let y=yy(n,f,m);const g=Y(p),v=n.data.get(y.dataId).values,x=n.data.get(d.dataId).values;for(let b=0;b<v.length;++b){const w=b*g;let C=0;for(let I=0;I<g;++I)C+=x[w+I];v[b]=C}if(i){const b=Gt(y.shape,c),w=y;y=ut({inputs:{x:y},backend:n,attrs:{shape:b}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(d),y}const Obe={kernelName:D0,backendName:"cpu",kernelFunc:Tp};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pbe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=z$(s,o.length);U$(i.length,l,o);const{path:c,steps:u}=V$(a,l),h=u.length;let d=null,f=i.length;const p=[];for(let m=0;m<h;++m){for(const y of u[m]){const{permutationIndices:g,expandDims:v}=B$(f,l[y]);let x;W$(g)?x=o[y]:(x=lr({inputs:{x:o[y]},backend:n,attrs:{perm:g}}),p.push(x));const b=x.shape.slice();for(let w=0;w<v.length;++w)b.splice(v[w],0,1);Qe(x.shape,b)||(x=ut({inputs:{x},backend:n,attrs:{shape:b}}),p.push(x)),d===null?d=x:(d=ex({inputs:{a:x,b:d},backend:n}),p.push(d))}m<h-1&&(c[m]>=0&&(d=Tp({inputs:{x:d},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(d)),f--)}for(const m of p)m!==d&&n.disposeIntermediateTensorInfo(m);return d}const Fbe={kernelName:oM,backendName:"cpu",kernelFunc:Pbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lbe(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e;me([r,s],"eluGrad");const o=new Float32Array(Y(s.shape)),i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=0?o[l]=a[l]:o[l]=a[l]*(c+1)}return n.makeTensorInfo(s.shape,"float32",o)}const Mbe={kernelName:yk,backendName:"cpu",kernelFunc:Lbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zbe=A$,Bbe=D$,Ube=O$,Vbe=P$,Wbe=F$,jbe=L$,Gbe=tt(Of,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+zbe*n);return e*(1-((((jbe*r+Wbe)*r+Vbe)*r+Ube)*r+Bbe)*r*Math.exp(-n*n))}),Hbe={kernelName:Of,backendName:"cpu",kernelFunc:Gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iy(t){const{inputs:e,backend:n,attrs:r}=t,{input:s}=e,{dim:o}=r,i=s.shape.length,a=s.shape.slice();let l=o;return o<0&&(k(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),ut({inputs:{x:s},backend:n,attrs:{shape:a}})}const Kbe={kernelName:n0,backendName:"cpu",kernelFunc:Iy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qbe=Ht((t,e)=>t/e),lE=un(Af,qbe),DC={kernelName:Af,backendName:"cpu",kernelFunc:lE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(t,e,n){const r=t.shape,s=r[0],o=r[1],i=n.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[s,o],u=Y(c),h=Rn("float32",u),d=Rn("float32",u);for(let y=0;y<s;y++){const g=fl({inputs:{x:a},backend:n,attrs:{begin:[y,0],size:[1,o]}}),v=fl({inputs:{x:l},backend:n,attrs:{begin:[y,0],size:[1,o]}}),x=yr({inputs:{real:g,imag:v},backend:n}),{real:b,imag:w}=Xbe(x,e,n),C=jo(b,w);for(let I=0;I<o;I++){const S=M$(C,I);h[y*o+I]=S.real,d[y*o+I]=S.imag}n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(x)}const f=n.makeTensorInfo(c,"float32",h),p=n.makeTensorInfo(c,"float32",d),m=yr({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function Xbe(t,e,n){const r=Y(t.shape),s=n.data.get(t.dataId),o=n.data.get(s.complexTensorInfos.real.dataId).values,i=n.data.get(s.complexTensorInfos.imag.dataId).values;if(Ybe(r)){const a=OC(o,i,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),h=n.makeTensorInfo([],"float32",oa(r,"float32")),d=fo({inputs:{x:h},backend:n}),f=DC.kernelFunc({inputs:{a:c,b:h},backend:n}),p=DC.kernelFunc({inputs:{a:u,b:d},backend:n}),m=n.data.get(f.dataId).values,y=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:y}}return a}else{const a=jo(o,i),l=Qbe(a,r,e);return Y3(l)}}function Ybe(t){return(t&t-1)===0}function OC(t,e,n,r,s){if(n===1)return{real:t,imag:e};const o=jo(t,e),i=n/2,a=Q3(o),l=a.real,c=a.imag,u=[l.length],h=s.makeTensorInfo(u,"float32",l),d=s.makeTensorInfo(u,"float32",c),f=yr({inputs:{real:h,imag:d},backend:s}),p=J3(o),m=p.real,y=p.imag,g=[m.length],v=s.makeTensorInfo(g,"float32",m),x=s.makeTensorInfo(g,"float32",y),b=yr({inputs:{real:v,imag:x},backend:s}),w=OC(l,c,i,r,s),C=w.real,I=w.imag,S=[C.length],$=s.makeTensorInfo(S,"float32",C),E=s.makeTensorInfo(S,"float32",I),A=yr({inputs:{real:$,imag:E},backend:s}),M=OC(m,y,i,r,s),B=M.real,U=M.imag,V=[B.length],H=s.makeTensorInfo(V,"float32",B),K=s.makeTensorInfo(V,"float32",U),R=yr({inputs:{real:H,imag:K},backend:s}),D=e4(n,r),z=[D.real.length],Q=s.makeTensorInfo(z,"float32",D.real),J=s.makeTensorInfo(z,"float32",D.imag),ee=yr({inputs:{real:Q,imag:J},backend:s}),ie=ex({inputs:{a:ee,b:R},backend:s}),re=Jc({inputs:{a:A,b:ie},backend:s}),ue=tE({inputs:{a:A,b:ie},backend:s}),ge=dl({inputs:{input:re},backend:s}),Se=dl({inputs:{input:ue},backend:s}),we=eu({inputs:{input:re},backend:s}),De=eu({inputs:{input:ue},backend:s}),Oe=tu({inputs:[ge,Se],backend:s,attrs:{axis:0}}),et=tu({inputs:[we,De],backend:s,attrs:{axis:0}}),it=s.data.get(Oe.dataId).values,Nt=s.data.get(et.dataId).values;return s.disposeIntermediateTensorInfo(h),s.disposeIntermediateTensorInfo(d),s.disposeIntermediateTensorInfo(f),s.disposeIntermediateTensorInfo(v),s.disposeIntermediateTensorInfo(x),s.disposeIntermediateTensorInfo(b),s.disposeIntermediateTensorInfo($),s.disposeIntermediateTensorInfo(E),s.disposeIntermediateTensorInfo(A),s.disposeIntermediateTensorInfo(H),s.disposeIntermediateTensorInfo(K),s.disposeIntermediateTensorInfo(R),s.disposeIntermediateTensorInfo(Q),s.disposeIntermediateTensorInfo(J),s.disposeIntermediateTensorInfo(ee),s.disposeIntermediateTensorInfo(ie),s.disposeIntermediateTensorInfo(re),s.disposeIntermediateTensorInfo(ue),s.disposeIntermediateTensorInfo(ge),s.disposeIntermediateTensorInfo(we),s.disposeIntermediateTensorInfo(Se),s.disposeIntermediateTensorInfo(De),s.disposeIntermediateTensorInfo(Oe),s.disposeIntermediateTensorInfo(et),{real:it,imag:Nt}}function Qbe(t,e,n){const r=new Float32Array(e*2);for(let s=0;s<e;s++){let o=0,i=0;for(let a=0;a<e;a++){const l=t4(s*a,e,n),c=M$(t,a);o+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}n&&(o/=e,i/=e),Z3(r,o,i,s)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jbe(t){const{inputs:e,backend:n}=t,{input:r}=e,s=Y(r.shape),o=r.shape[r.shape.length-1],i=s/o,a=ut({inputs:{x:r},backend:n,attrs:{shape:[i,o]}}),l=uB(a,!1,n),c=ut({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const Zbe={kernelName:vk,backendName:"cpu",kernelFunc:Jbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cE(t){const{backend:e,attrs:n}=t,{shape:r,value:s,dtype:o}=n,i=o||$u(s),a=Ft(i,Y(r));return t1e(a,s,i),e.makeTensorInfo(r,i,a)}const e1e={kernelName:xk,backendName:"cpu",kernelFunc:cE};function t1e(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n1e={kernelName:bk,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,s=n,o=Rn(r.dtype,Y(r.shape)),[i,a,l,c]=r.shape,u=s.data.get(r.dataId).values;for(let d=0;d<i;d++){const f=d*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let y=0;y<l;y++){const g=y*c;for(let v=0;v<c;v++){const x=Math.round(l-y-1),b=f+m+g+v;let w=u[b];if(x>=0&&x<l){const C=x*c,I=f+m+C+v;w=u[I]}o[b]=w}}}}return{dataId:s.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let m=lB({inputs:{x:s,filter:o},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(i){const y=m;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const g=ut({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=Jc({inputs:{a:m,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else m=Jc({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(y)}if(f){const y=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const g=ut({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=Cy(n,m,f,g,p),n.disposeIntermediateTensorInfo(g)}else m=Cy(n,m,f,a,p);n.disposeIntermediateTensorInfo(y)}return m}const s1e={kernelName:ay,backendName:"cpu",kernelFunc:r1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let m=cB({inputs:{x:s,filter:o},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:h,dimRoundingMode:d}});if(i){const y=m;m=Jc({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(y)}if(f){const y=m;m=Cy(n,m,f,a,p),n.disposeIntermediateTensorInfo(y)}return m}const i1e={kernelName:SM,backendName:"cpu",kernelFunc:o1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a1e(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=Y(r.shape),i=s.shape,a=i[i.length-1],[l,c,u,h]=w$(r,s);if(c===0)return n.makeTensorInfo(l,r.dtype,[]);const d=n.data.get(s.dataId).values,f=n.bufferSync(r),p=B4(d,f,r.dtype,c,a,u,h,r.shape,o);return n.makeTensorInfo(l,r.dtype,p.values)}const l1e={kernelName:iM,backendName:"cpu",kernelFunc:a1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r;me([s,o],"gatherV2");const l=Le(i,s.shape)[0],c=n.data.get(o.dataId).values,u=s.shape[l];for(let b=0;b<c.length;++b){const w=c[b];k(w<=u-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${u-1}]`)}let h=a;a==null&&(h=0);const d=Y(o.shape),f=G$(s,o,l,h),p=ut({inputs:{x:s},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=ut({inputs:{x:o},backend:n,attrs:{shape:[f.batchSize,d/f.batchSize]}}),y=[f.batchSize,f.outerSize,d/f.batchSize,f.sliceSize],g=n.bufferSync(m),v=n.bufferSync(p),x=U4(v,g,y);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,x.dtype,x.values)}const u1e={kernelName:s0,backendName:"cpu",kernelFunc:c1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1e(t){const{inputs:e,backend:n}=t,{input:r}=e,s=Y(r.shape),o=r.shape[r.shape.length-1],i=s/o,a=ut({inputs:{x:r},backend:n,attrs:{shape:[i,o]}}),l=uB(a,!0,n),c=ut({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const d1e={kernelName:wk,backendName:"cpu",kernelFunc:h1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f1e=tt(Uf,t=>Number.isFinite(t)?1:0,"bool"),p1e={kernelName:Uf,backendName:"cpu",kernelFunc:f1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m1e=tt(Vf,t=>Math.abs(t)===1/0?1:0,"bool"),g1e={kernelName:Vf,backendName:"cpu",kernelFunc:m1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y1e=tt(Wf,t=>Number.isNaN(t)?1:0,"bool"),v1e={kernelName:Wf,backendName:"cpu",kernelFunc:y1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1e(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=H4(r,s,o);return e.makeTensorInfo([i.length],"float32",i)}const b1e={kernelName:aM,backendName:"cpu",kernelFunc:x1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w1e=tt(Gf,t=>Math.log1p(t)),C1e={kernelName:Gf,backendName:"cpu",kernelFunc:w1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I1e=Ht((t,e)=>t&&e),S1e=un(c0,I1e,null,"bool"),k1e={kernelName:c0,backendName:"cpu",kernelFunc:S1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $1e=tt(u0,t=>t?0:1,"bool"),E1e={kernelName:u0,backendName:"cpu",kernelFunc:$1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N1e=Ht((t,e)=>t||e),T1e=un(h0,N1e,null,"bool"),R1e={kernelName:h0,backendName:"cpu",kernelFunc:T1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r;me(s,"LRN");const c=s.shape[3],u=c-1,h=n.data.get(s.dataId).values,d=Y(s.shape),f=new Float32Array(d);function p(m){const y=m%c;let g=m-y+Math.max(0,y-o);const v=m-y+Math.min(y+o,u);let x=0;for(;g<=v;g++){const b=h[g];x+=b*b}return x}for(let m=0;m<d;m++){const y=p(m),g=h[m]*Math.pow(i+a*y,-l);f[m]=g}return n.makeTensorInfo(s.shape,s.dtype,f)}const A1e={kernelName:d0,backendName:"cpu",kernelFunc:_1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=r;me(i,"LRNGrad");const h=Y(i.shape),d=i.shape[3],f=n.data.get(i.dataId).values,p=n.data.get(s.dataId).values,m=n.data.get(o.dataId).values,y=new Float32Array(h),g=h;for(let v=0;v<g;v++){const x=v%d,b=v-x+Math.max(0,x-a),w=v-x+Math.min(d,x+a+1);let C=0;for(let I=b;I<w;I++)C+=Math.pow(p[I],2);C=c*C+l;for(let I=b;I<w;I++){let S=-2*c*u*p[I]*m[v]/C;v===I&&(S+=Math.pow(C,-u)),S*=f[v],y[I]+=S}}return n.makeTensorInfo(i.shape,s.dtype,y)}const O1e={kernelName:Ik,backendName:"cpu",kernelFunc:D1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hB(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r,a=n;let l=s.shape;const c=l.length,u=Le(o,l);let h=u;const d=Et(h,c);let f=a.data.get(s.dataId).values;if(d!=null){const b=new Array(c);for(let w=0;w<b.length;w++)b[w]=l[d[w]];f=Z$(f,l,s.dtype,d,b),h=Bt(h.length,c),l=b}me(s,"max"),Cn("max",h,c);const[p,m]=cn(l,h),y=Y(m),g=q4(f,y,p,s.dtype),v=a.write(g,p,s.dtype);let x=p;return i&&(x=Gt(p,u)),{dataId:v,shape:x,dtype:s.dtype}}const P1e={kernelName:f0,backendName:"cpu",kernelFunc:hB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;me(s,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,c=1;k(Dn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=us(s.shape,o,i,c,a,l);let h;if(u.filterWidth===1&&u.filterHeight===1&&Qe(u.inShape,u.outShape))h=fo({inputs:{x:s},backend:n});else{const d=n.data.get(s.dataId).values,f=xe(s.shape),p=aE(d,s.shape,s.dtype,f,u,"max");h=n.makeTensorInfo(u.outShape,s.dtype,p.values)}return h}const L1e={kernelName:p0,backendName:"cpu",kernelFunc:F1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=r;me(s,"maxPool3d");const u=Yo(s.shape,o,i,1,a,l,c),h=n.data.get(s.dataId).values,d=aB(h,s.shape,s.dtype,xe(s.shape),u,"max");return n.makeTensorInfo(d.shape,"float32",d.values)}const z1e={kernelName:m0,backendName:"cpu",kernelFunc:M1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B1e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=r;me([s,o],"maxPool3DGrad");const u=Yo(o.shape,i,a,1,l,c),h=n.bufferSync(o),d=Rxe(h,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,y=u.dilationDepth,g=u.dilationHeight,v=u.dilationWidth,x=u.effectiveFilterDepth,b=u.effectiveFilterHeight,w=u.effectiveFilterWidth,C=x-1-u.padInfo.front,I=w-1-u.padInfo.left,S=b-1-u.padInfo.top,$=Fe(o.shape,"float32"),E=n.bufferSync(s);for(let A=0;A<u.batchSize;++A)for(let M=0;M<u.inChannels;++M)for(let B=0;B<u.inDepth;++B)for(let U=0;U<u.inHeight;++U)for(let V=0;V<u.inWidth;++V){const H=B-C,K=U-S,R=V-I;let D=0;for(let z=0;z<x;z+=y){const Q=(H+z)/f;if(!(Q<0||Q>=u.outDepth||Math.floor(Q)!==Q))for(let J=0;J<b;J+=g){const ee=(K+J)/p;if(!(ee<0||ee>=u.outHeight||Math.floor(ee)!==ee))for(let ie=0;ie<w;ie+=v){const re=(R+ie)/m;if(re<0||re>=u.outWidth||Math.floor(re)!==re)continue;const ue=x*b*w-1-d.get(A,Q,ee,re,M),ge=z*b*w+J*w+ie,Se=ue===ge?1:0;if(Se===0)continue;const we=E.get(A,Q,ee,re,M);D+=we*Se}}}$.set(D,A,B,U,V,M)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const U1e={kernelName:kk,backendName:"cpu",kernelFunc:B1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V1e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;me([o,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=r,d=us(a.shape,l,c,1,u,h),f=n.data.get(a.dataId).values,p=Fe(d.outShape,a.dtype,iB(f,a.shape,a.dtype,d).values),m=d.strideHeight,y=d.strideWidth,g=d.dilationHeight,v=d.dilationWidth,x=d.effectiveFilterHeight,b=d.effectiveFilterWidth,w=b-1-d.padInfo.left,C=x-1-d.padInfo.top,I=Fe(a.shape,"float32"),S=n.data.get(s.dataId).values,$=Fe(s.shape,"float32",S);for(let E=0;E<d.batchSize;++E)for(let A=0;A<d.inChannels;++A)for(let M=0;M<d.inHeight;++M)for(let B=0;B<d.inWidth;++B){const U=M-C,V=B-w;let H=0;for(let K=0;K<x;K+=g){const R=(U+K)/m;if(!(R<0||R>=d.outHeight||Math.floor(R)!==R))for(let D=0;D<b;D+=v){const z=(V+D)/y;if(z<0||z>=d.outWidth||Math.floor(z)!==z)continue;const Q=x*b-1-p.get(E,R,z,A),J=K*b+D,ee=Q===J?1:0;if(ee===0)continue;const ie=$.get(E,R,z,A);H+=ie*ee}}I.set(H,E,M,B,A)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const W1e={kernelName:Sk,backendName:"cpu",kernelFunc:V1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j1e(t,e,n,r,s){const o=xe(e),i=aE(t,e,n,o,s,"max"),a=iB(t,e,n,s,!0,r);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G1e={kernelName:lM,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;me(r,"MaxPoolWithArgmax");const c=l.data.get(r.dataId).values,u=us(r.shape,s,o,[1,1],i),[h,d]=j1e(c,r.shape,r.dtype,a,u),f=l.write(h,u.outShape,r.dtype),p=l.write(d,u.outShape,r.dtype);return[{dataId:f,shape:u.outShape,dtype:r.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=Le(o,s.shape),c=cn(s.shape,a)[1],u=Y(c),h=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));h.push(d);const f=qi({inputs:{x:s},backend:n,attrs:{dtype:"float32"}});h.push(f);const p=lE({inputs:{a:f,b:d},backend:n});h.push(p);const m=Tp({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:i}});return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),m}const K1e={kernelName:g0,backendName:"cpu",kernelFunc:H1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;me(s,"min");const a=Le(o,s.shape);let l=a;const c=Et(l,s.shape.length);let u=s;c!=null&&(u=lr({inputs:{x:s},backend:n,attrs:{perm:c}}),l=Bt(l.length,s.shape.length)),Cn("min",l,u.shape.length);const[h,d]=cn(u.shape,l),f=Y(d),p=_n(Y(h),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const v=g*f;let x=m[v];for(let b=0;b<f;++b){const w=m[v+b];(Number.isNaN(w)||w<x)&&(x=w)}p[g]=x}c!=null&&n.disposeIntermediateTensorInfo(u);const y=n.makeTensorInfo(h,u.dtype,p);if(i){const g=Gt(h,a),v=ut({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),v}return y}const X1e={kernelName:y0,backendName:"cpu",kernelFunc:q1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,mode:i}=r;me(s,"mirrorPad");const a=o.map((x,b)=>x[0]+s.shape[b]+x[1]),l=o.map(x=>x[0]),c=o.map((x,b)=>x[0]+s.shape[b]),u=i==="reflect"?0:1,h=n.data.get(s.dataId).values,d=s.shape.length,f=xe(s.shape),p=Y(a),m=a.length,y=xe(a),g=Rn(s.dtype,p);for(let x=0;x<p;x++){let b=Eu(x,m,y);for(let C=0;C<m;C++)b[C]<l[C]?b[C]=l[C]*2-b[C]-u:b[C]>=c[C]&&(b[C]=(c[C]-1)*2-b[C]+u);b=b.map((C,I)=>C-l[I]);const w=ro(b,d,f);g[x]=h[w]}return{dataId:n.write(g,a,s.dtype),shape:a,dtype:s.dtype}}const Q1e={kernelName:v0,backendName:"cpu",kernelFunc:Y1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J1e=Ht((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Z1e=un(qf,J1e),ewe={kernelName:qf,backendName:"cpu",kernelFunc:Z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=s.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=Le([a],s.shape),c=hB({inputs:{x:s},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=Gt(c.shape,l),h=ut({inputs:{x:c},backend:n,attrs:{shape:u}}),d=tE({inputs:{a:s,b:h},backend:n}),f=F4({inputs:{x:d},backend:n}),p=Tp({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=ut({inputs:{x:p},backend:n,attrs:{shape:u}}),y=lE({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),y}const twe={kernelName:F0,backendName:"cpu",kernelFunc:dB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nwe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r;me(s,"multinomial");const l=a?s:dB({inputs:{logits:s},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],h=n.data.get(l.dataId).values,d=[c,o],f=_n(Y(d),"int32");for(let p=0;p<c;++p){const m=p*u,y=new Float32Array(u-1);y[0]=h[m];for(let x=1;x<y.length;++x)y[x]=y[x-1]+h[m+x];const g=i$.alea(i.toString()),v=p*o;for(let x=0;x<o;++x){const b=g();f[v+x]=y.length;for(let w=0;w<y.length;w++)if(b<y[w]){f[v+x]=w;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(d,"int32",f)}const rwe={kernelName:cM,backendName:"cpu",kernelFunc:nwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const swe=m$;function owe(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r;me(s,"NonMaxSuppression");const c=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values,{selectedIndices:h}=swe(c,u,i,a,l);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const iwe={kernelName:$k,backendName:"cpu",kernelFunc:owe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const awe=g$;function lwe(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=r;me(s,"NonMaxSuppressionPadded");const u=n.data.get(s.dataId).values,h=n.data.get(o.dataId).values,{selectedIndices:d,validOutputs:f}=awe(u,h,i,a,l,c);return[n.makeTensorInfo([d.length],"int32",new Int32Array(d)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const cwe={kernelName:Ek,backendName:"cpu",kernelFunc:lwe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uwe=y$;function hwe(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=r;me(s,"NonMaxSuppressionWithScore");const u=n.data.get(s.dataId).values,h=n.data.get(o.dataId).values,d=i,f=a,p=l,m=c,{selectedIndices:y,selectedScores:g}=uwe(u,h,d,f,p,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const dwe={kernelName:Nk,backendName:"cpu",kernelFunc:hwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fwe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r;me(s,"oneHot");const c=Y(s.shape),u=new Float32Array(c*i);u.fill(l);const h=n.data.get(s.dataId).values;for(let d=0;d<c;++d)h[d]>=0&&h[d]<i&&(u[d*i+h[d]]=a);return n.makeTensorInfo([...s.shape,i],o,u)}const pwe={kernelName:C0,backendName:"cpu",kernelFunc:fwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sy(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const s=dl({inputs:{input:r},backend:n}),o=Sy({inputs:{x:s},backend:n}),i=eu({inputs:{input:r},backend:n}),a=Sy({inputs:{x:i},backend:n}),l=yr({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return cE({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const mwe={kernelName:z0,backendName:"cpu",kernelFunc:Sy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const s=dl({inputs:{input:r},backend:n}),o=fB({inputs:{x:s},backend:n}),i=eu({inputs:{input:r},backend:n}),a=Sy({inputs:{x:i},backend:n}),l=yr({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return cE({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const gwe={kernelName:w0,backendName:"cpu",kernelFunc:fB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Iy({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(u=>{QS(o,u.shape,"All tensors passed to stack must have matching shapes"),k(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const h=Iy({inputs:{input:u},backend:n,attrs:{dim:s}});return a.push(h),h}),c=tu({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const ywe={kernelName:I0,backendName:"cpu",kernelFunc:pB};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;me(s,"pad");const a=o.map((v,x)=>v[0]+s.shape[x]+v[1]),l=o.map(v=>v[0]),c=n.data.get(s.dataId).values,u=Y(s.shape),h=s.shape.length,d=xe(s.shape),f=Y(a),p=a.length,m=xe(a),y=Rn(s.dtype,f);i!==0&&y.fill(i);for(let v=0;v<u;v++){const b=Eu(v,h,d).map((C,I)=>C+l[I]),w=ro(b,p,m);y[w]=c[v]}return{dataId:n.write(y,a,s.dtype),shape:a,dtype:s.dtype}}const mB={kernelName:S0,backendName:"cpu",kernelFunc:vwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xwe=Ht((t,e)=>Math.pow(t,e)),bwe=un(Yf,xwe),wwe={kernelName:Yf,backendName:"cpu",kernelFunc:bwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cwe(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:o,indices:i}=e,a=s.map(y=>n.data.get(y.dataId).values),l=s.map(y=>y.shape),c=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values,[h,d,f]=ez(a,l,c,o.shape,o.dtype,u,i.shape),p=h.map(y=>n.makeTensorInfo([y.length],"int32",y)),m=n.makeTensorInfo(f,o.dtype,d);return p.concat([m])}const Iwe={kernelName:uM,backendName:"cpu",kernelFunc:Cwe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Swe(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:o}=e,i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,[c,u]=tz(i,r.shape,r.dtype,a,s.shape,l,o.shape),h=n.makeTensorInfo([c.length],"int32",c),d=n.makeTensorInfo([u.length],r.dtype,u);return[h,d]}const kwe={kernelName:hM,backendName:"cpu",kernelFunc:Swe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,c=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values,h=n.data.get(i.dataId).values,d=a.map(y=>n.data.get(y.dataId).values),f=a.map(y=>y.shape),[p,m]=nz(c,s.shape,u,o.shape,o.dtype,h,i.shape,d,f,l);return n.makeTensorInfo(p,o.dtype,m)}const Ewe={kernelName:dM,backendName:"cpu",kernelFunc:$we};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nwe(t){const{backend:e,attrs:n}=t,{start:r,stop:s,dtype:o,step:i}=n,a=rz(r,s,i,o);return e.makeTensorInfo([a.length],o,a)}const Twe={kernelName:Tk,backendName:"cpu",kernelFunc:Nwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rwe=tt(Qf,t=>1/t),_we={kernelName:Qf,backendName:"cpu",kernelFunc:Rwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Awe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r;me(s,"resizeBilinear");const l=xe(s.shape),[c,u]=a,[h,d,f,p]=s.shape,m=n.data.get(s.dataId).values,y=new Float32Array(Y([h,c,u,p])),g=[o&&c>1?d-1:d,o&&u>1?f-1:f],v=[o&&c>1?c-1:c,o&&u>1?u-1:u];let x=0;const b=g[0]/v[0],w=g[1]/v[1];for(let C=0;C<h;C++)for(let I=0;I<c;I++){let S;i?S=b*(I+.5)-.5:S=b*I;const $=Math.max(0,Math.floor(S)),E=S-$,A=Math.min(d-1,Math.ceil(S)),M=C*l[0]+$*l[1],B=C*l[0]+A*l[1];for(let U=0;U<u;U++){let V;i?V=w*(U+.5)-.5:V=w*U;const H=Math.max(0,Math.floor(V)),K=V-H,R=Math.min(f-1,Math.ceil(V)),D=M+H*l[2],z=B+H*l[2],Q=M+R*l[2],J=B+R*l[2];for(let ee=0;ee<p;ee++){const ie=m[D+ee],re=m[z+ee],ue=m[Q+ee],ge=m[J+ee],Se=ie+(ue-ie)*K,we=re+(ge-re)*K,De=Se+(we-Se)*E;y[x++]=De}}}return n.makeTensorInfo([h,c,u,p],"float32",y)}const Dwe={kernelName:T0,backendName:"cpu",kernelFunc:Awe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Owe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r;me([o,s],"resizeBilinearGrad");const a=xe(s.shape),[l,c,u,h]=s.shape,[,d,f]=o.shape,p=new Float32Array(l*c*u*h),m=[i&&d>1?c-1:c,i&&f>1?u-1:u],y=[i&&d>1?d-1:d,i&&f>1?f-1:f],g=m[0]/y[0],v=m[1]/y[1],x=n.data.get(o.dataId).values;let b=0;for(let w=0;w<l;w++){const C=w*a[0];for(let I=0;I<d;I++){const S=I*g,$=Math.floor(S),E=Math.min(Math.ceil(S),c-1),A=C+$*a[1],M=C+E*a[1],B=S-$,U=1-B;for(let V=0;V<f;V++){const H=V*v,K=Math.floor(H),R=Math.min(Math.ceil(H),u-1),D=H-K,z=1-D,Q=A+K*a[2],J=A+R*a[2],ee=M+K*a[2],ie=M+R*a[2],re=U*z,ue=U*D,ge=B*z,Se=B*D;for(let we=0;we<h;we++){const De=x[b++];p[Q+we]+=De*re,p[J+we]+=De*ue,p[ee+we]+=De*ge,p[ie+we]+=De*Se}}}}return n.makeTensorInfo([l,u,c,h],"float32",p)}const Pwe={kernelName:Ak,backendName:"cpu",kernelFunc:Owe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fwe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r;me(s,"resizeNearestNeighbor");const l=xe(s.shape),[c,u]=a,[h,d,f,p]=s.shape,m=n.data.get(s.dataId).values,y=new Float32Array(h*c*u*p),g=[o&&c>1?d-1:d,o&&u>1?f-1:f],v=[o&&c>1?c-1:c,o&&u>1?u-1:u],x=g[0]/v[0],b=g[1]/v[1];let w=0;for(let C=0;C<h;C++){const I=C*l[0];for(let S=0;S<c;S++){const $=i?x*(S+.5):x*S;let E=Math.min(d-1,o?Math.round($):Math.floor($));i&&(E=Math.max(0,E));const A=I+E*l[1];for(let M=0;M<u;M++){const B=i?b*(M+.5):b*M;let U=Math.min(f-1,o?Math.round(B):Math.floor(B));i&&(U=Math.max(0,U));const V=A+U*l[2];for(let H=0;H<p;H++){const K=m[V+H];y[w++]=K}}}}return n.makeTensorInfo([h,c,u,p],s.dtype,y)}const Lwe={kernelName:N0,backendName:"cpu",kernelFunc:Fwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mwe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r;me([o,s],"resizeNearestNeighborGrad");const a=xe(s.shape),l=xe(o.shape),[c,u,h,d]=s.shape,[,f,p]=o.shape,m=new Float32Array(c*u*h*d),y=n.data.get(o.dataId).values,g=[i&&f>1?u-1:u,i&&p>1?h-1:h],v=[i&&f>1?f-1:f,i&&p>1?p-1:p],x=g[0]/v[0],b=g[1]/v[1],w=1/x,C=1/b,I=Math.ceil(w)*2+2,S=Math.ceil(C)*2+2;for(let $=0;$<c;$++){const E=$*a[0];for(let A=0;A<u;A++){const M=E+A*a[1],B=Math.floor(A*w),U=Math.floor(B-I/2);for(let V=0;V<h;V++){const H=M+V*a[2],K=Math.floor(V*C),R=Math.floor(K-S/2);for(let D=0;D<d;D++){let z=0;for(let Q=0;Q<I;Q++){const J=Q+U;if(J<0||J>=f)continue;const ee=E+J*l[1],ie=J*x,re=Math.min(u-1,i?Math.round(ie):Math.floor(ie));if(A===re)for(let ue=0;ue<S;ue++){const ge=ue+R;if(ge<0||ge>=p)continue;const Se=ee+ge*l[2],we=ge*b,De=Math.min(h-1,i?Math.round(we):Math.floor(we));V===De&&(z+=y[Se+D])}}m[H+D]=z}}}}return n.makeTensorInfo(s.shape,s.dtype,m)}const zwe={kernelName:_k,backendName:"cpu",kernelFunc:Mwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r;me(s,"reverse");const i=s.shape.length,a=Le(o,s.shape);if(i===0)return fo({inputs:{x:s},backend:n});const l=new vn(s.shape,s.dtype),c=n.bufferSync(s);for(let u=0;u<l.size;u++){const h=l.indexToLoc(u),d=h.slice();a.forEach(f=>d[f]=s.shape[f]-1-d[f]),l.set(c.get(...d),...h)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Uwe={kernelName:R0,backendName:"cpu",kernelFunc:Bwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vwe={kernelName:zk,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=Rn(r.dtype,Y(r.shape)),[c,u,h,d]=r.shape,[f,p]=T$(i,u,h),m=255,y=Math.sin(s),g=Math.cos(s),v=a.data.get(r.dataId).values;for(let b=0;b<c;b++){const w=b*h*u*d;for(let C=0;C<u;C++){const I=C*(h*d);for(let S=0;S<h;S++){const $=S*d;for(let E=0;E<d;E++){const A=[c,C,S,E],M=A[2],B=A[1];let U=(M-f)*g-(B-p)*y,V=(M-f)*y+(B-p)*g;U=Math.round(U+f),V=Math.round(V+p);let H=o;if(typeof o!="number"&&(E===3?H=m:H=o[E]),U>=0&&U<h&&V>=0&&V<u){const R=V*(h*d),D=U*d,z=w+R+D+E;H=v[z]}const K=w+I+$+E;l[K]=H}}}}return{dataId:a.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wwe=tt(ep,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),jwe={kernelName:ep,backendName:"cpu",kernelFunc:Wwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gwe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=$l(o,s,i),d=!0,f=n.bufferSync(s),p=n.bufferSync(o),m=Oa(f,p,i,h,c,l,a,u,0,d);return n.makeTensorInfo(i,m.dtype,m.values)}const Hwe={kernelName:fM,backendName:"cpu",kernelFunc:Gwe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kwe(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<e?n=s+1:r=s;return r}function qwe(t,e){let n=0,r=t.length,s=0;for(;n<r;)s=Math.floor((n+r)/2),t[s]<=e?n=s+1:r=s;return r}function Xwe(t,e,n,r,s,o){const i=Ft("int32",n*s);for(let a=0;a<n;++a){const l=t.slice(a*r,(a+1)*r),c=a*s;for(let u=0;u<s;++u)i[c+u]=o==="left"?Kwe(l,e[u+c]):qwe(l,e[u+c])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ywe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,c=Xwe(a,l,s.shape[0],s.shape[1],o.shape[1],i);return n.makeTensorInfo(o.shape,"int32",c)}const Qwe={kernelName:mM,backendName:"cpu",kernelFunc:Ywe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jwe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e;me([r,s,o],"select");const i=r.shape.length,a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values,u=kr(s.dtype,o.dtype),h=_n(Y(s.shape),u);let d=0;const f=i===0||i>1||s.shape.length===1?1:Y(s.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?h[d++]=l[p]:h[d++]=c[p];return n.makeTensorInfo(s.shape,u,h)}const Zwe={kernelName:_0,backendName:"cpu",kernelFunc:Jwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eCe=Q0,tCe=J0,nCe=tt(np,t=>t>=0?tCe*t:eCe*(Math.exp(t)-1)),rCe={kernelName:np,backendName:"cpu",kernelFunc:nCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sCe=tt(op,t=>t<0?-1:t>0?1:0),oCe={kernelName:op,backendName:"cpu",kernelFunc:sCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iCe=tt(rp,t=>Math.sin(t)),aCe={kernelName:rp,backendName:"cpu",kernelFunc:iCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lCe=tt(sp,t=>Math.sinh(t)),cCe={kernelName:sp,backendName:"cpu",kernelFunc:lCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uCe=11920928955078125e-23,ZR=Math.log(uCe)+2,hCe=tt(ap,t=>{const e=t>-ZR,n=t<ZR,r=Math.exp(t);let s;return n?s=r:e?s=t:s=Math.log(1+r),s}),dCe={kernelName:ap,backendName:"cpu",kernelFunc:hCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;me([s],"spaceToBatchND");const a=Y(o),l=[[0,0]];l.push(...i);for(let C=1+o.length;C<s.shape.length;++C)l.push([0,0]);const c=mB.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),u=bp(c.shape,o,a,!1),h=wp(u.length,o.length,!1),d=Cp(c.shape,o,a,!1),m=ut({inputs:{x:c},backend:n,attrs:{shape:u}}),v=lr({inputs:{x:m},backend:n,attrs:{perm:h}}),w=ut({inputs:{x:v},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),w}const pCe={kernelName:O0,backendName:"cpu",kernelFunc:fCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mCe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${s.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values[0],[h,d,f,p,m]=az(a,r.shape,r.dtype,l,s.dtype,c,u);return[n.makeTensorInfo(d,r.dtype,h),n.makeTensorInfo([d[0]],s.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(y=>Number(y)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const gCe={kernelName:gM,backendName:"cpu",kernelFunc:mCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yCe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.data.get(s.dataId).values),a=n.data.get(r.dataId).values,l=Array.from(n.data.get(o.dataId).values),[c,u,h]=lz(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([h.length],o.dtype,new Int32Array(h))]}const vCe={kernelName:yM,backendName:"cpu",kernelFunc:yCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xCe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(s.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,[c,u]=eE(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(u,r.dtype,c)}const bCe={kernelName:vM,backendName:"cpu",kernelFunc:xCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wCe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(s.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values,l=n.data.get(o.dataId).values,[c,u]=eE(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(u,r.dtype,c)}const CCe={kernelName:xM,backendName:"cpu",kernelFunc:wCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ICe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:d}=$l(o,s,a),f=!1,p=n.bufferSync(s);let m;switch(o.dtype){case"bool":{const y=n.bufferSync(o),g=!!n.data.get(i.dataId).values[0];m=Oa(p,y,a,d,u,c,l,h,g,f);break}case"float32":{const y=n.bufferSync(o),g=n.data.get(i.dataId).values[0];m=Oa(p,y,a,d,u,c,l,h,g,f);break}case"int32":{const y=n.bufferSync(o),g=n.data.get(i.dataId).values[0];m=Oa(p,y,a,d,u,c,l,h,g,f);break}case"string":{const y=n.bufferSync(o),g=Hi(n.data.get(i.dataId).values[0]);m=Oa(p,y,a,d,u,c,l,h,g,f);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const SCe={kernelName:bM,backendName:"cpu",kernelFunc:ICe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=Le(i,s.shape)[0],l=j$(s,o,a),c=new Array(s.shape.length).fill(0),u=s.shape.slice();return l.map(h=>{const d=[...u];d[a]=h;const f=fl({inputs:{x:s},backend:n,attrs:{begin:c,size:d}});return c[a]+=h,f})}const $Ce={kernelName:P0,backendName:"cpu",kernelFunc:kCe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ECe={kernelName:Dk,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;me(n,"square");const s=r.data.get(n.dataId).values,o=new Float32Array(s.length);for(let a=0;a<s.length;++a){const l=s[a];o[a]=l*l}return{dataId:r.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NCe=tt(pp,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),TCe={kernelName:pp,backendName:"cpu",kernelFunc:NCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:h,shrinkAxisMask:d}=r;me(s,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:v,end:x,strides:b}=$$(s.shape,o,i,a,l,c,u,h,d);let w;if(m)w=ut({inputs:{x:s},backend:n,attrs:{shape:p}});else if(y||g){k(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const C=I$(v,x,b),I=fl({inputs:{x:s},backend:n,attrs:{begin:v,size:C}});w=ut({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else{const C=n.bufferSync(s),I=hz(f,C,b,v);w=n.makeTensorInfo(p,I.dtype,I.values)}return w}const _Ce={kernelName:Pk,backendName:"cpu",kernelFunc:RCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ACe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:h}=e,d=n.data.get(u.dataId).values,f=n.data.get(h.dataId).values,[p,m]=dz(d,f,s,o,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(h.shape,"int32",m)]}const DCe={kernelName:wM,backendName:"cpu",kernelFunc:ACe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OCe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,h]=fz(a,l,s),d=u.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(h))]}const PCe={kernelName:CM,backendName:"cpu",kernelFunc:OCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FCe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(o.dataId).values,a=pz(i,s);return n.makeTensorInfo(o.shape,"int32",a)}const LCe={kernelName:IM,backendName:"cpu",kernelFunc:FCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MCe=tt(hp,t=>Math.tan(t)),zCe={kernelName:hp,backendName:"cpu",kernelFunc:MCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BCe=tt(dp,t=>Math.tanh(t)),UCe={kernelName:dp,backendName:"cpu",kernelFunc:BCe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VCe(t){const{inputs:e,backend:n}=t,{tensor:r,indices:s,updates:o}=e,{sliceRank:i,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=$l(o,s,r.shape),h=!1,d=n.bufferSync(s),f=n.bufferSync(o),p=n.bufferSync(r),m=Oa(d,f,r.shape,u,l,a,i,c,p,h);return n.makeTensorInfo(r.shape,m.dtype,m.values)}const WCe={kernelName:pM,backendName:"cpu",kernelFunc:VCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;me(s,"tile");const i=gz(n.bufferSync(s),o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const GCe={kernelName:fp,backendName:"cpu",kernelFunc:jCe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r;me(s,"topk");const a=n.data.get(s.dataId).values,[l,c]=vz(a,s.shape,s.dtype,o,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const KCe={kernelName:Fk,backendName:"cpu",kernelFunc:HCe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qCe(t){const{inputs:e,attrs:n,backend:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=n,[u,h,d,f]=s.shape,[p,m]=c??[h,d],y=[u,p,m,f],g=xe(s.shape),v=g[0],x=g[1],b=g[2],w=xe(y),C=w[0],I=w[1],S=w[2],$=Rn(s.dtype,Y(y));$.fill(l);const E=r.data.get(s.dataId).values,A=r.data.get(o.dataId).values;for(let B=0;B<u;++B){const U=o.shape[0]===1?A:A.subarray(B*8,B*8+8);for(let V=0;V<p;++V)for(let H=0;H<m;++H)for(let K=0;K<f;++K){let R;const D=U[6]*H+U[7]*V+1;if(D===0)continue;const z=(U[0]*H+U[1]*V+U[2])/D,Q=(U[3]*H+U[4]*V+U[5])/D,J=e_(z,d,a),ee=e_(Q,h,a);switch(i){case"nearest":R=eIe(E,h,d,v,x,b,B,ee,J,K,l);break;case"bilinear":R=tIe(E,h,d,v,x,b,B,ee,J,K,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const ie=B*C+V*I+H*S+K;$[ie]=R}return r.makeTensorInfo(y,s.dtype,$)}return{dataId:r.write($,y,s.dtype),shape:s.shape,dtype:s.dtype}}const XCe={kernelName:Lk,backendName:"cpu",kernelFunc:qCe};function e_(t,e,n){switch(n){case"reflect":return YCe(t,e);case"wrap":return QCe(t,e);case"nearest":return ZCe(t,e);case"constant":default:return JCe(t)}}function YCe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return nl(0,n,e-1)}function QCe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return nl(0,n,e-1)}function JCe(t,e){return t}function ZCe(t,e){return nl(0,t,e-1)}function ph(t,e,n,r,s,o,i,a,l,c,u){const h=i*r+a*s+l*o+c;return 0<=a&&a<e&&0<=l&&l<n?t[h]:u}function eIe(t,e,n,r,s,o,i,a,l,c,u){const h=Math.round(a),d=Math.round(l);return ph(t,e,n,r,s,o,i,h,d,c,u)}function tIe(t,e,n,r,s,o,i,a,l,c,u){const h=Math.floor(a),d=Math.floor(l),f=h+1,p=d+1,m=(p-l)*ph(t,e,n,r,s,o,i,h,d,c,u)+(l-d)*ph(t,e,n,r,s,o,i,h,p,c,u),y=(p-l)*ph(t,e,n,r,s,o,i,f,d,c,u)+(l-d)*ph(t,e,n,r,s,o,i,f,p,c,u);return(f-a)*m+(a-h)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nIe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:o}=e;me(o,"unique");const i=r.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:c}=xz(i,s,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}const rIe={kernelName:Mk,backendName:"cpu",kernelFunc:nIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sIe(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s.shape.length,a=s.shape[o],l=new Array(i-1);let c=0;for(let f=0;f<i;f++)f!==o&&(l[c++]=s.shape[f]);const u=new Array(i).fill(0),h=s.shape.slice();h[o]=1;const d=new Array(a);for(let f=0;f<d.length;f++){u[o]=f;const p=fl({inputs:{x:s},backend:n,attrs:{begin:u,size:h}});d[f]=ut({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return d}const oIe={kernelName:L0,backendName:"cpu",kernelFunc:sIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r;me(s,"unsortedSegmentSum");const a=s.shape.length,l=o.shape.length,c=[],u=[],h=a-l;let d=o;for(let p=0;p<h;++p){const m=Iy({inputs:{input:d},backend:n,attrs:{dim:p+1}});d=m,u.push(m)}for(let p=0;p<i;++p){const m=oa(p,"int32"),y=n.makeTensorInfo([],"int32",m),g=O4({inputs:{a:y,b:d},backend:n}),v=qi({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),x=ex({inputs:{a:v,b:s},backend:n}),b=Tp({inputs:{x},backend:n,attrs:{axis:0,keepDims:!1}});c.push(b),u.push(y),u.push(g),u.push(v),u.push(x),u.push(b)}const f=pB({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const aIe={kernelName:M0,backendName:"cpu",kernelFunc:iIe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lIe=[sxe,Gle,ixe,lxe,Qle,uxe,dxe,pxe,gxe,vxe,bxe,Cxe,Sxe,Exe,Txe,Axe,Oxe,Fxe,Mxe,nxe,Bxe,Vxe,jxe,Hxe,Xle,Zle,qxe,Hle,Yxe,Jxe,Zxe,tbe,rbe,obe,abe,cbe,hbe,fbe,mbe,ybe,xbe,wbe,Ibe,Sbe,$be,Nbe,Rbe,_be,Abe,Dbe,Fbe,X0e,Mbe,ece,Hbe,tce,Kbe,rce,Zbe,e1e,n1e,oce,ace,s1e,i1e,l1e,u1e,cce,hce,Kle,d1e,Qxe,p1e,g1e,v1e,Y0e,fce,mce,b1e,yce,C1e,k1e,E1e,R1e,A1e,O1e,P1e,xce,L1e,z1e,U1e,W1e,G1e,K1e,X1e,wce,Q1e,ewe,rwe,Ice,kce,iwe,cwe,dwe,Ece,pwe,gwe,ywe,mB,wwe,J0e,Rce,Iwe,kwe,Ewe,Twe,qle,DC,_we,Z0e,exe,txe,Dwe,Pwe,Lwe,zwe,Uwe,Vwe,jwe,Mce,Hwe,Qwe,Zwe,rCe,Bce,oCe,aCe,cCe,Uce,twe,dCe,pCe,gCe,vCe,bCe,CCe,SCe,$Ce,jce,ECe,Hce,qce,TCe,_Ce,DCe,PCe,LCe,Jce,Obe,zCe,UCe,WCe,GCe,KCe,XCe,Nce,rIe,oIe,aIe,mwe];for(const t of lIe)kM(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gB={kernelName:Bv,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(t,xp(fe(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cIe={kernelName:bf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=pt(fe(n,"float32")),s=Yn(Ee(Ze(1),r));return Lt(Ce(t,s))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uIe={kernelName:wf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Yn(Ee(pt(fe(n,"float32")),1));return Ce(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hIe={kernelName:Nu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=_e(n.shape,r.shape);return{a:()=>{let a=t;const l=en(n.shape,s);return l.length>0&&(a=be(a,l)),F(a,n.shape)},b:()=>{let a=t;const l=en(r.shape,s);return l.length>0&&(a=be(a,l)),F(a,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dIe={kernelName:tk,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,s)=>{n[s]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fIe={kernelName:Uv,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>je(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pIe={kernelName:Vv,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>je(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mIe={kernelName:Cf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ce(t,Yn(Ee(Ze(1),pt(fe(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gIe={kernelName:If,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Yn(te(Ze(1),pt(fe(n,"float32"))));return Ce(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yIe={kernelName:$f,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=_e(n.shape,r.shape);return{a:()=>{const a=te(pt(n),pt(r));let l=O(t,Ce(r,a));const c=en(n.shape,s);return c.length>0&&(l=be(l,c)),F(l,n.shape)},b:()=>{const a=te(pt(n),pt(r));let l=Lt(O(t,Ce(n,a)));const c=en(r.shape,s);return c.length>0&&(l=be(l,c)),F(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vIe={kernelName:Sf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ce(t,te(pt(fe(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xIe={kernelName:kf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ce(t,Ee(Ze(1),pt(fe(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bIe(t,e,n,r,s,o){const i=N(t,"dy","avgPool3dGrad"),a=N(e,"input","avgPool3dGrad");let l=i,c=a,u=!1;a.rank===4&&(u=!0,l=F(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=F(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),k(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),k(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),hr("avgPool3dGrad",s,o);const h={dy:l,input:c},d={filterSize:n,strides:r,pad:s,dimRoundingMode:o},f=P.runKernel(ok,h,d);return u?F(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const wIe=L({avgPool3dGrad_:bIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CIe={kernelName:jv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:o,pad:i,dimRoundingMode:a}=n;return{x:()=>wIe(t,r,s,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IIe(t,e,n,r,s){const o=N(t,"dy","avgPoolGrad"),i=N(e,"input","avgPoolGrad");k(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,c=!1;i.rank===3&&(c=!0,a=F(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=F(o,[1,o.shape[0],o.shape[1],o.shape[2]])),k(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),k(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},h={filterSize:n,strides:r,pad:s},d=P.runKernel(sk,u,h);return c?F(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const SIe=L({avgPoolGrad_:IIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kIe={kernelName:Wv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:s,strides:o,pad:i}=n;return{x:()=>SIe(t,r,s,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ie={kernelName:Gv,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,s]=e,{transposeA:o,transposeB:i}=n;return!o&&!i?{a:()=>Ye(t,s,!1,!0),b:()=>Ye(r,t,!0,!1)}:!o&&i?{a:()=>Ye(t,s,!1,!1),b:()=>Ye(t,r,!0,!1)}:o&&!i?{a:()=>Ye(s,t,!1,!0),b:()=>Ye(r,t,!1,!1)}:{a:()=>Ye(s,t,!0,!0),b:()=>Ye(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EIe={kernelName:Hv,gradFunc:(t,e,n)=>{const{blockShape:r,crops:s}=n;return{x:()=>s$(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NIe={kernelName:kee,gradFunc:(t,e,n)=>{const r=n,s=r.inputShape,o=r.shape,i=Array.from(o);for(let l=s.length-1;l>=0;l--)if(s[l]===o[l])i[l]=1;else if(s[l]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>be(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TIe={kernelName:Ef,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RIe={kernelName:Nf,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ie={kernelName:Tf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:s,clipValueMax:o}=n;return{x:()=>Kn(Wo(Cl(r,s),Ru(r,o)),t,je(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AIe={kernelName:Kv,inputsToSave:["x"],gradFunc:gB.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DIe={kernelName:qv,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:s}=n,o=Le(s,e[0].shape)[0],i=r.map(l=>l[o]);return Mr(t,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OIe={kernelName:Xv,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{dilations:o,strides:i,pad:a,dataFormat:l}=n;return k(il(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>Kk(r.shape,t,s,i,a,l),filter:()=>u$(r,t,s.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PIe={kernelName:Yv,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>ll(t,s,o,i,a,1,l),filter:()=>u$(t,r,s.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIe(t,e,n,r,s){let o=t;t.rank===4&&(o=F(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=F(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),k(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),k(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),k(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),k(o.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`),k(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:o,dy:i},l={strides:r,pad:s,filterShape:n};return P.runKernel(ck,a,l)}const LIe=L({conv3DBackpropFilter_:FIe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MIe={kernelName:Qv,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:o}=n;k(il(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[i,a]=e;return{x:()=>s3(i.shape,t,a,s,o),filter:()=>LIe(i,t,a.shape,s,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zIe={kernelName:Rf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(Lt(b3(fe(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BIe={kernelName:_f,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(w3(fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UIe={kernelName:Jv,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s,exclusive:o,reverse:i}=n;return{x:()=>{const a=Et([s],r.rank);let l=i3(t,s,o,!i);return a!=null&&(l=We(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VIe={kernelName:Zv,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:s,pad:o,dimRoundingMode:i}=n,a=r??[1,1];k(il(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return k(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),k(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),k(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),k(Dn(s,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${s} and dilations '${a}'.`),hr("depthwiseConv2d",o,i),{x:()=>Woe(l.shape,t,c,s,o,a,i),filter:()=>Uoe(l,t,c.shape,s,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WIe={kernelName:e0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,s]=e,o={x:r,filter:s,dy:t},i={x:r,filter:s,dy:t};return{x:()=>P.runKernel(nC,o,n),filter:()=>P.runKernel(rC,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jIe={kernelName:Df,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>P.runKernel(yk,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GIe={kernelName:Of,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=O(Vo(Lt(pt(n))),2/Math.sqrt(Math.PI));return{x:()=>O(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HIe={kernelName:Pf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KIe={kernelName:n0,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>F(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qIe={kernelName:Ff,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(t,Vo(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XIe={kernelName:Lf,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YIe={kernelName:Mf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=_e(n.shape,r.shape);return{a:()=>{const a=Ce(t,fe(r,"float32")),l=en(n.shape,s);return l.length>0?F(be(a,l),n.shape):a},b:()=>{let a=O(t,fe(n,"float32"));const l=en(r.shape,s);l.length>0&&(a=F(be(a,l),r.shape));const c=pt(r);return Lt(Ce(a,fe(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QIe={kernelName:r0,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[s,o,i,a]=e,l=a??Ze(1),c=en(o.shape,s.shape),u=[];if(o.rank===1){for(let b=0;b<s.shape.length-1;++b)u.push(s.shape[b]);u.push(1)}const h=Ee(s,o),d=O(t,l),f=y3(te(i,Ze(r))),p=O(O(O(f,f),f),Ze(-.5));return{x:()=>o.rank===1?F(O(O(t,ks(F(f,[1,1,1,o.shape[0]]),u)),l),s.shape):F(O(O(t,f),l),s.shape),mean:()=>{let b=O(O(f,Ze(-1)),d);return o.rank===1&&(b=be(b,c)),F(b,o.shape)},variance:()=>{let b=O(O(p,h),d);return o.rank===1&&(b=be(b,c)),F(b,o.shape)},scale:()=>{const b=O(h,f);let w=O(t,b);return o.rank===1&&(w=be(w,c)),F(w,o.shape)},offset:()=>{let b=t;return o.rank===1&&(b=be(b,c)),F(b,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JIe={kernelName:s0,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,s]=e,{axis:o}=n,i=Le(o,r.shape)[0];return{x:()=>{const l=r.shape,c=s.size,u=l.slice(0,i),h=u.length,d=l.slice(o,l.length).slice(1),f=d.length,p=t_(0,h),m=t_(h+1,h+1+f),y=n_([u,[c],d]),g=F(t,y),v=F(s,[c]),x=n_([[h],p,m]),b=We(g,x);let w=$3(b,v,r.shape[i]);const C=aa(x);return w=We(w,C),w},indices:()=>s}}};function t_(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function n_(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZIe={kernelName:zf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>je(n),b:()=>je(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eSe={kernelName:Bf,gradFunc:t=>({x:()=>fe(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tSe={kernelName:Uf,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nSe={kernelName:Vf,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rSe={kernelName:Wf,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sSe={kernelName:i0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:s}=n,o=jr(r,0);return{x:()=>Kn(o,t,O(t,s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oSe={kernelName:Gf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ce(t,te(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iSe={kernelName:jf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ce(t,fe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aSe={kernelName:$ee,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;return{logits:()=>{const i=Vo(r);return Ee(t,O(be(t,s,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lSe(t,e,n,r=5,s=1,o=1,i=.5){const a={x:t,y:e,dy:n},l={depthRadius:r,bias:s,alpha:o,beta:i};return P.runKernel(Ik,a,l)}const cSe=L({localResponseNormalizationBackprop_:lSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uSe={kernelName:d0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{depthRadius:o,bias:i,alpha:a,beta:l}=n;return{x:()=>cSe(r,s,t,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(t,e,n,r){return e.rank<n.rank&&(e=F(e,Gt(e.shape,r))),t.rank<n.rank&&(t=F(t,Gt(t.shape,r))),{x:()=>O(t,fe(uo(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r_={kernelName:f0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:s}=r,o=e[0],i=e[1],a=Le(s,o.shape),l=yB(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hSe={kernelName:Hf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>O(t,fe(Cl(n,r),"float32")),b:()=>O(t,fe(dy(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dSe(t,e,n,r,s,o,i){const a=N(t,"dy","maxPool3dGrad"),l=N(e,"input","maxPool3dGrad"),c=N(n,"output","maxPool3dGrad");let u=a,h=l,d=c,f=!1;l.rank===4&&(f=!0,u=F(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),h=F(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),d=F(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),k(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),k(h.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),k(d.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${d.rank}.`),hr("maxPool3dGrad",o,i);const p={dy:u,input:h,output:d},m={filterSize:r,strides:s,pad:o,dimRoundingMode:i},y=P.runKernel(kk,p,m);return f?F(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const fSe=L({maxPool3dGrad_:dSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pSe={kernelName:m0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>fSe(t,r,s,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mSe(t,e,n,r,s,o,i){const a=N(t,"dy","maxPoolGrad"),l=N(e,"input","maxPoolGrad"),c=N(n,"output","maxPoolGrad");k(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),k(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),k(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),hr("maxPoolGrad",o,i);const u={dy:a,input:l,output:c},h={filterSize:r,strides:s,pad:o,dimRoundingMode:i};return P.runKernel(Sk,u,h)}const gSe=L({maxPoolGrad_:mSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ySe={kernelName:p0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,s]=e,{filterSize:o,strides:i,pad:a}=n;return{x:()=>gSe(t,r,s,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vSe={kernelName:g0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n,o=Le(s,r.shape),a=cn(r.shape,o)[1],l=Y(a);return{x:()=>{const u=r.shape.slice();o.forEach(f=>{u[f]=1});const h=F(t,u);return Ce(O(h,Il(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xSe={kernelName:y0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:s}=r,[o,i]=e,a=Le(s,o.shape),l=yB(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bSe={kernelName:Kf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>O(t,fe(Ru(n,r),"float32")),b:()=>O(t,fe(jr(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wSe={kernelName:v0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,o=s.map(i=>i[0]);return{x:()=>ct(t,o,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CSe={kernelName:qf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=_e(n.shape,r.shape);return{a:()=>{const a=en(n.shape,s);return a.length>0?F(be(t,a),n.shape):t},b:()=>{const a=O(t,Lt(q0(Ce(n,r)))),l=en(r.shape,s);return l.length>0?F(be(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ISe={kernelName:Xf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=_e(n.shape,r.shape);return{a:()=>{const a=O(t,fe(r,"float32")),l=en(n.shape,s);return l.length>0?F(be(a,l),n.shape):a},b:()=>{const a=O(t,fe(n,"float32")),l=en(r.shape,s);return l.length>0?F(be(a,l),r.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SSe={kernelName:x0,gradFunc:t=>({x:()=>Lt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kSe={kernelName:C0,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>sn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Se={kernelName:w0,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ESe={kernelName:I0,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return ul(t,r).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_={kernelName:S0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:s}=n,o=s.map(i=>i[0]);return{x:()=>ct(t,o,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NSe={kernelName:Yf,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,s]=e,o=n,i=r,a=_e(o.shape,i.shape);return{a:()=>{const u=fe(i,"float32");let h=O(t,O(u,qc(o,Ee(u,Ze(1)))));const d=en(o.shape,a);return d.length>0&&(h=be(h,d)),F(h,o.shape)},b:()=>{const u=jr(o,0),h=Kn(u,ho(o),je(o));let d=O(t,O(s,h));const f=en(i.shape,a);return f.length>0&&(d=be(d,f)),F(d,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TSe={kernelName:k0,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,s=jr(n,0);return{x:()=>Kn(s,t,O(t,r)),alpha:()=>{let o=Kn(s,je(t),O(t,n));const i=en(r.shape,t.shape);return i.length>0&&(o=be(o,i)),F(o,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSe(t,e,n){const r=t.shape.slice();r[n]=1;const s=F(e,r),o=vC(t,n,!0,!1),i=vC(t,n,!0,!0),a=O(o,i);return O(s,a)}function _Se(t,e,n){const r=t.shape.length,s=r-n.length,o=Et(n,r);let i=t;o!=null&&(i=We(t,o));const a=i.shape.slice(),c=a.splice(r-n.length,n.length).reduce((d,f)=>d*f,1);a.push(c);const u=i.reshape(a);let h=RSe(u,e,s);if(h=h.reshape(i.shape),o!=null){const d=aa(o);h=We(h,d)}return h}const ASe={kernelName:$0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:s}=n;let o=[];return s==null?o=r.shape.map((i,a)=>a):typeof s=="number"?o=[s]:o=s,{x:()=>_Se(r,t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DSe={kernelName:Af,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=_e(n.shape,r.shape);return{a:()=>{const a=Ce(t,fe(r,"float32")),l=en(n.shape,s);return l.length>0?F(be(a,l),n.shape):a},b:()=>{let a=O(t,fe(n,"float32"));const l=en(r.shape,s);l.length>0&&(a=F(be(a,l),r.shape));const c=pt(r);return Lt(Ce(a,fe(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OSe={kernelName:Qf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ce(t,Lt(pt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PSe={kernelName:Zf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=O(Ru(n,6),xp(n));return{x:()=>O(t,fe(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FSe={kernelName:Jf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(t,fe(xp(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LSe={kernelName:E0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MSe={kernelName:T0,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>P.runKernel(Ak,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zSe={kernelName:N0,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,s={dy:t,images:r};return{images:()=>P.runKernel(_k,s,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BSe={kernelName:R0,gradFunc:(t,e,n)=>{const{dims:r}=n,s=Le(r,t.shape);return{x:()=>cl(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const USe={kernelName:ep,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VSe={kernelName:tp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Lt(Ce(t,O(qc(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WSe={kernelName:_0,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>fe(je(n),"float32"),t:()=>O(t,fe(n,t.dtype)),e:()=>O(t,fe(e$(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jSe={kernelName:np,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=jr(n,Ze(0)),s=Ze(Q0),o=Ze(J0),i=O(t,o),a=O(O(t,s),Vo(fe(n,"float32")));return Kn(r,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GSe={kernelName:ip,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(t,O(n,Ee(Ze(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HSe={kernelName:op,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KSe={kernelName:rp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(qk(fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qSe={kernelName:sp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(o3(fe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XSe={kernelName:A0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:s,size:o}=n,i=r.shape,[a,l]=X0(r,s,o),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],i[u]-a[u]-l[u]]);return{x:()=>r$(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YSe={kernelName:F0,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:s}=n,o=!0,i=O(t,r);return{logits:()=>Ee(i,O(be(i,[s],o),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QSe={kernelName:ap,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(t,Tu(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o_={kernelName:O0,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:s}=n;return{x:()=>Hk(t,r,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i_={kernelName:P0,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>ir(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JSe={kernelName:lp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ce(t,O(Yn(fe(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZSe={kernelName:Dk,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(t,O(fe(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eke={kernelName:cp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=Ze(2);return{a:()=>O(t,O(s,Ee(n,r))),b:()=>O(t,O(s,Ee(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tke={kernelName:pp,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nke={kernelName:up,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,s=_e(n.shape,r.shape);return{a:()=>{let a=t;const l=en(n.shape,s);return l.length>0&&(a=be(a,l)),F(a,n.shape)},b:()=>{let a=t;const l=en(r.shape,s);return l.length>0&&(a=be(a,l)),F(Lt(a),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rke={kernelName:D0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,s=r.shape.slice(),{axis:o}=n;Le(o,r.shape).forEach(c=>{s[c]=1});const a=F(t,s),l=O(a,Il(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ske={kernelName:hp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ce(t,pt(qk(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oke={kernelName:dp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>O(Ee(Ze(1),pt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ike={kernelName:fp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:s}=n;return{x:()=>{let i=je(r);if(r.rank===1)for(let a=0;a<s[0];++a)i=te(i,ct(t,[a*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)i=te(i,ct(t,[a*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let c=0;c<s[2];++c)i=te(i,ct(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let a=0;a<s[0];++a)for(let l=0;l<s[1];++l)for(let c=0;c<s[2];++c)for(let u=0;u<s[3];++u)i=te(i,ct(t,[a*r.shape[0],l*r.shape[1],c*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ake={kernelName:vc,gradFunc:(t,e,n)=>{const r=n,{perm:s}=r,o=aa(s);return{x:()=>We(t,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lke={kernelName:L0,gradFunc:(t,e,n)=>{const r=n,{axis:s}=r;return{value:()=>Ki(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cke={kernelName:M0,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>uke(t,n)}}};function uke(t,e){const n=la(e,je(e)),r=Qk(t,n);let s=Cl(e,Ze(0,"int32"));const o=r.rank-s.rank;for(let a=0;a<o;++a)s=gr(s,a+1);s=Wo(s,Il(r.shape,"bool"));const i=je(r);return Kn(s,r,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hke={kernelName:z0,gradFunc:t=>({x:()=>je(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dke=[gB,cIe,uIe,hIe,dIe,fIe,pIe,mIe,gIe,yIe,vIe,xIe,CIe,kIe,$Ie,EIe,NIe,TIe,RIe,_Ie,AIe,DIe,PIe,OIe,MIe,zIe,BIe,UIe,VIe,WIe,DSe,jIe,GIe,HIe,KIe,qIe,YIe,XIe,QIe,JIe,ZIe,eSe,tSe,nSe,rSe,sSe,oSe,iSe,aSe,uSe,r_,r_,hSe,pSe,ySe,vSe,xSe,bSe,wSe,CSe,ISe,SSe,kSe,$Se,ESe,s_,s_,NSe,TSe,ASe,OSe,PSe,FSe,LSe,MSe,zSe,BSe,USe,VSe,WSe,jSe,GSe,HSe,KSe,qSe,XSe,YSe,QSe,o_,o_,i_,i_,JSe,eke,ZSe,tke,nke,rke,ske,oke,ike,ake,lke,cke,hke];for(const t of dke)Tee(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.abs=function(){return this.throwIfDisposed(),zn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.acos=function(){return this.throwIfDisposed(),Ate(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.acosh=function(){return this.throwIfDisposed(),Ote(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.add=function(t){return this.throwIfDisposed(),te(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.all=function(t,e){return this.throwIfDisposed(),t3(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.any=function(t,e){return this.throwIfDisposed(),gC(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.argMax=function(t){return this.throwIfDisposed(),Nd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.argMin=function(t){return this.throwIfDisposed(),zte(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.asScalar=function(){return this.throwIfDisposed(),k(this.size===1,()=>"The array must have only 1 element."),F(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.asType=function(t){return this.throwIfDisposed(),fe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as1D=function(){return this.throwIfDisposed(),F(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as2D=function(t,e){return this.throwIfDisposed(),F(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),F(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),F(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.as5D=function(t,e,n,r,s){return this.throwIfDisposed(),F(this,[t,e,n,r,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.asin=function(){return this.throwIfDisposed(),Ute(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.asinh=function(){return this.throwIfDisposed(),Wte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.atan=function(){return this.throwIfDisposed(),Gte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.atan2=function(t){return this.throwIfDisposed(),Kte(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.atanh=function(){return this.throwIfDisposed(),Xte(this)};X().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),jk(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Hk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.batchNorm=function(t,e,n,r,s){return this.throwIfDisposed(),j0(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Ah(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cast=function(t){return this.throwIfDisposed(),fe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.ceil=function(){return this.throwIfDisposed(),Cne(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Ur(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Wt&&(t=[t]),ir([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.conv1d=function(t,e,n,r,s,o){return this.throwIfDisposed(),n3(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.conv2dTranspose=function(t,e,n,r,s){return this.throwIfDisposed(),r3(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.conv2d=function(t,e,n,r,s,o){return this.throwIfDisposed(),ll(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cos=function(){return this.throwIfDisposed(),qk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cosh=function(){return this.throwIfDisposed(),o3(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),vC(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),i3(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Kne(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.depthwiseConv2d=function(t,e,n,r,s,o){return this.throwIfDisposed(),Xk(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.dilation2d=function(t,e,n,r,s){return this.throwIfDisposed(),Yne(this,t,e,n,r,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.divNoNan=function(t){return this.throwIfDisposed(),tre(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.div=function(t){return this.throwIfDisposed(),Ce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.dot=function(t){return this.throwIfDisposed(),rre(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.elu=function(){return this.throwIfDisposed(),H0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.equal=function(t){return this.throwIfDisposed(),uo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.erf=function(){return this.throwIfDisposed(),ire(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),mre(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.exp=function(){return this.throwIfDisposed(),Vo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.expandDims=function(t){return this.throwIfDisposed(),gr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.expm1=function(){return this.throwIfDisposed(),xre(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.fft=function(){return this.throwIfDisposed(),I3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.flatten=function(){return this.throwIfDisposed(),F(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.floor=function(){return this.throwIfDisposed(),q0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.floorDiv=function(t){return this.throwIfDisposed(),e3(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Qk(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Cl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.greater=function(t){return this.throwIfDisposed(),jr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.ifft=function(){return this.throwIfDisposed(),$C(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.irfft=function(){return this.throwIfDisposed(),hoe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.isFinite=function(){return this.throwIfDisposed(),Nre(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.isInf=function(){return this.throwIfDisposed(),Rre(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.isNaN=function(){return this.throwIfDisposed(),Are(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Zk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.lessEqual=function(t){return this.throwIfDisposed(),Ru(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.less=function(t){return this.throwIfDisposed(),dy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),Lre(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logSigmoid=function(){return this.throwIfDisposed(),jre(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logSoftmax=function(t){return this.throwIfDisposed(),h3(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),qre(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.log=function(){return this.throwIfDisposed(),ho(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.log1p=function(){return this.throwIfDisposed(),u3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Wo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logicalNot=function(){return this.throwIfDisposed(),e$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logicalOr=function(t){return this.throwIfDisposed(),d3(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.logicalXor=function(t){return this.throwIfDisposed(),Zre(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Ye(this,t,e,n)};X().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),t$(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.max=function(t,e){return this.throwIfDisposed(),Ts(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.maximum=function(t){return this.throwIfDisposed(),la(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.mean=function(t,e){return this.throwIfDisposed(),jt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.min=function(t,e){return this.throwIfDisposed(),hy(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.minimum=function(t){return this.throwIfDisposed(),_d(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),ase(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.mod=function(t){return this.throwIfDisposed(),cse(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.mul=function(t){return this.throwIfDisposed(),O(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.neg=function(){return this.throwIfDisposed(),Lt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.norm=function(t,e,n){return this.throwIfDisposed(),K0(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.notEqual=function(t){return this.throwIfDisposed(),fy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),f3(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.onesLike=function(){return this.throwIfDisposed(),cs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.pad=function(t,e){return this.throwIfDisposed(),r$(this,t,e)};X().prototype.pool=function(t,e,n,r,s,o){return this.throwIfDisposed(),xse(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.pow=function(t){return this.throwIfDisposed(),qc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.prelu=function(t){return this.throwIfDisposed(),o$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.prod=function(t,e){return this.throwIfDisposed(),Cse(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.reciprocal=function(){return this.throwIfDisposed(),Gse(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.relu=function(){return this.throwIfDisposed(),kl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.relu6=function(){return this.throwIfDisposed(),m3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.reshapeAs=function(t){return this.throwIfDisposed(),F(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.reshape=function(t){return this.throwIfDisposed(),F(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),N3(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),T3(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.reverse=function(t){return this.throwIfDisposed(),cl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.rfft=function(){return this.throwIfDisposed(),poe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.round=function(){return this.throwIfDisposed(),g3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.rsqrt=function(){return this.throwIfDisposed(),y3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.selu=function(){return this.throwIfDisposed(),v3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.separableConv2d=function(t,e,n,r,s,o){return this.throwIfDisposed(),x3(this,t,e,n,r,s,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sigmoid=function(){return this.throwIfDisposed(),Tu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sign=function(){return this.throwIfDisposed(),eoe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sin=function(){return this.throwIfDisposed(),b3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sinh=function(){return this.throwIfDisposed(),w3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.slice=function(t,e){return this.throwIfDisposed(),ct(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.softmax=function(t){return this.throwIfDisposed(),c$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.softplus=function(){return this.throwIfDisposed(),gp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),s$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.split=function(t,e){return this.throwIfDisposed(),Mr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sqrt=function(){return this.throwIfDisposed(),Yn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.square=function(){return this.throwIfDisposed(),pt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.squaredDifference=function(t){return this.throwIfDisposed(),goe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.squeeze=function(t){return this.throwIfDisposed(),vp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Wt?[this,t]:[this,...t];return Ki(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.step=function(t){return this.throwIfDisposed(),xp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.stridedSlice=function(t,e,n,r,s,o,i,a){return this.throwIfDisposed(),woe(this,t,e,n,r,s,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sub=function(t){return this.throwIfDisposed(),Ee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.sum=function(t,e){return this.throwIfDisposed(),be(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.tan=function(){return this.throwIfDisposed(),Ioe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.tanh=function(){return this.throwIfDisposed(),Gk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.tile=function(t){return this.throwIfDisposed(),ks(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.toBool=function(){return this.throwIfDisposed(),fe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.toFloat=function(){return this.throwIfDisposed(),fe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.toInt=function(){return this.throwIfDisposed(),fe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.topk=function(t,e){return this.throwIfDisposed(),$oe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.transpose=function(t){return this.throwIfDisposed(),We(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.unique=function(t){return this.throwIfDisposed(),Toe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),$3(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.unstack=function(t){return this.throwIfDisposed(),ul(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.where=function(t,e){return this.throwIfDisposed(),Kn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */X().prototype.zerosLike=function(){return this.throwIfDisposed(),je(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class js extends Error{constructor(e){super(e),Object.setPrototypeOf(this,js.prototype)}}class rs extends Error{constructor(e){super(e),Object.setPrototypeOf(this,rs.prototype)}}class _ extends Error{constructor(e){super(e),Object.setPrototypeOf(this,_.prototype)}}class Ae extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ae.prototype)}}class uE extends Error{constructor(e){super(e),Object.setPrototypeOf(this,uE.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vB{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pl(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Gs(t,e){if(!t)throw new uE(e)}function a_(t,e){let n=0;for(const r of t)r===e&&n++;return n}function tr(t){return t.length===1?t[0]:t}function ht(t){return Array.isArray(t)?t:[t]}function xo(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Sa(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Kr={};function hE(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function PC(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>PC(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:PC(r))}}}function Rp(t,e={},n={},r="object",s=!1){if(typeof t=="string"){const o=t;let i;if(o in n)i=n[o];else if(o in Kr)i=Kr[o];else if(i=e[o],i==null)throw new _(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=t;if(o.className==null||o.config==null)throw new _(`${r}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in n?[a,l]=n[i]:i in Kr?[a,l]=Kr.className:i in e&&([a,l]=e[i]),a==null)throw new _(`Unknown ${r}: ${i}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(Kr))c[f]=Kr[f];for(const f of Object.keys(n))c[f]=n[f];const u=o.config;u.customObjects=c;const h=Object.assign({},Kr);for(const f of Object.keys(n))Kr[f]=n[f];PC(o.config);const d=l(a,o.config,n,s);return Kr=Object.assign({},h),d}else{const c=Object.assign({},Kr);for(const h of Object.keys(n))Kr[h]=n[h];const u=new a(o.config);return Kr=Object.assign({},c),u}}}function fke(t,e){return t<e?-1:t>e?1:0}function km(t,e){return-1*fke(t,e)}function Mi(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function pke(t){if(t==null)throw new _(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function _l(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new _(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function dE(t,e,n=0,r=1/0){return Gs(n>=0),Gs(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(s=>typeof s===e)}function an(t,e){Array.isArray(t)?(k(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>an(n,`element ${r+1} of ${e}`))):k(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${xB(t)}.`)}function xB(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>xB(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function mke(t,e,n){let r=n!=null?n():er(),s;return(...i)=>{const a=n!=null?n():er();return a-r<e||(r=a,s=t(...i)),s}}function bB(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let gke=0;function wB(){return gke++}const $m={};function ix(t=""){return t in $m||($m[t]=0),$m[t]+=1,t+$m[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const yke=["channelsFirst","channelsLast"],vke=["nearest","bilinear"],xke=["valid","same","causal"],bke=["max","avg"],wke=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Fl=new Map;function Ut(t){_l(yke,"DataFormat",t)}function Cke(t){_l(vke,"InterpolationFormat",t)}function Gr(t){_l(xke,"PaddingMode",t)}function CB(t){_l(bke,"PoolMode",t)}const Dh=[],l_="/";function Va(t,e){Dh.push(t);try{const n=e();return Dh.pop(),n}catch(n){throw Dh.pop(),n}}function Ike(){return Dh.length===0?"":Dh.join(l_)+l_}function IB(t){if(!kB(t))throw new Error("Not a valid tensor name: '"+t+"'");return Ike()+t}function SB(t){if(!kB(t))throw new Error("Not a valid tensor name: '"+t+"'");Fl.has(t)||Fl.set(t,0);const e=Fl.get(t);if(Fl.set(t,Fl.get(t)+1),e>0){const n=`${t}_${e}`;return Fl.set(n,1),n}else return t}const Ske=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function kB(t){return!!t.match(Ske)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kke(t){return t===parseInt(t.toString(),10)}function zi(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let s=e;s<n;++s)r*=t[s];return r}function nu(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function Xi(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function Ps(t,e){if(e<t)throw new _(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Rb;function Yt(){return Rb==null&&(Rb=kte().epsilon()),Rb}function Fs(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function io(t,e){return fe(t,e)}function _p(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),F(t,n)}function $ke(t,e){return j(()=>{if(t.shape.length!==2)throw new _(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=_p(t,1);return FC(n,[1,e,1])})}function Eke(t){const e=[zi(t.shape)];return F(t,e)}function Nke(t){if(t.rank<=1)throw new _(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],zi(t.shape,1)];return F(t,e)}function Wa(t,e,n){return j(()=>{switch(t.rank){case 1:return a$(t,e,n);case 2:return C3(t,[e,0],[n,t.shape[1]]);case 3:return l$(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return my(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return ct(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return ct(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new _(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function _b(t,e,n){return j(()=>{switch(t.rank){case 1:return a$(t,e,n);case 2:return C3(t,[0,e],[t.shape[0],n]);case 3:return l$(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return my(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new _(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Em(t,e,n,r){return j(()=>{switch(t.rank){case 1:return a$(t,e,n);case 2:switch(r){case 1:return Wa(t,e,n);case 2:return _b(t,e,n);default:throw new _(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Wa(t,e,n);case 2:return l$(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return _b(t,e,n);default:throw new _(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Wa(t,e,n);case 2:return my(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return my(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return _b(t,e,n);default:throw new _(`The axis is not within the rank of the tensor ${r}`)}default:throw new _(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function fE(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),ir(t,e)}function c_(t,e){switch(t.rank){case 1:return kne([t,e]);case 2:return Ene([t,e],0);case 3:return Tne([t,e],0);case 4:return _ne([t,e],0);default:throw new _(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function FC(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new _(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return ks(t,e)}function ax(t,e=0,n=1,r,s){return Use(t,e,n,r,s)}function ao(t,e,n,r){if(t.rank<2||e.rank<2)throw new Ae(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const s=t.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(s!==o)throw new Ae(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return fR({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?LC(t.rank,r,Fs()):null,activation:n});{const s=t.shape.slice(),o=s.pop();t=F(t,[-1,o]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),c=[...i,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=F(We(e,u),[l,-1]);const h=[...s,...c];return F(fR({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?LC(t.rank,r,Fs()):null,activation:n}),h)}}function $B(t,e,n){return j(()=>(Array.isArray(e)?e=Or(e,"int32"):e=fe(e,"int32"),Qk(t,e,n)))}function Ap(t){return O(t,t)}function LC(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new _(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?F(e,[1,r[0],1,1,1]):F(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?F(e,[1,1,1,1,r[0]]):F(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?F(e,[1,r[0],1,1]):F(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?F(e,[1,1,1,r[0]]):F(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?F(e,[1,r[0],1]):F(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?F(e,[1,1,r[0]]):F(e,[1].concat(r))}else if(t<3)return e;throw new _(`Unsupported input rank by biasAdd: ${e.rank}`)}function Ms(t,e,n){return j(()=>(n==null&&(n=Fs()),Ut(n),te(t,LC(t.rank,e,n))))}function Tke(t,e=1){if(e!==1)throw new Ae(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return H0(t)}function Rke(t){return j(()=>Ce(t,te(zn(t),1)))}function EB(t,e,n,r){return j(()=>Foe(t,e,n,r))}function _ke(t){return j(()=>{const e=te(.5,O(.2,t));return Ur(e,0,1)})}function Dp(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ake=["fanIn","fanOut","fanAvg"],Dke=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oke(t){_l(Ake,"FanMode",t)}function Pke(t){_l(Dke,"Distribution",t)}class ds extends Au{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class NB extends ds{apply(e,n){return sn(e,n)}}NB.className="Zeros";Z(NB);class pE extends ds{apply(e,n){return Il(e,n)}}pE.className="Ones";Z(pE);class TB extends ds{constructor(e){if(super(),typeof e!="object")throw new _(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new _(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return j(()=>O(Ze(this.value),Il(e,n)))}getConfig(){return{value:this.value}}}TB.className="Constant";Z(TB);class RB extends ds{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return yp(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}RB.className="RandomUniform";Z(RB);class _B extends ds{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ae(`randomNormal does not support dType ${n}.`);return ax(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}_B.className="RandomNormal";Z(_B);class AB extends ds{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ae(`truncatedNormal does not support dType ${n}.`);return k3(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}AB.className="TruncatedNormal";Z(AB);class DB extends ds{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return j(()=>{if(e.length!==2||e[0]!==e[1])throw new _("Identity matrix initializer can only be used for 2D square matrices.");return O(this.gain,c3(e[0]))})}getConfig(){return{gain:this.gain}}}DB.className="Identity";Z(DB);function Fke(t,e="channelsLast"){let n,r;if(Ut(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const s=zi(t,2);n=t[1]*s,r=t[0]*s}else if(e==="channelsLast"){const s=zi(t,0,t.length-2);n=t[t.length-2]*s,r=t[t.length-1]*s}}else{const s=zi(t);n=Math.sqrt(s),r=Math.sqrt(s)}return[n,r]}class Er extends ds{constructor(e){if(super(),e.scale<0)throw new _(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Oke(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Pke(this.distribution),this.seed=e.seed}apply(e,n){const r=Fke(e),s=r[0],o=r[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,s):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(s+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ae(`${this.getClassName()} does not support dType ${n}.`);return k3(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return yp(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Er.className="VarianceScaling";Z(Er);class mE extends Er{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Er.className}}mE.className="GlorotUniform";Z(mE);class gE extends Er{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Er.className}}gE.className="GlorotNormal";Z(gE);class yE extends Er{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Er.className}}yE.className="HeNormal";Z(yE);class vE extends Er{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Er.className}}vE.className="HeUniform";Z(vE);class xE extends Er{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Er.className}}xE.className="LeCunNormal";Z(xE);class bE extends Er{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Er.className}}bE.className="LeCunUniform";Z(bE);class OB extends ds{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return j(()=>{if(e.length<2)throw new Ae("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=Y(e.slice(0,-1)),s=e[e.length-1],o=r*s;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const i=[Math.max(s,r),Math.min(s,r)],a=ax(i,0,1,n,this.seed),l=Rie.qr(a,!1);let c=l[0];const h=l[1].flatten().stridedSlice([0],[Math.min(s,r)*Math.min(s,r)],[Math.min(s,r)+1]);return c=O(c,h.sign()),r<s&&(c=c.transpose()),O(Ze(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}OB.className="Orthogonal";Z(OB);const u_={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function h_(t,e={}){return Rp(t,Qr.getMap().classNameMap,e,"initializer")}function $t(t){return hE(t)}function bt(t){if(typeof t=="string"){const e=t in u_?u_[t]:t;if(e==="GlorotNormal")return new gE;if(e==="GlorotUniform")return new mE;if(e==="HeNormal")return new yE;if(e==="HeUniform")return new vE;if(e==="LeCunNormal")return new xE;if(e==="LeCunUniform")return new bE;{const n={};return n.className=e,n.config={},h_(n)}}else return t instanceof ds?t:h_(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function MC(t){return Array.isArray(t)&&Array.isArray(t[0])}function ky(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function $e(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new _(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ke(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new _(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $y(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,s)=>r*s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const d_="Variable";class Lke{constructor(e,n="float32",r=d_,s=!0,o=null){this.dtype=n??"float32",this.shape=e.shape,this.id=wB(),r=r??d_,this.originalName=IB(r),this.name=SB(this.originalName),this.trainable_=s,this.constraint=o,this.val=Aoe(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Mke(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Mke(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function zC(t){return t.map(e=>e.read())}function wE(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Qt{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Js{constructor(e,n,r,s,o,i,a){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=s,this.callArgs=o,this.outputTensorIndex=a,this.id=wB(),i!=null&&(this.originalName=IB(i),this.name=SB(this.originalName)),this.rank=n.length}}let zke=0;class lx{constructor(e,n){this.callArgs=n,this.id=zke++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Bke=0;class Me extends Au{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Bke++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=xo(r)+"_"+ix(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),r=[o].concat(e.inputShape)}this.batchInputShape=r;let s=e.dtype;s==null&&(s=e.inputDType),s==null&&(s="float32"),this.dtype=s}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new rs(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new _(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return tr(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return tr(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new js(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new js(`Layer ${this.name} is not connected, no input to return.`);return tr(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new js(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new js(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return tr(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=ht(e),this.inputSpec==null||this.inputSpec.length===0)return;const n=ht(this.inputSpec);if(e.length!==n.length)throw new _(`Layer ${this.name} expects ${n.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let r=0;r<e.length;r++){const s=e[r],o=n[r];if(o==null)continue;const i=s.rank;if(o.ndim!=null&&i!==o.ndim)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${i}`);if(o.maxNDim!=null&&i>o.maxNDim)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${i}`);if(o.minNDim!=null&&i<o.minNDim)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${i}.`);if(o.dtype!=null&&s.dtype!==o.dtype)throw new _(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${s.dtype}.`);if(o.axes){const a=s.shape;for(const l in o.axes){const c=Number(l),u=o.axes[l],h=c>=0?a[c]:a[a.length+c];if(u!=null&&[u,null].indexOf(h)===-1)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${u} but got shape ${a}.`)}}if(o.shape!=null)for(let a=0;a<o.shape.length;++a){const l=o.shape[a],c=s.shape[a];if(l!=null&&c!=null&&l!==c)throw new _(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${s.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=ht(e);let s=!0;for(const i of r)if(!(i instanceof Js)){s=!1;break}let o=!0;for(const i of r)if(i instanceof Js){o=!1;break}if(s===o)throw new _("Arguments to apply() must be all SymbolicTensors or all Tensors");return Va(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of ht(e))i.push(a.shape);this.build(tr(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,n);const a=ht(i),l=[];for(let c of a)r.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=tr(l),this.activityRegularizer!=null)throw new Ae("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=Uke(e),a=this.computeOutputShape(i);let l;const c=Vke(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,h)=>new Js(c,u,this,ht(e),n,this.name,h)):l=new Js(c,a,this,ht(e),n,this.name),this.addInboundNode(e,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new Ae("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,s)=>{r!=null&&e[s]!=null&&e[s]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new js(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new js(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new rs(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return $y(this.weights)}build(e){this.built=!0}getWeights(e=!1){return zC(e?this.trainableWeights:this.weights)}setWeights(e){j(()=>{const n=this.weights;if(n.length!==e.length)throw new _(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],s=zC(n);for(let o=0;o<s.length;++o){const i=s[o],a=n[o],l=e[o];if(!Qe(i.shape,l.shape))throw new _(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);r.push([a,l])}wE(r)})}addWeight(e,n,r,s,o,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new _(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(s=l!=null?l():bt("zeros"));const c=s.apply(n,r),u=new Lke(c,r,e,i,a);return c.dispose(),o!=null&&this.addLoss(()=>o.apply(u.read())),i==null&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=ht(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}addInboundNode(e,n,r,s,o,i,a=null){const l=ht(e);n=ht(n),r=ht(r),s=ht(s),o=ky(o),i=ky(i);const c=[],u=[],h=[];for(const d of l)c.push(d.sourceLayer),u.push(d.nodeIndex),h.push(d.tensorIndex);new lx({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:h,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:s,inputShapes:o,outputShapes:i},a);for(let d=0;d<n.length;d++)n[d].sourceLayer=this,n[d].nodeIndex=this.inboundNodes.length-1,n[d].tensorIndex=d}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Uke(t){t=ht(t);const e=[];for(const n of t)e.push(n.shape);return tr(e)}function Vke(t){return"float32"}function PB(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const s=[];for(let o=0;o<r.inboundLayers.length;o++){const i=r.inputTensors[o],a=r.inboundLayers[o],l=r.nodeIndices[o],c=PB(i,a,l);for(const u of c)s.indexOf(u)===-1&&s.push(u)}return s}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Op extends Me{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:ix("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new _("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new _("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new _("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const s=new Js(this.dtype,this.batchInputShape,this,[],{},this.name);s.nodeIndex=0,s.tensorIndex=0,new lx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[s],outputTensors:[s],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new _(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Op.className="InputLayer";Z(Op);function Wke(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new _("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Op({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jke(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return fe(e,t.dtype)}catch{throw new _(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class wi{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof wi)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=jke(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new _(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Js){if(this.id2Value[e.id]==null)throw new _(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new _(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Js){if(this.id2Value[e.id]==null)throw new _(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new _(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&ze(this.id2Mask)}}const Ey=new vB,Ny=new vB;function Gke(t){Ey!=null&&Ey.setMaxEntries(t),Ny!=null&&Ny.setMaxEntries(t)}function mh(t,e,n,r){const s=n==null?!1:n.training,o=Array.isArray(t),i=o?t:[t],a=i.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const u=a.join(",")+"|"+e.names().sort().join(",");let h=Ey.get(u),d;if(h==null){const p=Hke(i,e);h=p.sorted,d=p.recipientCounts,Ey.put(u,h),Ny.put(u,d)}d={},s||Object.assign(d,Ny.get(u));const f=new wi(e);for(let p=0;p<h.length;++p){if(r!=null){const $=mC().numTensors;$>r.maxNumTensors&&(r.maxNumTensors=$),$<r.minNumTensors&&(r.minNumTensors=$)}const m=h[p],y=m.sourceLayer;if(y instanceof Op)continue;const g=[],v=[],x=[];let b=!1;for(const $ of m.inputs){const E=f.getValue($),A=f.getMask($);g.push(E),v.push(A),A!=null&&(b=!0),s||(d[$.name]--,d[$.name]===0&&!e.hasKey($)&&a.indexOf($.name)===-1&&!E.isDisposed&&$.sourceLayer.stateful!==!0&&x.push(E))}b&&(n=n||{},n.mask=v[0]);const w=ht(y.apply(g,n));let C=null;y.supportsMasking&&(C=y.computeMask(g,v));const I=qke(m),S=Array.isArray(I)?I:[I];for(let $=0;$<S.length;++$){f.hasKey(S[$])||f.add(S[$],w[$],Array.isArray(C)?C[0]:C);const E=a.indexOf(S[$].name);E!==-1&&(l[E]=w[$])}s||ze(x)}return f.disposeMasks(),o?l:l[0]}function Hke(t,e){k(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const s=f_(t[0],e);n=s.sorted,r=s.recipientMap}else{const s=new Set;for(const o of t){const{sorted:i,recipientMap:a}=f_(o,e);for(const l of i)s.has(l.name)||(n.push(l),s.add(l.name));for(const l in a)r[l]==null&&(r[l]=new Set),a[l].forEach(c=>r[l].add(c))}}return{sorted:n,recipientCounts:Kke(r)}}function Kke(t){const e={};for(const n in t)e[n]=t[n].size;return e}function f_(t,e){const n=new Set,r=[],s={};for(const a of e.names())n.add(a);const o=[],i=[];for(o.push(t);o.length>0;){const a=o[o.length-1];if(n.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),r.push(a),n.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const c of a.inputs)s[c.name]==null&&(s[c.name]=new Set),s[c.name].add(a.name),!n.has(c.name)&&o.push(c)}}return{sorted:r,recipientMap:s}}function qke(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const s of t.sourceLayer.inboundNodes[r].outputTensors)if(s.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xke=G();Xke.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Gke);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function CE(t,e){return j(()=>Yn(be(O(t,t),e,!0)))}class Pp extends Au{getConfig(){return{}}}class FB extends Pp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return j(()=>{const n=CE(e,this.axis),r=Ur(n,0,this.maxValue);return O(e,Ce(r,te(Yt(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}FB.className="MaxNorm";Z(FB);class LB extends Pp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return j(()=>Ce(e,te(Yt(),CE(e,this.axis))))}getConfig(){return{axis:this.axis}}}LB.className="UnitNorm";Z(LB);class MB extends Pp{apply(e){return kl(e)}}MB.className="NonNeg";Z(MB);class zB extends Pp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return j(()=>{const n=CE(e,this.axis),r=te(O(this.rate,Ur(n,this.minValue,this.maxValue)),O(1-this.rate,n));return O(e,Ce(r,te(Yt(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}zB.className="MinMaxNorm";Z(zB);const p_={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Jt(t){return hE(t)}function m_(t,e={}){return Rp(t,Qr.getMap().classNameMap,e,"constraint")}function Zt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in p_?p_[t]:t,config:{}};return m_(n)}else return t instanceof Pp?t:m_(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function ga(t){if(t==null)return;const e=[],n=[],r=[];for(const s in t){const o=t[s];if(typeof o!="number"){const i=o;e.push(i.data()),n.push(s),r.push(i)}}if(e.length>0){const s=await Promise.all(e);for(let o=0;o<s.length;++o)t[n[o]]=s[o][0];ze(r)}}function BB(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var g_;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(g_||(g_={}));const Yke=125;class Ld{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Qke{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class Jke extends Ld{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const s in n){const o=n[s];if(typeof o=="number")this.totals.hasOwnProperty(s)||(this.totals[s]=0),this.totals[s]=this.totals[s]+o*r;else{let i;s in this.totals?i=this.totals[s]:this.totals[s]=0;const a=j(()=>te(this.totals[s],O(o,r)));this.totals[s]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:j(()=>{const s=O(Ce(1,this.seen),this.totals[r]);n[r]=s,this.totals[r].dispose(),so(n[r])}))}}class Zke extends Ld{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),n.push(o),r.push(a)}}const s=await Promise.all(e);for(let o=0;o<s.length;++o)this.history[n[o]][r[o]].dispose(),this.history[n[o]][r[o]]=s[o][0]}}class e$e extends Ld{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||G3,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Yke),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Zw(this.yieldEvery)&&(this.maybeWait=mke(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const s=[];this.yield!=null&&(await ga(r),s.push(this.yield(e,n,r))),s.push(this.nextFrameFunc()),await Promise.all(s)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await ga(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await ga(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await ga(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await ga(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):Zw(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await ga(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await ga(e),await this.trainEnd(e))}}function UB(t,e){return t==null&&(t={}),t instanceof Ld?[t]:Array.isArray(t)&&t[0]instanceof Ld?t:ht(t).map(r=>new e$e(r,e))}class qr{constructor(){}static registerCallbackConstructor(e,n){k(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),qr.checkForDuplicate(n),qr.constructors[e]==null&&(qr.constructors[e]=[]),qr.constructors[e].push(n)}static checkForDuplicate(e){for(const n in qr.constructors)qr.constructors[+n].forEach(s=>{if(s===e)throw new _("Duplicate callback constructor.")})}static clear(){qr.constructors={}}static createCallbacks(e){const n=[];for(const r in qr.constructors){const s=+r;e>=s&&n.push(...qr.constructors[s])}return n.map(r=>new r)}}qr.constructors={};function VB(t,e,n,r,s,o,i,a,l){const c=new Zke,u=[new Jke,...qr.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const h=new Qke(u);return h.setParams({epochs:n,initialEpoch:r,samples:s,steps:o,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:h,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ro(t,e={},n=!1){return Rp(t,Qr.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ty(t,e){return j(()=>{t.dtype!=="float32"&&(t=fe(t,"float32"));const n=be(Ap(t),e,!0),r=G0(n.shape,Yt()),s=Yn(la(n,r));return Ce(t,s)})}function cx(t,e){return j(()=>jt(Ap(Ee(e,t)),-1))}function IE(t,e){return j(()=>jt(zn(Ee(e,t)),-1))}function SE(t,e){return j(()=>{const n=Ee(t,e),r=Ur(zn(t),Yt(),Number.MAX_VALUE),s=zn(Ce(n,r));return O(100,jt(s,-1))})}function t$e(t,e){return j(()=>{const n=Ur(e,Yt(),Number.MAX_VALUE),r=ho(te(1,n)),s=Ur(t,Yt(),Number.MAX_VALUE),o=ho(te(1,s));return jt(Ap(Ee(r,o)),-1)})}function n$e(t,e){return j(()=>{const n=la(0,Ee(1,O(t,e)));return jt(Ap(n),-1)})}function r$e(t,e){return j(()=>{const n=la(0,Ee(1,O(t,e)));return jt(n,-1)})}function s$e(t,e){return j(()=>{const n=be(O(t,e),-1),r=Ts(O(Ee(1,t),e),-1);return la(0,te(1,Ee(r,n)))})}function o$e(t,e){return j(()=>{const n=Math.log(2),r=Ee(e,t),s=Ee(te(r,gp(O(-2,r))),n);return jt(s,-1)})}function Md(t,e,n=!1){return j(()=>{if(n)e=c$(e);else{const r=be(e,e.shape.length-1,!0);e=Ce(e,r)}return e=Ur(e,Yt(),1-Yt()),Lt(be(O(fe(t,"float32"),ho(e)),e.shape.length-1))})}function Ry(t,e,n=!1){return j(()=>{const r=fe(q0(Eke(t)),"int32");e=Ur(e,Yt(),1-Yt());const s=e.shape,o=F(f3(r,s[s.length-1]),s);return Md(o,e,n)})}function i$e(t,e){if(!Qe(t.shape,e.shape))throw new _(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return j(()=>{const n=kl(e),r=Lt(zn(e));return te(Ee(n,O(e,t)),u3(Vo(r)))})}function ux(t,e){return j(()=>{let n;return n=Ur(e,Yt(),1-Yt()),n=ho(Ce(n,Ee(1,n))),jt(i$e(t,n),-1)})}function a$e(t,e){return j(()=>{const n=Ur(t,Yt(),1),r=Ur(e,Yt(),1);return be(O(t,ho(Ce(n,r))),-1)})}function l$e(t,e){return j(()=>{const n=ho(te(Yt(),e));return jt(Ee(e,O(t,n)),-1)})}function WB(t,e){return j(()=>{const n=Ty(t,-1),r=Ty(e,-1),s=O(n,r);return Lt(be(s,-1))})}const _y={meanSquaredError:cx,meanAbsoluteError:IE,meanAbsolutePercentageError:SE,meanSquaredLogarithmicError:t$e,squaredHinge:n$e,hinge:r$e,categoricalHinge:s$e,logcosh:o$e,categoricalCrossentropy:Md,sparseCategoricalCrossentropy:Ry,binaryCrossentropy:ux,kullbackLeiblerDivergence:a$e,poisson:l$e,cosineProximity:WB};function Ab(t){if(typeof t=="string"){if(t in _y)return _y[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new _(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jB(t,e){return j(()=>{const n=O(.5,cs(e)),r=io(jr(e,n),t.dtype);return jt(uo(t,r),-1)})}function GB(t,e){return j(()=>io(uo(Nd(t,-1),Nd(e,-1)),"float32"))}function c$e(t,e){return j(()=>fe(be(Wo(uo(t,1),uo(e,1))),"float32"))}function u$e(t,e){return j(()=>fe(be(Wo(uo(t,0),uo(e,1))),"float32"))}function h$e(t,e){return j(()=>{const n=c$e(t,e),r=u$e(t,e),s=te(n,r);return fe(Kn(jr(s,0),Ce(n,s),0),"float32")})}function d$e(t,e){return ux(t,e)}function f$e(t,e){return t.rank===e.rank&&(t=vp(t,[t.rank-1])),e=Nd(e,-1),e.dtype!==t.dtype&&(e=fe(e,t.dtype)),fe(uo(t,e),"float32")}const p$e=cx,m$e=cx,g$e=IE,y$e=IE,v$e=SE,x$e=SE,HB=Md,b$e=WB,KB=Ry,Ay={binaryAccuracy:jB,categoricalAccuracy:GB,precision:h$e,categoricalCrossentropy:HB,sparseCategoricalCrossentropy:KB,mse:p$e,MSE:m$e,mae:g$e,MAE:y$e,mape:v$e,MAPE:x$e,cosine:b$e};function w$e(t){if(typeof t=="string"&&t in Ay)return Ay[t];if(typeof t!="string"&&t!=null)return t;throw new _(`Unknown metric ${t}`)}function Nm(t){if(Gs(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(_y))if(_y[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Ay))if(Ay[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function C$e(t){const e={Adagrad:()=>Ol.adagrad(.01),Adadelta:()=>Ol.adadelta(1,.95,Yt()),Adam:()=>Ol.adam(.001,.9,.999,Yt()),Adamax:()=>Ol.adamax(.002,.9,.999,Yt(),0),RMSProp:()=>Ol.rmsprop(.001,.9,0,Yt()),SGD:()=>Ol.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new _(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const y_=1*1024*1024;function v_(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!BC(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>y_&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${y_}.`)}}function BC(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!BC(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!BC(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function I$e(t,e,n,r=console.log){const s=k$e(t),o=["Layer (type)","Input Shape","Output shape","Param #"];s?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let i;if(!s){o.push("Receives inputs"),i=[];for(const u in t.nodesByDepth)i.push(...t.nodesByDepth[u])}r("_".repeat(e)),Dy(o,n,r),r("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)s?$$e(a[u],n,r):E$e(a[u],n,i,r),r((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=S$e(t),c=$y(t.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(e))}function S$e(t){let e;return t.collectedTrainableWeights!=null?e=$y(t.collectedTrainableWeights):e=$y(t.trainableWeights),e}function k$e(t){let e=!0;const n=[],r=[];for(const s in t.nodesByDepth)n.push(t.nodesByDepth[s]);for(const s of n){if(s.length>1||s.length===1&&s[0].inboundLayers.length>1){e=!1;break}r.push(...s)}if(e)for(const s of t.layers){let o=!1;for(const i of s.inboundNodes)if(r.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Dy(t,e,n=console.log){let r="";for(let s=0;s<t.length;++s)s>0&&(r=r.slice(0,r.length-1)+" "),r+=t[s],r=r.slice(0,e[s]),r+=" ".repeat(e[s]-r.length);n(r)}function $$e(t,e,n){let r,s;try{s=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{s="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=t.name,i=t.getClassName(),a=[`${o} (${i})`,s,r,t.countParams().toString()];Dy(a,e,n)}function E$e(t,e,n,r){let s,o;try{o=t.inboundNodes.map(h=>JSON.stringify(h.inputShapes)).join(",")}catch{o="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const i=[];for(const h of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(h)===-1))for(let d=0;d<h.inboundLayers.length;++d){const f=h.inboundLayers[d].name,p=h.nodeIndices[d],m=h.tensorIndices[d];i.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=i.length===0?"":i[0],u=[`${a} (${l})`,o,s,t.countParams().toString(),c];Dy(u,e,r);for(let h=1;h<i.length;++h)Dy(["","","","",i[h]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qB(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function UC(t,e){if(t===null)return null;if(typeof t=="string")return Sa(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const o=t[s];qB(e,s,o)?n.push(o):n.push(UC(o,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r];if(r==="name"&&typeof s=="string")n[r]=s;else{const o=Sa(r);n[o]=UC(s,o)}}return n}}function VC(t,e){if(t==null)return null;if(typeof t=="string")return xo(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let s=0;s<r;++s){const o=t[s];qB(e,s,o)?n.push(o):n.push(VC(o,e))}return n}else{const n={};for(const r of Object.keys(t)){const s=t[r],o=xo(r);(r==="name"||r==="className")&&typeof s=="string"?n[o]=s:n[o]=VC(s,r)}return n}}/** @license See the LICENSE file. */const XB="4.4.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gs extends Me{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const v=this.getClassName().toLowerCase();this.name=ix(v)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Mi(this.inputs).length!==this.inputs.length)throw new _(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(v=>v.name)}`);Mi(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(v=>v.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const v of this.outputs){const x=v.sourceLayer,b=v.nodeIndex,w=v.tensorIndex;this.outputLayers.push(x),this.outputLayersNodeIndices.push(b),this.outputLayersTensorIndices.push(w)}for(const v of this.inputs){const x=v.sourceLayer,b=v.nodeIndex,w=v.tensorIndex;Gs(b===0,"input layer has >1 nodes"),Gs(w===0,"input layer has >1 tensors"),this.inputLayers.push(x),this.inputLayersNodeIndices.push(b),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let v=0;v<this.inputLayers.length;v++){const x=this.inputLayers[v];if(!(x instanceof Op))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${v} (0-based) originates from layer type ${x.getClassName()}.`);this.inputNames.push(x.name),this.feedInputShapes.push(x.batchInputShape),this.feedInputNames.push(x.name)}for(const v of this.outputLayers)this.outputNames.push(v.name);this.internalInputShapes=this.inputs.map(v=>v.shape),this.internalOutputShapes=this.outputs.map(v=>v.shape);const n={},r={},s={},o={},i={},a=[],l=(v,x,b,w,C,I)=>{(w==null||C==null||I==null)&&(w=v.sourceLayer,C=v.nodeIndex,I=v.tensorIndex);const S=w.inboundNodes[C];if(b.indexOf(S)!==-1)throw new rs(`The tensor ${v.name} at layer "${w.name}" is part of a cycle.`);if(x.indexOf(S)!==-1)return;this.containerNodes.add(gs.nodeKey(w,C)),w.id in i||(i[w.id]=Object.keys(i).length),b.indexOf(S)===-1&&b.push(S);const $=S.inboundLayers.length;for(let E=0;E<$;E++){const A=S.inputTensors[E],M=S.inboundLayers[E],B=S.nodeIndices[E],U=S.tensorIndices[E];l(A,x,b,M,B,U)}for(x.push(S);b.indexOf(S)>=0;)b.splice(b.indexOf(S),1);a.push(S)},c=[],u=[];for(const v of this.outputs)l(v,c,u);const h=a.slice().reverse();for(const v of h){r[v.id]=v,v.id in n||(n[v.id]=0);let x=n[v.id];const b=s[v.outboundLayer.id]==null?0:s[v.outboundLayer.id];x=Math.max(x,b),s[v.outboundLayer.id]=x,o[v.outboundLayer.id]=v.outboundLayer,n[v.id]=x;for(let w=0;w<v.inboundLayers.length;w++){const C=v.inboundLayers[w],I=v.nodeIndices[w],S=C.inboundNodes[I],$=n[S.id]==null?0:n[S.id];n[S.id]=Math.max(x+1,$),r[S.id]=S}}const d={};for(const v in n){const x=n[v];x in d||(d[x]=[]),d[x].push(r[v])}const f={};for(const v in s){const x=s[v];x in f||(f[x]=[]),f[x].push(o[v])}let p=Object.keys(f).map(v=>parseInt(v,10)).sort(km);this.layers=[];for(const v of p){const x=f[v];x.sort((b,w)=>{const C=i[b.id],I=i[w.id];return C<I?-1:C>I?1:0});for(const b of x)b instanceof gs&&this.internalContainerRefs.push(b),this.layers.push(b)}this.layersByDepth=f,p=Object.keys(d).map(v=>parseInt(v,10)).sort(km);const m=this.inputs.slice(),y=[];for(const v of p)for(const x of d[v]){const b=x.outboundLayer;if(b!=null){for(const w of x.inputTensors)if(m.indexOf(w)===-1)throw new rs(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${b.name}". The following previous layers were accessed without issue: ${y}`);for(const w of x.outputTensors)m.push(w);y.push(b.name)}}this.nodesByDepth=d;const g=this.layers.map(v=>v.name);for(const v of g){const x=g.filter(b=>b===v).length;if(x!==1)throw new rs(`The name "${v}" is used ${x} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new lx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(v=>null),outputMasks:this.outputs.map(v=>null),inputShapes:this.inputs.map(v=>v.shape),outputShapes:this.outputs.map(v=>v.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new _("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let s=0;for(const i of this.layers)for(const a of i.weights){if(r[a.originalName]!=null)throw new _(`Duplicate weight name: ${a.originalName}`);r[a.originalName]=a,s++}const o=[];for(const i in e){let a=i;if(r[i]==null){const l=i.split("/");a=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(r[a]!=null)o.push([r[a],e[i]]);else if(n)throw new _(`Provided weight data has no target variable: ${i}`);delete r[a]}if(n){const i=[];for(const a in r)i.push(a);if(i.length>0)throw new _(`${i.length} of ${s} weights are not set: ${i}`)}wE(o)}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${XB}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=VC(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return j(()=>{e=ht(e);const r=new wi;for(let s=0;s<this.inputs.length;++s)r.add(this.inputs[s],e[s]);return mh(this.outputs,r,n)})}computeMask(e,n){return j(()=>{e=ht(e);let r;return n==null?r=pl(null,e.length):r=ht(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=ky(e);if(n.length!==this.inputLayers.length)throw new _(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";r[u]=c}const s=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(km);if(s.length>1)for(const a of s){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const h=[];for(let m=0;m<c.inboundLayers.length;m++){const y=c.inboundLayers[m],g=c.nodeIndices[m],v=c.tensorIndices[m],x=`${y.name}_${g}_${v}`,b=r[x];h.push(b)}const d=u.computeOutputShape(tr(h)),f=ky(d),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const y=`${u.name}_${p}_${m}`;r[y]=f[m]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],h=`${l.name}_${c}_${u}`;i.push(h)}for(let a=0;a<i.length;a++){const l=i[a];Gs(l in r),o.push(r[l])}return tr(o)}runInternalGraph(e,n){n==null&&(n=pl(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],h=n[l];r[c.id]=[u,h]}const s=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(km);for(const l of s){const c=this.nodesByDepth[l];for(const u of c){const h=u.outboundLayer,d=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of d)m.id in r&&p.push(r[m.id]);if(p.length===d.length){let m={},y,g,v,x;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[b,w]=p[0];m.mask==null&&(m.mask=w),v=ht(h.call(b,m)),x=ht(h.computeMask(b,w)),y=[b],g=[w]}else y=p.map(b=>b[0]),g=p.map(b=>b[1]),m.mask==null&&(m.mask=g),v=ht(h.call(y,m)),x=ht(h.computeMask(y,g));if(h.activityRegularizer)throw new Ae("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let b=0;b<f.length;++b){const w=f[b],C=v[b],I=x[b];r[w.id]=[C,I]}}}}const o=[],i=[],a=[];for(const l of this.outputs){Gs(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=r[l.id];a.push(c.shape),o.push(c),i.push(u)}return[o,i,a]}buildNodeConversionMap(e){const n={};let r;for(const s of this.layers){r=s instanceof gs?1:0;for(let o=0;o<s.inboundNodes.length;o++){const i=gs.nodeKey(s,o);this.containerNodes.has(i)&&(n[i]=r,r+=1)}}return n}getLayer(e,n){if(n!=null){if(this.layers.length<=n)throw new _(`Was asked to retrieve layer at index ${n}, but model only has ${this.layers.length} layer(s).`);return this.layers[n]}else if(e==null)throw new _("Provide either a layer name or layer index");for(const r of this.layers)if(r.name===e)return r;throw new _(`No such layer: ${e}`)}calculateLosses(){return j(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const s=gs.nodeKey(n,r);this.containerNodes.has(s)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),c=[];for(let h=0;h<i.inboundNodes.length;h++){const d=i.inboundNodes[h],f=gs.nodeKey(i,h);let p={};if(this.containerNodes.has(f)){if(d.callArgs)try{JSON.stringify(d.callArgs),p=d.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${d.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(d.inboundLayers.length>0){const m=[];for(let y=0;y<d.inboundLayers.length;y++){const g=d.inboundLayers[y],v=d.nodeIndices[y],x=d.tensorIndices[y],b=gs.nodeKey(g,v);let w=n[b];w==null&&(w=0),m.push([g.name,w,x,p])}c.push(m)}}}const u={};u.name=i.name,u.className=a,u.config=l,u.inboundNodes=c,r.push(u)}e.layers=r;const s=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=gs.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.inputLayersTensorIndices[i];s.push([a.name,u,h])}e.inputLayers=s;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=gs.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const h=this.outputLayersTensorIndices[i];o.push([a.name,u,h])}return e.outputLayers=o,e}static fromConfig(e,n,r={},s=!1){const o={},i={};function a(y,g){y.name in i?i[y.name].push(g):i[y.name]=[g]}function l(y,g){const v=[];let x;for(const b of g){const w=b[0],C=b[1],I=b[2];if(x=b[3]==null?{}:b[3],!(w in o)){a(y,g);return}const S=o[w];if(S.inboundNodes.length<=C){a(y,g);return}const $=S.inboundNodes[C];v.push($.outputTensors[I])}v.length>0&&y.apply(tr(v),x)}function c(y){const g=y.name,v=Ro(y,n.customObjects!=null?n.customObjects:{});v.setFastWeightInitDuringBuild(s),o[g]=v,y.inboundNodes.forEach(b=>{if(!(b instanceof Array))throw new _(`Corrupted configuration, expected array for nodeData: ${b}`);a(v,b)})}const u=n.name,h=n.layers;for(const y of h)c(y);for(;!pke(i);)for(const y of h){const g=o[y.name];if(g.name in i){const v=i[g.name];delete i[g.name];for(const x of v)l(g,x)}}const d=[],f=[],p=n.inputLayers;for(const y of p){const g=y[0],v=y[1],x=y[2];Gs(g in o);const w=o[g].inboundNodes[v].outputTensors;d.push(w[x])}const m=n.outputLayers;for(const y of m){const g=y[0],v=y[1],x=y[2];Gs(g in o);const w=o[g].inboundNodes[v].outputTensors;f.push(w[x])}return new e({inputs:d,outputs:f,name:u})}get stateful(){if(this._stateful)throw new _("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){j(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function N$e(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const s=[];return e.forEach(o=>{o in t?s.push(t[o]):s.push(null)}),s}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function YB(t,e){return N$e(t,e,"classWeight")}async function QB(t,e,n,r){if(e!=null||r!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const s=j(()=>{if(t.shape.length===1)return Ua(t);if(t.shape.length===2){if(t.shape[1]>1)return Nd(t,1);if(t.shape[1]===1)return F(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await s.data());ze(s);const i=[];return o.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),Or(i,"float32")}else return null}function T$e(t,e){return O(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const R$e=32;function JB(t,e){let n,r;const s=e;n=s.xs,r=s.ys,k(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=x_("input",t.inputNames,n),i=x_("output",t.outputNames,r),a=o[0].shape[0];k(o.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),k(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<o.length;l++)k(o[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)k(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:o,ys:i}}function x_(t,e,n){if(n instanceof Wt)return[n];if(Array.isArray(n))return k(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const s of e){if(n[s]==null)throw new _(`The feature data generated by the dataset lacks the required ${t} key '${s}'.`);r.push(n[s])}return r}}function _$e(t){if(t.length===3)throw new Ae("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function A$e(t,e,n){const r=n.batchesPerEpoch!=null;if(k(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),k(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),k(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),k(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),k(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const s=n.validationData!=null;let o,i;if(s)if(b_(n.validationData))k(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const y=_$e(n.validationData);o=y.xs,i=y.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;s?c=l.slice().concat(l.map(y=>"val_"+y)):c=l.slice();const u=UB(n.callbacks,n.yieldEvery),h=n.verbose==null?1:n.verbose,{callbackList:d,history:f}=VB(u,h,n.epochs,null,null,D$e(e,n),null,s,c);d.setModel(t),t.history=f,await d.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const y={};await d.onEpochBegin(p);let g=0,v=0;for(r||(m=await e.iterator());!r||g<n.batchesPerEpoch;){const x=await m.next();if(r&&x.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${g} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(x.value!=null){const{xs:b,ys:w}=JB(t,x.value),C={};C.batch=v,C.size=b[0].shape[0],await d.onBatchBegin(v,C);const I=[];if(n.classWeight!=null){const E=YB(n.classWeight,t.outputNames);for(let A=0;A<E.length;++A)I.push(await QB(w[A],null,E[A]))}const S=b.concat(w).concat(I),$=a(S);ze(S);for(let E=0;E<l.length;++E){const A=l[E],M=$[E];C[A]=M,so(M)}await d.onBatchEnd(v,C),BB(C),v++,g++}if(r?g>=n.batchesPerEpoch:x.done){if(s){let b;b_(n.validationData)?b=ht(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):b=ht(t.evaluate(o,i,{batchSize:n.validationBatchSize==null?R$e:n.validationBatchSize,verbose:0}));for(let w=0;w<t.metricsNames.length;++w)y[`val_${t.metricsNames[w]}`]=b[w]}break}if(t.stopTraining_)break}if(await d.onEpochEnd(p,y),p++,t.stopTraining_)break}return await d.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function D$e(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function b_(t){return typeof t.iterator=="function"}function O$e(t){return typeof t.next=="function"}async function P$e(t,e,n){n=n||{};const r=n.batches!=null,s=t.testFunction;let o=[];if(n.verbose>0)throw new Ae("Verbose mode is not implemented yet.");k(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=O$e(e)?e:await e.iterator();let a=0,l=0;for(;!r||l<n.batches;){const c=await i.next();if(o=j(()=>{if(c.value){const{xs:u,ys:h}=JB(t,c.value),d=u.concat(h),f=j(()=>s(d));if(ze(d),l===0)for(let m=0;m<f.length;++m)o.push(Ze(0));const p=d[0].shape[0];for(let m=0;m<f.length;++m){const y=f[m],g=o[m];o[m]=j(()=>te(o[m],O(p,y))),l>0&&ze(g)}ze(f),a+=p,++l}return o}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<o.length;++c){const u=o[c];o[c]=Ce(o[c],a),ze(u)}return tr(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Db(t){k(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Ju(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>Wa(r,e,n-e)):Wa(t,e,n-e)}function WC(t,e){return j(()=>t==null?null:Array.isArray(t)?t.map(n=>WC(n,e)):$B(t,e.dtype==="int32"?e:fe(e,"int32")))}function Ob(t,e){const n=[];let r=0,s=null;for(;r<t;)s=r+e,s>=t&&(s=t),n.push([r,s]),r=s;return n}function ZB(t){const e=[];t instanceof Wt&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(_p(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function ms(t,e){if(t==null)return;const n=[];if(e instanceof Wt)n.push(e.id);else if(Array.isArray(e))e.forEach(s=>n.push(s.id));else if(e!=null)for(const s in e){const o=e[s];n.push(o.id)}const r=[];if(t instanceof Wt)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(s=>{n.indexOf(s.id)===-1&&r.push(s)});else if(t!=null)for(const s in t){const o=t[s];n.indexOf(o.id)===-1&&r.push(o)}r.forEach(s=>{s.isDisposed||s.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function F$e(t){return t instanceof Wt}function jC(t){return Array.isArray(t)}function w_(t){return!F$e(t)&&!jC(t)}function C_(t,e,n,r=!0,s=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(jC(t)&&t.length>0)i=!0;else if(w_(t)){for(const a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new _(`Error when checking model ${s} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let o;if(w_(t)){t=t,o=[];for(const i of e){if(t[i]==null)throw new _(`No data provided for "${i}". Need data for each key in: ${e}`);o.push(t[i])}}else if(jC(t)){if(t=t,t.length!==e.length)throw new _(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);o=t}else{if(t=t,e.length>1)throw new _(`The model ${s} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);o=[t]}if(o=ZB(o),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new _(`Error when checking ${s}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!r)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u>=0&&c!==u)throw new _(`${s} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${s} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function L$e(t,e,n){const r=Mi(t.map(o=>o.shape[0]));r.sort();const s=Mi(e.map(o=>o.shape[0]));if(s.sort(),r.length>1)throw new _(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(o=>o.shape))}`);if(s.length>1)throw new _(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(r.length>0&&s.length>0&&!Qe(r,s))throw new _(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${s[0]} target sample(s).`)}function M$e(t,e,n){const r=[cx,ux,Md];for(let s=0;s<t.length;++s){const o=t[s],i=e[s],a=n[s];if(i!=null){if(i===Md&&o.shape[o.shape.length-1]===1)throw new _(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(i)!==-1){const l=o.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const h=l[u],d=c[u];if(d!=null&&h!==d)throw new _(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function I_(t,e,n,r=!0,s=""){let o;if(Array.isArray(t)){if(t.length!==e.length)throw new _(`Error when checking model ${s}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);o=t}else{if(e.length>1)throw new _(`The model expects ${e.length} ${s} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);o=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new _(`Error when checking ${s}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!r)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u!==c)throw new _(`Error when checking ${s}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function z$e(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const s of e){let o=n.hasOwnProperty(s)?n[s]:[];Array.isArray(o)||(o=[o]),r.push(o)}return r}}const B$e="layers-model";class bc extends gs{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new _("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");I$e(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=C$e(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ca))throw new _("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new _(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(Ab(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new _(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>Ab(a))}else{const i=Ab(e.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Va("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(r.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const s=z$e(e.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};Va("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(r.indexOf(i)!==-1)continue;const a=s[i];(c=>{const u="";let h,d,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const y=this.internalOutputShapes[i];y[y.length-1]===1||this.lossFunctions[i]===ux?["accuracy","acc"].indexOf(p)!==-1?d=jB:["crossentropy","ce"].indexOf(p)!==-1&&(d=d$e):this.lossFunctions[i]===Ry?["accuracy","acc"].indexOf(p)!==-1?d=f$e:["crossentropy","ce"].indexOf(p)!==-1&&(d=KB):["accuracy","acc"].indexOf(p)!==-1?d=GB:["crossentropy","ce"].indexOf(p)!==-1&&(d=HB);let g;["accuracy","acc"].indexOf(p)!==-1?g="acc":["crossentropy","ce"].indexOf(p)!==-1&&(g="ce"),f=d,h=u+g}else f=w$e(p),h=u+Nm(p);let m;Va(h,()=>{m=f}),o(i,h,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const s=r.batchSize==null?32:r.batchSize;Db(s);const o=!0,i=this.standardizeUserDataXY(e,n,o,s);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,s,r.verbose,r.steps);return tr(c)}finally{ms(i[0],e),ms(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),P$e(this,e,n)}checkNumSamples(e,n,r,s="steps"){let o;if(r!=null){if(o=null,n!=null)throw new _(`If ${s} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new _(`Either the input data should have a defined shape, or ${s} shoud be specified.`);return o}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new _("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),s=r?n:[n],o=this.retrieveSymbolicTensors(s),i=new wi;if(e instanceof Wt&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new _(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new _(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const a=mh(o,i);return r?a:a[0]}retrieveSymbolicTensors(e){const n=pl(null,e.length);let r=e.length;for(const s of this.layers){const o=Array.isArray(s.output)?s.output:[s.output],i=o.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(n[a]=o[l],r--),r===0)break}if(r===0)break}if(r>0){const s=[];throw n.forEach((o,i)=>{o==null&&s.push(e[i])}),new _(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(s)}`)}return n}predictLoop(e,n=32,r=!1){return j(()=>{const s=this.checkNumSamples(e);if(r)throw new Ae("Verbose predictLoop() is not implemented yet.");const o=Ob(s,n),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)j(()=>{const c=o[a][0],u=o[a][1],h=Ju(e,c,u),d=[];if(Array.isArray(h))for(let p=0;p<h.length;++p)d.push({key:this.inputs[p],value:h[p]});else d.push({key:this.inputs[0],value:h});const f=new wi(d);return mh(this.outputs,f)}).forEach((c,u)=>i[u].push(c));return tr(i.map(a=>ir(a,0)))})}predict(e,n={}){const r=ZB(e);I_(r,this.inputNames,this.feedInputShapes,!1);try{const s=n.batchSize==null?32:n.batchSize;return Db(s),this.predictLoop(r,s)}finally{ms(r,e)}}predictOnBatch(e){I_(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,s){if(this.optimizer_==null)throw new rs("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===Ry?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(e=C_(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=C_(n,this.feedOutputNames,o,!1,"target"),L$e(e,n),M$e(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&s!=null&&s>0&&e[0].shape[0]%s!==0)throw new _(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${s}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,s,o=!0,i){const[a,l]=this.standardizeUserDataXY(e,n,o,i);if(r!=null)throw new Error("sample weight is not supported yet.");let c=null;if(s!=null){const u=YB(s,this.outputNames);c=[];for(let h=0;h<u.length;++h)c.push(await QB(l[h],null,u[h]))}return[a,l,c]}testLoop(e,n,r,s=0,o){return j(()=>{const i=this.checkNumSamples(n,r,o,"steps"),a=[];if(s>0)throw new Ae("Verbose mode is not implemented yet.");if(o!=null)throw new Ae("steps mode in testLoop() is not implemented yet");{const l=Ob(i,r),c=Or(Ps(0,i));for(let u=0;u<l.length;++u){const h=l[u][0],d=l[u][1],f=Wa(c,h,d-h),p=WC(n,f),m=e(p);if(u===0)for(let y=0;y<m.length;++y)a.push(Ze(0));for(let y=0;y<m.length;++y){const g=m[y];a[y]=te(a[y],O(d-h,g))}}for(let u=0;u<a.length;++u)a[u]=Ce(a[u],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const s=e[r];let o=s;if(a_(e,s)>1){const i=a_(e.slice(0,r),s);o+=`_${i}`}n.push(o)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const h=[];for(let m=0;m<this.inputs.length;++m)h.push({key:this.inputs[m],value:r[m]});const d=new wi(h),f=mh(this.outputs,d,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const y=this.lossFunctions[m];let g=y(s[m],f[m]);o[m]!=null&&(g=T$e(g,o[m]));const v=jt(g);n.push(v),m===0?p=g:p=te(p,g)}for(let m=0;m<this.metricsTensors.length;++m){let y;if(this.outputs.length>1&&m<this.outputs.length)y=n[m];else{const g=this.metricsTensors[m][0],v=this.metricsTensors[m][1];y=jt(g(s[v],f[v]))}so(y),i.push(y)}return p=jt(p),this.calculateLosses().forEach(m=>{p=te(p,m)}),p},l=this.collectedTrainableWeights.map(h=>h.read()),c=!0;return[this.optimizer_.minimize(a,c,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>j(()=>{const n=[];let r;const s=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:s[c]});const a=new wi(i),l=mh(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],h=jt(u(o[c],l[c]));c===0?r=h:r=te(r,h),n.push(r)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],h=this.metricsTensors[c][1],d=jt(u(o[h],l[h]));n.push(d)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let s,o,i,a,l,c,u,h,d;try{const f=r.batchSize==null?32:r.batchSize;Db(f);const p=!1,m=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,p,f);s=m[0],o=m[1],d=m[2];let y=!1,g;if(r.validationData!=null&&r.validationData.length>0){if(y=!0,r.validationData.length===2)l=r.validationData[0],c=r.validationData[1];else throw r.validationData.length===3?new Ae("validationData including sample weights is not supported yet."):new _(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const $=!0,E=await this.standardizeUserData(l,c,null,null,$,f);u=E[0],h=E[1],g=u.concat(h)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){y=!0;const $=Math.floor(s[0].shape[0]*(1-r.validationSplit)),E=s[0].shape[0];u=Ju(s,$,E),i=s,s=Ju(s,0,$),h=Ju(o,$,E),a=o,o=Ju(o,0,$),g=u.concat(h)}else r.validationSteps!=null&&(y=!0);const v=s.concat(o).concat(d);this.checkTrainableWeightsConsistency();const x=this.makeTrainFunction(),b=this.getDedupedMetricsNames();let w,C;y?(this.makeTestFunction(),w=this.testFunction,C=b.slice().concat(b.map($=>"val_"+$))):(w=null,g=[],C=b.slice());const I=UB(r.callbacks,r.yieldEvery);return await this.fitLoop(x,v,b,f,r.epochs,r.verbose,I,w,g,r.shuffle,C,r.initialEpoch,null,null)}finally{this.isTraining=!1,ms(s,e),ms(o,n),ms(i,e),ms(a,n),ms(u,l),ms(h,c),d!=null&&ze(d)}}async fitLoop(e,n,r,s,o,i,a,l,c,u,h,d,f,p){s==null&&(s=32),o==null&&(o=1),u==null&&(u=!0),d==null&&(d=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new _("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const y=this.checkNumSamples(n,s,f,"steps_per_epoch");let g;y!=null&&(g=Ps(0,y)),i==null&&(i=1);const{callbackList:v,history:x}=VB(a,i,o,d,y,f,s,m,h);v.setModel(this),this.history=x,await v.onTrainBegin(),this.stopTraining_=!1;for(let b=d;b<o;++b){await v.onEpochBegin(b);const w={};if(f!=null)throw new Ae("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Ae("batch shuffling is not implemneted yet");u&&dee(g);const C=Or(g),I=Ob(y,s);for(let S=0;S<I.length;++S){const $={};if(await v.onBatchBegin(S,$),j(()=>{const E=I[S][0],A=I[S][1],M=Wa(C,E,A-E);$.batch=S,$.size=A-E;const B=WC(n,M),U=e(B);for(let V=0;V<r.length;++V){const H=r[V],K=U[V];$[H]=K,so(K)}if(S===I.length-1&&m){const V=this.testLoop(l,c,s);for(let H=0;H<r.length;++H){const K=r[H],R=V[H];so(R),w["val_"+K]=R}}}),await v.onBatchEnd(S,$),BB($),this.stopTraining_)break}C.dispose()}if(await v.onEpochEnd(b,w),this.stopTraining_)break}return await v.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return A$e(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),s=r[0],o=r[1],a=this.makeTrainFunction()(s.concat(o)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return ze(a),ms(r[0],e),ms(r[1],n),tr(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,s=r?this.trainableWeights:this.weights,o=this.getWeights(r);for(let i=0;i<s.length;++i)r&&!s[i].trainable||n.push({name:s[i].originalName,tensor:o[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=mC().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-mC().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=xo(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>xo(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const s of n)if(typeof r[s]=="string")e[s]=xo(r[s]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[xo(Nm(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>xo(Nm(e)));{const e={};for(const n in this.metrics)e[n]=xo(Nm(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=UC(e.optimizer_config),r=Ro(n);let s;if(typeof e.loss=="string")s=Sa(e.loss);else if(Array.isArray(e.loss))s=e.loss.map(i=>Sa(i));else if(e.loss!=null){s={};for(const i in e.loss)s[i]=Sa(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>Sa(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=Sa(e.metrics[i])}this.compile({loss:s,metrics:o,optimizer:r})}async save(e,n){if(typeof e=="string"){const c=ite(e);if(c.length===0)throw new _(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new _(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new _("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await cR(this.getNamedWeights(n)),s=!1,o=null,a={modelTopology:this.toJSON(o,s),format:B$e,generatedBy:`TensorFlow.js tfjs-layers v${XB}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:h}=await cR(await this.optimizer.getWeights(),c);r.specs.push(...h),r.data=GM([r.data,u])}return this.userDefinedMetadata!=null&&(v_(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,e.save(a)}setUserDefinedMetadata(e){v_(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}bc.className="Model";Z(bc);class eU extends bc{}eU.className="Functional";Z(eU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zd extends bc{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:ix("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new _(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof zd||e instanceof bc;let r;if(n){if(r=e,r.outputs.length!==1)throw new _("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new _("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new _("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const s=Wke({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(s)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new _(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new _("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=PB(this.outputs[0])}this.inboundNodes=[],new lx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:pl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(s=>s.shape),outputShapes:this.outputs[0].shape})}else{const s=e.apply(this.outputs[0]);if(Array.isArray(s))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[s],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ke(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new bc({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new rs("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new rs("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new rs("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new rs("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},s=!1){let o,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new _("Legacy serialization format not supported yet.");o=n}else k(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=n.layers,delete n.layers,i=n;const a=new e(i);if(!(a instanceof zd))throw new Ae(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const u=Ro(l,void 0,s);s&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new _("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new _("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}zd.className="Sequential";Z(zd);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let dr=class extends Au{getConfig(){return{}}};class tU extends dr{apply(e,n=1){return Tke(e,n)}}tU.className="elu";Z(tU);class nU extends dr{apply(e){return v3(e)}}nU.className="selu";Z(nU);class rU extends dr{apply(e){return kl(e)}}rU.className="relu";Z(rU);class sU extends dr{apply(e){return j(()=>_d(6,kl(e)))}}sU.className="relu6";Z(sU);class oU extends dr{apply(e){return e}}oU.className="linear";Z(oU);class iU extends dr{apply(e){return Tu(e)}}iU.className="sigmoid";Z(iU);class aU extends dr{apply(e){return _ke(e)}}aU.className="hardSigmoid";Z(aU);class lU extends dr{apply(e){return gp(e)}}lU.className="softplus";Z(lU);class cU extends dr{apply(e){return Rke(e)}}cU.className="softsign";Z(cU);class uU extends dr{apply(e){return Gk(e)}}uU.className="tanh";Z(uU);let kE=class extends dr{apply(e,n=-1){return c$(e,n)}};kE.className="softmax";Z(kE);class hU extends dr{apply(e,n=-1){return h3(e,n)}}hU.className="logSoftmax";Z(hU);class dU extends dr{apply(e,n=1){return j(()=>O(Tu(O(e,n)),e))}}dU.className="swish";Z(dU);class fU extends dr{apply(e){return j(()=>O(e,Gk(gp(e))))}}fU.className="mish";Z(fU);function Yi(t){return t.getClassName()}function Pb(t,e={}){return Rp(t,Qr.getMap().classNameMap,e,"activation")}function Qi(t){if(t==null){const e={};return e.className="linear",e.config={},Pb(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},Pb(e)}else return t instanceof dr?t:Pb(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function U$e(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class pU extends Au{}class mU extends pU{constructor(e){super(),U$e(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return j(()=>{let n=sn([1]);return this.hasL1&&(n=te(n,be(O(this.l1,zn(e))))),this.hasL2&&(n=te(n,be(O(this.l2,Ap(e))))),F(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}mU.className="L1L2";Z(mU);const S_={l1l2:"L1L2"};function ot(t){return hE(t)}function k_(t,e={}){return Rp(t,Qr.getMap().classNameMap,e,"regularizer")}function wt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in S_?S_[t]:t,config:{}};return k_(n)}else return t instanceof pU?t:k_(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gU extends Me{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=$e(e);let r=kl(e);return this.maxValue!=null&&(r=Ur(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}gU.className="ReLU";Z(gU);class yU extends Me{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=$e(e);return Zk(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}yU.className="LeakyReLU";Z(yU);class vU extends Me{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=bt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=wt(e.alphaRegularizer),this.alphaConstraint=Zt(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new _(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ke(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const s of this.sharedAxes)n[s-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let s=1;s<e.length;++s)r[s]=e[s];this.inputSpec=[new Qt({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=$e(e),o$(e,this.alpha.read())}getConfig(){const e={alphaInitializer:$t(this.alphaInitializer),alphaRegularizer:ot(this.alphaRegularizer),alphaConstraint:Jt(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}vU.className="PReLU";Z(vU);class xU extends Me{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ae(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=$e(e);return H0(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}xU.className="ELU";Z(xU);class bU extends Me{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=$e(e);return O(r,fe(jr(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}bU.className="ThresholdedReLU";Z(bU);class wU extends Me{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new kE().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){const r=$e(e);return this.softmax(r,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}wU.className="Softmax";Z(wU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wc(t,e,n){if(typeof t=="number")return pl(t,e);if(t.length!==e)throw new _(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const s=t[r];if(!kke(s))throw new _(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${s}`)}return t}function Rs(t,e,n,r,s=1){if(t==null)return t;const o=e+(e-1)*(s-1);let i;return n==="same"?i=t:i=t-o+1,Math.floor((i+r-1)/r)}function Hs(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+Xi([n-e,0]);else if(r==="same")t=t*e;else throw new _(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $E(t,e){return j(()=>(Ut(e),e==="channelsFirst"?We(t,[0,2,3,1]):t))}function CU(t,e){return j(()=>(Ut(e),e==="channelsFirst"?We(t,[0,2,3,4,1]):t))}function V$e(t,e,n,r=1,s="valid",o,i=1){return j(()=>{if(o==null&&(o=Fs()),Ut(o),t.shape.length!==3)throw new _(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new _(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new _(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(o==="channelsFirst"&&(t=We(t,[0,2,1])),s==="causal")throw new Ae("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=n3(t,e,r,s==="same"?"same":"valid","NWC",i);return n!=null&&(a=Ms(a,n)),a})}function $_(t,e,n,r=[1,1],s="valid",o,i,a=null){return j(()=>{if(o==null&&(o=Fs()),Ut(o),t.rank!==3&&t.rank!==4)throw new _(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new _(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=$E(t,o);if(s==="causal")throw new Ae("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=zoe({x:l,filter:e,strides:r,pad:s==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),o==="channelsFirst"&&(l=We(l,[0,3,1,2])),l})}function W$e(t,e,n,r=[1,1,1],s="valid",o,i){return j(()=>{if(o==null&&(o=Fs()),Ut(o),t.rank!==4&&t.rank!==5)throw new _(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new _(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=CU(t,o);if(s==="causal")throw new Ae("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=Lne(a,e,r,s==="same"?"same":"valid","NDHWC",i),n!=null&&(a=Ms(a,n)),o==="channelsFirst"&&(a=We(a,[0,4,1,2,3])),a})}class hx extends Me{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",hx.verifyArgs(n),this.rank=e,an(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ae(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=wc(n.kernelSize,e,"kernelSize"),this.strides=wc(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Gr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Ut(this.dataFormat),this.activation=Qi(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=bt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Zt(n.biasConstraint),this.biasRegularizer=wt(n.biasRegularizer),this.activityRegularizer=wt(n.activityRegularizer),this.dilationRate=wc(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new _(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new _(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new _(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Gs("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!dE(e.kernelSize,"number",1,3))throw new _(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Yi(this.activation),useBias:this.useBias,biasInitializer:$t(this.biasInitializer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),biasConstraint:Jt(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Bu extends hx{constructor(e,n){super(e,n),this.kernel=null,Bu.verifyArgs(n),this.filters=n.filters,an(this.filters,"filters"),this.kernelInitializer=bt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Zt(n.kernelConstraint),this.kernelRegularizer=wt(n.kernelRegularizer)}build(e){e=Ke(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new _(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],s=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",s,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return j(()=>{e=$e(e);let r;const s=this.bias==null?null:this.bias.read(),o=bB(this.activation.getClassName());if(o!=null&&this.rank===2)r=$_(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)r=V$e(e,this.kernel.read(),s,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=$_(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=W$e(e,this.kernel.read(),s,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ae("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Ke(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<r.length;++o){const i=Rs(r[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);n.push(i)}let s=[e[0]];return this.dataFormat==="channelsLast"?(s=s.concat(n),s.push(this.filters)):(s.push(this.filters),s=s.concat(n)),s}getConfig(){const e={filters:this.filters,kernelInitializer:$t(this.kernelInitializer),kernelRegularizer:ot(this.kernelRegularizer),kernelConstraint:Jt(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new _(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Fp extends Bu{constructor(e){super(2,e),Fp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!dE(e.kernelSize,"number",1,2))throw new _(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Fp.className="Conv2D";Z(Fp);class Lp extends Bu{constructor(e){super(3,e),Lp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new _(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Lp.className="Conv3D";Z(Lp);class IU extends Fp{constructor(e){if(super(e),this.inputSpec=[new Qt({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new _(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ke(e),e.length!==4)throw new _("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new _("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Qt({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return j(()=>{let r=$e(e);if(r.shape.length!==4)throw new _(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,o=s[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=s[i],c=s[a],u=this.kernelSize[0],h=this.kernelSize[1],d=this.strides[0],f=this.strides[1],p=Hs(l,d,u,this.padding),m=Hs(c,f,h,this.padding),y=[o,p,m,this.filters];this.dataFormat!=="channelsLast"&&(r=We(r,[0,2,3,1]));let g=r3(r,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=We(g,[0,3,1,2])),this.bias!=null&&(g=Ms(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=Ke(e);const n=e.slice();let r,s,o;this.dataFormat==="channelsFirst"?(r=1,s=2,o=3):(r=3,s=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[r]=this.filters,n[s]=Hs(n[s],l,i,this.padding),n[o]=Hs(n[o],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}IU.className="Conv2DTranspose";Z(IU);class SU extends Lp{constructor(e){if(super(e),this.inputSpec=[new Qt({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new _(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ke(e),e.length!==5)throw new _("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new _("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],s=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",s,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Qt({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return j(()=>{let r=$e(e);if(r.shape.length!==5)throw new _(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const s=r.shape,o=s[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const c=s[l],u=s[i],h=s[a],d=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],y=this.strides[1],g=this.strides[2],v=Hs(c,m,d,this.padding),x=Hs(u,y,f,this.padding),b=Hs(h,g,p,this.padding),w=[o,v,x,b,this.filters];this.dataFormat!=="channelsLast"&&(r=We(r,[0,2,3,4,1]));let C=Bne(r,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(C=We(C,[0,4,1,2,3])),this.bias!==null&&(C=Ms(C,this.bias.read(),this.dataFormat)),this.activation!==null&&(C=this.activation.apply(C)),C})}computeOutputShape(e){e=Ke(e);const n=e.slice();let r,s,o,i;this.dataFormat==="channelsFirst"?(r=1,s=2,o=3,i=4):(r=4,s=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],h=this.strides[1],d=this.strides[2];return n[r]=this.filters,n[s]=Hs(n[s],u,a,this.padding),n[o]=Hs(n[o],h,l,this.padding),n[i]=Hs(n[i],d,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}SU.className="Conv3DTranspose";Z(SU);class kU extends Bu{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new _("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new _("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new _(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=bt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=wt(n.depthwiseRegularizer),this.depthwiseConstraint=Zt(n.depthwiseConstraint),this.pointwiseInitializer=bt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=wt(n.pointwiseRegularizer),this.pointwiseConstraint=Zt(n.pointwiseConstraint)}build(e){if(e=Ke(e),e.length<this.rank+2)throw new _(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new _(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],s=this.kernelSize.concat([r,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(r*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",s,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Qt({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return j(()=>{e=$e(e);let r;if(this.rank===1)throw new Ae("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=We(e,[0,2,3,1])),r=x3(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=Ms(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=We(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=$t(this.depthwiseInitializer),e.pointwiseInitializer=$t(this.pointwiseInitializer),e.depthwiseRegularizer=ot(this.depthwiseRegularizer),e.pointwiseRegularizer=ot(this.pointwiseRegularizer),e.depthwiseConstraint=Jt(this.depthwiseConstraint),e.pointwiseConstraint=Jt(this.pointwiseConstraint),e}}kU.className="SeparableConv";class $U extends kU{constructor(e){super(2,e)}}$U.className="SeparableConv2D";Z($U);class dx extends Bu{constructor(e){super(1,e),dx.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!dE(e.kernelSize,"number",1,1))throw new _(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}dx.className="Conv1D";Z(dx);class EU extends Me{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return j(()=>{if(e=$e(e),this.dataFormat==="channelsLast"){const r=Em(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Em(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=Em(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Em(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}EU.className="Cropping2D";Z(EU);class NU extends Me{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ut(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Cke(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return j(()=>{let r=$e(e);const s=r.shape;if(this.dataFormat==="channelsFirst"){r=We(r,[0,2,3,1]);const o=this.size[0]*s[2],i=this.size[1]*s[3],a=this.interpolation==="nearest"?$o.resizeNearestNeighbor(r,[o,i]):$o.resizeBilinear(r,[o,i]);return We(a,[0,3,1,2])}else{const o=this.size[0]*s[1],i=this.size[1]*s[2];return this.interpolation==="nearest"?$o.resizeNearestNeighbor(r,[o,i]):$o.resizeBilinear(r,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}NU.className="UpSampling2D";Z(NU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function j$e(t,e,n=[1,1],r="valid",s,o){return j(()=>{s==null&&(s=Fs()),Ut(s);let i=$E(t,s);if(t.rank!==4)throw new _(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new _(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=Xk(i,e,n,r==="same"?"same":"valid","NHWC",o),s==="channelsFirst"&&(i=We(i,[0,3,1,2])),i})}class TU extends hx{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=bt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Zt(e.depthwiseConstraint),this.depthwiseRegularizer=wt(e.depthwiseRegularizer)}build(e){if(e=Ke(e),e.length<4)throw new _(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new _(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],s=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",s,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return j(()=>{e=$e(e);let r=j$e(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=Ms(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Ke(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=Rs(n,this.kernelSize[0],this.padding,this.strides[0]),i=Rs(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],s,o,i]:[e[0],o,i,s]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=$t(this.depthwiseInitializer),e.depthwiseRegularizer=ot(this.depthwiseRegularizer),e.depthwiseConstraint=Jt(this.depthwiseRegularizer),e}}TU.className="DepthwiseConv2D";Z(TU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RU(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new _("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function s(o){return o==null||Array.isArray(o)?o:[o]}return e=s(e),n=s(n),{inputs:t,initialState:e,constants:n}}function _U(t,e,n,r=!1,s,o,i=!1,a=!1){return j(()=>{const l=e.shape.length;if(l<3)throw new _(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Ps(2,l));if(e=We(e,c),o!=null)throw new Ae("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),s!=null&&(s=fe(fe(s,"bool"),"float32"),s.rank===l-1&&(s=gr(s,-1)),s=We(s,c)),r&&(e=cl(e,0),s!=null&&(s=cl(s,0)));const u=[];let h,d=n;const f=e.shape[0],p=ul(e);let m;s!=null&&(m=ul(s));for(let g=0;g<f;++g){const v=p[g],x=j(()=>t(v,d));if(s==null)h=x[0],d=x[1];else{const b=j(()=>{const w=m[g],C=Ee(cs(w),w),I=te(O(x[0],w),O(d[0],C)),S=d.map(($,E)=>te(O(x[1][E],w),O($,C)));return{output:I,newStates:S}});h=b.output,d=b.newStates}a&&u.push(h)}let y;return a&&(y=Ki(u,1)),[h,y,d]})}class da extends Me{constructor(e){super(e);let n;if(e.cell==null)throw new _("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new TE({cells:e.cell}):n=e.cell,n.stateSize==null)throw new _("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Qt({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ps(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){MC(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let s;if(this.returnSequences?s=[e[0],e[1],r]:s=[e[0],r],this.returnState){const o=[];for(const i of n)o.push([e[0],i]);return[s].concat(o)}else return s}computeMask(e,n){return j(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const s=this.states.map(o=>null);return[r].concat(s)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ae("Constants support is not implemented in RNN yet.");MC(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Qt({shape:[n,null,...r]});const s=[e[0]].concat(e.slice(2));this.cell.build(s);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!Qe(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new _(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new Qt({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){j(()=>{if(!this.stateful)throw new js("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new _("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>sn([r,s])):this.states_=[sn([r,this.cell.stateSize])];else if(e==null)ze(this.states_),this.keptStates!=null&&(ze(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(s=>sn([r,s])):this.states_[0]=sn([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new _(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):ze(this.states_);for(let s=0;s<this.states_.length;++s){const o=e[s],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[s]:this.cell.stateSize,a=[r,i];if(!Qe(o.shape,a))throw new _(`State ${s} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[s]=o}}this.states_=this.states_.map(s=>so(s.clone()))})}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const o=RU(e,r,s,this.numConstants);e=o.inputs,r=o.initialState,s=o.constants;let i=[],a=[];if(r!=null){n.initialState=r,i=i.concat(r),this.stateSpec=[];for(const c of r)this.stateSpec.push(new Qt({shape:c.shape}));a=a.concat(this.stateSpec)}if(s!=null&&(n.constants=s,i=i.concat(s),this.numConstants=s.length),i[0]instanceof Js){const c=[e].concat(i),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return j(()=>{const r=n==null?null:n.mask,s=n==null?null:n.training;let o=n==null?null:n.initialState;e=$e(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new _(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:s},c=_U((p,m)=>{const y=this.cell.call([p].concat(m),a);return[y[0],y.slice(1)]},e,o,this.goBackwards,r,null,this.unroll,this.returnSequences),u=c[0],h=c[1],d=c[2];this.stateful&&this.resetStates(d,s);const f=this.returnSequences?h:u;return this.returnState?[f].concat(d):f})}getInitialState(e){return j(()=>{let n=sn(e.shape);return n=be(n,[1,2]),n=_p(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?FC(n,[1,r]):n):this.cell.stateSize>1?[FC(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===da.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const s=n.cell,o=Ro(s,r);return new e(Object.assign(n,{cell:o}))}}da.className="RNN";Z(da);class fx extends Me{}class EE extends fx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,an(this.units,"units"),this.activation=Qi(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=bt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=bt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=bt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=wt(e.kernelRegularizer),this.recurrentRegularizer=wt(e.recurrentRegularizer),this.biasRegularizer=wt(e.biasRegularizer),this.kernelConstraint=Zt(e.kernelConstraint),this.recurrentConstraint=Zt(e.recurrentConstraint),this.biasConstraint=Zt(e.biasConstraint),this.dropout=nu([1,Xi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=nu([1,Xi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ke(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return j(()=>{if(e=e,e.length!==2)throw new _(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const s=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ji({ones:()=>cs(e),rate:this.dropout,training:s,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ji({ones:()=>cs(r),rate:this.recurrentDropout,training:s,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=ao(O(e,i),this.kernel.read()):o=ao(e,this.kernel.read()),this.bias!=null&&(o=Ms(o,this.bias.read())),a!=null&&(r=O(r,a));let l=te(o,ao(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Yi(this.activation),useBias:this.useBias,kernelInitializer:$t(this.kernelInitializer),recurrentInitializer:$t(this.recurrentInitializer),biasInitializer:$t(this.biasInitializer),kernelRegularizer:ot(this.kernelRegularizer),recurrentRegularizer:ot(this.recurrentRegularizer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),kernelConstraint:Jt(this.kernelConstraint),recurrentConstraint:Jt(this.recurrentConstraint),biasConstraint:Jt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}EE.className="SimpleRNNCell";Z(EE);class AU extends da{constructor(e){e.cell=new EE(e),super(e)}call(e,n){return j(()=>{this.cell.dropoutMask!=null&&(ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:o})})}static fromConfig(e,n){return new e(n)}}AU.className="SimpleRNN";Z(AU);class NE extends fx{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new _("GRUCell does not support reset_after parameter set to true.");this.units=e.units,an(this.units,"units"),this.activation=Qi(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Qi(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=bt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=bt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=bt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=wt(e.kernelRegularizer),this.recurrentRegularizer=wt(e.recurrentRegularizer),this.biasRegularizer=wt(e.biasRegularizer),this.kernelConstraint=Zt(e.kernelConstraint),this.recurrentConstraint=Zt(e.recurrentConstraint),this.biasConstraint=Zt(e.biasConstraint),this.dropout=nu([1,Xi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=nu([1,Xi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ke(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return j(()=>{if(e=e,e.length!==2)throw new _(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let s=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ji({ones:()=>cs(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ji({ones:()=>cs(s),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=O(e,o[0]));let u=ao(e,this.kernel.read());this.useBias&&(u=Ms(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(s=O(s,i[0]));const h=this.recurrentKernel.read(),[d,f]=Mr(h,[2*this.units,this.units],h.rank-1),p=ao(s,d),[m,y,g]=Mr(u,3,u.rank-1),[v,x]=Mr(p,2,p.rank-1);a=this.recurrentActivation.apply(te(m,v)),l=this.recurrentActivation.apply(te(y,x));const b=ao(O(l,s),f);c=this.activation.apply(te(g,b));const w=te(O(a,s),O(te(1,Lt(a)),c));return[w,w]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Yi(this.activation),recurrentActivation:Yi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$t(this.kernelInitializer),recurrentInitializer:$t(this.recurrentInitializer),biasInitializer:$t(this.biasInitializer),kernelRegularizer:ot(this.kernelRegularizer),recurrentRegularizer:ot(this.recurrentRegularizer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),kernelConstraint:Jt(this.kernelConstraint),recurrentConstraint:Jt(this.recurrentConstraint),biasConstraint:Jt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}NE.className="GRUCell";Z(NE);class DU extends da{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new NE(e),super(e)}call(e,n){return j(()=>{this.cell.dropoutMask!=null&&(ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}DU.className="GRU";Z(DU);class px extends fx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,an(this.units,"units"),this.activation=Qi(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Qi(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=bt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=bt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=bt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=wt(e.kernelRegularizer),this.recurrentRegularizer=wt(e.recurrentRegularizer),this.biasRegularizer=wt(e.biasRegularizer),this.kernelConstraint=Zt(e.kernelConstraint),this.recurrentConstraint=Zt(e.recurrentConstraint),this.biasConstraint=Zt(e.biasConstraint),this.dropout=nu([1,Xi([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=nu([1,Xi([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ke(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let s;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;s=new(n=class extends ds{apply(l,c){const u=o.apply([i]),h=new pE().apply([i]),d=o.apply([i*2]);return c_(c_(u,h),d)}},n.className="CustomInit",n)}else s=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,s,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return j(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new _(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let s=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ji({ones:()=>cs(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ji({ones:()=>cs(s),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,h;0<this.dropout&&this.dropout<1&&(e=O(e,i[0]));let d=ao(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(s=O(s,a[0])),d=te(d,ao(s,this.recurrentKernel.read())),this.useBias&&(d=Ms(d,this.bias.read()));const[f,p,m,y]=Mr(d,4,d.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=te(O(c,o),O(l,this.activation.apply(m))),h=this.recurrentActivation.apply(y);const g=O(h,this.activation.apply(u));return[g,g,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Yi(this.activation),recurrentActivation:Yi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$t(this.kernelInitializer),recurrentInitializer:$t(this.recurrentInitializer),biasInitializer:$t(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ot(this.kernelRegularizer),recurrentRegularizer:ot(this.recurrentRegularizer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),kernelConstraint:Jt(this.kernelConstraint),recurrentConstraint:Jt(this.recurrentConstraint),biasConstraint:Jt(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}px.className="LSTMCell";Z(px);class OU extends da{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new px(e),super(e)}call(e,n){return j(()=>{this.cell.dropoutMask!=null&&(ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,s=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}OU.className="LSTM";Z(OU);class TE extends fx{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return j(()=>{e=e;let r=e.slice(1);const s=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?s.push(r.splice(0,a.stateSize.length)):s.push(r.splice(0,1));s.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];r=s[a],a===0?i=[e[0]].concat(r):i=[i[0]].concat(r),i=l.call(i,n),o.push(i.slice(1))}r=[];for(const a of o.slice().reverse())r.push(...a);return[i[0]].concat(r)})}build(e){MC(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,s)=>{Va(`RNNCell_${s}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=o=>({className:o.getClassName(),config:o.getConfig()}),s={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),s)}static fromConfig(e,n,r={}){const s=[];for(const o of n.cells)s.push(Ro(o,r));return new e({cells:s})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return zC(e)}setWeights(e){const n=[];for(const r of this.cells){const s=r.weights.length,o=e.splice(s);for(let i=0;i<r.weights.length;++i)n.push([r.weights[i],o[i]])}wE(n)}}TE.className="StackedRNNCells";Z(TE);function Ji(t){const{ones:e,rate:n,training:r=!1,count:s=1,dropoutFunc:o}=t,i=()=>o!=null?o(e(),n):EB(e(),n),a=()=>Dp(i,e,r);return!s||s<=1?so(a().clone()):Array(s).fill(void 0).map(a).map(c=>so(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var G$e=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class PU extends da{constructor(e){if(e.unroll)throw new Ae("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ae("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Qt({ndim:5})]}call(e,n){return j(()=>{if(this.cell.dropoutMask!=null&&(ze(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ze(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new _("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,s=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:r,training:s,initialState:o})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return j(()=>{const{stateSize:n}=this.cell,r=e.shape,s=this.computeSingleOutputShape(r),o=[s[0],...s.slice(2)],i=sn(o);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){j(()=>{if(!this.stateful)throw new js("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,s=this.computeSingleOutputShape(r),o=[s[0],...s.slice(2)];if(r[0]==null)throw new _("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>sn(o)):this.states_=[sn(o)];else if(e==null)ze(this.states_),this.keptStates!=null&&(ze(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>sn(o)):this.states_[0]=sn(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new _(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):ze(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=o;if(!Qe(l.shape,c))throw new _(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>so(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:s,padding:o,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],h=Rs(c,s[0],o,i[0],a[0]),d=Rs(u,s[1],o,i[1],a[1]);return[...e.slice(0,2),...l?[r,h,d]:[h,d,r]]}}PU.className="ConvRNN2D";class RE extends px{constructor(e){const{filters:n,kernelSize:r,strides:s,padding:o,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,an(this.filters,"filters"),this.kernelSize=wc(r,2,"kernelSize"),this.kernelSize.forEach(l=>an(l,"kernelSize")),this.strides=wc(s||1,2,"strides"),this.strides.forEach(l=>an(l,"strides")),this.padding=o||"valid",Gr(this.padding),this.dataFormat=i||"channelsLast",Ut(this.dataFormat),this.dilationRate=wc(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>an(l,"dilationRate"))}build(e){var n;e=Ke(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new _(`The channel dimension of the input should be defined. Found ${e[r]}`);const s=e[r],o=4,i=this.kernelSize.concat([s,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends ds{apply(d,f){const p=c.apply([u]),m=Il([u]),y=c.apply([u*2]);return fE([p,m,y])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return j(()=>{if(e.length!==3)throw new _(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,s=e[0],o=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ji({ones:()=>cs(s),rate:this.dropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(z,Q,J)=>!Q||!Q[J]?z:O(Q[J],z);let u=c(s,l,0),h=c(s,l,1),d=c(s,l,2),f=c(s,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ji({ones:()=>cs(o),rate:this.recurrentDropout,training:r,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(o,p,0),y=c(o,p,1),g=c(o,p,2),v=c(o,p,3);const x=3,[b,w,C,I]=Mr(this.kernel.read(),a,x),[S,$,E,A]=this.useBias?Mr(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,b,S,this.padding),h=this.inputConv(h,w,$,this.padding),d=this.inputConv(d,C,E,this.padding),f=this.inputConv(f,I,A,this.padding);const[M,B,U,V]=Mr(this.recurrentKernel.read(),a,x);m=this.recurrentConv(m,M),y=this.recurrentConv(y,B),g=this.recurrentConv(g,U),v=this.recurrentConv(v,V);const H=this.recurrentActivation.apply(te(u,m)),K=this.recurrentActivation.apply(te(h,y)),R=te(O(K,i),O(H,this.activation.apply(te(d,g)))),D=O(this.recurrentActivation.apply(te(f,v)),this.activation.apply(R));return[D,D,R]})}getConfig(){const e=super.getConfig(),n=G$e(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,n,r,s){const o=ll(e,n,this.strides,s||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?Ms(o,r,this.dataFormat):o}recurrentConv(e,n){return ll(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}RE.className="ConvLSTM2DCell";Z(RE);class FU extends PU{constructor(e){const n=new RE(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}FU.className="ConvLSTM2D";Z(FU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _E extends Me{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let s=0;s<this.noiseShape.length;++s)r.push(this.noiseShape[s]==null?n[s]:this.noiseShape[s]);return r}call(e,n){return j(()=>{this.invokeCallHook(e,n);const r=$e(e);if(0<this.rate&&this.rate<1){const s=n.training==null?!1:n.training,o=this.getNoiseShape(r);return Dp(()=>EB(r,this.rate,o,this.seed),()=>r,s)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}_E.className="Dropout";Z(_E);class LU extends _E{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}LU.className="SpatialDropout1D";Z(LU);class MU extends Me{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,an(this.units,"units"),this.activation=Qi(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=bt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=bt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Zt(e.kernelConstraint),this.biasConstraint=Zt(e.biasConstraint),this.kernelRegularizer=wt(e.kernelRegularizer),this.biasRegularizer=wt(e.biasRegularizer),this.activityRegularizer=wt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ke(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ke(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return j(()=>{this.invokeCallHook(e,n);const r=$e(e),s=bB(this.activation.getClassName());let o;return s!=null?o=ao(r,this.kernel.read(),s,this.bias?this.bias.read():null):(o=ao(r,this.kernel.read()),this.bias!=null&&(o=Ms(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:Yi(this.activation),useBias:this.useBias,kernelInitializer:$t(this.kernelInitializer),biasInitializer:$t(this.biasInitializer),kernelRegularizer:ot(this.kernelRegularizer),biasRegularizer:ot(this.biasRegularizer),activityRegularizer:ot(this.activityRegularizer),kernelConstraint:Jt(this.kernelConstraint),biasConstraint:Jt(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}MU.className="Dense";Z(MU);class zU extends Me{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ke(e);for(const n of e.slice(1))if(n==null)throw new _(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],zi(e,1)]}call(e,n){return j(()=>{this.invokeCallHook(e,n);let r=$e(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const s=[0];for(let o=2;o<r.rank;++o)s.push(o);s.push(1),r=We(r,s)}return Nke(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}zU.className="Flatten";Z(zU);class BU extends Me{constructor(e){super(e),this.supportsMasking=!0,this.activation=Qi(e.activation)}call(e,n){return j(()=>{this.invokeCallHook(e,n);const r=$e(e);return this.activation.apply(r)})}getConfig(){const e={activation:Yi(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}BU.className="Activation";Z(BU);class UU extends Me{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return j(()=>(e=$e(e),$ke(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}UU.className="RepeatVector";Z(UU);class VU extends Me{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",s=n.slice();let o=1,i=null;for(let l=0;l<s.length;++l){const c=s[l];if(this.isUnknown(c))if(i===null)i=l;else throw new _("Can only specifiy one unknown dimension.");else o*=c}const a=zi(e);if(i!==null){if(o===0||a%o!==0)throw new _(r);s[i]=a/o}else if(a!==o)throw new _(r);return s}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return j(()=>{this.invokeCallHook(e,n);const r=$e(e),s=r.shape,o=s.slice(0,1).concat(this.fixUnknownDimension(s.slice(1),this.targetShape));return F(r,o)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}VU.className="Reshape";Z(VU);class WU extends Me{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Ps(1,e.dims.length+1);if(!Qe(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Qt({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ke(e);const n=e.slice();return this.dims.forEach((r,s)=>{n[s+1]=e[r]}),n}call(e,n){return We($e(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}WU.className="Permute";Z(WU);class jU extends Me{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=$e(e),s=-1;return gC(fy(r,this.maskValue),s)}call(e,n){return j(()=>{this.invokeCallHook(e,n);const r=$e(e),s=-1,o=!0,i=gC(fy(r,this.maskValue),s,o);return O(r,fe(i,r.dtype))})}}jU.className="Masking";Z(jU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class GU extends Me{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(ht(e.inputLength))}this.inputDim=e.inputDim,an(this.inputDim,"inputDim"),this.outputDim=e.outputDim,an(this.outputDim,"outputDim"),this.embeddingsInitializer=bt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=wt(e.embeddingsRegularizer),this.activityRegularizer=wt(e.activityRegularizer),this.embeddingsConstraint=Zt(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return j(()=>this.maskZero?(e=$e(e),fy(e,je(e))):null)}computeOutputShape(e){if(e=Ke(e),this.inputLength==null)return[...e,this.outputDim];const n=ht(this.inputLength);if(n.length!==e.length-1)throw new _(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let s=0;s<n.length;++s){const o=n[s],i=e[s+1];if(o!=null&&i!=null&&o!==i)throw new _(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(n[r]=i),r++}}return[e[0],...n,this.outputDim]}call(e,n){return j(()=>{this.invokeCallHook(e,n);let r=$e(e);r.dtype!=="int32"&&(r=io(r,"int32"));const s=$B(this.embeddings.read(),F(r,[r.size]));return F(s,Ke(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:$t(this.embeddingsInitializer),embeddingsRegularizer:ot(this.embeddingsRegularizer),activityRegularizer:ot(this.activityRegularizer),embeddingsConstraint:Jt(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}GU.className="Embedding";Z(GU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Al extends Me{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ae}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let s=0;s<n.length;++s){const o=e[e.length-n.length+s],i=n[s];if(o==null||i==null||o<0||i<0)r.push(null);else if(o===1)r.push(i);else if(i===1)r.push(o);else{if(o!==i)throw new _("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(o)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ke(e)]),e=e,e.length<2)throw new _(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const o of e)o!=null&&o[0]!==null&&n.push(o[0]);if(n=Mi(n),n.length>1)throw new _(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);r=this.computeElementwiseOpOutputShape(r,i)}const s=e.map(o=>o.length);e.indexOf(null)===-1&&Mi(s).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return j(()=>{if(e=e,this.reshapeRequired){const r=[],s=e.map(o=>o.rank);if(s.indexOf(null)===-1){const o=Xi(s);for(let i of e){const a=i.rank;for(let l=0;l<o-a;++l)i=_p(i,1);r.push(i)}return this.mergeFunction(r)}else{let o=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,h=u[0],d=u.slice(1).concat([h]);let f=F(l,[h].concat(zi(u.slice(1))));f=We(f,[1,0]),f=F(f,d),r.push(f),o=!0}else if(c>1){const u=Ps(1,c).concat([0]);r.push(We(l,u)),o=!0}else r.push(l)}let i=this.mergeFunction(r);const a=i.rank;if(o){if(a==null){const l=i.shape,c=l.length,u=l[c-1],h=[u].concat(l.slice(0,l.length-1));i=F(We(F(i,[-1,u]),[1,0]),h)}else if(a>1){const l=[a-1].concat(Ps(0,a-1));i=We(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let s=1;s<e.length;++s){const o=e[s]==null?null:e[s].slice(1);n=this.computeElementwiseOpOutputShape(n,o)}let r=[];for(const s of e)s!=null&&s[0]!==null&&r.push(s[0]);return r=Mi(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return j(()=>{if(n==null)return null;if(!Array.isArray(n))throw new _("`mask` should be an Array");if(!Array.isArray(e))throw new _("`inputs` should be an Array");if(n.length!==e.length)throw new _(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(s=>s==null))return null;n=n.map(s=>s==null?s:gr(s,0));let r=n[0];for(let s=1;s<n.length-1;++s)r=Wo(r,n[s]);return r})}}class HU extends Al{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=te(n,e[r]);return n})}}HU.className="Add";Z(HU);class KU extends Al{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=O(n,e[r]);return n})}}KU.className="Multiply";Z(KU);class qU extends Al{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=te(n,e[r]);return O(1/e.length,n)})}}qU.className="Average";Z(qU);class XU extends Al{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=la(n,e[r]);return n})}}XU.className="Maximum";Z(XU);class YU extends Al{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=_d(n,e[r]);return n})}}YU.className="Minimum";Z(YU);class QU extends Al{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new _("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const s of e)if(s!=null){n=!1;break}if(n)return;const r=[];for(let s=0;s<e.length;++s){const o=e[s].slice();o.splice(this.axis,1);let i=!1;for(const a of r)if(Qe(a,o)){i=!0;break}i||r.push(o)}if(r.length>1)throw new _("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return j(()=>fE(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new _("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),s=this.axis<0?r.length+this.axis:this.axis;for(const o of n.slice(1)){if(r[s]==null||o[s]==null){r[s]=null;break}r[s]+=o[s]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new _("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new _("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new _(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return j(()=>{let r=!0;if(n.forEach(i=>{if(i!=null){r=!1;return}}),r)return null;const s=[];for(let i=0;i<e.length;++i)n[i]==null?s.push(fe(cs(e[i]),"bool")):n[i].rank<e[i].rank?s.push(gr(n[i],-1)):s.push(n[i]);const o=ir(s,this.axis);return t3(o,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}QU.className="Concatenate";Z(QU);function Zu(t,e){for(;t<0;)t+=e;return t}function H$e(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ae("batchDot is not implemented for tensors of 4D or higher rank yet");if(k(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),k(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ae("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,s=e.shape.length;n==null&&(n=[r-1,s-2]);const o=n;return j(()=>{let i;if(r>s){i=r-s;const l=[];for(let c=0;c<i;++c)l.push(1);e=F(e,e.shape.concat(l))}else if(s>r){i=s-r;const l=[];for(let c=0;c<i;++c)l.push(1);t=F(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&e.shape.length===2)o[0]===o[1]?a=be(O(t,e),o[0]):a=be(O(We(t,[1,0]),e),o[1]);else{const l=o[0]!==t.shape.length-1,c=o[1]===e.shape.length-1;a=Ye(t,e,l,c)}if(i>0){let l;r>s?l=r+s-3:l=r-1;const c=[];for(let u=l;u<l+i;++u)c.push(u);a=vp(a,c)}return a.shape.length===1&&(a=gr(a,1)),a})}class JU extends Al{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){k(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new Ae("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);if(n[s[0]]!==r[s[1]])throw new _(`Dimension incompatibility: ${n[s[0]]} !== ${r[s[1]]}`)}mergeFunction(e){if(e.length!==2)throw new _(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],s;return Array.isArray(this.axes)?s=this.axes.map((o,i)=>Zu(o,e[i].shape.length)):s=[Zu(this.axes,n.shape.length),Zu(this.axes,r.shape.length)],this.normalize&&(n=Ty(n,s[0]),r=Ty(r,s[1])),H$e(n,r,s)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[Zu(this.axes,e.length),Zu(this.axes,n.length)],r}computeOutputShape(e){k(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new Ae("Dot layer does not support tensors of 4D or higher rank yet.");const s=this.interpretAxes(n,r);n.splice(s[0],1),r.splice(s[1],1),r.splice(0,1);const o=n.concat(r);return o.length===1&&o.push(1),o}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}JU.className="Dot";Z(JU);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ZU extends Me{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return j(()=>{this.invokeCallHook(e,n);const r=$e(e);return Dp(()=>te(ax(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}ZU.className="GaussianNoise";Z(ZU);class eV extends Me{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return j(()=>{this.invokeCallHook(e,n);const r=$e(e);return this.rate>0&&this.rate<1?Dp(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return O(r,ax(r.shape,1,o))},()=>r,n.training||!1):r})}}eV.className="GaussianDropout";Z(eV);class tV extends Me{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||$e(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return j(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return Dp(()=>{const o=$e(e),i=1.6732632423543772,a=1.0507009873554805,l=-i*a;let c=Cl(yp(r),this.rate);c=io(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-u*l*this.rate,d=te(O(o,c),O(te(c,-1),l));return te(O(d,u),h)},()=>$e(e),n.training||!1)}return e})}}tV.className="AlphaDropout";Z(tV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bd(t,e,n,r,s,o=.001){let i;if(t.rank===2)i=fne(t,e,n,r,s,o);else if(t.rank===3)i=mne(t,e,n,r,s,o);else if(t.rank===4)i=yne(t,e,n,r,s,o);else throw new Ae(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function K$e(t,e,n,r,s=.001){return j(()=>{const o=n$(t,r),i=o.mean,a=o.variance;return[Bd(t,i,a,n,e,s),i,a]})}function q$e(t,e,n,r,s=.001){return j(()=>{const o=n$(t,r),i=o.mean,a=o.variance,l=[];for(const p of Ps(0,t.rank))r.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=F(i,l),u=F(a,l),h=e==null?null:F(e,l),d=n==null?null:F(n,l);return[Bd(t,c,u,d,h,s),i,a]})}function X$e(t,e,n,r,s=.001){return Qe(r.slice().sort(),Ps(0,t.rank-1))?K$e(t,e,n,r,s):q$e(t,e,n,r,s)}class nV extends Me{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=bt(e.betaInitializer||"zeros"),this.gammaInitializer=bt(e.gammaInitializer||"ones"),this.movingMeanInitializer=bt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=bt(e.movingVarianceInitializer||"ones"),this.betaConstraint=Zt(e.betaConstraint),this.gammaConstraint=Zt(e.gammaConstraint),this.betaRegularizer=wt(e.betaRegularizer),this.gammaRegularizer=wt(e.gammaRegularizer)}build(e){e=Ke(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new _(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Qt({ndim:e.length,axes:{[n]:r}})];const s=[r];this.scale&&(this.gamma=this.addWeight("gamma",s,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",s,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",s,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",s,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return j(()=>{const r=n.training==null?!1:n.training,s=$e(e),o=s.shape,i=o.length,a=Ps(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const c=pl(1,i);c[l]=o[l];const u=a.slice();u.sort();const h=!Qe(u,Ps(0,i).slice(0,i-1)),d=()=>{if(h){const v=F(this.movingMean.read(),c),x=F(this.movingVariance.read(),c),b=this.center?F(this.beta.read(),c):null,w=this.scale?F(this.gamma.read(),c):null;return Bd(s,v,x,b,w,this.epsilon)}else return Bd(s,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return d();const[f,p,m]=X$e(s,this.gamma.read(),this.beta.read(),a,this.epsilon),y=(v,x,b)=>{j(()=>{const w=1-b,C=v.read(),I=O(Ee(C,x),w);v.write(Ee(C,I))})};return(()=>{y(this.movingMean,p,this.momentum),y(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$t(this.betaInitializer),gammaInitializer:$t(this.gammaInitializer),movingMeanInitializer:$t(this.movingMeanInitializer),movingVarianceInitializer:$t(this.movingVarianceInitializer),betaRegularizer:ot(this.betaRegularizer),gammaRegularizer:ot(this.gammaRegularizer),betaConstraint:Jt(this.betaConstraint),gammaConstraint:Jt(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}nV.className="BatchNormalization";Z(nV);class rV extends Me{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=bt(e.betaInitializer||"zeros"),this.gammaInitializer=bt(e.gammaInitializer||"ones"),this.betaRegularizer=wt(e.betaRegularizer),this.gammaRegularizer=wt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ke(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=n);for(const o of this.axis)if(o<0||o>=n)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==Mi(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(o=>e[o]),s=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,s):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,s):this.beta=null,this.built=!0}call(e,n){const r=$e(e),s=r.shape,o=s.length;return j(()=>{let{mean:a,variance:l}=n$(r,this.axis,!0);const c=pl(1,o);for(const m of this.axis)c[m]=s[m];const u=m=>m!=null&&m.shape.length!==o?F(m,c):m;let h=this.scale?u(this.gamma.read()):null,d=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<o;++m)this.axis.indexOf(m)!==-1?(f.push(s[m]),p.push(1)):(f.push(1),p.push(s[m]));return a=ks(a,f),l=ks(l,f),h!=null&&(h=ks(h,p)),d!=null&&(d=ks(d,p)),Bd(r,a,l,d,h,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$t(this.betaInitializer),gammaInitializer:$t(this.gammaInitializer),betaRegularizer:ot(this.betaRegularizer),gammaRegularizer:ot(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}rV.className="LayerNormalization";Z(rV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Y$e(t,e,n){return j(()=>{if(t.rank!==4)throw new _(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new _("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Fs()),n!=="channelsLast"&&n!=="channelsFirst")throw new _(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],r$(t,r)})}class sV extends Me{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Fs():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new _(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new _(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new _(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new Qt({ndim:4})]}computeOutputShape(e){e=Ke(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return j(()=>Y$e($e(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}sV.className="ZeroPadding2D";Z(sV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mx(t,e,n,r,s,o){return j(()=>{Ut(s),CB(o),Gr(r),n==null&&(n=[1,1]),r==null&&(r="valid"),s==null&&(s=Fs()),o==null&&(o="max"),t=$E(t,s);let i;const a=r==="same"?"same":"valid";return o==="max"?i=t$(t,e,n,a):i=jk(t,e,n,a),s==="channelsFirst"&&(i=We(i,[0,3,1,2])),i})}function oV(t,e,n,r,s,o){return j(()=>{Ut(s),CB(o),Gr(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),s==null&&(s=Fs()),o==null&&(o="max"),t=CU(t,s);let i;const a=r==="same"?"same":"valid";return o==="max"?i=nse(t,e,n,a):i=rne(t,e,n,a),s==="channelsFirst"&&(i=We(i,[0,4,1,2,3])),i})}class iV extends Me{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new _(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(an(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new _(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);an(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Gr(this.padding),this.inputSpec=[new Qt({ndim:3})]}computeOutputShape(e){e=Ke(e);const n=Rs(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return j(()=>{this.invokeCallHook(e,n),e=_p($e(e),2);const r=this.poolingFunction($e(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return vp(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class aV extends iV{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Ut(o),Gr(s),mx(e,n,r,s,o,"max")}}aV.className="MaxPooling1D";Z(aV);class lV extends iV{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Ut(o),Gr(s),mx(e,n,r,s,o,"avg")}}lV.className="AveragePooling1D";Z(lV);class cV extends Me{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new _(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];an(this.poolSize,"poolSize"),an(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ut(this.dataFormat),Gr(this.padding),this.inputSpec=[new Qt({ndim:4})]}computeOutputShape(e){e=Ke(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Rs(n,this.poolSize[0],this.padding,this.strides[0]),r=Rs(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return j(()=>(this.invokeCallHook(e,n),this.poolingFunction($e(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class uV extends cV{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Ut(o),Gr(s),mx(e,n,r,s,o,"max")}}uV.className="MaxPooling2D";Z(uV);class hV extends cV{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Ut(o),Gr(s),mx(e,n,r,s,o,"avg")}}hV.className="AveragePooling2D";Z(hV);class dV extends Me{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new _(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];an(this.poolSize,"poolSize"),an(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ut(this.dataFormat),Gr(this.padding),this.inputSpec=[new Qt({ndim:5})]}computeOutputShape(e){e=Ke(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],s=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Rs(n,this.poolSize[0],this.padding,this.strides[0]),r=Rs(r,this.poolSize[1],this.padding,this.strides[1]),s=Rs(s,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,s]:[e[0],n,r,s,e[4]]}call(e,n){return j(()=>(this.invokeCallHook(e,n),this.poolingFunction($e(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class fV extends dV{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Ut(o),Gr(s),oV(e,n,r,s,o,"max")}}fV.className="MaxPooling3D";Z(fV);class pV extends dV{constructor(e){super(e)}poolingFunction(e,n,r,s,o){return Ut(o),Gr(s),oV(e,n,r,s,o,"avg")}}pV.className="AveragePooling3D";Z(pV);class mV extends Me{constructor(e){super(e),this.inputSpec=[new Qt({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ae}}class gV extends mV{constructor(e){super(e||{})}call(e,n){return j(()=>{const r=$e(e);return jt(r,1)})}}gV.className="GlobalAveragePooling1D";Z(gV);class yV extends mV{constructor(e){super(e||{})}call(e,n){return j(()=>{const r=$e(e);return Ts(r,1)})}}yV.className="GlobalMaxPooling1D";Z(yV);class vV extends Me{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Ut(this.dataFormat),this.inputSpec=[new Qt({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ae}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class xV extends vV{call(e,n){return j(()=>{const r=$e(e);return this.dataFormat==="channelsLast"?jt(r,[1,2]):jt(r,[2,3])})}}xV.className="GlobalAveragePooling2D";Z(xV);class bV extends vV{call(e,n){return j(()=>{const r=$e(e);return this.dataFormat==="channelsLast"?Ts(r,[1,2]):Ts(r,[2,3])})}}bV.className="GlobalMaxPooling2D";Z(bV);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wV extends Me{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const s=n.layer,o=Ro(s,r);delete n.layer;const i={layer:o};return Object.assign(i,n),new e(i)}}class CV extends wV{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ke(e),e.length<3)throw new _(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ke(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),s=e[1];return[r[0],s].concat(r.slice(1))}call(e,n){return j(()=>(e=$e(e),_U((i,a)=>[$e(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}CV.className="TimeDistributed";Z(CV);function Q$e(t){_l(wke,"BidirectionalMergeMode",t)}const J$e="concat";class IV extends wV{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=Ro(r),n.goBackwards=n.goBackwards!==!0;const s={};if(s.className=e.layer.getClassName(),s.config=n,this.backwardLayer=Ro(s),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?J$e:e.mergeMode,Q$e(this.mergeMode),e.weights)throw new Ae("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,s,o;return this.returnState&&(o=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,s=[r]):this.mergeMode==null?s=[r,r.slice()]:s=[r],this.returnState?this.mergeMode==null?s.concat(o).concat(o.slice()):[r].concat(o).concat(o.slice()):tr(s)}apply(e,n){let r=n==null?null:n.initialState,s=n==null?null:n.constants;n==null&&(n={});const o=RU(e,r,s,this.numConstants);if(e=o.inputs,r=o.initialState,s=o.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&s==null)return super.apply(e,n);const i=[],a=[];if(r!=null){const c=r.length;if(c%2>0)throw new _("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,i.push(...r);const u=r.map(h=>new Qt({shape:h.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(s!=null)throw new Ae("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof Js;for(const c of i)if(c instanceof Js!==l)throw new _("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(i),u=this.inputSpec.concat(a),h=this.inputSpec;this.inputSpec=u;const d=super.apply(c,n);return this.inputSpec=h,d}else return super.apply(e,n)}call(e,n){return j(()=>{const r=n.initialState;let s,o;if(r==null)s=this.forwardLayer.call(e,n),o=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),c=r.slice(r.length/2);s=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let i;this.returnState&&(Array.isArray(s)&&(i=s.slice(1).concat(o.slice(1))),s=s[0],o=o[0]),this.returnSequences&&(o=cl(o,1));let a;return this.mergeMode==="concat"?a=fE([s,o]):this.mergeMode==="sum"?a=te(s,o):this.mergeMode==="ave"?a=O(.5,te(s,o)):this.mergeMode==="mul"?a=O(s,o):this.mergeMode==null&&(a=[s,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Va(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Va(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(r)?r.concat(o).concat(o):[r].concat(o).concat(o)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=Ro(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ae("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const s=n;return s.layer=r,new e(s)}}IV.className="Bidirectional";Z(IV);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class SV extends Me{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return j(()=>(e=$e(e),e.dtype!=="float32"&&(e=io(e,"float32")),te(O(e,this.scale),this.offset)))}}SV.className="Rescaling";Z(SV);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Z$e,cropAndResize:eEe}=$o;class kV extends Me{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,s,o,i,a,l){return j(()=>{let c,u=!1;const h=n/i,d=r/a,f=(s+n)/i,p=(o+r)/a,m=[h,d,f,p],y=[];e.rank===3?(u=!0,c=Ki([e])):c=e;for(let w=0;w<c.shape[0];w++)y.push(m);const g=jM(y,[y.length,4]),v=Ad(0,y.length,1,"int32"),b=eEe(c,g,v,[s,o],"nearest");return io(u?$e(ul(b)):b,l)})}upsize(e,n,r,s){return j(()=>{const o=Z$e(e,[n,r]);return io(o,s)})}call(e,n){return j(()=>{const r=$e(e),s=r.dtype,o=r.shape,i=o[o.length-3],a=o[o.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(r,l,c,this.height,this.width,i,a,s):this.upsize(e,this.height,this.width,s)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ke(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}kV.className="CenterCrop";Z(kV);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tEe(t,e,n,r){let s=$e(t);if(s.dtype!=="int32"&&(s=io(s,"int32")),e==="int")return s;const o=s.shape;if(s.rank===0&&(s=gr(s,-1)),e==="oneHot"&&s.shape[s.shape.length-1]!==1&&(s=gr(s,-1)),s.rank>2)throw new _(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${o} which would result in output rank ${s.rank}.`);const i=["multiHot","oneHot"].includes(e),a=s;let l;if(typeof r<"u"&&e==="count"?l=dR(a,r,n,i):l=dR(a,[],n,i),e!=="tfIdf")return l;if(r)return O(l,r);throw new _("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class $V extends Me{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ke(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return j(()=>{e=$e(e),e.dtype!=="int32"&&(e=io(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new _(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=$e(n.countWeights)}const s=Ts(e),o=hy(e),i=jr(this.numTokens,s).bufferSync().get(0),a=Cl(o,0).bufferSync().get(0);if(!(i&&a))throw new _(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return tEe(e,this.outputMode,this.numTokens,r)})}}$V.className="CategoryEncoding";Z($V);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const nEe=["bilinear","nearest"],E_=new Set(nEe);class EV extends Me{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(E_.has(e.interpolation))this.interpolation=e.interpolation;else throw new _(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ke(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return j(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return $o.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return $o.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...E_]} are supported`)})}}EV.className="Resizing";Z(EV);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class NV{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}NV.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TV extends Me{constructor(e){super(e),this.randomGenerator=new NV(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}TV.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const rEe=["bilinear","nearest"],N_=new Set(rEe);class RV extends TV{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new _(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new _(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new _(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(N_.has(r))this.interpolation=r;else throw new _(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ke(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return j(()=>{const r=$e(e);this.imgHeight=r.shape[r.shape.length-3];const s=r.shape[r.shape.length-2];this.widthFactor=yp([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*s;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return $o.resizeBilinear(e,i);case"nearest":return $o.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...N_]} are supported`)}})}}RV.className="RandomWidth";Z(RV);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sEe=G();sEe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var T_;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(T_||(T_={}));var R_;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(R_||(R_={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var __;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(__||(__={}));const oEe=()=>{const[t,e]=W.useState(null),[n,r]=W.useState(null),[s,o]=W.useState({name:"",prompt:"",photo:""}),[i,a]=W.useState("No Disease"),{speak:l}=ku.useSpeechSynthesis(),c=()=>{l({text:i})};W.useEffect(()=>{c()},[i]),console.log(t);const u=p=>{const m=p.target.files[0];if(e(m),m&&m.type.substr(0,5)==="image"){const y=new FileReader;y.onloadend=()=>{o({...s,photo:y.result})},y.readAsDataURL(m)}else alert("Please upload an image")},h=os.currentUser,d=async p=>{try{const m=await pu(fu(xu,"plantdisease"),{name:i,time:new Date().toLocaleString(),user:h.uid})}catch{}};return T(_o,{children:he("div",{className:"main flex lg:flex-row flex-col    justify-between mt-10 lg:mt-5",children:[he("div",{className:"model flex flex-col  justify-center items-center  lg:w-[950px]  lg:h-[600px] border-solid border-[2px] lg:m-3 m-5 ",children:[T("h1",{className:"lg:text-2xl text-1xl mb-10  font-bold",children:"Upload image to detect plant disease"}),he("form",{className:"flex flex-col items-center justify center",onSubmit:async p=>{p.preventDefault();const m=new FileReader;m.readAsDataURL(t),m.onloadend=()=>r(m.result);const y=await qL(n,"plant_diseases");a(y);try{d()}catch(g){console.log(g)}},children:[T("div",{className:"lg:text-xl text-1xl flex justify-center items-center   md:w-[500px] md:h-[300px] border-solid border-2 rounded-[15px]",children:s.photo?T("img",{src:s.photo,alt:"uploaded",className:" w-[400px] h-[199px]  md:w-[500px] md:h-[299px]  border-2 lg:w-[500px] lg:h-[300px] border-solid border-4 rounded:-[5px] md:rounded-[15px]"}):T("h1",{className:" font-bold",children:"No Image Uploaded"})}),he("div",{className:"flex",children:[he("label",{htmlFor:"photo",className:"cursor-pointer",children:[T("div",{className:"mt-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",children:"Upload"}),T("input",{type:"file",accept:"image/*",capture:"environment",name:"photo",id:"photo",className:"sr-only",onChange:u})]}),T("button",{className:"m-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",type:"submit",children:"Predict"})]})]}),T("h1",{className:"lg:text-2xl text-1xl font-bold  m-5",children:i})]}),T("h1",{className:"font-bold flex justify-center lg:hidden",children:"HelperBot"}),T(Vc,{})]})})};function iEe(t){return zF({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"}},{tag:"path",attr:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}}]})(t)}function aEe(t){return t.trigger?T("div",{className:"popup",children:he("div",{className:"popup-inner h-[500px]",children:[T("span",{className:"close-btn ",onClick:()=>{t.setTrigger(!1)},children:T(iEe,{})}),t.children]})}):""}function lEe(t){return zF({tag:"svg",attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M4 21v-13a3 3 0 0 1 3 -3h10a3 3 0 0 1 3 3v6a3 3 0 0 1 -3 3h-9l-4 4"}},{tag:"path",attr:{d:"M9.5 9h.01"}},{tag:"path",attr:{d:"M14.5 9h.01"}},{tag:"path",attr:{d:"M9.5 13a3.5 3.5 0 0 0 5 0"}}]})(t)}const cEe=()=>{const[t,e]=W.useState(null),[n,r]=W.useState(null),[s,o]=W.useState({name:"",prompt:"",photo:""}),[i,a]=W.useState("No Species Detected"),[l,c]=W.useState(!1),{speak:u}=ku.useSpeechSynthesis(),h=()=>{u({text:i})},d=()=>{c(!0)};W.useEffect(()=>{h()},[i]),console.log(t);const f=g=>{const v=g.target.files[0];if(e(v),v&&v.type.substr(0,5)==="image"){const x=new FileReader;x.onloadend=()=>{o({...s,photo:x.result})},x.readAsDataURL(v)}else alert("Please upload animage")},p=os.currentUser,m=async g=>{try{const v=await pu(fu(xu,"invasive"),{name:i,time:new Date().toLocaleString(),user:p.uid})}catch{}};return T(_o,{children:he("div",{className:"main flex lg:flex-row flex-col    justify-between mt-10 lg:mt-5",children:[he("div",{className:"model flex flex-col  justify-center items-center  lg:w-[950px]  lg:h-[600px] border-solid border-[2px] lg:m-3 m-5 ",children:[T("h1",{className:"lg:text-2xl text-1xl mb-10  font-bold",children:"Upload image to detect invasive species"}),he("form",{className:"flex flex-col items-center justify center",onSubmit:async g=>{g.preventDefault();const v=new FileReader;v.readAsDataURL(t),v.onloadend=()=>r(v.result);const x=await model_predict(n,"invasive_species");a(x);try{m()}catch(b){console.log(b)}},children:[T("div",{className:"lg:text-xl text-1xl flex justify-center items-center   md:w-[500px] md:h-[300px] border-solid border-2 rounded-[15px]",children:s.photo?T("img",{src:s.photo,alt:"uploaded",className:" w-[400px] h-[199px]  md:w-[500px] md:h-[299px]  border-2 lg:w-[500px] lg:h-[300px] border-solid border-4 rounded:-[5px] md:rounded-[15px]"}):T("h1",{className:" font-bold",children:"No Image Uploaded"})}),he("div",{className:"flex",children:[he("label",{htmlFor:"photo",className:"cursor-pointer",children:[T("div",{className:"mt-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",children:"Upload"}),T("input",{type:"file",accept:"image/*",capture:"environment",name:"photo",id:"photo",className:"sr-only",onChange:f})]}),T("button",{className:"m-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",type:"submit",children:"Predict"})]})]}),T("h1",{className:"lg:text-2xl text-1xl font-bold  m-5",children:i})]}),he("div",{className:"hidden lg:block",children:[T("h1",{className:"font-bold flex justify-center lg:hidden",children:"HelperBot"}),T(Vc,{})]}),T("div",{className:" flex lg:hidden justify-end mr-10 text-2xl",children:he("button",{onClick:d,className:"flex",children:[T(lEe,{})," ",T("h1",{className:"text-sm",children:"HelperBot"})]})}),T(aEe,{trigger:l,setTrigger:c,children:he("div",{className:"flex flex-col  justify-center  items-center",children:[T("h1",{className:"text-xl font-bold text-gray-700 flex justify-center",children:"Helper Bot"}),T("div",{className:"w-[350px] h-[400px] flex justify-center items-center ",children:T(Vc,{})})]})})]})})};const uEe=()=>{const[t,e]=W.useState(null),[n,r]=W.useState({name:"",prompt:"",photo:""}),[s,o]=W.useState("No Species Detected"),{speak:i}=ku.useSpeechSynthesis(),a=()=>{i({text:s})};W.useEffect(()=>{a()},[s]),console.log(t);const l=d=>{const f=d.target.files[0];if(e(f),f&&f.type.substr(0,5)==="image"){const p=new FileReader;p.onloadend=()=>{r({...n,photo:p.result})},p.readAsDataURL(f)}else alert("Please upload animage")},c=os.currentUser,u=async d=>{try{const f=await pu(fu(xu,"eggquality"),{name:s,time:new Date().toLocaleString(),user:c.uid})}catch{}};return T(_o,{children:he("div",{className:"main flex lg:flex-row flex-col    justify-between mt-10 lg:mt-5",children:[he("div",{className:"model flex flex-col  justify-center items-center  lg:w-[950px]  lg:h-[600px] border-solid border-[2px] lg:m-3 m-5 ",children:[T("h1",{className:"lg:text-2xl text-1xl mb-10  font-bold",children:"Upload image to detect egg quality"}),he("form",{className:"flex flex-col items-center justify center",onSubmit:async d=>{d.preventDefault(),o("Founded");try{u()}catch(f){console.log(f)}},children:[T("div",{className:"lg:text-xl text-1xl flex justify-center items-center   md:w-[500px] md:h-[300px] border-solid border-2 rounded-[15px]",children:n.photo?T("img",{src:n.photo,alt:"uploaded",className:" w-[400px] h-[199px]  md:w-[500px] md:h-[299px]  border-2 lg:w-[500px] lg:h-[300px] border-solid border-4 rounded:-[5px] md:rounded-[15px]"}):T("h1",{className:" font-bold",children:"No Image Uploaded"})}),he("div",{className:"flex",children:[he("label",{htmlFor:"photo",className:"cursor-pointer",children:[T("div",{className:"mt-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",children:"Upload"}),T("input",{type:"file",accept:"image/*",capture:"environment",name:"photo",id:"photo",className:"sr-only",onChange:l})]}),T("button",{className:"m-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",type:"submit",children:"Predict"})]})]}),T("h1",{className:"lg:text-2xl text-1xl font-bold  m-5",children:s})]}),T("h1",{className:"font-bold flex justify-center lg:hidden",children:"HelperBot"}),T(Vc,{})]})})};const hEe=()=>{const[t,e]=W.useState(null);W.useState(null),W.useState({name:"",prompt:"",photo:""});const[n,r]=W.useState("No Species Detected"),{speak:s}=ku.useSpeechSynthesis(),o=()=>{s({text:n})};W.useEffect(()=>{o()},[n]),console.log(t);const i=os.currentUser,a=async c=>{try{const u=await pu(fu(xu,"eggquality"),{name:n,time:new Date().toLocaleString(),user:i.uid})}catch{}};return T(_o,{children:he("div",{className:"main flex lg:flex-row flex-col    justify-between mt-10 lg:mt-5",children:[he("div",{className:"model flex flex-col  justify-center items-center  lg:w-[950px]  lg:h-[600px] border-solid border-[2px] lg:m-3 m-5 ",children:[T("h1",{className:"lg:text-2xl text-1xl mb-10  font-bold",children:"Realtime Analysis"}),T("form",{className:"flex flex-col items-center justify center",onSubmit:async c=>{c.preventDefault();const u=await lee();console.log(100),console.log(u.crop),r(u.crop);try{a()}catch(h){console.log(h)}},children:T("button",{className:"m-3 text-white bg-[#6469ff] hover:text-[#6469ff] hover:bg-blue-200 font-medium rounded-md text-sm w-full sm:w-auto px-5 py-2.5 text-center",type:"submit",children:"Predict"})}),T("h1",{className:"lg:text-2xl text-1xl font-bold  m-5",children:n})]}),T("h1",{className:"font-bold flex justify-center lg:hidden",children:"HelperBot"}),T(Vc,{})]})})};function dEe(){return T("div",{className:"App",children:he(iH,{children:[T(AX,{}),he(tH,{children:[T(Bs,{path:"/home",element:T(TX,{})}),T(Bs,{path:"/",element:T(s2,{title:"SignIn"})}),T(Bs,{path:"/signup",element:T(s2,{title:"SignUp"})}),T(Bs,{path:"/chicken",element:T(cee,{})}),T(Bs,{path:"/plant",element:T(oEe,{})}),T(Bs,{path:"/invasive",element:T(cEe,{})}),T(Bs,{path:"/egg",element:T(uEe,{})}),T(Bs,{path:"/feed",element:T(hEe,{})}),T(Bs,{path:"/dashboard",element:T(ZX,{})})]})]})})}Lb.createRoot(document.getElementById("root")).render(T(q.StrictMode,{children:T(dEe,{})}));
